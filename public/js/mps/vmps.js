/*! For license information please see vmps.js.LICENSE.txt */
(self.webpackChunkMPS=self.webpackChunkMPS||[]).push([[132],{44605:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(80223),s=r(47401);const a={components:{AttachmentsComponent:i.Z,ListAttachmentsComponent:s.Z},data:function(){return{attachments:null,form:{attachments:[]}}},methods:{handleUpload:function(t){this.form.attachments.push(t)},clearAttachments:function(){this.form.attachments=[],this.form.new_attachments=[]},deleteAttachment:function(t){this.attachments=this.attachments.filter((function(e){return e.uuid!==t.uuid}))}}}},48921:(t,e,r)=>{"use strict";function i(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{Z:()=>l});const l=function(t,e,r,s,a){return a=a||!0,r=r||!1,s=s||!1,{data:function(){return{original:{},saving:!1,loading:!0,attributes:[],errors:{message:"",form:{}}}},created:function(){this.original=n({},this.form),this.$route.params.id?a&&this.fetch(this.$route.params.id):r?this.create():this.loading=!1},watch:{$route:function(t,e){t.name.includes("add")?(this.form=n({},this.original),this.handleReset()):t.name.includes("edit")&&this.$route.params.id&&(this.loading=!0,this.fetch(this.$route.params.id))}},methods:{handleSubmit:function(e){var r=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$refs[t].validate((function(t){t?(r.saving=!0,r.submit(e,i)):r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10})}))},handleReset:function(){this.form=n({},this.original),this.$refs[t].resetFields(),this.saving=!1},submit:function(a,o){var l=this,c=e,u="added";this.errors.message="";var d="record_added";this.form.id&&""!=this.form.id&&(u="updated",c=e+"/"+this.form.id,d="record_updated",this.form._method="PUT"),c+=o?"?stay=1":"";var m=n({},this.form);if(this.attributes&&this.attributes.length>0){var h=this.attributes.map((function(t){var e={};return delete m[t.slug],e[t.slug]=l.form[t.slug],e}));m.extra_attributes=Object.assign.apply(Object,i(h))}"promo"!=t&&m.items&&(m.items=m.items.map((function(t){var e={id:t.id,name:t.name,code:t.code,cost:t.cost,price:t.price,item_id:t.item_id,unit_id:t.unit_id,item_unit_id:t.item_unit_id,quantity:t.quantity,batch_no:t.batch_no,net_cost:t.net_cost,net_price:t.net_price,tax_amount:t.tax_amount,unit_cost:t.unit_cost,unit_price:t.unit_price,taxes:t.taxes,allTaxes:t.allTaxes,categories:t.categories,selected:(t.selected,{modifiers:[],variations:[],portions:[]}),has_serials:t.has_serials,tax_included:t.tax_included,discount_amount:t.discount_amount,discount:t.discount?t.discount:0,expiry_date:t.expiry_date?l.$moment(t.expiry_date).format(l.$moment.HTML5_FMT.DATE):""};return t.selected.modifiers.length&&(e.selected.modifiers=t.selected.modifiers.map((function(t){return{id:t.mId,selected:t.id,price:t.price,quantity:t.quantity}}))),t.selected.variations.length&&(e.selected.variations=t.selected.variations.map((function(t){return{id:t.id,price:t.price,quantity:t.quantity}}))),t.selected.portions.length&&(e.selected.portions=t.selected.portions.map((function(t){return{id:t.id,cost:t.cost,price:t.price,quantity:t.quantity,essentials:t.essentials.map((function(t){return{id:t.id,item_id:t.item_id,variation_id:t.variation_id}})),choosables:t.choosables.map((function(t){return{id:t.id,selected:t.selected,variation_id:t.variation_id}})),portion_items:t.portion_items.map((function(t){return{id:t.id,item_id:t.item_id,variation_id:t.variation_id}}))}}))),e.promotions&&e.promotions.length&&(e.promotions=e.allPromotions.filter((function(t){return e.promotions.includes(t.id)}))),e.categories&&e.categories.length&&(e.categories=e.categories.map((function(t){return{id:t.id,promotions:t.promotions&&t.promotions.length?t.promotions.map((function(t){return t.id})):[]}}))),e.selected.variations.length&&(e.selected.variations=e.selected.variations.map((function(t){return t.taxes=t.taxes?t.taxes.map((function(t){return t.id})):[],t.allTaxes=t.item_taxes=t.allTaxes?t.allTaxes.map((function(t){return t.id})):[],t}))),e.selected.serials=t.selected.serials,e.taxes=e.taxes?e.taxes.map((function(t){return t.id})):[],e.allTaxes=e.item_taxes=e.allTaxes?e.allTaxes.map((function(t){return t.id})):[],e.promotions=t.promotions&&t.promotions.length?t.promotions.map((function(t){return t.id})):[],e.allPromotions=e.item_promotions=t.allPromotions&&t.allPromotions.length?t.allPromotions.map((function(t){return t.id})):[],e}))),"modifiers"==a&&(m.options=m.options.map((function(t){return{id:t.id,sku:t.sku,item_id:t.item_id,quantity:t.quantity}}))),m.date&&(m.date=this.$moment(m.date).format(this.$moment.HTML5_FMT.DATE)),m.start_date&&(m.start_date=this.$moment(m.start_date).format(this.$moment.HTML5_FMT.DATE)),m.expiry_date&&(m.expiry_date=this.$moment(m.expiry_date).format(this.$moment.HTML5_FMT.DATE)),m.settings&&m.settings.birth_date&&(m.settings.birth_date=this.$moment(m.settings.birth_date).format(this.$moment.HTML5_FMT.DATE)),m.settings&&m.settings.hire_date&&(m.settings.hire_date=this.$moment(m.settings.hire_date).format(this.$moment.HTML5_FMT.DATE)),m.user&&delete m.user,m.customer&&delete m.customer,m.location&&delete m.location,m=this.$form(m),this.$http.post(c,m).then((function(e){e.data.success?(l.$Notice.destroy(),l.$Notice.success({title:l.$tc(t)+" "+l.$t(u),desc:l.$t(d)}),o?("updated"==u?s&&(l.form=s(e.data.data,l)):l.handleReset(),l.step&&(l.step=0),r&&l.create()):l.$router.push({name:a+".list"})):l.$Notice.error({title:l.$t("failed"),desc:l.$t("failed_error_text")})})).catch((function(t){return l.errors=t})).finally((function(){return l.saving=!1}))},updateCF:function(e,r){var i=this;this.form[e]=r,setTimeout((function(){i.$refs[t].validateField(e)}),1e3)}}}}},21490:(t,e,r)=>{"use strict";r.d(e,{Z:()=>f});var i=r(36940),s=r.n(i),a=r(23279),n=r.n(a),o=r(48921),l=r(44605);function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function d(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t){return function(t){if(Array.isArray(t))return h(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var p=function(t,e,r){return e.attributes=t.attributes,delete t.customer,delete t.supplier,delete t.user,delete t.attributes,t.discount_method="items",t.items=t.items.map((function(t){t.item.guid=e.guid(),t.item.id=r?"":t.id,t.item.item_id=t.item_id,t.item.sale_item_id=t.id,t.item.item_unit_id=t.item.unit_id,t.item.unit_id=t.unit_id,t.item.batch_no=t.batch_no,t.item.unit&&(t.item.allUnits=[u({},t.item.unit)].concat(m(t.item.unit.subunits))),t.item.quantity=parseFloat(t.quantity),t.item.real_value=parseFloat(t.item[e.field]),t.item[e.field]=parseFloat(t[e.field]),t.item.expiry_date=new Date(t.expiry_date),t.item.discount_amount=parseFloat(t.discount_amount);var i=t.item[e.field]-t.item.discount_amount;return t.item.discount=t.discount&&parseFloat(t.discount)>0?parseFloat(t.discount):null,t.item.allTaxes=m(t.item.taxes),t.item.taxes=e.calculateTaxes(t.item.allTaxes,i),"price"==e.field&&(t.promotions=t.promotions,t.item.promotions=t.promotions,t.item.allPromotions=m(t.item.promotions)),t.item.selected={modifiers:[],variations:[],portions:[]},t.modifier_options&&t.modifier_options.length&&(t.item.selected.modifiers=t.modifier_options.map((function(r){var i=t.item.modifiers.find((function(t){return t.id==r.modifier_id})),s=i.options.find((function(t){return t.id==r.id})),a={id:r.id,meta:r.meta,title:i.title,mId:r.modifier_id,option:s.name,cost:parseFloat(r.pivot.cost),price:parseFloat(r.pivot.price),quantity:parseFloat(r.pivot.quantity)};a.discount_amount=parseFloat(r.pivot.discount_amount);var n=a[e.field]-a.discount_amount;return a.discount=t.discount&&parseFloat(t.discount)>0?parseFloat(t.discount):null,a.taxes=e.calculateTaxes(t.item.allTaxes,n),a}))),t.variations&&t.variations.length&&(t.item.selected.variations=t.variations.map((function(r){var i=t.item.variations.find((function(t){return r.id==t.id})),s={id:r.id,meta:r.meta,cost:parseFloat(r.pivot.cost),price:parseFloat(r.pivot.price),quantity:parseFloat(r.pivot.quantity),available:parseFloat(r.pivot.quantity+i.location_stock[0].quantity)};s.discount_amount=parseFloat(r.pivot.discount_amount);var a=s[e.field]-s.discount_amount;return s.discount=t.discount&&parseFloat(t.discount)>0?parseFloat(t.discount):null,s.taxes=e.calculateTaxes(t.item.allTaxes,a),s}))),t.portions&&t.portions.length&&(t.item.selected.portions=t.portions.map((function(r){var i={id:r.id,name:r.name,cost:parseFloat(r.pivot.cost),price:parseFloat(r.pivot.price),quantity:parseFloat(r.pivot.quantity),choosables:r.choosables.map((function(t){var e=r.pivot.choosables.find((function(e){return e.id==t.id})),i=t.items.find((function(t){return t.item_id==e.item_id})).item,s=i.has_variants?i.variations.find((function(t){return t.id==e.variation_id})):null;return i.has_variants?u(u({},t),{},{selected:e.item_id,meta:s?s.meta:null,variation_id:e.variation_id,variants:m(i.variants),variations:m(i.variations)}):u(u({},t),{},{selected:e.item_id,variation_id:null})})),essentials:r.essentials.map((function(t){var e=r.pivot.essentials.find((function(e){return e.id==t.id}));if(t.item.has_variants){var i=t.item.variations.find((function(t){return t.id==e.variation_id}));return u(u({},t),{},{meta:i?i.meta:null,variation_id:e.variation_id,variants:m(t.item.variants),variations:m(t.item.variations)})}return t})),portion_items:r.portion_items.map((function(t){var e=r.pivot.portion_items.find((function(e){return e.id==t.id}));if(t.item.has_variants){var i=t.item.variations.find((function(t){return t.id==e.variation_id}));return u(u({},t),{},{meta:i?i.meta:null,variation_id:e.variation_id,variants:m(t.item.variants),variations:m(t.item.variations)})}return t}))};i.discount_amount=parseFloat(r.pivot.discount_amount);var s=i[e.field]-i.discount_amount;return i.discount=t.discount&&parseFloat(t.discount)>0?parseFloat(t.discount):null,i.taxes=e.calculateTaxes(t.item.allTaxes,s),i}))),t.item})),t.shipping_fee=t.shipping_fee?parseFloat(t.shipping_fee):null,e.is_draft=!!t.draft,t.draft=t.draft?""+t.draft:"0",t.payment="0",t.type=t.type||"nett",t.deduct_from_register="0",t.date&&(t.date=new Date(t.date)),t.start_date&&(t.start_date=new Date(t.start_date)),r&&(t.id="",t.reference="",t.date=new Date),e.attachments=t.attachments&&t.attachments.length?m(t.attachments):[],e.form=u(u({},t),t.extra_attributes),e.changed=!1,e.form};const f=function(t,e,r,i,a){return s().capitalize(t),e=e||"app/"+s().pluralize(t),r=r||("purchase"==t?"cost":"price"),{mixins:[l.Z,(0,o.Z)(t,e,!0,p,!1)],data:function(){var e=this;return{query:"",taxes:[],result:[],photo:null,customers:[],suppliers:[],attributes:[],is_draft:!0,changed:!1,deleting:!1,new_photo:null,edit_item:null,searching:!1,field:r,attachments:null,show_item_edit:!1,expiry_date_options:{disabledDate:function(t){return t&&t.valueOf()<Date.now()-864e5}},form:{id:"",taxes:[],items:[],draft:0,payment:0,repeat:"",details:"",reference:"",discount:null,attachments:[],date:new Date,shipping_fee:null,create_before:null,start_date:new Date,deduct_from_register:0,discount_method:"items",type:"return_order"==t?"":"nett",customer_id:"",supplier_id:""},rules:{discount:[{validator:function(t,r,i){r&&parseFloat(r)>parseFloat(e.$store.state.settings.max_discount)?i(new Error(e.$t("max_discount_error",{percent:parseFloat(e.$store.state.settings.max_discount)}))):i()},type:"number",trigger:["change","blur"]}],details:[{message:this.$t("field_is_required",{field:this.$t("details")}),trigger:"blur"}],customer_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("customer")}),trigger:"change"}],supplier_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("supplier")}),trigger:"change"}],date:[{type:"date",required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("date")})}],start_date:[{type:"date",required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("start_date")})}],type:[{required:!0,message:this.$t("field_is_required",{field:this.$t("type")}),trigger:"change"}],repeat:[{required:!0,message:this.$t("field_is_required",{field:this.$t("repeat")}),trigger:"change"}],taxes:[{type:"array",required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("category")})}]}}},watch:{"form.customer_id":function(t,e){var r=this;if(e){var i=this.customers.find((function(t){return t.value==e}));i&&i.customer_group&&i.customer_group.discount&&this.form.items.map((function(t){t.discount=parseFloat(t.discount)-parseFloat(i.customer_group.discount),r.addToOrder(t,t.quantity,!0,!0)}))}t&&this.checkCustomerGroup(t)},"form.discount_method":function(t,e){var r=this;"order"==this.form.discount_method?this.form.items=this.form.items.map((function(t){return t.discount=null,t.discount_amount=0,t})):this.form.items=this.form.items.map((function(t){return t.discount=r.form.discount?r.form.discount:null,t.discount_amount=r.form.discount?r.formatDecimal(t[r.field]*t.discount/100):0,t}))},"form.discount":n()((function(t,e){var r=this;(t=t?parseFloat(t):0)<=parseFloat(this.$store.state.settings.max_discount)&&"items"==this.form.discount_method&&(this.form.items=this.form.items.map((function(e){return e.discount=t,e.discount_amount=t?r.formatDecimal(e[r.field]*e.discount/100):0,e})))}),500)},created:function(){var t=this;this.$route.params.id||this.$event.fire("location:select"),this.$event.listen("addOrderRowByItemID",(function(e){t.addOrderRowByItemID(e.id,e.item_id)})),this.$http.get("app/taxes/search").then((function(e){return t.taxes=e.data})).then((function(){t.$route.params.id&&t.fetch(t.$route.params.id)})),i&&i.id?this.$route.query[i.qId]?this.$http.get("/app/quotations/".concat(this.$route.query[i.qId],"?attr=sale")).then((function(e){return p(e.data,t,!0)})).finally((function(){return t.loading=!1})):this.$route.query[i.id]&&this.fetch(this.$route.query[i.id],!0):this.form.customer_id=this.$store.state.settings.default_customer},methods:{create:function(){var t=this;this.$http.get("".concat(e,"/create")).then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t,r){var i=this;this.$http.get("".concat(e,"/").concat(t)).then((function(t){return p(t.data,i,r)})).finally((function(){return i.loading=!1}))},selectPurchaseItem:function(t){var e=this;this.loading=!0,this.$http.get("app/purchase_order_items/"+t).then((function(t){return e.addToOrder(t.data)})).catch((function(t){return console.log(t)})).finally((function(){return e.loading=!1}))},searchItems:function(e){if("return_order"==t&&!this.form.type)return this.$Notice.error({title:this.$t("invalid_form"),desc:this.$t("invalid_form_error"),duration:10}),!1;if(e.length<35&&!e.includes("(")){var r="purchase"==t||"adjustment"==t;this.getItems(e,this,r)}},getItems:n()((function(t,e,r){e.searching=!0;var i="app/items/search?q="+t;r&&(i="app/items_wp/search?type=standard,service&q="+t);var s=null,a=(e.$store.getters.search_delay,e.$store.getters.scale_barcode);a&&a.total_digits&&a.total_digits==t.length&&(i="app/items/search?scale=1&q="+(s=e.parseScaleBarcode(t,a)).item_code+"&barcode="+t),e.$http.get(i).then((function(t){if(s&&t.data&&t.data.id){var i=t.data.location_stock.length>0&&t.data.location_stock[0].price?parseFloat(t.data.location_stock[0].price):parseFloat(t.data.price);t.data.barcode_price=e.formatDecimal(s.price,4),t.data.barcode_qty=e.formatQtyDecimal(s.weight,4),t.data.barcode_price||(t.data.barcode_price=e.formatDecimal(i/t.data.barcode_qty)),t.data.barcode_qty||(t.data.barcode_qty=e.formatQtyDecimal(s.price/i)),e.selectSaleItem(t.data.id,t.data),e.result=[]}else t.data&&1==t.data.length?(r?e.selectPurchaseItem(t.data[0].id):e.selectSaleItem(t.data[0].id),e.result=[]):e.result=t.data||[]})).finally((function(){return e.searching=!1}))}),search_delay||250),searchCustomers:function(t){""===t||this.customers.find((function(e){return e.label==t}))||this.getCustomers(t,this)},getCustomers:n()((function(t,e){e.searching=!0,e.$http.get("app/customers/search?q="+t).then((function(t){return e.customers=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),searchSuppliers:function(t){""===t||this.suppliers.find((function(e){return e.label==t}))||this.getSuppliers(t,this)},getSuppliers:n()((function(t,e){e.searching=!0,e.$http.get("app/suppliers/search?q="+t).then((function(t){return e.suppliers=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),is_draftable:function(){return!this.$route.params.id||this.is_draft}}}}},42184:(t,e,r)=>{"use strict";r.d(e,{Z:()=>u});var i=r(6151),s=r(22254);function a(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const u=function(t,e,r,n){return{components:{InputNumberComponent:i.Z,SelectVariationComponent:s.Z},data:function(){return{item:{},variantModal:!1}},watch:{variantModal:function(t){t||(this.item={},this.$refs.selectVarMod.$refs.form.resetFields())}},methods:{variationSubmitted:function(t){var e=t.quantity?t.quantity:1;this.item.selected={modifiers:[],variations:[],portions:[],serials:[]},t.serials&&t.serials.length&&(this.item.selected.serials=t.serials),t.modifiers&&t.modifiers.length&&(this.item.selected.modifiers=t.modifiers),t.selected_variation&&this.item.selected.variations.push(t.selected_variation),t.selected_portion&&this.item.selected.portions.push(t.selected_portion),this.addToOrder(this.item,e,!1,!1,!0),this.variantModal=!1},calculateItemDiscountAmount:function(t){var e=this,r=0;return t.selected.modifiers.length&&t.selected.modifiers.length&&(t.selected.modifiers=t.selected.modifiers.map((function(i){var s=e.formatDecimal(parseFloat(i[e.field])*parseFloat(t.discount)/100);return e.applicablePromotions(t).map((function(t){s+=e.formatDecimal(parseFloat(i[e.field]-s)*parseFloat(t.discount)/100)})),r+=s,i.discount_amount=s,i}))),t.selected.variations.length||t.selected.portions.length?(t.selected.variations.length&&(t.selected.variations=t.selected.variations.map((function(i){var s=e.formatDecimal(parseFloat(i[e.field])*parseFloat(t.discount)/100);return e.applicablePromotions(t).map((function(t){s+=e.formatDecimal(parseFloat(i[e.field]-s)*parseFloat(t.discount)/100)})),r+=s,i.discount_amount=s,i}))),t.selected.portions.length&&(t.selected.portions=t.selected.portions.map((function(i){var s=e.formatDecimal(parseFloat(i[e.field])*parseFloat(t.discount)/100);return e.applicablePromotions(t).map((function(t){s+=e.formatDecimal(parseFloat(i[e.field]-s)*parseFloat(t.discount)/100)})),r+=s,i.discount_amount=s,i}))),t.discount_amount=parseFloat(this.formatDecimal(r)),t):(r=this.formatDecimal(parseFloat(t[this.field])*parseFloat(t.discount)/100),this.applicablePromotions(t).map((function(i){r+=e.formatDecimal(parseFloat(t[e.field]-r)*parseFloat(i.discount)/100)})),t.discount_amount=r,t)},applySXGD:function(t){var r=this;this[e].items=this[e].items.map((function(t){t.promotions&&t.promotions.length&&t.promotions.map((function(e,i){t=r.calculateItemDiscountAmount(t)}))}))},applicablePromotions:function(t){return t.allPromotions?t.allPromotions.filter((function(e){return t.promotions.includes(e.id)})):[]},applyPromotions:function(t,e){var r=this;return!t.allPromotions||t.allPromotions.length<1?[]:t.allPromotions.filter((function(e){return r.applyPromoDiscount(e,t)})).map((function(t){return t.id}))},addPromoDiscount:function(t,e){return t.id||(t=e.allPromotions.find((function(e){return e.id==t}))),e.allPromotions.find((function(e){return e.id==t.id}))||e.allPromotions.push(t),e},applyPromoDiscount:function(t,e){if("simple"==t.type)return!0;if("advance"==t.type){if(e.quantity>=parseFloat(t.quantity_to_buy))return!0}else if("BXGY"==t.type){if(e.quantity>=parseFloat(t.quantity_to_buy))return this.addOrderRowByItemID(t.item_id_to_get,e.id),!0}else if("SXGD"==t.type&&this.orderTotalAmount>=parseFloat(t.amount_to_spend))return!0;return!1},checkCustomerGroup:function(t){var r=this;this.$nextTick((function(){var t=r.customers.find((function(t){return t.value==r[e].customer_id}));t&&t.customer_group&&r[e].items.map((function(e){e.discount=(e.discount?parseFloat(e.discount):0)+parseFloat(t.customer_group.discount),r.addToOrder(e,e.quantity,!0,!0)}))}))},checkPromos:function(t){var e=this;return t.promotions=t.valid_promotions,delete t.valid_promotions,t.promotions&&t.promotions.length&&t.promotions.map((function(r){t=e.addPromoDiscount(r,t)})),t.categories&&t.categories[0].valid_promotions&&t.categories[0].valid_promotions.length&&t.categories[0].valid_promotions.map((function(r){t=e.addPromoDiscount(r,t)})),t.promotions=this.applyPromotions(t),t=this.calculateItemDiscountAmount(t),t=this.doTaxCalculation(t)},calcItemTax:function(t){return t.taxes&&t.taxes.length?t.taxes.reduce((function(t,e){return t+parseFloat(e.amount)}),0):0},doTaxCalculation:function(t,e){var r=this,i=t[this.field]-(!e&&t.discount_amount?parseFloat(t.discount_amount):0);return t.taxes=this.calculateTaxes(t.allTaxes,i,t.tax_included),t.selected.modifiers.length&&(t.selected.modifiers=t.selected.modifiers.map((function(i){var s=i[r.field]-(!e&&i.discount_amount?parseFloat(i.discount_amount):0);return i.taxes=r.calculateTaxes(t.allTaxes,s),i.total_tax_amount=r.calcItemTax(i),i}))),t.selected.variations.length&&(t.selected.variations=t.selected.variations.map((function(i){var s=i[r.field]-(!e&&i.discount_amount?parseFloat(i.discount_amount):0);return i.taxes=r.calculateTaxes(t.allTaxes,s),i.total_tax_amount=r.calcItemTax(i),i}))),t.selected.portions.length&&(t.selected.portions=t.selected.portions.map((function(i){var s=i[r.field]-(!e&&i.discount_amount?parseFloat(i.discount_amount):0);return i.taxes=r.calculateTaxes(t.allTaxes,s),i.total_tax_amount=r.calcItemTax(i),i}))),t},calculateTaxes:function(t,e,r){var i=this,s=(t=this.applicableTaxes(t)).filter((function(t){return 1==t.compound})),n=t.filter((function(t){return 0==t.compound})).map((function(t){return l(l({},t),{},{value:t.id,on:parseFloat(e),amount:i.calculateTaxOn(t.rate,e,r)})})),o=n.reduce((function(t,e){return t+parseFloat(e.amount)}),0),c=s.map((function(t){return l(l({},t),{},{value:t.id,on:parseFloat(e)+parseFloat(o),amount:i.calculateTaxOn(t.rate,parseFloat(e)+parseFloat(o),r)})}));return[].concat(a(n),a(c))},calculateTaxOn:function(t,e,r){return 1==r?this.calculateInclusiveTax(t,e):this.calculateExclusiveTax(t,e)},calculateInclusiveTax:function(t,e){return this.formatDecimal(parseFloat(e)*parseFloat(t)/(100+parseFloat(t)),4)},calculateExclusiveTax:function(t,e){return this.formatDecimal(parseFloat(e)*parseFloat(t)/100,4)},applicableTaxes:function(r){var i=this;return r.filter((function(r){var s=i.$store.getters.location;if("cost"==t){if(n)return!r.same;var a=i.suppliers.find((function(t){return t.value==i[e].supplier_id}));if(r.state&&a&&s){var o=a.state==s.state;return r.same?o:!o}}else{var l=i.customers?i.customers.find((function(t){return t.value==i[e].customer_id})):null;if(r.state&&l&&s){var c=l.state==s.state;return r.same?c:!c}}return!0}))},playSound:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];1==this.$store.getters.play_sound&&this.$event.fire(t?"okSound":"errorSound")},addOrderRowByItemID:function(t,e){var r=this;this.$http.get("app/items/"+t).then((function(t){t.data[r.field]=0,t.data.promo=1,t.data.promotions=null,t.data.promo_item_id=e,t.data.categories[0].promotions=null,r.addToOrder(t.data)}))},selectItem:function(t){this.query="",this.addToOrder(JSON.parse(t))},selectSaleItem:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r?this.cloading=!0:this.loading=!0,i?(this.addToOrder(i),this.loading=!1):this.$http.get("app/sale_order_items/"+t).then((function(t){return e.addToOrder(t.data)})).catch((function(t){return console.log(t)})).finally((function(){r?(e.query="",e.cloading=!1):e.loading=!1}))},addToOrder:function(i,s,o,c,u){var d=this;if(!i)return!1;if(!this[e]||!i.code||!i.name)return!1;if(i.selected||(i.selected={modifiers:[],portions:[],variations:[],serials:[]},n||"cost"!=t||(i.selected.serials=[{number:"",till:""}])),c)o||(i=this.checkPromos(i)),r?this.$store.commit("setOrderRow",i):this[e].items=this[e].items.map((function(t){return t.item_id==i.id?i:t}));else{if(this.cloading=!0,!u&&(i.serials&&i.serials.length||i.modifiers&&i.modifiers.length>0||i.portions&&i.portions.length>0||i.variants&&i.variants.length>0&&i.variations&&i.variations.length>0))return"recipe"!=i.type||1!=i.portions.length||i.modifiers&&i.modifiers.length?(this.cloading=!1,this.item=JSON.parse(JSON.stringify(i)),this.variantModal=!0,!1):(i.selected.portions=a(i.portions),this.addToOrder(i,1,!1,!1,!0),!0);var m={},h=!!(this[e].items&&this[e].items.length>0)&&this[e].items.find((function(t){return t.id==i.id&&t.promo==i.promo&&(!t.variation||t.variation&&i.variation&&t.variation.id==i.variation.id)}));h?(h.quantity=o?parseFloat(s):parseFloat(h.quantity)+(s?parseFloat(s):i.barcode_qty?i.barcode_qty:1),i.selected.portions.length&&(i.selected.portions=i.selected.portions.map((function(t){return t.quantity=t.quantity?t.quantity:1,t})),h.selected.portions.push(i.selected.portions[0])),i.selected.variations.length&&h.selected.variations.push(i.selected.variations[0]),i.selected.modifiers.length&&(h.selected.modifiers.length?i.selected.modifiers.map((function(t){h.selected.modifiers=h.selected.modifiers.map((function(e){return e.id==t.id&&(e.quantity=parseFloat(e.quantity)+1),e})),h.selected.modifiers.find((function(e){return e.id==t.id}))||h.selected.modifiers.push(t)})):h.selected.modifiers=i.selected.modifiers),h=this.doTaxCalculation(h),"price"==t&&(h=this.checkPromos(h)),r?this.$store.commit("setOrderRow",h):this[e].items=this[e].items.map((function(t){return t.item_id==h.id?h:t})),this.alert(this.$root.$t("cart_item_updated",{item:i.name})),this.playSound(!0)):("price"==t&&this.customer&&this.customer.customer_group&&(i.discount=parseFloat(i.discount?i.discount:0)+(this.customer.customer_group?parseFloat(this.customer.customer_group.discount):0)),i.unit&&(i.allUnits=[l(l({},i.unit),{},{subunits:null})].concat(a(i.unit.subunits))),(m=l(l({},i),{},{comment:"",item_id:i.id,item_unit_id:i.unit_id,unit_id:"price"==t?i.sale_unit_id?i.sale_unit_id:i.unit_id:i.purchase_unit_id?i.purchase_unit_id:i.unit_id,guid:this.guid(),allTaxes:a(i.taxes),selected:l({},i.selected),discount:i.discount?i.discount:null,quantity:s?parseFloat(s):i.barcode_qty?i.barcode_qty:1})).selected.portions=m.selected.portions.map((function(t){return t.quantity=t.quantity?t.quantity:1,t})),m.price=m.location_stock.length>0&&m.location_stock[0].price?parseFloat(m.location_stock[0].price):parseFloat(m.price),m.cost=m.location_stock.length>0&&m.location_stock[0].cost?parseFloat(m.location_stock[0].cost):parseFloat(m.cost),(m=this.doTaxCalculation(m)).total_tax_amount=this.calcItemTax(m),"price"==t&&(m.promotions=i.promotions?i.promotions:[],m.allPromotions=i.allPromotions?i.allPromotions:[],m=this.checkPromos(m)),r?this.$store.commit("addOrderRow",m):this[e].items.push(m),this.alert(this.$root.$t("added_to_cart",{item:m.name})),this.playSound(!0)),r&&window&&document.documentElement.clientWidth>768&&this.$event.fire("order:scroll"),this.cloading=!1}this.$nextTick((function(){d.query="",d.isMobile()||document.querySelector("#scan_barcode").focus()}))}}}}},61402:(t,e,r)=>{"use strict";r.d(e,{Z:()=>d});r(18446);var i=r(23279),s=r.n(i),a=r(42184);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}const d=function(t,e,i,n){return{mixins:[(0,a.Z)(t,e,i,n)],data:function(){var e=this,r=function(t,r,i){r&&r>e.edit_item.max_discount?i(new Error(e.$t("max_discount_error",{percent:parseFloat(e.edit_item.max_discount)}))):i()},i=function(t,r,i){r&&(r>e.edit_item.max_price||r<e.edit_item.min_price)?i(new Error(e.$t("mm_price_error",{min:parseFloat(e.edit_item.min_price),max:parseFloat(e.edit_item.max_price)}))):i()};return{show:!1,field:t,gift_cards:[],gift_card:null,cloading:!1,itemPrice:i,itemDiscount:r,itemRules:{cost:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("cost")}),trigger:["change","blur"]}],price:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("price")}),trigger:["change","blur"]},{validator:i,trigger:["change","blur"]}],quantity:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("quantity")}),trigger:["change","blur"]}],discount:[{validator:r,trigger:["change","blur"]}]}}},computed:{customer:function(){var t=this;return this.customers.find((function(r){return r.value==t[e].customer_id}))},orderTotalItems:function(){return this[e]&&this[e].items?this[e].items.length:0},orderOriginalTotal:function(){var t=this;if(this[e]&&"order"!=this[e].discount_method){var r=c(this[e].items).map((function(e){var r={tax_included:e.tax_included,allTaxes:c(e.allTaxes),quantity:e.quantity,selected:{}};return r[t.field]=e[t.field],r.selected.variations=e.selected.variations.map((function(t){return o({},t)})),r.selected.portions=e.selected.portions.map((function(t){return o({},t)})),r.selected.modifiers=e.selected.modifiers.map((function(t){return o({},t)})),parseFloat(t.calcRowOriginalTotal(r))})).reduce((function(t,e){return t+e}),0);return this.formatDecimal(r)}return 0},orderDiscount:function(){return this[e]&&"order"==this[e].discount_method?this.formatDecimal(this.orderTotalAmount*this[e].discount/100):0},orderTotalQuantity:function(){return this[e]?this[e].items.map((function(t){return t.quantity})).reduce((function(t,e){return t+e}),0):0},orderPayableAmount:function(){return this[e]?this.formatDecimal(this.orderTotalAmount-this.orderDiscount):0},paymentChange:function(){return this.paymentForm.amount>this.orderTotalAmount?this.paymentForm.amount-this.orderTotalAmount:0},totalItemTax:function(){var t=this,r=this[e].items.reduce((function(e,r){var i=(r=t.doTaxCalculation(r)).taxes.reduce((function(t,e){return t+parseFloat(e.amount)*parseFloat(r.quantity)}),0);return parseFloat(e+i)}),0);return this.formatDecimal(r)},orderTotalAmount:function(){var t=this;c(this[e].items);return this.formatDecimal(this[e].items.reduce((function(e,r){return e+(r?t.calcRowTotal(r):0)}),0))}},methods:{giftCardSelected:function(t){this.gift_card=this.gift_cards.find((function(e){return e.number==t}))},searchGiftCard:function(t){this.getGiftCard(t,this)},getGiftCard:s()((function(t,e){e.searching=!0,e.$http.get("app/gift_cards/search?q="+t).then((function(t){1==t.data.length?(e.gift_card=t.data[0],e.paymentForm.gift_card_number=t.data[0].number):e.gift_cards=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),getPortionById:function(t,e){return t.find((function(t){return t.id==e}))},getPortionChoosable:function(t,e,r){return t.choosables.find((function(t){return t.id==e})).selected==r},changeSelectedPortion:function(t,e){var r=t?this.edit_item.portions.find((function(t,r){return r==e})):{},i=t?this.edit_item.portions.find((function(e){return e.id==t})):{},s={id:i.id,name:i.name,choosables:[],quantity:r.quantity?r.quantity:1};i.choosables.map((function(t){s.choosables.push({id:t.id,selected:t.items[0].item_id})})),this.edit_item.selected.portions[e]=o({},s)},modOptLabel:function(t){return t.item.name+" (+"+this.formatDecimal(t.item[this.field])+")"},itemQuantityChanged:function(t){i?this.$event.fire("pos:order:update",{item:t,qty:t.quantity,set:!0,force:!1,vCheck:!1}):this.addToOrder(t,t.quantity,!0)},itemUnitChanged:function(){var t=this.calculateUnitPrice(this.edit_item,this.field);this.edit_item=this.doTaxCalculation(t)},itemVariationQuantityChanged:function(t){t.quantity=t.selected.variations.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),i?this.$event.fire("pos:order:update",{item:t,qty:t.quantity,set:!0,force:!0,vCheck:!0}):this.addToOrder(t,t.quantity,!0,!0,!0)},itemPortionQuantityChanged:function(t){t.quantity=t.selected.portions.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),i?this.$event.fire("pos:order:update",{item:t,qty:t.quantity,set:!0,force:!0,vCheck:!0}):this.addToOrder(t,t.quantity,!0,!0,!0)},itemModifierQuantityChanged:function(t){i?this.$event.fire("pos:order:update",{item:t,qty:t.quantity,set:!0,force:!0,vCheck:!0}):this.addToOrder(t,t.quantity,!0,!0,!0)},checkDisc:function(t,e){if(t){if(-1!==t.toString().indexOf("%")){var r=t.split("%"),i=this.formatDecimal(parseFloat(e)*parseFloat(r[0])/100);return{discount:t,discount_amount:isNaN(parseFloat(i))?0:parseFloat(i)}}return{discount:t,discount_amount:isNaN(parseFloat(t))?0:parseFloat(t)}}return{discount:"",discount_amount:0}},calcRowOriginalTotal:function(t){var e=this,r=0;return t.selected.modifiers.length&&(r+=t.selected.modifiers.reduce((function(r,i){var s=parseFloat(i[e.field]);return i.taxes=e.calculateTaxes(t.allTaxes,s,t.tax_included),i.total_tax_amount=e.calcItemTax(i),r+parseFloat(i.quantity)*(s+(1==t.tax_included?0:parseFloat(i.total_tax_amount)))}),0)),t.selected.variations.length||t.selected.portions.length?(t.selected.variations.length&&(r+=t.selected.variations.reduce((function(r,i){var s=parseFloat(i[e.field]?i[e.field]:t[e.field]);return i.taxes=e.calculateTaxes(t.allTaxes,s,t.tax_included),i.total_tax_amount=e.calcItemTax(i),r+parseFloat(i.quantity)*(s+(1==t.tax_included?0:parseFloat(i.total_tax_amount)))}),0)),t.selected.portions.length&&(r+=t.selected.portions.reduce((function(r,i){var s=parseFloat(i[e.field]);return i.taxes=e.calculateTaxes(t.allTaxes,s,t.tax_included),i.total_tax_amount=e.calcItemTax(i),r+parseFloat(i.quantity)*(s+(1==t.tax_included?0:parseFloat(i.total_tax_amount)))}),0)),r):(t.taxes=this.calculateTaxes(t.allTaxes,t[this.field],t.tax_included),t.total_tax_amount=this.calcItemTax(t),r+parseFloat(t.quantity)*(parseFloat(t[this.field])+(1==t.tax_included?0:t.total_tax_amount)))},doTotal:function(t,e,r){return parseFloat(t.quantity)*(parseFloat(t[this.field])-parseFloat(t[this.field]&&!r&&t.discount_amount?t.discount_amount:0)+(1==e?0:parseFloat(t[this.field]?t.total_tax_amount:0)))},calcRowTotal:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r&&r.taxes&&r.taxes.length&&!r.total_tax_amount&&0!=r.total_tax_amount?(r.taxes=this.calculateTaxes(r.allTaxes,r[this.field],r.tax_included),r.total_tax_amount=this.calcItemTax(r)):t.taxes&&t.taxes.length&&!t.total_tax_amount&&0!=t.total_tax_amount&&(t.taxes=this.calculateTaxes(t.allTaxes,t[this.field],t.tax_included),t.total_tax_amount=this.calcItemTax(t));var i=0;return t.selected.modifiers&&t.selected.modifiers.length&&(i+=t.selected.modifiers.reduce((function(r,i){return r+e.doTotal(i,t.tax_included)}),0)),r||!t.selected.variations.length&&!t.selected.portions.length?i+this.formatDecimal(parseFloat(r?r.quantity:t.quantity)*(parseFloat(r?r[this.field]:t[this.field])-parseFloat(r?r.discount_amount:t.discount_amount?t.discount_amount:0)+(1==t.tax_included?0:r?r.total_tax_amount:t.total_tax_amount))):(t.selected.variations.length&&(i+=t.selected.variations.reduce((function(r,i){return r+e.doTotal(i,t.tax_included)}),0)),t.selected.portions.length&&(i+=t.selected.portions.reduce((function(r,i){return r+e.doTotal(i,t.tax_included)}),0)),i)},guid:function(){return r(18738)(this.uuid()+Date.now().toString()+Math.random().toString())},uuid:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))},portionChanged:function(t){var e=t?this.edit_item.portions.find((function(e){return e.id==t})):{};this.edit_item.portion=o({},e)},addPortionToEditItem:function(){var t={quantity:1,choosables:[],essentials:[],portion_items:[],id:this.edit_item.portions[0].id,name:this.edit_item.portions[0].name};this.edit_item.portions[0].portion_items.map((function(e){t.portion_items.push(e)})),this.edit_item.portions[0].essentials.map((function(e){t.essentials.push(e)})),this.edit_item.portions[0].choosables.map((function(e){t.choosables.push({id:e.id,selected:e.items[0].item_id})})),this.edit_item.selected.portions.push(t)},editItem:function(t){var r=this;this[e].items[t].guid||(this[e].items[t].guid=this.guid()),this.edit_item=JSON.parse(JSON.stringify(this[e].items[t]));var i=this.edit_item.selected.portions.length;if(i){var s=this.edit_item.quantity-i;if(s&&s>0)if(1==this.edit_item.portions.length)this.edit_item.selected.portions[0].quantity=this.edit_item.quantity;else for(var a=function(t){var e={quantity:1,choosables:[],id:r.edit_item.portions[0].id,name:r.edit_item.portions[0].name};r.edit_item.portions[0].choosables.map((function(t){e.choosables.push({id:t.id,selected:t.items[0].item_id})})),r.edit_item.selected.portions.push(e)},n=1;n<=s;n++)a();else if(s&&s<0)for(var o=s;o<0;o++)this.edit_item.selected.portions.pop()}this.edit_item.discount=this.edit_item.discount?parseFloat(this.edit_item.discount):null,this.edit_item.allTaxes=this.edit_item.allTaxes.map((function(t){return t.id})),this.show_item_edit=!0},updateItem:function(){var r=this;this.$refs.editItemForm.validate((function(s){if(s){if("price"==t){if(r.edit_item.serials&&r.edit_item.has_serials&&r.edit_item.serials.length&&r.edit_item.selected.serials.length!=r.edit_item.quantity)return r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10}),!1}else if(r.edit_item.serials&&r.edit_item.selected.serials.length!=r.edit_item.quantity)return r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10}),!1;if(r.edit_item.selected.modifiers=[],r.edit_item.modifiers&&r.edit_item.modifiers.length&&r.edit_item.modifiers.map((function(t){t.selected&&("checkbox"==t.show_as||"select_multiple"==t.show_as?t.selected.map((function(e){t.options.map((function(i){e==i.id&&r.edit_item.selected.modifiers.push({id:i.id,mId:t.id,quantity:1,cost:i.item.cost,option:i.item.name,price:i.item.price,title:t.title})}))})):t.options.map((function(e){t.selected==e.id&&r.edit_item.selected.modifiers.push({id:e.id,mId:t.id,quantity:1,cost:e.item.cost,option:e.item.name,price:e.item.price,title:t.title})})))})),r.edit_item.portions&&r.edit_item.portions.length&&(r.edit_item.quantity=r.edit_item.selected.portions.reduce((function(t,e){return t+parseFloat(e.quantity)}),0)),r.edit_item.variations&&r.edit_item.variations.length&&(r.edit_item.quantity=r.edit_item.selected.variations.reduce((function(t,e){return t+parseFloat(e.quantity)}),0)),r.edit_item.allTaxes=r.taxes.filter((function(t){return r.edit_item.allTaxes.includes(t.id)})),r.edit_item=r.calculateItemDiscountAmount(r.edit_item),"price"==t)r[e].items.find((function(t){return t.id==r.edit_item.id})).promotions!=r.edit_item.promotions&&r.edit_item.allPromotions.map((function(t){r.edit_item.promotions.includes(t.id)&&"BXGY"==t.type&&(r[e].items=r[e].items.filter((function(e){return e.id!=t.item_id_to_get&&e.promo_item_id!=r.edit_item.id})))})),r.applicablePromotions(r.edit_item).map((function(t){"BXGY"==t.type&&r.edit_item.quantity>=t.quantity_to_buy&&r.addOrderRowByItemID(t.item_id_to_get,r.edit_item.id)}));r.edit_item=r.doTaxCalculation(r.edit_item);var a=JSON.parse(JSON.stringify(r.edit_item));r[e].items=r[e].items.map((function(t){return t.guid==a.guid?a:t})),i?r.$event.fire("pos:order:update",{item:a,qty:a.quantity,set:!0,force:!0,vCheck:!1}):r.addToOrder(a,a.quantity,!0,!0),r.edit_item=null,r.show_item_edit=!1}else r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10})}))},deleteItem:function(t,r,s){var a=this;t.promotions&&t.promotions.length&&(t.promotions=t.allPromotions?t.allPromotions.filter((function(e){return t.promotions.includes(e.id)})):[],t.promotions.map((function(e){"BXGY"==e.type&&t.quantity>=e.quantity_to_buy&&a.$store.commit("delPromotionItem",{id:e.item_id_to_get,promo_item_id:t.id})}))),i?this.$store.commit("delOrderRow",t):this[e].items=this[e].items.filter((function(e){return e.guid!=t.guid})),this.edit_item=null,this.show_item_edit=!1},deleteItemVariation:function(t,r,s){var a=this[e].items.find((function(e){return e.guid==t.guid}));a.selected_variation=null,a.selected.variations=a.selected.variations.filter((function(t){return t.id!==r.id})),a.quantity=a.selected.variations.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),a.selected.variations.length<=0?this.deleteItem(a):i&&this.$store.commit("setOrderRow",a)},deleteItemPortion:function(t,r,s){var a=this[e].items.find((function(e){return e.guid==t.guid}));a.selected_portion=null,a.selected.portions=a.selected.portions.filter((function(t,e){return e!==s})),a.quantity=a.selected.portions.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),a.selected.portions.length<=0?this.deleteItem(a):i&&this.$store.commit("setOrderRow",a)},deleteItemModifier:function(t,r,s){var a=this[e].items.find((function(e){return e.guid==t.guid}));a.selected.modifiers=a.selected.modifiers.filter((function(t){return t.id!==r.id})),a.modifiers=a.modifiers.map((function(t){return t.id==r.mId&&(Array.isArray(t.selected)?t.selected=t.options.filter((function(t){return t.id==r.id})):t.selected=null),t})),i&&this.$store.commit("setOrderRow",a)},remove:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(!i||this.$store.getters.superAdmin)this["deleteItem"+r](t,s,a);else{var n=null;this.$Modal.confirm({width:260,okText:this.$t("ok"),cancelText:this.$t("cancel"),title:this.$t("pin_required"),render:function(t){return t("Input",{props:{value:n,autofocus:!0,placeholder:e.$t("type_pin")},on:{input:function(t){return n=t}}})},onOk:function(){e.$Message.info("Check POS pin "+n+" then perform delete!"),e["deleteItem"+r](t,s,a)}})}}}}}},92704:(t,e,r)=>{"use strict";r.d(e,{Z:()=>n});var i=r(36940),s=r.n(i),a=r(47401);const n=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4?arguments[4]:void 0,o=s().pluralize(t),l=n?"."+s().pluralize(n):"";return{data:function(){return{refresh:1}},created:function(){1!=this.$store.state.settings.hide_id&&this.columns.unshift({title:this.$t("id"),sortable:!0,key:"id",width:275})},mounted:function(){this.isSmallScreen&&(this.columns=this.columns.map((function(t){return t.fixed&&delete t.fixed,t})))},methods:{showInfo:function(t){console.log("show: ",t)},editRecord:function(t){this.$router.push({name:o+l+".edit",params:{id:t.id}})},renderAttachments:function(t,e){var r=this;return e.row.attachments&&e.row.attachments.length?t("Button",{props:{size:"small",type:"primary",icon:"ios-link"},on:{click:function(){r.viewAttachments(e.row.attachments)}}}):""},viewAttachments:function(t){var e=this;this.$Modal.info({width:750,closable:!0,scrollable:!0,okText:this.$t("close"),title:this.$tc("attachment",2),render:function(r){return r(a.Z,{props:{attachments:t},on:{input:function(t){e.value=t}}})}})},deleteAttachment:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e?e.attachments=e.attachments.filter((function(e){return e.uuid!==t.uuid})):this.attachments=this.attachments.filter((function(e){return e.uuid!==t.uuid}))},deleteRecord:function(r){var i=this;this.$http.delete(e+"/"+r.id).then((function(e){e.data.success?(i.$Notice.success({title:i.$tc(t)+" "+i.$t("deleted"),desc:i.$t("record_deleted")}),i.refresh++):i.$Notice.error({title:i.$tc("failed"),desc:e.data.error||i.$t("failed_record_delete_text"),duration:15})})).catch((function(t){i.$event.fire("appError",t.response)})).finally((function(){return i.$Modal.remove()}))},deleteRecords:function(t){var r=this,i=t.map((function(t){return t.id}));this.$http.post(e+"/delete/many",{ids:i}).then((function(t){t.data.success?(r.$Notice.success({duration:10,desc:r.$t("records_deleted"),title:t.data.count+" "+r.$t("deleted")+", "+t.data.failed+" "+r.$t("failed")}),r.refresh++):r.$Notice.error({title:r.$tc("failed"),desc:r.$t("bulk_failed_error_text"),duration:15})}))},renderBoolean:function(t,e,r){return t("div",{style:"text-align:center;"},[1==e.row[r]?t("i",{class:"ivu-icon ivu-icon-md-checkmark",style:"font-size: 16px; color: #19be6b;"}):t("i",{class:"ivu-icon ivu-icon-md-close",style:"font-size: 16px; color: #ed4014;"})])},renderUnlessIcon:function(t,e,r){return t("div",{style:"text-align:center;"},[e.row[r]?t("i",{class:"ivu-icon ivu-icon-md-close",style:"font-size: 16px; color: #ed4014;"}):t("i",{class:"ivu-icon ivu-icon-md-checkmark",style:"font-size: 16px; color: #19be6b;"})])},renderExtras:function(t,e){return e.row.extra_attributes?t("div",[Object.entries(e.row.extra_attributes).map((function(t){return t.join(": ")})).join(", ")]):""},renderActions:function(e,s){return e("actions-component",{props:{params:s,deleteFn:this.deleteRecord,editFn:this.editRecord,record:{model:t,code:r,name:i}}})},renderNumber:function(t,e,r,i,s,a){return t("div",{class:"text-right ".concat(i?"bold":"")},[(s||"")+this.$options.filters.formatNumber(e.row[r],this.$store.getters.settings.decimals)+(a||"")])},renderMyNumber:function(t,e){return(0,this.$createElement)("div",{class:"text-right ".concat(e?"bold":"")},[this.formatNumber(t)])},renderDate:function(t,e,r){return r=r||"date",t("div",[e.row[r]?this.$options.filters.formatDate(e.row[r],this.$store.state.settings.dateformat):""])},renderDateTime:function(t,e){return this.renderCreatedAt(t,e)},renderCreatedAt:function(t,e){return t("div",[this.$options.filters.formatDate(e.row.created_at,this.$store.state.settings.dateformat+" HH:mm A")])},renderUpdatedAt:function(t,e){return t("div",[this.$options.filters.formatDate(e.row.updated_at,this.$store.state.settings.dateformat+" HH:mm A")])},renderUser:function(t,e){return t("div",[e.row.user?e.row.user.name:""])},renderAddress:function(t,e){return t("div",["".concat(e.row.house_no||""," ").concat(e.row.street_no||""," ").concat(e.row.address||""," ").concat(e.row.city||""," ").concat(e.row.postal_code||"")])}}}}},32777:(t,e,r)=>{var i,s,a,n,o,l,c,u,d,m,h,p,f,_,v,g,b,y,x,$,w,C,k=r(48764).Buffer,S=S||{version:"4.6.0"};if(e.fabric=S,"undefined"!=typeof document&&"undefined"!=typeof window)document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?S.document=document:S.document=document.implementation.createHTMLDocument(""),S.window=window;else{var O=new(r(24960).JSDOM)(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;S.document=O.document,S.jsdomImplForWrapper=r(26759).implForWrapper,S.nodeCanvas=r(56272).Canvas,S.window=O,DOMParser=S.window.DOMParser}function I(t,e){var r=t.canvas,i=e.targetCanvas,s=i.getContext("2d");s.translate(0,i.height),s.scale(1,-1);var a=r.height-i.height;s.drawImage(r,0,a,i.width,i.height,0,0,i.width,i.height)}function F(t,e){var r=e.targetCanvas.getContext("2d"),i=e.destinationWidth,s=e.destinationHeight,a=i*s*4,n=new Uint8Array(this.imageBuffer,0,a),o=new Uint8ClampedArray(this.imageBuffer,0,a);t.readPixels(0,0,i,s,t.RGBA,t.UNSIGNED_BYTE,n);var l=new ImageData(o,i,s);r.putImageData(l,0,0)}S.isTouchSupported="ontouchstart"in S.window||"ontouchstart"in S.document||S.window&&S.window.navigator&&S.window.navigator.maxTouchPoints>0,S.isLikelyNode=void 0!==k&&"undefined"==typeof window,S.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],S.DPI=96,S.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",S.commaWsp="(?:\\s+,?\\s*|,\\s*)",S.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,S.reNonWord=/[ \n\.,;!\?\-]/,S.fontPaths={},S.iMatrix=[1,0,0,1,0,0],S.svgNS="http://www.w3.org/2000/svg",S.perfLimitSizeTotal=2097152,S.maxCacheSideLimit=4096,S.minCacheSideLimit=256,S.charWidthsCache={},S.textureSize=2048,S.disableStyleCopyPaste=!1,S.enableGLFiltering=!0,S.devicePixelRatio=S.window.devicePixelRatio||S.window.webkitDevicePixelRatio||S.window.mozDevicePixelRatio||1,S.browserShadowBlurConstant=1,S.arcToSegmentsCache={},S.boundsOfCurveCache={},S.cachesBoundsOfCurve=!0,S.forceGLPutImageData=!1,S.initFilterBackend=function(){return S.enableGLFiltering&&S.isWebglSupported&&S.isWebglSupported(S.textureSize)?(console.log("max texture size: "+S.maxTextureSize),new S.WebglFilterBackend({tileSize:S.textureSize})):S.Canvas2dFilterBackend?new S.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=S),function(){function t(t,e){if(this.__eventListeners[t]){var r=this.__eventListeners[t];e?r[r.indexOf(e)]=!1:S.util.array.fill(r,!1)}}function e(t,e){var r=function(){e.apply(this,arguments),this.off(t,r)}.bind(this);this.on(t,r)}S.Observable={fire:function(t,e){if(!this.__eventListeners)return this;var r=this.__eventListeners[t];if(!r)return this;for(var i=0,s=r.length;i<s;i++)r[i]&&r[i].call(this,e||{});return this.__eventListeners[t]=r.filter((function(t){return!1!==t})),this},on:function(t,e){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var r in t)this.on(r,t[r]);else this.__eventListeners[t]||(this.__eventListeners[t]=[]),this.__eventListeners[t].push(e);return this},once:function(t,r){if(1===arguments.length)for(var i in t)e.call(this,i,t[i]);else e.call(this,t,r);return this},off:function(e,r){if(!this.__eventListeners)return this;if(0===arguments.length)for(e in this.__eventListeners)t.call(this,e);else if(1===arguments.length&&"object"==typeof arguments[0])for(var i in e)t.call(this,i,e[i]);else t.call(this,e,r);return this}}}(),S.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,r){var i=this._objects;return r?i[e]=t:i.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t,e=this._objects,r=!1,i=0,s=arguments.length;i<s;i++)-1!==(t=e.indexOf(arguments[i]))&&(r=!0,e.splice(t,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&r&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var r=this.getObjects(),i=0,s=r.length;i<s;i++)t.call(e,r[i],i,r);return this},getObjects:function(t){return void 0===t?this._objects.concat():this._objects.filter((function(e){return e.type===t}))},item:function(t){return this._objects[t]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(t,e){return this._objects.indexOf(t)>-1||!!e&&this._objects.some((function(e){return"function"==typeof e.contains&&e.contains(t,!0)}))},complexity:function(){return this._objects.reduce((function(t,e){return t+=e.complexity?e.complexity():0}),0)}},S.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){!t||!t.colorStops||t instanceof S.Gradient||this.set(e,new S.Gradient(t))},_initPattern:function(t,e,r){!t||!t.source||t instanceof S.Pattern?r&&r():this.set(e,new S.Pattern(t,r))},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return"object"==typeof t?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return"boolean"==typeof e&&this.set(t,!e),this},get:function(t){return this[t]}},i=e,s=Math.sqrt,a=Math.atan2,n=Math.pow,o=Math.PI/180,l=Math.PI/2,S.util={cos:function(t){if(0===t)return 1;switch(t<0&&(t=-t),t/l){case 1:case 3:return 0;case 2:return-1}return Math.cos(t)},sin:function(t){if(0===t)return 0;var e=1;switch(t<0&&(e=-1),t/l){case 1:return e;case 2:return 0;case 3:return-e}return Math.sin(t)},removeFromArray:function(t,e){var r=t.indexOf(e);return-1!==r&&t.splice(r,1),t},getRandomInt:function(t,e){return Math.floor(Math.random()*(e-t+1))+t},degreesToRadians:function(t){return t*o},radiansToDegrees:function(t){return t/o},rotatePoint:function(t,e,r){var i=new S.Point(t.x-e.x,t.y-e.y),s=S.util.rotateVector(i,r);return new S.Point(s.x,s.y).addEquals(e)},rotateVector:function(t,e){var r=S.util.sin(e),i=S.util.cos(e);return{x:t.x*i-t.y*r,y:t.x*r+t.y*i}},transformPoint:function(t,e,r){return r?new S.Point(e[0]*t.x+e[2]*t.y,e[1]*t.x+e[3]*t.y):new S.Point(e[0]*t.x+e[2]*t.y+e[4],e[1]*t.x+e[3]*t.y+e[5])},makeBoundingBoxFromPoints:function(t,e){if(e)for(var r=0;r<t.length;r++)t[r]=S.util.transformPoint(t[r],e);var i=[t[0].x,t[1].x,t[2].x,t[3].x],s=S.util.array.min(i),a=S.util.array.max(i)-s,n=[t[0].y,t[1].y,t[2].y,t[3].y],o=S.util.array.min(n);return{left:s,top:o,width:a,height:S.util.array.max(n)-o}},invertTransform:function(t){var e=1/(t[0]*t[3]-t[1]*t[2]),r=[e*t[3],-e*t[1],-e*t[2],e*t[0]],i=S.util.transformPoint({x:t[4],y:t[5]},r,!0);return r[4]=-i.x,r[5]=-i.y,r},toFixed:function(t,e){return parseFloat(Number(t).toFixed(e))},parseUnit:function(t,e){var r=/\D{0,2}$/.exec(t),i=parseFloat(t);switch(e||(e=S.Text.DEFAULT_SVG_FONT_SIZE),r[0]){case"mm":return i*S.DPI/25.4;case"cm":return i*S.DPI/2.54;case"in":return i*S.DPI;case"pt":return i*S.DPI/72;case"pc":return i*S.DPI/72*12;case"em":return i*e;default:return i}},falseFunction:function(){return!1},getKlass:function(t,e){return t=S.util.string.camelize(t.charAt(0).toUpperCase()+t.slice(1)),S.util.resolveNamespace(e)[t]},getSvgAttributes:function(t){var e=["instantiated_by_use","style","id","class"];switch(t){case"linearGradient":e=e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":e=e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":e=e.concat(["offset","stop-color","stop-opacity"])}return e},resolveNamespace:function(t){if(!t)return S;var e,r=t.split("."),s=r.length,a=i||S.window;for(e=0;e<s;++e)a=a[r[e]];return a},loadImage:function(t,e,r,i){if(t){var s=S.util.createImage(),a=function(){e&&e.call(r,s,!1),s=s.onload=s.onerror=null};s.onload=a,s.onerror=function(){S.log("Error loading "+s.src),e&&e.call(r,null,!0),s=s.onload=s.onerror=null},0!==t.indexOf("data")&&null!=i&&(s.crossOrigin=i),"data:image/svg"===t.substring(0,14)&&(s.onload=null,S.util.loadImageInDom(s,a)),s.src=t}else e&&e.call(r,t)},loadImageInDom:function(t,e){var r=S.document.createElement("div");r.style.width=r.style.height="1px",r.style.left=r.style.top="-100%",r.style.position="absolute",r.appendChild(t),S.document.querySelector("body").appendChild(r),t.onload=function(){e(),r.parentNode.removeChild(r),r=null}},enlivenObjects:function(t,e,r,i){var s=[],a=0,n=(t=t||[]).length;function o(){++a===n&&e&&e(s.filter((function(t){return t})))}n?t.forEach((function(t,e){t&&t.type?S.util.getKlass(t.type,r).fromObject(t,(function(r,a){a||(s[e]=r),i&&i(t,r,a),o()})):o()})):e&&e(s)},enlivenPatterns:function(t,e){function r(){++s===a&&e&&e(i)}var i=[],s=0,a=(t=t||[]).length;a?t.forEach((function(t,e){t&&t.source?new S.Pattern(t,(function(t){i[e]=t,r()})):(i[e]=t,r())})):e&&e(i)},groupSVGElements:function(t,e,r){var i;return t&&1===t.length?t[0]:(e&&(e.width&&e.height?e.centerPoint={x:e.width/2,y:e.height/2}:(delete e.width,delete e.height)),i=new S.Group(t,e),void 0!==r&&(i.sourcePath=r),i)},populateWithProperties:function(t,e,r){if(r&&"[object Array]"===Object.prototype.toString.call(r))for(var i=0,s=r.length;i<s;i++)r[i]in t&&(e[r[i]]=t[r[i]])},drawDashedLine:function(t,e,r,i,n,o){var l=i-e,c=n-r,u=s(l*l+c*c),d=a(c,l),m=o.length,h=0,p=!0;for(t.save(),t.translate(e,r),t.moveTo(0,0),t.rotate(d),e=0;u>e;)(e+=o[h++%m])>u&&(e=u),t[p?"lineTo":"moveTo"](e,0),p=!p;t.restore()},createCanvasElement:function(){return S.document.createElement("canvas")},copyCanvasElement:function(t){var e=S.util.createCanvasElement();return e.width=t.width,e.height=t.height,e.getContext("2d").drawImage(t,0,0),e},toDataURL:function(t,e,r){return t.toDataURL("image/"+e,r)},createImage:function(){return S.document.createElement("img")},multiplyTransformMatrices:function(t,e,r){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],r?0:t[0]*e[4]+t[2]*e[5]+t[4],r?0:t[1]*e[4]+t[3]*e[5]+t[5]]},qrDecompose:function(t){var e=a(t[1],t[0]),r=n(t[0],2)+n(t[1],2),i=s(r),l=(t[0]*t[3]-t[2]*t[1])/i,c=a(t[0]*t[2]+t[1]*t[3],r);return{angle:e/o,scaleX:i,scaleY:l,skewX:c/o,skewY:0,translateX:t[4],translateY:t[5]}},calcRotateMatrix:function(t){if(!t.angle)return S.iMatrix.concat();var e=S.util.degreesToRadians(t.angle),r=S.util.cos(e),i=S.util.sin(e);return[r,i,-i,r,0,0]},calcDimensionsMatrix:function(t){var e=void 0===t.scaleX?1:t.scaleX,r=void 0===t.scaleY?1:t.scaleY,i=[t.flipX?-e:e,0,0,t.flipY?-r:r,0,0],s=S.util.multiplyTransformMatrices,a=S.util.degreesToRadians;return t.skewX&&(i=s(i,[1,0,Math.tan(a(t.skewX)),1],!0)),t.skewY&&(i=s(i,[1,Math.tan(a(t.skewY)),0,1],!0)),i},composeMatrix:function(t){var e=[1,0,0,1,t.translateX||0,t.translateY||0],r=S.util.multiplyTransformMatrices;return t.angle&&(e=r(e,S.util.calcRotateMatrix(t))),(1!==t.scaleX||1!==t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&(e=r(e,S.util.calcDimensionsMatrix(t))),e},resetObjectTransform:function(t){t.scaleX=1,t.scaleY=1,t.skewX=0,t.skewY=0,t.flipX=!1,t.flipY=!1,t.rotate(0)},saveObjectTransform:function(t){return{scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,angle:t.angle,left:t.left,flipX:t.flipX,flipY:t.flipY,top:t.top}},isTransparent:function(t,e,r,i){i>0&&(e>i?e-=i:e=0,r>i?r-=i:r=0);var s,a=!0,n=t.getImageData(e,r,2*i||1,2*i||1),o=n.data.length;for(s=3;s<o&&!1!=(a=n.data[s]<=0);s+=4);return n=null,a},parsePreserveAspectRatioAttribute:function(t){var e,r="meet",i=t.split(" ");return i&&i.length&&("meet"!==(r=i.pop())&&"slice"!==r?(e=r,r="meet"):i.length&&(e=i.pop())),{meetOrSlice:r,alignX:"none"!==e?e.slice(1,4):"none",alignY:"none"!==e?e.slice(5,8):"none"}},clearFabricFontCache:function(t){(t=(t||"").toLowerCase())?S.charWidthsCache[t]&&delete S.charWidthsCache[t]:S.charWidthsCache={}},limitDimsByArea:function(t,e){var r=Math.sqrt(e*t),i=Math.floor(e/r);return{x:Math.floor(r),y:i}},capValue:function(t,e,r){return Math.max(t,Math.min(e,r))},findScaleToFit:function(t,e){return Math.min(e.width/t.width,e.height/t.height)},findScaleToCover:function(t,e){return Math.max(e.width/t.width,e.height/t.height)},matrixToSVG:function(t){return"matrix("+t.map((function(t){return S.util.toFixed(t,S.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"},removeTransformFromObject:function(t,e){var r=S.util.invertTransform(e),i=S.util.multiplyTransformMatrices(r,t.calcOwnMatrix());S.util.applyTransformToObject(t,i)},addTransformToObject:function(t,e){S.util.applyTransformToObject(t,S.util.multiplyTransformMatrices(e,t.calcOwnMatrix()))},applyTransformToObject:function(t,e){var r=S.util.qrDecompose(e),i=new S.Point(r.translateX,r.translateY);t.flipX=!1,t.flipY=!1,t.set("scaleX",r.scaleX),t.set("scaleY",r.scaleY),t.skewX=r.skewX,t.skewY=r.skewY,t.angle=r.angle,t.setPositionByOrigin(i,"center","center")},sizeAfterTransform:function(t,e,r){var i=t/2,s=e/2,a=[{x:-i,y:-s},{x:i,y:-s},{x:-i,y:s},{x:i,y:s}],n=S.util.calcDimensionsMatrix(r),o=S.util.makeBoundingBoxFromPoints(a,n);return{x:o.width,y:o.height}}},function(){var t=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},r={m:"l",M:"L"};function i(t,e,r,i,s,a,n,o,l,c,u){var d=S.util.cos(t),m=S.util.sin(t),h=S.util.cos(e),p=S.util.sin(e),f=r*s*h-i*a*p+n,_=i*s*h+r*a*p+o;return["C",c+l*(-r*s*m-i*a*d),u+l*(-i*s*m+r*a*d),f+l*(r*s*p+i*a*h),_+l*(i*s*p-r*a*h),f,_]}function s(t,e,r,s,n,o,l){var c=Math.PI,u=l*c/180,d=S.util.sin(u),m=S.util.cos(u),h=0,p=0,f=-m*t*.5-d*e*.5,_=-m*e*.5+d*t*.5,v=(r=Math.abs(r))*r,g=(s=Math.abs(s))*s,b=_*_,y=f*f,x=v*g-v*b-g*y,$=0;if(x<0){var w=Math.sqrt(1-x/(v*g));r*=w,s*=w}else $=(n===o?-1:1)*Math.sqrt(x/(v*b+g*y));var C=$*r*_/s,k=-$*s*f/r,O=m*C-d*k+.5*t,I=d*C+m*k+.5*e,F=a(1,0,(f-C)/r,(_-k)/s),T=a((f-C)/r,(_-k)/s,(-f-C)/r,(-_-k)/s);0===o&&T>0?T-=2*c:1===o&&T<0&&(T+=2*c);for(var P=Math.ceil(Math.abs(T/c*2)),j=[],A=T/P,D=8/3*Math.sin(A/4)*Math.sin(A/4)/Math.sin(A/2),q=F+A,E=0;E<P;E++)j[E]=i(F,q,m,d,r,s,O,I,D,h,p),h=j[E][5],p=j[E][6],F=q,q+=A;return j}function a(t,e,r,i){var s=Math.atan2(e,t),a=Math.atan2(i,r);return a>=s?a-s:2*Math.PI-(s-a)}function n(e,r,i,s,a,n,o,l){var c;if(S.cachesBoundsOfCurve&&(c=t.call(arguments),S.boundsOfCurveCache[c]))return S.boundsOfCurveCache[c];var u,d,m,h,p,f,_,v,g=Math.sqrt,b=Math.min,y=Math.max,x=Math.abs,$=[],w=[[],[]];d=6*e-12*i+6*a,u=-3*e+9*i-9*a+3*o,m=3*i-3*e;for(var C=0;C<2;++C)if(C>0&&(d=6*r-12*s+6*n,u=-3*r+9*s-9*n+3*l,m=3*s-3*r),x(u)<1e-12){if(x(d)<1e-12)continue;0<(h=-m/d)&&h<1&&$.push(h)}else(_=d*d-4*m*u)<0||(0<(p=(-d+(v=g(_)))/(2*u))&&p<1&&$.push(p),0<(f=(-d-v)/(2*u))&&f<1&&$.push(f));for(var k,O,I,F=$.length,T=F;F--;)k=(I=1-(h=$[F]))*I*I*e+3*I*I*h*i+3*I*h*h*a+h*h*h*o,w[0][F]=k,O=I*I*I*r+3*I*I*h*s+3*I*h*h*n+h*h*h*l,w[1][F]=O;w[0][T]=e,w[1][T]=r,w[0][T+1]=o,w[1][T+1]=l;var P=[{x:b.apply(null,w[0]),y:b.apply(null,w[1])},{x:y.apply(null,w[0]),y:y.apply(null,w[1])}];return S.cachesBoundsOfCurve&&(S.boundsOfCurveCache[c]=P),P}function o(t,e,r){for(var i=r[1],a=r[2],n=r[3],o=r[4],l=r[5],c=s(r[6]-t,r[7]-e,i,a,o,l,n),u=0,d=c.length;u<d;u++)c[u][1]+=t,c[u][2]+=e,c[u][3]+=t,c[u][4]+=e,c[u][5]+=t,c[u][6]+=e;return c}function l(t,e,r,i){return Math.sqrt((r-t)*(r-t)+(i-e)*(i-e))}function c(t,e,r,i,s,a,n,o){return function(l){var c,u=(c=l)*c*c,d=function(t){return 3*t*t*(1-t)}(l),m=function(t){return 3*t*(1-t)*(1-t)}(l),h=function(t){return(1-t)*(1-t)*(1-t)}(l);return{x:n*u+s*d+r*m+t*h,y:o*u+a*d+i*m+e*h}}}function u(t,e,r,i,s,a,n,o){return function(l){var c=1-l,u=3*c*c*(r-t)+6*c*l*(s-r)+3*l*l*(n-s),d=3*c*c*(i-e)+6*c*l*(a-i)+3*l*l*(o-a);return Math.atan2(d,u)}}function d(t,e,r,i,s,a){return function(n){var o,l=(o=n)*o,c=function(t){return 2*t*(1-t)}(n),u=function(t){return(1-t)*(1-t)}(n);return{x:s*l+r*c+t*u,y:a*l+i*c+e*u}}}function m(t,e,r,i,s,a){return function(n){var o=1-n,l=2*o*(r-t)+2*n*(s-r),c=2*o*(i-e)+2*n*(a-i);return Math.atan2(c,l)}}function h(t,e,r){var i,s,a={x:e,y:r},n=0;for(s=1;s<=100;s+=1)i=t(s/100),n+=l(a.x,a.y,i.x,i.y),a=i;return n}function p(t,e){for(var r,i,s,a=0,n=0,o=t.iterator,c={x:t.x,y:t.y},u=.01,d=t.angleFinder;n<e&&a<=1&&u>1e-4;)r=o(a),s=a,(i=l(c.x,c.y,r.x,r.y))+n>e?a-=u/=2:(c=r,a+=u,n+=i);return r.angle=d(s),r}function f(t){for(var e,r,i,s,a=0,n=t.length,o=0,p=0,f=0,_=0,v=[],g=0;g<n;g++){switch(i={x:o,y:p,command:(e=t[g])[0]},e[0]){case"M":i.length=0,f=o=e[1],_=p=e[2];break;case"L":i.length=l(o,p,e[1],e[2]),o=e[1],p=e[2];break;case"C":r=c(o,p,e[1],e[2],e[3],e[4],e[5],e[6]),s=u(o,p,e[1],e[2],e[3],e[4],e[5],e[6]),i.iterator=r,i.angleFinder=s,i.length=h(r,o,p),o=e[5],p=e[6];break;case"Q":r=d(o,p,e[1],e[2],e[3],e[4]),s=m(o,p,e[1],e[2],e[3],e[4]),i.iterator=r,i.angleFinder=s,i.length=h(r,o,p),o=e[3],p=e[4];break;case"Z":case"z":i.destX=f,i.destY=_,i.length=l(o,p,f,_),o=f,p=_}a+=i.length,v.push(i)}return v.push({length:a,x:o,y:p}),v}S.util.joinPath=function(t){return t.map((function(t){return t.join(" ")})).join(" ")},S.util.parsePath=function(t){var i,s,a,n,o,l=[],c=[],u=S.rePathCommand,d="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",m="("+d+")"+S.commaWsp,h="([01])"+S.commaWsp+"?",p=new RegExp(m+"?"+m+"?"+m+h+h+m+"?("+d+")","g");if(!t||!t.match)return l;for(var f,_=0,v=(o=t.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;_<v;_++){n=(i=o[_]).slice(1).trim(),c.length=0;var g=i.charAt(0);if(f=[g],"a"===g.toLowerCase())for(var b;b=p.exec(n);)for(var y=1;y<b.length;y++)c.push(b[y]);else for(;a=u.exec(n);)c.push(a[0]);y=0;for(var x=c.length;y<x;y++)s=parseFloat(c[y]),isNaN(s)||f.push(s);var $=e[g.toLowerCase()],w=r[g]||g;if(f.length-1>$)for(var C=1,k=f.length;C<k;C+=$)l.push([g].concat(f.slice(C,C+$))),g=w;else l.push(f)}return l},S.util.makePathSimpler=function(t){var e,r,i,s,a,n,l=0,c=0,u=t.length,d=0,m=0,h=[];for(r=0;r<u;++r){switch(i=!1,(e=t[r].slice(0))[0]){case"l":e[0]="L",e[1]+=l,e[2]+=c;case"L":l=e[1],c=e[2];break;case"h":e[1]+=l;case"H":e[0]="L",e[2]=c,l=e[1];break;case"v":e[1]+=c;case"V":e[0]="L",c=e[1],e[1]=l,e[2]=c;break;case"m":e[0]="M",e[1]+=l,e[2]+=c;case"M":l=e[1],c=e[2],d=e[1],m=e[2];break;case"c":e[0]="C",e[1]+=l,e[2]+=c,e[3]+=l,e[4]+=c,e[5]+=l,e[6]+=c;case"C":a=e[3],n=e[4],l=e[5],c=e[6];break;case"s":e[0]="S",e[1]+=l,e[2]+=c,e[3]+=l,e[4]+=c;case"S":"C"===s?(a=2*l-a,n=2*c-n):(a=l,n=c),l=e[3],c=e[4],e[0]="C",e[5]=e[3],e[6]=e[4],e[3]=e[1],e[4]=e[2],e[1]=a,e[2]=n,a=e[3],n=e[4];break;case"q":e[0]="Q",e[1]+=l,e[2]+=c,e[3]+=l,e[4]+=c;case"Q":a=e[1],n=e[2],l=e[3],c=e[4];break;case"t":e[0]="T",e[1]+=l,e[2]+=c;case"T":"Q"===s?(a=2*l-a,n=2*c-n):(a=l,n=c),e[0]="Q",l=e[1],c=e[2],e[1]=a,e[2]=n,e[3]=l,e[4]=c;break;case"a":e[0]="A",e[6]+=l,e[7]+=c;case"A":i=!0,h=h.concat(o(l,c,e)),l=e[6],c=e[7];break;case"z":case"Z":l=d,c=m}i||h.push(e),s=e[0]}return h},S.util.getSmoothPathFromPoints=function(t,e){var r,i=[],s=new S.Point(t[0].x,t[0].y),a=new S.Point(t[1].x,t[1].y),n=t.length,o=1,l=0,c=n>2;for(e=e||0,c&&(o=t[2].x<a.x?-1:t[2].x===a.x?0:1,l=t[2].y<a.y?-1:t[2].y===a.y?0:1),i.push(["M",s.x-o*e,s.y-l*e]),r=1;r<n;r++){if(!s.eq(a)){var u=s.midPointFrom(a);i.push(["Q",s.x,s.y,u.x,u.y])}s=t[r],r+1<t.length&&(a=t[r+1])}return c&&(o=s.x>t[r-2].x?1:s.x===t[r-2].x?0:-1,l=s.y>t[r-2].y?1:s.y===t[r-2].y?0:-1),i.push(["L",s.x+o*e,s.y+l*e]),i},S.util.getPathSegmentsInfo=f,S.util.getBoundsOfCurve=n,S.util.getPointOnPath=function(t,e,r){r||(r=f(t));for(var i=0;e-r[i].length>0&&i<r.length-2;)e-=r[i].length,i++;var s,a=r[i],n=e/a.length,o=a.command,l=t[i];switch(o){case"M":return{x:a.x,y:a.y,angle:0};case"Z":case"z":return(s=new S.Point(a.x,a.y).lerp(new S.Point(a.destX,a.destY),n)).angle=Math.atan2(a.destY-a.y,a.destX-a.x),s;case"L":return(s=new S.Point(a.x,a.y).lerp(new S.Point(l[1],l[2]),n)).angle=Math.atan2(l[2]-a.y,l[1]-a.x),s;case"C":case"Q":return p(a,e)}},S.util.transformPath=function(t,e,r){return r&&(e=S.util.multiplyTransformMatrices(e,[1,0,0,1,-r.x,-r.y])),t.map((function(t){for(var r=t.slice(0),i={},s=1;s<t.length-1;s+=2)i.x=t[s],i.y=t[s+1],i=S.util.transformPoint(i,e),r[s]=i.x,r[s+1]=i.y;return r}))},S.util.fromArcToBeizers=o,S.util.getBoundsOfArc=function(t,e,r,i,a,o,l,c,u){for(var d,m=0,h=0,p=[],f=s(c-t,u-e,r,i,o,l,a),_=0,v=f.length;_<v;_++)d=n(m,h,f[_][1],f[_][2],f[_][3],f[_][4],f[_][5],f[_][6]),p.push({x:d[0].x+t,y:d[0].y+e}),p.push({x:d[1].x+t,y:d[1].y+e}),m=f[_][5],h=f[_][6];return p},S.util.drawArc=function(t,e,r,i){o(e,r,i=i.slice(0).unshift("X")).forEach((function(e){t.bezierCurveTo.apply(t,e.slice(1))}))}}(),function(){var t=Array.prototype.slice;function e(t,e,r){if(t&&0!==t.length){var i=t.length-1,s=e?t[i][e]:t[i];if(e)for(;i--;)r(t[i][e],s)&&(s=t[i][e]);else for(;i--;)r(t[i],s)&&(s=t[i]);return s}}S.util.array={fill:function(t,e){for(var r=t.length;r--;)t[r]=e;return t},invoke:function(e,r){for(var i=t.call(arguments,2),s=[],a=0,n=e.length;a<n;a++)s[a]=i.length?e[a][r].apply(e[a],i):e[a][r].call(e[a]);return s},min:function(t,r){return e(t,r,(function(t,e){return t<e}))},max:function(t,r){return e(t,r,(function(t,e){return t>=e}))}}}(),function(){function t(e,r,i){if(i)if(!S.isLikelyNode&&r instanceof Element)e=r;else if(r instanceof Array){e=[];for(var s=0,a=r.length;s<a;s++)e[s]=t({},r[s],i)}else if(r&&"object"==typeof r)for(var n in r)"canvas"===n||"group"===n?e[n]=null:r.hasOwnProperty(n)&&(e[n]=t({},r[n],i));else e=r;else for(var n in r)e[n]=r[n];return e}S.util.object={extend:t,clone:function(e,r){return t({},e,r)}},S.util.object.extend(S.util,S.Observable)}(),function(){function t(t,e){var r=t.charCodeAt(e);if(isNaN(r))return"";if(r<55296||r>57343)return t.charAt(e);if(55296<=r&&r<=56319){if(t.length<=e+1)throw"High surrogate without following low surrogate";var i=t.charCodeAt(e+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return t.charAt(e)+t.charAt(e+1)}if(0===e)throw"Low surrogate without preceding high surrogate";var s=t.charCodeAt(e-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1}S.util.string={camelize:function(t){return t.replace(/-+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))},capitalize:function(t,e){return t.charAt(0).toUpperCase()+(e?t.slice(1):t.slice(1).toLowerCase())},escapeXml:function(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(e){var r,i=0,s=[];for(i=0;i<e.length;i++)!1!==(r=t(e,i))&&s.push(r);return s}}}(),function(){var t=Array.prototype.slice,e=function(){},r=function(){for(var t in{toString:1})if("toString"===t)return!1;return!0}(),i=function(t,e,i){for(var s in e)s in t.prototype&&"function"==typeof t.prototype[s]&&(e[s]+"").indexOf("callSuper")>-1?t.prototype[s]=function(t){return function(){var r=this.constructor.superclass;this.constructor.superclass=i;var s=e[t].apply(this,arguments);if(this.constructor.superclass=r,"initialize"!==t)return s}}(s):t.prototype[s]=e[s],r&&(e.toString!==Object.prototype.toString&&(t.prototype.toString=e.toString),e.valueOf!==Object.prototype.valueOf&&(t.prototype.valueOf=e.valueOf))};function s(){}function a(e){for(var r=null,i=this;i.constructor.superclass;){var s=i.constructor.superclass.prototype[e];if(i[e]!==s){r=s;break}i=i.constructor.superclass.prototype}return r?arguments.length>1?r.apply(this,t.call(arguments,1)):r.call(this):console.log("tried to callSuper "+e+", method not found in prototype chain",this)}S.util.createClass=function(){var r=null,n=t.call(arguments,0);function o(){this.initialize.apply(this,arguments)}"function"==typeof n[0]&&(r=n.shift()),o.superclass=r,o.subclasses=[],r&&(s.prototype=r.prototype,o.prototype=new s,r.subclasses.push(o));for(var l=0,c=n.length;l<c;l++)i(o,n[l],r);return o.prototype.initialize||(o.prototype.initialize=e),o.prototype.constructor=o,o.prototype.callSuper=a,o}}(),c=!!S.document.createElement("div").attachEvent,u=["touchstart","touchmove","touchend"],S.util.addListener=function(t,e,r,i){t&&t.addEventListener(e,r,!c&&i)},S.util.removeListener=function(t,e,r,i){t&&t.removeEventListener(e,r,!c&&i)},S.util.getPointer=function(t){var e=t.target,r=S.util.getScrollLeftTop(e),i=function(t){var e=t.changedTouches;return e&&e[0]?e[0]:t}(t);return{x:i.clientX+r.left,y:i.clientY+r.top}},S.util.isTouchEvent=function(t){return u.indexOf(t.type)>-1||"touch"===t.pointerType},d=S.document.createElement("div"),m="string"==typeof d.style.opacity,h="string"==typeof d.style.filter,p=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,f=function(t){return t},m?f=function(t,e){return t.style.opacity=e,t}:h&&(f=function(t,e){var r=t.style;return t.currentStyle&&!t.currentStyle.hasLayout&&(r.zoom=1),p.test(r.filter)?(e=e>=.9999?"":"alpha(opacity="+100*e+")",r.filter=r.filter.replace(p,e)):r.filter+=" alpha(opacity="+100*e+")",t}),S.util.setStyle=function(t,e){var r=t.style;if(!r)return t;if("string"==typeof e)return t.style.cssText+=";"+e,e.indexOf("opacity")>-1?f(t,e.match(/opacity:\s*(\d?\.?\d*)/)[1]):t;for(var i in e)"opacity"===i?f(t,e[i]):r["float"===i||"cssFloat"===i?void 0===r.styleFloat?"cssFloat":"styleFloat":i]=e[i];return t},function(){var t=Array.prototype.slice;var e,r,i,s,a=function(e){return t.call(e,0)};try{e=a(S.document.childNodes)instanceof Array}catch(t){}function n(t,e){var r=S.document.createElement(t);for(var i in e)"class"===i?r.className=e[i]:"for"===i?r.htmlFor=e[i]:r.setAttribute(i,e[i]);return r}function o(t){for(var e=0,r=0,i=S.document.documentElement,s=S.document.body||{scrollLeft:0,scrollTop:0};t&&(t.parentNode||t.host)&&((t=t.parentNode||t.host)===S.document?(e=s.scrollLeft||i.scrollLeft||0,r=s.scrollTop||i.scrollTop||0):(e+=t.scrollLeft||0,r+=t.scrollTop||0),1!==t.nodeType||"fixed"!==t.style.position););return{left:e,top:r}}e||(a=function(t){for(var e=new Array(t.length),r=t.length;r--;)e[r]=t[r];return e}),r=S.document.defaultView&&S.document.defaultView.getComputedStyle?function(t,e){var r=S.document.defaultView.getComputedStyle(t,null);return r?r[e]:void 0}:function(t,e){var r=t.style[e];return!r&&t.currentStyle&&(r=t.currentStyle[e]),r},i=S.document.documentElement.style,s="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"",S.util.makeElementUnselectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=S.util.falseFunction),s?t.style[s]="none":"string"==typeof t.unselectable&&(t.unselectable="on"),t},S.util.makeElementSelectable=function(t){return void 0!==t.onselectstart&&(t.onselectstart=null),s?t.style[s]="":"string"==typeof t.unselectable&&(t.unselectable=""),t},S.util.setImageSmoothing=function(t,e){t.imageSmoothingEnabled=t.imageSmoothingEnabled||t.webkitImageSmoothingEnabled||t.mozImageSmoothingEnabled||t.msImageSmoothingEnabled||t.oImageSmoothingEnabled,t.imageSmoothingEnabled=e},S.util.getById=function(t){return"string"==typeof t?S.document.getElementById(t):t},S.util.toArray=a,S.util.addClass=function(t,e){t&&-1===(" "+t.className+" ").indexOf(" "+e+" ")&&(t.className+=(t.className?" ":"")+e)},S.util.makeElement=n,S.util.wrapElement=function(t,e,r){return"string"==typeof e&&(e=n(e,r)),t.parentNode&&t.parentNode.replaceChild(e,t),e.appendChild(t),e},S.util.getScrollLeftTop=o,S.util.getElementOffset=function(t){var e,i,s=t&&t.ownerDocument,a={left:0,top:0},n={left:0,top:0},l={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!s)return n;for(var c in l)n[l[c]]+=parseInt(r(t,c),10)||0;return e=s.documentElement,void 0!==t.getBoundingClientRect&&(a=t.getBoundingClientRect()),i=o(t),{left:a.left+i.left-(e.clientLeft||0)+n.left,top:a.top+i.top-(e.clientTop||0)+n.top}},S.util.getNodeCanvas=function(t){var e=S.jsdomImplForWrapper(t);return e._canvas||e._image},S.util.cleanUpJsdomNode=function(t){if(S.isLikelyNode){var e=S.jsdomImplForWrapper(t);e&&(e._image=null,e._canvas=null,e._currentSrc=null,e._attributes=null,e._classList=null)}}}(),function(){function t(){}S.util.request=function(e,r){r||(r={});var i=r.method?r.method.toUpperCase():"GET",s=r.onComplete||function(){},a=new S.window.XMLHttpRequest,n=r.body||r.parameters;return a.onreadystatechange=function(){4===a.readyState&&(s(a),a.onreadystatechange=t)},"GET"===i&&(n=null,"string"==typeof r.parameters&&(e=function(t,e){return t+(/\?/.test(t)?"&":"?")+e}(e,r.parameters))),a.open(i,e,!0),"POST"!==i&&"PUT"!==i||a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(n),a}}(),S.log=console.log,S.warn=console.warn,function(){function t(){return!1}function e(t,e,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+e}var r=S.window.requestAnimationFrame||S.window.webkitRequestAnimationFrame||S.window.mozRequestAnimationFrame||S.window.oRequestAnimationFrame||S.window.msRequestAnimationFrame||function(t){return S.window.setTimeout(t,1e3/60)},i=S.window.cancelAnimationFrame||S.window.clearTimeout;function s(){return r.apply(S.window,arguments)}S.util.animate=function(r){var i=!1;return s((function(a){r||(r={});var n,o=a||+new Date,l=r.duration||500,c=o+l,u=r.onChange||t,d=r.abort||t,m=r.onComplete||t,h=r.easing||e,p="startValue"in r?r.startValue:0,f="endValue"in r?r.endValue:100,_=r.byValue||f-p;r.onStart&&r.onStart(),function t(e){var r=(n=e||+new Date)>c?l:n-o,a=r/l,v=h(r,p,_,l),g=Math.abs((v-p)/_);if(!i){if(!d(v,g,a))return n>c?(u(f,1,1),void m(f,1,1)):(u(v,g,a),void s(t));m(f,1,1)}}(o)})),function(){i=!0}},S.util.requestAnimFrame=s,S.util.cancelAnimFrame=function(){return i.apply(S.window,arguments)}}(),function(){function t(t,e,r){var i="rgba("+parseInt(t[0]+r*(e[0]-t[0]),10)+","+parseInt(t[1]+r*(e[1]-t[1]),10)+","+parseInt(t[2]+r*(e[2]-t[2]),10);return i+=","+(t&&e?parseFloat(t[3]+r*(e[3]-t[3])):1),i+=")"}S.util.animateColor=function(e,r,i,s){var a=new S.Color(e).getSource(),n=new S.Color(r).getSource(),o=s.onComplete,l=s.onChange;return s=s||{},S.util.animate(S.util.object.extend(s,{duration:i||500,startValue:a,endValue:n,byValue:n,easing:function(e,r,i,a){return t(r,i,s.colorEasing?s.colorEasing(e,a):1-Math.cos(e/a*(Math.PI/2)))},onComplete:function(e,r,i){if(o)return o(t(n,n,0),r,i)},onChange:function(e,r,i){if(l){if(Array.isArray(e))return l(t(e,e,0),r,i);l(e,r,i)}}}))}}(),function(){function t(t,e,r,i){return t<Math.abs(e)?(t=e,i=r/4):i=0===e&&0===t?r/(2*Math.PI)*Math.asin(1):r/(2*Math.PI)*Math.asin(e/t),{a:t,c:e,p:r,s:i}}function e(t,e,r){return t.a*Math.pow(2,10*(e-=1))*Math.sin((e*r-t.s)*(2*Math.PI)/t.p)}function r(t,e,r,s){return r-i(s-t,0,r,s)+e}function i(t,e,r,i){return(t/=i)<1/2.75?r*(7.5625*t*t)+e:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+e:r*(7.5625*(t-=2.625/2.75)*t+.984375)+e}S.util.ease={easeInQuad:function(t,e,r,i){return r*(t/=i)*t+e},easeOutQuad:function(t,e,r,i){return-r*(t/=i)*(t-2)+e},easeInOutQuad:function(t,e,r,i){return(t/=i/2)<1?r/2*t*t+e:-r/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,r,i){return r*(t/=i)*t*t+e},easeOutCubic:function(t,e,r,i){return r*((t=t/i-1)*t*t+1)+e},easeInOutCubic:function(t,e,r,i){return(t/=i/2)<1?r/2*t*t*t+e:r/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,r,i){return r*(t/=i)*t*t*t+e},easeOutQuart:function(t,e,r,i){return-r*((t=t/i-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,r,i){return(t/=i/2)<1?r/2*t*t*t*t+e:-r/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,r,i){return r*(t/=i)*t*t*t*t+e},easeOutQuint:function(t,e,r,i){return r*((t=t/i-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,r,i){return(t/=i/2)<1?r/2*t*t*t*t*t+e:r/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+e},easeOutSine:function(t,e,r,i){return r*Math.sin(t/i*(Math.PI/2))+e},easeInOutSine:function(t,e,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+e},easeInExpo:function(t,e,r,i){return 0===t?e:r*Math.pow(2,10*(t/i-1))+e},easeOutExpo:function(t,e,r,i){return t===i?e+r:r*(1-Math.pow(2,-10*t/i))+e},easeInOutExpo:function(t,e,r,i){return 0===t?e:t===i?e+r:(t/=i/2)<1?r/2*Math.pow(2,10*(t-1))+e:r/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOutCirc:function(t,e,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOutCirc:function(t,e,r,i){return(t/=i/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+e:r/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(r,i,s,a){var n=0;return 0===r?i:1===(r/=a)?i+s:(n||(n=.3*a),-e(t(s,s,n,1.70158),r,a)+i)},easeOutElastic:function(e,r,i,s){var a=0;if(0===e)return r;if(1===(e/=s))return r+i;a||(a=.3*s);var n=t(i,i,a,1.70158);return n.a*Math.pow(2,-10*e)*Math.sin((e*s-n.s)*(2*Math.PI)/n.p)+n.c+r},easeInOutElastic:function(r,i,s,a){var n=0;if(0===r)return i;if(2===(r/=a/2))return i+s;n||(n=a*(.3*1.5));var o=t(s,s,n,1.70158);return r<1?-.5*e(o,r,a)+i:o.a*Math.pow(2,-10*(r-=1))*Math.sin((r*a-o.s)*(2*Math.PI)/o.p)*.5+o.c+i},easeInBack:function(t,e,r,i,s){return void 0===s&&(s=1.70158),r*(t/=i)*t*((s+1)*t-s)+e},easeOutBack:function(t,e,r,i,s){return void 0===s&&(s=1.70158),r*((t=t/i-1)*t*((s+1)*t+s)+1)+e},easeInOutBack:function(t,e,r,i,s){return void 0===s&&(s=1.70158),(t/=i/2)<1?r/2*(t*t*((1+(s*=1.525))*t-s))+e:r/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+e},easeInBounce:r,easeOutBounce:i,easeInOutBounce:function(t,e,s,a){return t<a/2?.5*r(2*t,0,s,a)+e:.5*i(2*t-a,0,s,a)+.5*s+e}}}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,i=e.util.object.clone,s=e.util.toFixed,a=e.util.parseUnit,n=e.util.multiplyTransformMatrices,o={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},l={stroke:"strokeOpacity",fill:"fillOpacity"},c="font-size",u="clip-path";function d(t){return t in o?o[t]:t}function m(t,r,i,s){var o,l="[object Array]"===Object.prototype.toString.call(r);if("fill"!==t&&"stroke"!==t||"none"!==r){if("strokeUniform"===t)return"non-scaling-stroke"===r;if("strokeDashArray"===t)r="none"===r?null:r.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===t)r=i&&i.transformMatrix?n(i.transformMatrix,e.parseTransformAttribute(r)):e.parseTransformAttribute(r);else if("visible"===t)r="none"!==r&&"hidden"!==r,i&&!1===i.visible&&(r=!1);else if("opacity"===t)r=parseFloat(r),i&&void 0!==i.opacity&&(r*=i.opacity);else if("textAnchor"===t)r="start"===r?"left":"end"===r?"right":"center";else if("charSpacing"===t)o=a(r,s)/s*1e3;else if("paintFirst"===t){var c=r.indexOf("fill"),u=r.indexOf("stroke");r="fill";(c>-1&&u>-1&&u<c||-1===c&&u>-1)&&(r="stroke")}else{if("href"===t||"xlink:href"===t||"font"===t)return r;if("imageSmoothing"===t)return"optimizeQuality"===r;o=l?r.map(a):a(r,s)}}else r="";return!l&&isNaN(o)?r:o}function h(t){return new RegExp("^("+t.join("|")+")\\b","i")}function p(t,e){var r,i,s,a,n=[];for(s=0,a=e.length;s<a;s++)r=e[s],i=t.getElementsByTagName(r),n=n.concat(Array.prototype.slice.call(i));return n}function f(t,e){var r,i=!0;return(r=_(t,e.pop()))&&e.length&&(i=function(t,e){var r,i=!0;for(;t.parentNode&&1===t.parentNode.nodeType&&e.length;)i&&(r=e.pop()),i=_(t=t.parentNode,r);return 0===e.length}(t,e)),r&&i&&0===e.length}function _(t,e){var r,i,s=t.nodeName,a=t.getAttribute("class"),n=t.getAttribute("id");if(r=new RegExp("^"+s,"i"),e=e.replace(r,""),n&&e.length&&(r=new RegExp("#"+n+"(?![a-zA-Z\\-]+)","i"),e=e.replace(r,"")),a&&e.length)for(i=(a=a.split(" ")).length;i--;)r=new RegExp("\\."+a[i]+"(?![a-zA-Z\\-]+)","i"),e=e.replace(r,"");return 0===e.length}function v(t,e){var r;if(t.getElementById&&(r=t.getElementById(e)),r)return r;var i,s,a,n=t.getElementsByTagName("*");for(s=0,a=n.length;s<a;s++)if(e===(i=n[s]).getAttribute("id"))return i}e.svgValidTagNamesRegEx=h(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),e.svgViewBoxElementsRegEx=h(["symbol","image","marker","pattern","view","svg"]),e.svgInvalidAncestorsRegEx=h(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),e.svgValidParentsRegEx=h(["symbol","g","a","svg","clipPath","defs"]),e.cssRules={},e.gradientDefs={},e.clipPaths={},e.parseTransformAttribute=function(){function t(t,r,i){t[i]=Math.tan(e.util.degreesToRadians(r[0]))}var r=e.iMatrix,i=e.reNum,s=e.commaWsp,a="(?:"+("(?:(matrix)\\s*\\(\\s*("+i+")"+s+"("+i+")"+s+"("+i+")"+s+"("+i+")"+s+"("+i+")"+s+"("+i+")\\s*\\))")+"|"+("(?:(translate)\\s*\\(\\s*("+i+")(?:"+s+"("+i+"))?\\s*\\))")+"|"+("(?:(scale)\\s*\\(\\s*("+i+")(?:"+s+"("+i+"))?\\s*\\))")+"|"+("(?:(rotate)\\s*\\(\\s*("+i+")(?:"+s+"("+i+")"+s+"("+i+"))?\\s*\\))")+"|"+("(?:(skewX)\\s*\\(\\s*("+i+")\\s*\\))")+"|"+("(?:(skewY)\\s*\\(\\s*("+i+")\\s*\\))")+")",n=new RegExp("^\\s*(?:"+("(?:"+a+"(?:"+s+"*"+a+")*)")+"?)\\s*$"),o=new RegExp(a,"g");return function(i){var s=r.concat(),l=[];if(!i||i&&!n.test(i))return s;i.replace(o,(function(i){var n=new RegExp(a).exec(i).filter((function(t){return!!t})),o=n[1],c=n.slice(2).map(parseFloat);switch(o){case"translate":!function(t,e){t[4]=e[0],2===e.length&&(t[5]=e[1])}(s,c);break;case"rotate":c[0]=e.util.degreesToRadians(c[0]),function(t,r){var i=e.util.cos(r[0]),s=e.util.sin(r[0]),a=0,n=0;3===r.length&&(a=r[1],n=r[2]),t[0]=i,t[1]=s,t[2]=-s,t[3]=i,t[4]=a-(i*a-s*n),t[5]=n-(s*a+i*n)}(s,c);break;case"scale":!function(t,e){var r=e[0],i=2===e.length?e[1]:e[0];t[0]=r,t[3]=i}(s,c);break;case"skewX":t(s,c,2);break;case"skewY":t(s,c,1);break;case"matrix":s=c}l.push(s.concat()),s=r.concat()}));for(var c=l[0];l.length>1;)l.shift(),c=e.util.multiplyTransformMatrices(c,l[0]);return c}}();var g=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function b(t){if(!e.svgViewBoxElementsRegEx.test(t.nodeName))return{};var r,i,s,n,o,l,c=t.getAttribute("viewBox"),u=1,d=1,m=t.getAttribute("width"),h=t.getAttribute("height"),p=t.getAttribute("x")||0,f=t.getAttribute("y")||0,_=t.getAttribute("preserveAspectRatio")||"",v=!c||!(c=c.match(g)),b=!m||!h||"100%"===m||"100%"===h,y=v&&b,x={},$="",w=0,C=0;if(x.width=0,x.height=0,x.toBeParsed=y,v&&(p||f)&&t.parentNode&&"#document"!==t.parentNode.nodeName&&($=" translate("+a(p)+" "+a(f)+") ",o=(t.getAttribute("transform")||"")+$,t.setAttribute("transform",o),t.removeAttribute("x"),t.removeAttribute("y")),y)return x;if(v)return x.width=a(m),x.height=a(h),x;if(r=-parseFloat(c[1]),i=-parseFloat(c[2]),s=parseFloat(c[3]),n=parseFloat(c[4]),x.minX=r,x.minY=i,x.viewBoxWidth=s,x.viewBoxHeight=n,b?(x.width=s,x.height=n):(x.width=a(m),x.height=a(h),u=x.width/s,d=x.height/n),"none"!==(_=e.util.parsePreserveAspectRatioAttribute(_)).alignX&&("meet"===_.meetOrSlice&&(d=u=u>d?d:u),"slice"===_.meetOrSlice&&(d=u=u>d?u:d),w=x.width-s*u,C=x.height-n*u,"Mid"===_.alignX&&(w/=2),"Mid"===_.alignY&&(C/=2),"Min"===_.alignX&&(w=0),"Min"===_.alignY&&(C=0)),1===u&&1===d&&0===r&&0===i&&0===p&&0===f)return x;if((p||f)&&"#document"!==t.parentNode.nodeName&&($=" translate("+a(p)+" "+a(f)+") "),o=$+" matrix("+u+" 0 0 "+d+" "+(r*u+w)+" "+(i*d+C)+") ","svg"===t.nodeName){for(l=t.ownerDocument.createElementNS(e.svgNS,"g");t.firstChild;)l.appendChild(t.firstChild);t.appendChild(l)}else(l=t).removeAttribute("x"),l.removeAttribute("y"),o=l.getAttribute("transform")+o;return l.setAttribute("transform",o),x}function y(t,e){var r="xlink:href",i=v(t,e.getAttribute(r).substr(1));if(i&&i.getAttribute(r)&&y(t,i),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach((function(t){i&&!e.hasAttribute(t)&&i.hasAttribute(t)&&e.setAttribute(t,i.getAttribute(t))})),!e.children.length)for(var s=i.cloneNode(!0);s.firstChild;)e.appendChild(s.firstChild);e.removeAttribute(r)}e.parseSVGDocument=function(t,r,s,a){if(t){!function(t){for(var r=p(t,["use","svg:use"]),i=0;r.length&&i<r.length;){var s=r[i],a=s.getAttribute("xlink:href")||s.getAttribute("href");if(null===a)return;var n,o,l,c,u=a.substr(1),d=s.getAttribute("x")||0,m=s.getAttribute("y")||0,h=v(t,u).cloneNode(!0),f=(h.getAttribute("transform")||"")+" translate("+d+", "+m+")",_=r.length,g=e.svgNS;if(b(h),/^svg$/i.test(h.nodeName)){var y=h.ownerDocument.createElementNS(g,"g");for(o=0,c=(l=h.attributes).length;o<c;o++)n=l.item(o),y.setAttributeNS(g,n.nodeName,n.nodeValue);for(;h.firstChild;)y.appendChild(h.firstChild);h=y}for(o=0,c=(l=s.attributes).length;o<c;o++)"x"!==(n=l.item(o)).nodeName&&"y"!==n.nodeName&&"xlink:href"!==n.nodeName&&"href"!==n.nodeName&&("transform"===n.nodeName?f=n.nodeValue+" "+f:h.setAttribute(n.nodeName,n.nodeValue));h.setAttribute("transform",f),h.setAttribute("instantiated_by_use","1"),h.removeAttribute("id"),s.parentNode.replaceChild(h,s),r.length===_&&i++}}(t);var n,o,l=e.Object.__uid++,c=b(t),u=e.util.toArray(t.getElementsByTagName("*"));if(c.crossOrigin=a&&a.crossOrigin,c.svgUid=l,0===u.length&&e.isLikelyNode){var d=[];for(n=0,o=(u=t.selectNodes('//*[name(.)!="svg"]')).length;n<o;n++)d[n]=u[n];u=d}var m=u.filter((function(t){return b(t),e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))&&!function(t,e){for(;t&&(t=t.parentNode);)if(t.nodeName&&e.test(t.nodeName.replace("svg:",""))&&!t.getAttribute("instantiated_by_use"))return!0;return!1}(t,e.svgInvalidAncestorsRegEx)}));if(!m||m&&!m.length)r&&r([],{});else{var h={};u.filter((function(t){return"clipPath"===t.nodeName.replace("svg:","")})).forEach((function(t){var r=t.getAttribute("id");h[r]=e.util.toArray(t.getElementsByTagName("*")).filter((function(t){return e.svgValidTagNamesRegEx.test(t.nodeName.replace("svg:",""))}))})),e.gradientDefs[l]=e.getGradientDefs(t),e.cssRules[l]=e.getCSSRules(t),e.clipPaths[l]=h,e.parseElements(m,(function(t,i){r&&(r(t,c,i,u),delete e.gradientDefs[l],delete e.cssRules[l],delete e.clipPaths[l])}),i(c),s,a)}}};var x=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");r(e,{parseFontDeclaration:function(t,e){var r=t.match(x);if(r){var i=r[1],s=r[3],n=r[4],o=r[5],l=r[6];i&&(e.fontStyle=i),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),n&&(e.fontSize=a(n)),l&&(e.fontFamily=l),o&&(e.lineHeight="normal"===o?1:o)}},getGradientDefs:function(t){var e,r=p(t,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),i=0,s={};for(i=r.length;i--;)(e=r[i]).getAttribute("xlink:href")&&y(t,e),s[e.getAttribute("id")]=e;return s},parseAttributes:function(t,i,n){if(t){var o,h,p,_={};void 0===n&&(n=t.getAttribute("svgUid")),t.parentNode&&e.svgValidParentsRegEx.test(t.parentNode.nodeName)&&(_=e.parseAttributes(t.parentNode,i,n));var v=i.reduce((function(e,r){return(o=t.getAttribute(r))&&(e[r]=o),e}),{}),g=r(function(t,r){var i={};for(var s in e.cssRules[r])if(f(t,s.split(" ")))for(var a in e.cssRules[r][s])i[a]=e.cssRules[r][s][a];return i}(t,n),e.parseStyleAttribute(t));v=r(v,g),g[u]&&t.setAttribute(u,g[u]),h=p=_.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,v[c]&&(v[c]=h=a(v[c],p));var b,y,x={};for(var $ in v)y=m(b=d($),v[$],_,h),x[b]=y;x&&x.font&&e.parseFontDeclaration(x.font,x);var w=r(_,x);return e.svgValidParentsRegEx.test(t.nodeName)?w:function(t){for(var r in l)if(void 0!==t[l[r]]&&""!==t[r]){if(void 0===t[r]){if(!e.Object.prototype[r])continue;t[r]=e.Object.prototype[r]}if(0!==t[r].indexOf("url(")){var i=new e.Color(t[r]);t[r]=i.setAlpha(s(i.getAlpha()*t[l[r]],2)).toRgba()}}return t}(w)}},parseElements:function(t,r,i,s,a){new e.ElementsParser(t,r,i,s,a).parse()},parseStyleAttribute:function(t){var e={},r=t.getAttribute("style");return r?("string"==typeof r?function(t,e){var r,i;t.replace(/;\s*$/,"").split(";").forEach((function(t){var s=t.split(":");r=s[0].trim().toLowerCase(),i=s[1].trim(),e[r]=i}))}(r,e):function(t,e){var r,i;for(var s in t)void 0!==t[s]&&(r=s.toLowerCase(),i=t[s],e[r]=i)}(r,e),e):e},parsePointsAttribute:function(t){if(!t)return null;var e,r,i=[];for(e=0,r=(t=(t=t.replace(/,/g," ").trim()).split(/\s+/)).length;e<r;e+=2)i.push({x:parseFloat(t[e]),y:parseFloat(t[e+1])});return i},getCSSRules:function(t){var r,i,s=t.getElementsByTagName("style"),a={};for(r=0,i=s.length;r<i;r++){var n=s[r].textContent;""!==(n=n.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&n.match(/[^{]*\{[\s\S]*?\}/g).map((function(t){return t.trim()})).forEach((function(t){var s=t.match(/([\s\S]*?)\s*\{([^}]*)\}/),n={},o=s[2].trim().replace(/;$/,"").split(/\s*;\s*/);for(r=0,i=o.length;r<i;r++){var l=o[r].split(/\s*:\s*/),c=l[0],u=l[1];n[c]=u}(t=s[1]).split(",").forEach((function(t){""!==(t=t.replace(/^svg/i,"").trim())&&(a[t]?e.util.object.extend(a[t],n):a[t]=e.util.object.clone(n))}))}))}return a},loadSVGFromURL:function(t,r,i,s){t=t.replace(/^\n\s*/,"").trim(),new e.util.request(t,{method:"get",onComplete:function(t){var a=t.responseXML;if(!a||!a.documentElement)return r&&r(null),!1;e.parseSVGDocument(a.documentElement,(function(t,e,i,s){r&&r(t,e,i,s)}),i,s)}})},loadSVGFromString:function(t,r,i,s){var a=(new e.window.DOMParser).parseFromString(t.trim(),"text/xml");e.parseSVGDocument(a.documentElement,(function(t,e,i,s){r(t,e,i,s)}),i,s)}})}(e),S.ElementsParser=function(t,e,r,i,s,a){this.elements=t,this.callback=e,this.options=r,this.reviver=i,this.svgUid=r&&r.svgUid||0,this.parsingOptions=s,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=a},(_=S.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},_.createObjects=function(){var t=this;this.elements.forEach((function(e,r){e.setAttribute("svgUid",t.svgUid),t.createObject(e,r)}))},_.findTag=function(t){return S[S.util.string.capitalize(t.tagName.replace("svg:",""))]},_.createObject=function(t,e){var r=this.findTag(t);if(r&&r.fromElement)try{r.fromElement(t,this.createCallback(e,t),this.options)}catch(t){S.log(t)}else this.checkIfDone()},_.createCallback=function(t,e){var r=this;return function(i){var s;r.resolveGradient(i,e,"fill"),r.resolveGradient(i,e,"stroke"),i instanceof S.Image&&i._originalElement&&(s=i.parsePreserveAspectRatioAttribute(e)),i._removeTransformMatrix(s),r.resolveClipPath(i,e),r.reviver&&r.reviver(e,i),r.instances[t]=i,r.checkIfDone()}},_.extractPropertyDefinition=function(t,e,r){var i=t[e],s=this.regexUrl;if(s.test(i)){s.lastIndex=0;var a=s.exec(i)[1];return s.lastIndex=0,S[r][this.svgUid][a]}},_.resolveGradient=function(t,e,r){var i=this.extractPropertyDefinition(t,r,"gradientDefs");if(i){var s=e.getAttribute(r+"-opacity"),a=S.Gradient.fromElement(i,t,s,this.options);t.set(r,a)}},_.createClipPathCallback=function(t,e){return function(t){t._removeTransformMatrix(),t.fillRule=t.clipRule,e.push(t)}},_.resolveClipPath=function(t,e){var r,i,s,a,n=this.extractPropertyDefinition(t,"clipPath","clipPaths");if(n){s=[],i=S.util.invertTransform(t.calcTransformMatrix());for(var o=n[0].parentNode,l=e;l.parentNode&&l.getAttribute("clip-path")!==t.clipPath;)l=l.parentNode;l.parentNode.appendChild(o);for(var c=0;c<n.length;c++)r=n[c],this.findTag(r).fromElement(r,this.createClipPathCallback(t,s),this.options);n=1===s.length?s[0]:new S.Group(s),a=S.util.multiplyTransformMatrices(i,n.calcTransformMatrix()),n.clipPath&&this.resolveClipPath(n,l);var u=S.util.qrDecompose(a);n.flipX=!1,n.flipY=!1,n.set("scaleX",u.scaleX),n.set("scaleY",u.scaleY),n.angle=u.angle,n.skewX=u.skewX,n.skewY=0,n.setPositionByOrigin({x:u.translateX,y:u.translateY},"center","center"),t.clipPath=n}else delete t.clipPath},_.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter((function(t){return null!=t})),this.callback(this.instances,this.elements))},function(t){"use strict";var e=t.fabric||(t.fabric={});function r(t,e){this.x=t,this.y=e}e.Point?e.warn("fabric.Point is already defined"):(e.Point=r,r.prototype={type:"point",constructor:r,add:function(t){return new r(this.x+t.x,this.y+t.y)},addEquals:function(t){return this.x+=t.x,this.y+=t.y,this},scalarAdd:function(t){return new r(this.x+t,this.y+t)},scalarAddEquals:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return new r(this.x-t.x,this.y-t.y)},subtractEquals:function(t){return this.x-=t.x,this.y-=t.y,this},scalarSubtract:function(t){return new r(this.x-t,this.y-t)},scalarSubtractEquals:function(t){return this.x-=t,this.y-=t,this},multiply:function(t){return new r(this.x*t,this.y*t)},multiplyEquals:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return new r(this.x/t,this.y/t)},divideEquals:function(t){return this.x/=t,this.y/=t,this},eq:function(t){return this.x===t.x&&this.y===t.y},lt:function(t){return this.x<t.x&&this.y<t.y},lte:function(t){return this.x<=t.x&&this.y<=t.y},gt:function(t){return this.x>t.x&&this.y>t.y},gte:function(t){return this.x>=t.x&&this.y>=t.y},lerp:function(t,e){return void 0===e&&(e=.5),e=Math.max(Math.min(1,e),0),new r(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},distanceFrom:function(t){var e=this.x-t.x,r=this.y-t.y;return Math.sqrt(e*e+r*r)},midPointFrom:function(t){return this.lerp(t)},min:function(t){return new r(Math.min(this.x,t.x),Math.min(this.y,t.y))},max:function(t){return new r(Math.max(this.x,t.x),Math.max(this.y,t.y))},toString:function(){return this.x+","+this.y},setXY:function(t,e){return this.x=t,this.y=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setFromPoint:function(t){return this.x=t.x,this.y=t.y,this},swap:function(t){var e=this.x,r=this.y;this.x=t.x,this.y=t.y,t.x=e,t.y=r},clone:function(){return new r(this.x,this.y)}})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function r(t){this.status=t,this.points=[]}e.Intersection?e.warn("fabric.Intersection is already defined"):(e.Intersection=r,e.Intersection.prototype={constructor:r,appendPoint:function(t){return this.points.push(t),this},appendPoints:function(t){return this.points=this.points.concat(t),this}},e.Intersection.intersectLineLine=function(t,i,s,a){var n,o=(a.x-s.x)*(t.y-s.y)-(a.y-s.y)*(t.x-s.x),l=(i.x-t.x)*(t.y-s.y)-(i.y-t.y)*(t.x-s.x),c=(a.y-s.y)*(i.x-t.x)-(a.x-s.x)*(i.y-t.y);if(0!==c){var u=o/c,d=l/c;0<=u&&u<=1&&0<=d&&d<=1?(n=new r("Intersection")).appendPoint(new e.Point(t.x+u*(i.x-t.x),t.y+u*(i.y-t.y))):n=new r}else n=new r(0===o||0===l?"Coincident":"Parallel");return n},e.Intersection.intersectLinePolygon=function(t,e,i){var s,a,n,o,l=new r,c=i.length;for(o=0;o<c;o++)s=i[o],a=i[(o+1)%c],n=r.intersectLineLine(t,e,s,a),l.appendPoints(n.points);return l.points.length>0&&(l.status="Intersection"),l},e.Intersection.intersectPolygonPolygon=function(t,e){var i,s=new r,a=t.length;for(i=0;i<a;i++){var n=t[i],o=t[(i+1)%a],l=r.intersectLinePolygon(n,o,e);s.appendPoints(l.points)}return s.points.length>0&&(s.status="Intersection"),s},e.Intersection.intersectPolygonRectangle=function(t,i,s){var a=i.min(s),n=i.max(s),o=new e.Point(n.x,a.y),l=new e.Point(a.x,n.y),c=r.intersectLinePolygon(a,o,t),u=r.intersectLinePolygon(o,n,t),d=r.intersectLinePolygon(n,l,t),m=r.intersectLinePolygon(l,a,t),h=new r;return h.appendPoints(c.points),h.appendPoints(u.points),h.appendPoints(d.points),h.appendPoints(m.points),h.points.length>0&&(h.status="Intersection"),h})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});function r(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function i(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}e.Color?e.warn("fabric.Color is already defined."):(e.Color=r,e.Color.prototype={_tryParsingColor:function(t){var e;t in r.colorNameMap&&(t=r.colorNameMap[t]),"transparent"===t&&(e=[255,255,255,0]),e||(e=r.sourceFromHex(t)),e||(e=r.sourceFromRgb(t)),e||(e=r.sourceFromHsl(t)),e||(e=[0,0,0,1]),e&&this.setSource(e)},_rgbToHsl:function(t,r,i){t/=255,r/=255,i/=255;var s,a,n,o=e.util.array.max([t,r,i]),l=e.util.array.min([t,r,i]);if(n=(o+l)/2,o===l)s=a=0;else{var c=o-l;switch(a=n>.5?c/(2-o-l):c/(o+l),o){case t:s=(r-i)/c+(r<i?6:0);break;case r:s=(i-t)/c+2;break;case i:s=(t-r)/c+4}s/=6}return[Math.round(360*s),Math.round(100*a),Math.round(100*n)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+e[0]+","+e[1]+"%,"+e[2]+"%)"},toHsla:function(){var t=this.getSource(),e=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+e[0]+","+e[1]+"%,"+e[2]+"%,"+t[3]+")"},toHex:function(){var t,e,r,i=this.getSource();return t=1===(t=i[0].toString(16)).length?"0"+t:t,e=1===(e=i[1].toString(16)).length?"0"+e:e,r=1===(r=i[2].toString(16)).length?"0"+r:r,t.toUpperCase()+e.toUpperCase()+r.toUpperCase()},toHexa:function(){var t,e=this.getSource();return t=1===(t=(t=Math.round(255*e[3])).toString(16)).length?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var e=this.getSource();return e[3]=t,this.setSource(e),this},toGrayscale:function(){var t=this.getSource(),e=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),r=t[3];return this.setSource([e,e,e,r]),this},toBlackWhite:function(t){var e=this.getSource(),r=(.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),i=e[3];return t=t||127,r=Number(r)<Number(t)?0:255,this.setSource([r,r,r,i]),this},overlayWith:function(t){t instanceof r||(t=new r(t));var e,i=[],s=this.getAlpha(),a=this.getSource(),n=t.getSource();for(e=0;e<3;e++)i.push(Math.round(.5*a[e]+.5*n[e]));return i[3]=s,this.setSource(i),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},e.Color.fromRgb=function(t){return r.fromSource(r.sourceFromRgb(t))},e.Color.sourceFromRgb=function(t){var e=t.match(r.reRGBa);if(e){var i=parseInt(e[1],10)/(/%$/.test(e[1])?100:1)*(/%$/.test(e[1])?255:1),s=parseInt(e[2],10)/(/%$/.test(e[2])?100:1)*(/%$/.test(e[2])?255:1),a=parseInt(e[3],10)/(/%$/.test(e[3])?100:1)*(/%$/.test(e[3])?255:1);return[parseInt(i,10),parseInt(s,10),parseInt(a,10),e[4]?parseFloat(e[4]):1]}},e.Color.fromRgba=r.fromRgb,e.Color.fromHsl=function(t){return r.fromSource(r.sourceFromHsl(t))},e.Color.sourceFromHsl=function(t){var e=t.match(r.reHSLa);if(e){var s,a,n,o=(parseFloat(e[1])%360+360)%360/360,l=parseFloat(e[2])/(/%$/.test(e[2])?100:1),c=parseFloat(e[3])/(/%$/.test(e[3])?100:1);if(0===l)s=a=n=c;else{var u=c<=.5?c*(l+1):c+l-c*l,d=2*c-u;s=i(d,u,o+1/3),a=i(d,u,o),n=i(d,u,o-1/3)}return[Math.round(255*s),Math.round(255*a),Math.round(255*n),e[4]?parseFloat(e[4]):1]}},e.Color.fromHsla=r.fromHsl,e.Color.fromHex=function(t){return r.fromSource(r.sourceFromHex(t))},e.Color.sourceFromHex=function(t){if(t.match(r.reHex)){var e=t.slice(t.indexOf("#")+1),i=3===e.length||4===e.length,s=8===e.length||4===e.length,a=i?e.charAt(0)+e.charAt(0):e.substring(0,2),n=i?e.charAt(1)+e.charAt(1):e.substring(2,4),o=i?e.charAt(2)+e.charAt(2):e.substring(4,6),l=s?i?e.charAt(3)+e.charAt(3):e.substring(6,8):"FF";return[parseInt(a,16),parseInt(n,16),parseInt(o,16),parseFloat((parseInt(l,16)/255).toFixed(2))]}},e.Color.fromSource=function(t){var e=new r;return e.setSource(t),e})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=["e","se","s","sw","w","nw","n","ne","e"],i=["ns","nesw","ew","nwse"],s={},a="left",n="top",o="right",l="bottom",c="center",u={top:l,bottom:n,left:o,right:a,center:c},d=e.util.radiansToDegrees,m=Math.sign||function(t){return(t>0)-(t<0)||+t};function h(t,e){var r=t.angle+d(Math.atan2(e.y,e.x))+360;return Math.round(r%360/45)}function p(t,r){var i=r.transform.target,s=i.canvas,a=e.util.object.clone(r);a.target=i,s&&s.fire("object:"+t,a),i.fire(t,r)}function f(t,e){var r=e.canvas,i=t[r.uniScaleKey];return r.uniformScaling&&!i||!r.uniformScaling&&i}function _(t){return t.originX===c&&t.originY===c}function v(t,e,r){var i=t.lockScalingX,s=t.lockScalingY;return!(!i||!s)||(!(e||!i&&!s||!r)||(!(!i||"x"!==e)||!(!s||"y"!==e)))}function g(t,e,r,i){return{e:t,transform:e,pointer:{x:r,y:i}}}function b(t){return function(e,r,i,s){var a=r.target,n=a.getCenterPoint(),o=a.translateToOriginPoint(n,r.originX,r.originY),l=t(e,r,i,s);return a.setPositionByOrigin(o,r.originX,r.originY),l}}function y(t,e){return function(r,i,s,a){var n=e(r,i,s,a);return n&&p(t,g(r,i,s,a)),n}}function x(t,r,i,s,a){var n=t.target,o=n.controls[t.corner],l=n.canvas.getZoom(),c=n.padding/l,u=n.toLocalPoint(new e.Point(s,a),r,i);return u.x>=c&&(u.x-=c),u.x<=-c&&(u.x+=c),u.y>=c&&(u.y-=c),u.y<=c&&(u.y+=c),u.x-=o.offsetX,u.y-=o.offsetY,u}function $(t){return t.flipX!==t.flipY}function w(t,e,r,i,s){if(0!==t[e]){var a=s/t._getTransformedDimensions()[i]*t[r];t.set(r,a)}}function C(t,e,r,i){var s,c=e.target,u=c._getTransformedDimensions(0,c.skewY),m=x(e,e.originX,e.originY,r,i),h=Math.abs(2*m.x)-u.x,p=c.skewX;h<2?s=0:(s=d(Math.atan2(h/c.scaleX,u.y/c.scaleY)),e.originX===a&&e.originY===l&&(s=-s),e.originX===o&&e.originY===n&&(s=-s),$(c)&&(s=-s));var f=p!==s;if(f){var _=c._getTransformedDimensions().y;c.set("skewX",s),w(c,"skewY","scaleY","y",_)}return f}function k(t,e,r,i){var s,c=e.target,u=c._getTransformedDimensions(c.skewX,0),m=x(e,e.originX,e.originY,r,i),h=Math.abs(2*m.y)-u.y,p=c.skewY;h<2?s=0:(s=d(Math.atan2(h/c.scaleY,u.x/c.scaleX)),e.originX===a&&e.originY===l&&(s=-s),e.originX===o&&e.originY===n&&(s=-s),$(c)&&(s=-s));var f=p!==s;if(f){var _=c._getTransformedDimensions().x;c.set("skewY",s),w(c,"skewX","scaleX","x",_)}return f}function S(t,e,r,i,s){s=s||{};var a,n,o,l,c,d,h=e.target,p=h.lockScalingX,g=h.lockScalingY,b=s.by,y=f(t,h),$=v(h,b,y),w=e.gestureScale;if($)return!1;if(w)n=e.scaleX*w,o=e.scaleY*w;else{if(a=x(e,e.originX,e.originY,r,i),c="y"!==b?m(a.x):1,d="x"!==b?m(a.y):1,e.signX||(e.signX=c),e.signY||(e.signY=d),h.lockScalingFlip&&(e.signX!==c||e.signY!==d))return!1;if(l=h._getTransformedDimensions(),y&&!b){var C=Math.abs(a.x)+Math.abs(a.y),k=e.original,S=C/(Math.abs(l.x*k.scaleX/h.scaleX)+Math.abs(l.y*k.scaleY/h.scaleY));n=k.scaleX*S,o=k.scaleY*S}else n=Math.abs(a.x*h.scaleX/l.x),o=Math.abs(a.y*h.scaleY/l.y);_(e)&&(n*=2,o*=2),e.signX!==c&&"y"!==b&&(e.originX=u[e.originX],n*=-1,e.signX=c),e.signY!==d&&"x"!==b&&(e.originY=u[e.originY],o*=-1,e.signY=d)}var O=h.scaleX,I=h.scaleY;return b?("x"===b&&h.set("scaleX",n),"y"===b&&h.set("scaleY",o)):(!p&&h.set("scaleX",n),!g&&h.set("scaleY",o)),O!==h.scaleX||I!==h.scaleY}s.scaleCursorStyleHandler=function(t,e,i){var s=f(t,i),a="";if(0!==e.x&&0===e.y?a="x":0===e.x&&0!==e.y&&(a="y"),v(i,a,s))return"not-allowed";var n=h(i,e);return r[n]+"-resize"},s.skewCursorStyleHandler=function(t,e,r){var s="not-allowed";if(0!==e.x&&r.lockSkewingY)return s;if(0!==e.y&&r.lockSkewingX)return s;var a=h(r,e)%4;return i[a]+"-resize"},s.scaleSkewCursorStyleHandler=function(t,e,r){return t[r.canvas.altActionKey]?s.skewCursorStyleHandler(t,e,r):s.scaleCursorStyleHandler(t,e,r)},s.rotationWithSnapping=y("rotating",b((function(t,e,r,i){var s=e,a=s.target,n=a.translateToOriginPoint(a.getCenterPoint(),s.originX,s.originY);if(a.lockRotation)return!1;var o,l=Math.atan2(s.ey-n.y,s.ex-n.x),c=Math.atan2(i-n.y,r-n.x),u=d(c-l+s.theta);if(a.snapAngle>0){var m=a.snapAngle,h=a.snapThreshold||m,p=Math.ceil(u/m)*m,f=Math.floor(u/m)*m;Math.abs(u-f)<h?u=f:Math.abs(u-p)<h&&(u=p)}return u<0&&(u=360+u),u%=360,o=a.angle!==u,a.angle=u,o}))),s.scalingEqually=y("scaling",b((function(t,e,r,i){return S(t,e,r,i)}))),s.scalingX=y("scaling",b((function(t,e,r,i){return S(t,e,r,i,{by:"x"})}))),s.scalingY=y("scaling",b((function(t,e,r,i){return S(t,e,r,i,{by:"y"})}))),s.scalingYOrSkewingX=function(t,e,r,i){return t[e.target.canvas.altActionKey]?s.skewHandlerX(t,e,r,i):s.scalingY(t,e,r,i)},s.scalingXOrSkewingY=function(t,e,r,i){return t[e.target.canvas.altActionKey]?s.skewHandlerY(t,e,r,i):s.scalingX(t,e,r,i)},s.changeWidth=y("resizing",b((function(t,e,r,i){var s=e.target,a=x(e,e.originX,e.originY,r,i),n=s.strokeWidth/(s.strokeUniform?s.scaleX:1),o=_(e)?2:1,l=s.width,c=Math.abs(a.x*o/s.scaleX)-n;return s.set("width",Math.max(c,0)),l!==c}))),s.skewHandlerX=function(t,e,r,i){var s,l=e.target,u=l.skewX,d=e.originY;return!l.lockSkewingX&&(0===u?s=x(e,c,c,r,i).x>0?a:o:(u>0&&(s=d===n?a:o),u<0&&(s=d===n?o:a),$(l)&&(s=s===a?o:a)),e.originX=s,y("skewing",b(C))(t,e,r,i))},s.skewHandlerY=function(t,e,r,i){var s,o=e.target,u=o.skewY,d=e.originX;return!o.lockSkewingY&&(0===u?s=x(e,c,c,r,i).y>0?n:l:(u>0&&(s=d===a?n:l),u<0&&(s=d===a?l:n),$(o)&&(s=s===n?l:n)),e.originY=s,y("skewing",b(k))(t,e,r,i))},s.dragHandler=function(t,e,r,i){var s=e.target,a=r-e.offsetX,n=i-e.offsetY,o=!s.get("lockMovementX")&&s.left!==a,l=!s.get("lockMovementY")&&s.top!==n;return o&&s.set("left",a),l&&s.set("top",n),(o||l)&&p("moving",g(t,e,r,i)),o||l},s.scaleOrSkewActionName=function(t,e,r){var i=t[r.canvas.altActionKey];return 0===e.x?i?"skewX":"scaleY":0===e.y?i?"skewY":"scaleX":void 0},s.rotationStyleHandler=function(t,e,r){return r.lockRotation?"not-allowed":e.cursorStyle},s.fireEvent=p,s.wrapWithFixedAnchor=b,s.wrapWithFireEvent=y,s.getLocalPoint=x,e.controlsUtils=s}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.degreesToRadians,i=e.controlsUtils;i.renderCircleControl=function(t,e,r,i,s){i=i||{};var a,n=this.sizeX||i.cornerSize||s.cornerSize,o=this.sizeY||i.cornerSize||s.cornerSize,l=void 0!==i.transparentCorners?i.transparentCorners:s.transparentCorners,c=l?"stroke":"fill",u=!l&&(i.cornerStrokeColor||s.cornerStrokeColor),d=e,m=r;t.save(),t.fillStyle=i.cornerColor||s.cornerColor,t.strokeStyle=i.cornerStrokeColor||s.cornerStrokeColor,n>o?(a=n,t.scale(1,o/n),m=r*n/o):o>n?(a=o,t.scale(n/o,1),d=e*o/n):a=n,t.lineWidth=1,t.beginPath(),t.arc(d,m,a/2,0,2*Math.PI,!1),t[c](),u&&t.stroke(),t.restore()},i.renderSquareControl=function(t,e,i,s,a){s=s||{};var n=this.sizeX||s.cornerSize||a.cornerSize,o=this.sizeY||s.cornerSize||a.cornerSize,l=void 0!==s.transparentCorners?s.transparentCorners:a.transparentCorners,c=l?"stroke":"fill",u=!l&&(s.cornerStrokeColor||a.cornerStrokeColor),d=n/2,m=o/2;t.save(),t.fillStyle=s.cornerColor||a.cornerColor,t.strokeStyle=s.cornerStrokeColor||a.cornerStrokeColor,t.lineWidth=1,t.translate(e,i),t.rotate(r(a.angle)),t[c+"Rect"](-d,-m,n,o),u&&t.strokeRect(-d,-m,n,o),t.restore()}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Control=function(t){for(var e in t)this[e]=t[e]},e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(t,e){return e.cursorStyle},getActionName:function(t,e){return e.actionName},getVisibility:function(t,e){var r=t._controlsVisibility;return r&&void 0!==r[e]?r[e]:this.visible},setVisibility:function(t){this.visible=t},positionHandler:function(t,r){return e.util.transformPoint({x:this.x*t.x+this.offsetX,y:this.y*t.y+this.offsetY},r)},calcCornerCoords:function(t,r,i,s,a){var n,o,l,c,u=a?this.touchSizeX:this.sizeX,d=a?this.touchSizeY:this.sizeY;if(u&&d&&u!==d){var m=Math.atan2(d,u),h=Math.sqrt(u*u+d*d)/2,p=m-e.util.degreesToRadians(t),f=Math.PI/2-m-e.util.degreesToRadians(t);n=h*e.util.cos(p),o=h*e.util.sin(p),l=h*e.util.cos(f),c=h*e.util.sin(f)}else{h=.7071067812*(u&&d?u:r);p=e.util.degreesToRadians(45-t);n=l=h*e.util.cos(p),o=c=h*e.util.sin(p)}return{tl:{x:i-c,y:s-l},tr:{x:i+n,y:s-o},bl:{x:i-n,y:s+o},br:{x:i+c,y:s+l}}},render:function(t,r,i,s,a){if("circle"===((s=s||{}).cornerStyle||a.cornerStyle))e.controlsUtils.renderCircleControl.call(this,t,r,i,s,a);else e.controlsUtils.renderSquareControl.call(this,t,r,i,s,a)}}}(e),function(){function t(t,e){var r,i,s,a,n=t.getAttribute("style"),o=t.getAttribute("offset")||0;if(o=(o=parseFloat(o)/(/%$/.test(o)?100:1))<0?0:o>1?1:o,n){var l=n.split(/\s*;\s*/);for(""===l[l.length-1]&&l.pop(),a=l.length;a--;){var c=l[a].split(/\s*:\s*/),u=c[0].trim(),d=c[1].trim();"stop-color"===u?r=d:"stop-opacity"===u&&(s=d)}}return r||(r=t.getAttribute("stop-color")||"rgb(0,0,0)"),s||(s=t.getAttribute("stop-opacity")),i=(r=new S.Color(r)).getAlpha(),s=isNaN(parseFloat(s))?1:parseFloat(s),s*=i*e,{offset:o,color:r.toRgb(),opacity:s}}var e=S.util.object.clone;S.Gradient=S.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(t){t||(t={}),t.coords||(t.coords={});var e,r=this;Object.keys(t).forEach((function(e){r[e]=t[e]})),this.id?this.id+="_"+S.Object.__uid++:this.id=S.Object.__uid++,e={x1:t.coords.x1||0,y1:t.coords.y1||0,x2:t.coords.x2||0,y2:t.coords.y2||0},"radial"===this.type&&(e.r1=t.coords.r1||0,e.r2=t.coords.r2||0),this.coords=e,this.colorStops=t.colorStops.slice()},addColorStop:function(t){for(var e in t){var r=new S.Color(t[e]);this.colorStops.push({offset:parseFloat(e),color:r.toRgb(),opacity:r.getAlpha()})}return this},toObject:function(t){var e={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return S.util.populateWithProperties(this,e,t),e},toSVG:function(t,r){var i,s,a,n,o=e(this.coords,!0),l=(r=r||{},e(this.colorStops,!0)),c=o.r1>o.r2,u=this.gradientTransform?this.gradientTransform.concat():S.iMatrix.concat(),d=-this.offsetX,m=-this.offsetY,h=!!r.additionalTransform,p="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(l.sort((function(t,e){return t.offset-e.offset})),"objectBoundingBox"===p?(d/=t.width,m/=t.height):(d+=t.width/2,m+=t.height/2),"path"===t.type&&"percentage"!==this.gradientUnits&&(d-=t.pathOffset.x,m-=t.pathOffset.y),u[4]-=d,u[5]-=m,n='id="SVGID_'+this.id+'" gradientUnits="'+p+'"',n+=' gradientTransform="'+(h?r.additionalTransform+" ":"")+S.util.matrixToSVG(u)+'" ',"linear"===this.type?a=["<linearGradient ",n,' x1="',o.x1,'" y1="',o.y1,'" x2="',o.x2,'" y2="',o.y2,'">\n']:"radial"===this.type&&(a=["<radialGradient ",n,' cx="',c?o.x1:o.x2,'" cy="',c?o.y1:o.y2,'" r="',c?o.r1:o.r2,'" fx="',c?o.x2:o.x1,'" fy="',c?o.y2:o.y1,'">\n']),"radial"===this.type){if(c)for((l=l.concat()).reverse(),i=0,s=l.length;i<s;i++)l[i].offset=1-l[i].offset;var f=Math.min(o.r1,o.r2);if(f>0){var _=f/Math.max(o.r1,o.r2);for(i=0,s=l.length;i<s;i++)l[i].offset+=_*(1-l[i].offset)}}for(i=0,s=l.length;i<s;i++){var v=l[i];a.push("<stop ",'offset="',100*v.offset+"%",'" style="stop-color:',v.color,void 0!==v.opacity?";stop-opacity: "+v.opacity:";",'"/>\n')}return a.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),a.join("")},toLive:function(t){var e,r,i,s=S.util.object.clone(this.coords);if(this.type){for("linear"===this.type?e=t.createLinearGradient(s.x1,s.y1,s.x2,s.y2):"radial"===this.type&&(e=t.createRadialGradient(s.x1,s.y1,s.r1,s.x2,s.y2,s.r2)),r=0,i=this.colorStops.length;r<i;r++){var a=this.colorStops[r].color,n=this.colorStops[r].opacity,o=this.colorStops[r].offset;void 0!==n&&(a=new S.Color(a).setAlpha(n).toRgba()),e.addColorStop(o,a)}return e}}}),S.util.object.extend(S.Gradient,{fromElement:function(e,r,i,s){var a=parseFloat(i)/(/%$/.test(i)?100:1);a=a<0?0:a>1?1:a,isNaN(a)&&(a=1);var n,o,l,c,u=e.getElementsByTagName("stop"),d="userSpaceOnUse"===e.getAttribute("gradientUnits")?"pixels":"percentage",m=e.getAttribute("gradientTransform")||"",h=[],p=0,f=0;for("linearGradient"===e.nodeName||"LINEARGRADIENT"===e.nodeName?(n="linear",o=function(t){return{x1:t.getAttribute("x1")||0,y1:t.getAttribute("y1")||0,x2:t.getAttribute("x2")||"100%",y2:t.getAttribute("y2")||0}}(e)):(n="radial",o=function(t){return{x1:t.getAttribute("fx")||t.getAttribute("cx")||"50%",y1:t.getAttribute("fy")||t.getAttribute("cy")||"50%",r1:0,x2:t.getAttribute("cx")||"50%",y2:t.getAttribute("cy")||"50%",r2:t.getAttribute("r")||"50%"}}(e)),l=u.length;l--;)h.push(t(u[l],a));return c=S.parseTransformAttribute(m),function(t,e,r,i){var s,a;Object.keys(e).forEach((function(t){"Infinity"===(s=e[t])?a=1:"-Infinity"===s?a=0:(a=parseFloat(e[t],10),"string"==typeof s&&/^(\d+\.\d+)%|(\d+)%$/.test(s)&&(a*=.01,"pixels"===i&&("x1"!==t&&"x2"!==t&&"r2"!==t||(a*=r.viewBoxWidth||r.width),"y1"!==t&&"y2"!==t||(a*=r.viewBoxHeight||r.height)))),e[t]=a}))}(0,o,s,d),"pixels"===d&&(p=-r.left,f=-r.top),new S.Gradient({id:e.getAttribute("id"),type:n,coords:o,colorStops:h,gradientUnits:d,gradientTransform:c,offsetX:p,offsetY:f})}})}(),function(){"use strict";var t=S.util.toFixed;S.Pattern=S.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(t,e){if(t||(t={}),this.id=S.Object.__uid++,this.setOptions(t),!t.source||t.source&&"string"!=typeof t.source)e&&e(this);else{var r=this;this.source=S.util.createImage(),S.util.loadImage(t.source,(function(t,i){r.source=t,e&&e(r,i)}),null,this.crossOrigin)}},toObject:function(e){var r,i,s=S.Object.NUM_FRACTION_DIGITS;return"string"==typeof this.source.src?r=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(r=this.source.toDataURL()),i={type:"pattern",source:r,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,s),offsetY:t(this.offsetY,s),patternTransform:this.patternTransform?this.patternTransform.concat():null},S.util.populateWithProperties(this,i,e),i},toSVG:function(t){var e="function"==typeof this.source?this.source():this.source,r=e.width/t.width,i=e.height/t.height,s=this.offsetX/t.width,a=this.offsetY/t.height,n="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(i=1,a&&(i+=Math.abs(a))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(r=1,s&&(r+=Math.abs(s))),e.src?n=e.src:e.toDataURL&&(n=e.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+s+'" y="'+a+'" width="'+r+'" height="'+i+'">\n<image x="0" y="0" width="'+e.width+'" height="'+e.height+'" xlink:href="'+n+'"></image>\n</pattern>\n'},setOptions:function(t){for(var e in t)this[e]=t[e]},toLive:function(t){var e=this.source;if(!e)return"";if(void 0!==e.src){if(!e.complete)return"";if(0===e.naturalWidth||0===e.naturalHeight)return""}return t.createPattern(e,this.repeat)}})}(),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.toFixed;e.Shadow?e.warn("fabric.Shadow is already defined."):(e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(t){for(var r in"string"==typeof t&&(t=this._parseShadow(t)),t)this[r]=t[r];this.id=e.Object.__uid++},_parseShadow:function(t){var r=t.trim(),i=e.Shadow.reOffsetsAndBlur.exec(r)||[];return{color:(r.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(i[1],10)||0,offsetY:parseFloat(i[2],10)||0,blur:parseFloat(i[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(t){var i=40,s=40,a=e.Object.NUM_FRACTION_DIGITS,n=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-t.angle)),o=new e.Color(this.color);return t.width&&t.height&&(i=100*r((Math.abs(n.x)+this.blur)/t.width,a)+20,s=100*r((Math.abs(n.y)+this.blur)/t.height,a)+20),t.flipX&&(n.x*=-1),t.flipY&&(n.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+i+'%" width="'+(100+2*i)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+r(this.blur?this.blur/2:0,a)+'"></feGaussianBlur>\n\t<feOffset dx="'+r(n.x,a)+'" dy="'+r(n.y,a)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+o.toRgb()+'" flood-opacity="'+o.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var t={},r=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach((function(e){this[e]!==r[e]&&(t[e]=this[e])}),this),t}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(e),function(){"use strict";if(S.StaticCanvas)S.warn("fabric.StaticCanvas is already defined.");else{var t=S.util.object.extend,e=S.util.getElementOffset,r=S.util.removeFromArray,i=S.util.toFixed,s=S.util.transformPoint,a=S.util.invertTransform,n=S.util.getNodeCanvas,o=S.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");S.StaticCanvas=S.util.createClass(S.CommonMethods,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:S.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(t,e){var r=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(t),this._initOptions(e),this.interactive||this._initRetinaScaling(),e.overlayImage&&this.setOverlayImage(e.overlayImage,r),e.backgroundImage&&this.setBackgroundImage(e.backgroundImage,r),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor,r),e.overlayColor&&this.setOverlayColor(e.overlayColor,r),this.calcOffset()},_isRetinaScaling:function(){return 1!==S.devicePixelRatio&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?S.devicePixelRatio:1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var t=S.devicePixelRatio;this.__initRetinaScaling(t,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(t,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(t,e,r){e.setAttribute("width",this.width*t),e.setAttribute("height",this.height*t),r.scale(t,t)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(t,e,r){return this.__setBgOverlayImage("overlayImage",t,e,r)},setBackgroundImage:function(t,e,r){return this.__setBgOverlayImage("backgroundImage",t,e,r)},setOverlayColor:function(t,e){return this.__setBgOverlayColor("overlayColor",t,e)},setBackgroundColor:function(t,e){return this.__setBgOverlayColor("backgroundColor",t,e)},__setBgOverlayImage:function(t,e,r,i){return"string"==typeof e?S.util.loadImage(e,(function(e,s){if(e){var a=new S.Image(e,i);this[t]=a,a.canvas=this}r&&r(e,s)}),this,i&&i.crossOrigin):(i&&e.setOptions(i),this[t]=e,e&&(e.canvas=this),r&&r(e,!1)),this},__setBgOverlayColor:function(t,e,r){return this[t]=e,this._initGradient(e,t),this._initPattern(e,t,r),this},_createCanvasElement:function(){var t=o();if(!t)throw l;if(t.style||(t.style={}),void 0===t.getContext)throw l;return t},_initOptions:function(t){var e=this.lowerCanvasEl;this._setOptions(t),this.width=this.width||parseInt(e.width,10)||0,this.height=this.height||parseInt(e.height,10)||0,this.lowerCanvasEl.style&&(e.width=this.width,e.height=this.height,e.style.width=this.width+"px",e.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(t){t&&t.getContext?this.lowerCanvasEl=t:this.lowerCanvasEl=S.util.getById(t)||this._createCanvasElement(),S.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t,e){return this.setDimensions({width:t},e)},setHeight:function(t,e){return this.setDimensions({height:t},e)},setDimensions:function(t,e){var r;for(var i in e=e||{},t)r=t[i],e.cssOnly||(this._setBackstoreDimension(i,t[i]),r+="px",this.hasLostContext=!0),e.backstoreOnly||this._setCssDimension(i,r);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(),this._initRetinaScaling(),this.calcOffset(),e.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(t,e){return this.lowerCanvasEl[t]=e,this.upperCanvasEl&&(this.upperCanvasEl[t]=e),this.cacheCanvasEl&&(this.cacheCanvasEl[t]=e),this[t]=e,this},_setCssDimension:function(t,e){return this.lowerCanvasEl.style[t]=e,this.upperCanvasEl&&(this.upperCanvasEl.style[t]=e),this.wrapperEl&&(this.wrapperEl.style[t]=e),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(t){var e,r,i,s=this._activeObject,a=this.backgroundImage,n=this.overlayImage;for(this.viewportTransform=t,r=0,i=this._objects.length;r<i;r++)(e=this._objects[r]).group||e.setCoords(!0);return s&&s.setCoords(),a&&a.setCoords(!0),n&&n.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(t,e){var r=t,i=this.viewportTransform.slice(0);t=s(t,a(this.viewportTransform)),i[0]=e,i[3]=e;var n=s(t,i);return i[4]+=r.x-n.x,i[5]+=r.y-n.y,this.setViewportTransform(i)},setZoom:function(t){return this.zoomToPoint(new S.Point(0,0),t),this},absolutePan:function(t){var e=this.viewportTransform.slice(0);return e[4]=-t.x,e[5]=-t.y,this.setViewportTransform(e)},relativePan:function(t){return this.absolutePan(new S.Point(-t.x-this.viewportTransform[4],-t.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(t){this.stateful&&t.setupState(),t._set("canvas",this),t.setCoords(),this.fire("object:added",{target:t}),t.fire("added")},_onObjectRemoved:function(t){this.fire("object:removed",{target:t}),t.fire("removed"),delete t.canvas},clearContext:function(t){return t.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var t=this.contextContainer;return this.renderCanvas(t,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=S.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var t={},e=this.width,r=this.height,i=a(this.viewportTransform);return t.tl=s({x:0,y:0},i),t.br=s({x:e,y:r},i),t.tr=new S.Point(t.br.x,t.tl.y),t.bl=new S.Point(t.tl.x,t.br.y),this.vptCoords=t,t},cancelRequestedRender:function(){this.isRendering&&(S.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(t,e){var r=this.viewportTransform,i=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(t),S.util.setImageSmoothing(t,this.imageSmoothingEnabled),this.fire("before:render",{ctx:t}),this._renderBackground(t),t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(t,e),t.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),i&&(i.canvas=this,i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(t)),this._renderOverlay(t),this.controlsAboveOverlay&&this.interactive&&this.drawControls(t),this.fire("after:render",{ctx:t})},drawClipPathOnCanvas:function(t){var e=this.viewportTransform,r=this.clipPath;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t.globalCompositeOperation="destination-in",r.transform(t),t.scale(1/r.zoomX,1/r.zoomY),t.drawImage(r._cacheCanvas,-r.cacheTranslationX,-r.cacheTranslationY),t.restore()},_renderObjects:function(t,e){var r,i;for(r=0,i=e.length;r<i;++r)e[r]&&e[r].render(t)},_renderBackgroundOrOverlay:function(t,e){var r=this[e+"Color"],i=this[e+"Image"],s=this.viewportTransform,a=this[e+"Vpt"];if(r||i){if(r){t.save(),t.beginPath(),t.moveTo(0,0),t.lineTo(this.width,0),t.lineTo(this.width,this.height),t.lineTo(0,this.height),t.closePath(),t.fillStyle=r.toLive?r.toLive(t,this):r,a&&t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),t.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);var n=r.gradientTransform||r.patternTransform;n&&t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),t.fill(),t.restore()}i&&(t.save(),a&&t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),i.render(t),t.restore())}},_renderBackground:function(t){this._renderBackgroundOrOverlay(t,"background")},_renderOverlay:function(t){this._renderBackgroundOrOverlay(t,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},centerObjectH:function(t){return this._centerObject(t,new S.Point(this.getCenter().left,t.getCenterPoint().y))},centerObjectV:function(t){return this._centerObject(t,new S.Point(t.getCenterPoint().x,this.getCenter().top))},centerObject:function(t){var e=this.getCenter();return this._centerObject(t,new S.Point(e.left,e.top))},viewportCenterObject:function(t){var e=this.getVpCenter();return this._centerObject(t,e)},viewportCenterObjectH:function(t){var e=this.getVpCenter();return this._centerObject(t,new S.Point(e.x,t.getCenterPoint().y)),this},viewportCenterObjectV:function(t){var e=this.getVpCenter();return this._centerObject(t,new S.Point(t.getCenterPoint().x,e.y))},getVpCenter:function(){var t=this.getCenter(),e=a(this.viewportTransform);return s({x:t.left,y:t.top},e)},_centerObject:function(t,e){return t.setPositionByOrigin(e,"center","center"),t.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(t){return this.toDatalessObject(t)},toObject:function(t){return this._toObjectMethod("toObject",t)},toDatalessObject:function(t){return this._toObjectMethod("toDatalessObject",t)},_toObjectMethod:function(e,r){var i=this.clipPath,s={version:S.version,objects:this._toObjects(e,r)};return i&&!i.excludeFromExport&&(s.clipPath=this._toObject(this.clipPath,e,r)),t(s,this.__serializeBgOverlay(e,r)),S.util.populateWithProperties(this,s,r),s},_toObjects:function(t,e){return this._objects.filter((function(t){return!t.excludeFromExport})).map((function(r){return this._toObject(r,t,e)}),this)},_toObject:function(t,e,r){var i;this.includeDefaultValues||(i=t.includeDefaultValues,t.includeDefaultValues=!1);var s=t[e](r);return this.includeDefaultValues||(t.includeDefaultValues=i),s},__serializeBgOverlay:function(t,e){var r={},i=this.backgroundImage,s=this.overlayImage,a=this.backgroundColor,n=this.overlayColor;return a&&a.toObject?a.excludeFromExport||(r.background=a.toObject(e)):a&&(r.background=a),n&&n.toObject?n.excludeFromExport||(r.overlay=n.toObject(e)):n&&(r.overlay=n),i&&!i.excludeFromExport&&(r.backgroundImage=this._toObject(i,t,e)),s&&!s.excludeFromExport&&(r.overlayImage=this._toObject(s,t,e)),r},svgViewportTransformation:!0,toSVG:function(t,e){t||(t={}),t.reviver=e;var r=[];return this._setSVGPreamble(r,t),this._setSVGHeader(r,t),this.clipPath&&r.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",e),this._setSVGObjects(r,e),this.clipPath&&r.push("</g>\n"),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",e),r.push("</svg>"),r.join("")},_setSVGPreamble:function(t,e){e.suppressPreamble||t.push('<?xml version="1.0" encoding="',e.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(t,e){var r,s=e.width||this.width,a=e.height||this.height,n='viewBox="0 0 '+this.width+" "+this.height+'" ',o=S.Object.NUM_FRACTION_DIGITS;e.viewBox?n='viewBox="'+e.viewBox.x+" "+e.viewBox.y+" "+e.viewBox.width+" "+e.viewBox.height+'" ':this.svgViewportTransformation&&(r=this.viewportTransform,n='viewBox="'+i(-r[4]/r[0],o)+" "+i(-r[5]/r[3],o)+" "+i(this.width/r[0],o)+" "+i(this.height/r[3],o)+'" '),t.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',s,'" ','height="',a,'" ',n,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",S.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(e),"</defs>\n")},createSVGClipPathMarkup:function(t){var e=this.clipPath;return e?(e.clipPathId="CLIPPATH_"+S.Object.__uid++,'<clipPath id="'+e.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(t.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var t=this;return["background","overlay"].map((function(e){var r=t[e+"Color"];if(r&&r.toLive){var i=t[e+"Vpt"],s=t.viewportTransform,a={width:t.width/(i?s[0]:1),height:t.height/(i?s[3]:1)};return r.toSVG(a,{additionalTransform:i?S.util.matrixToSVG(s):""})}})).join("")},createSVGFontFacesMarkup:function(){var t,e,r,i,s,a,n,o,l="",c={},u=S.fontPaths,d=[];for(this._objects.forEach((function t(e){d.push(e),e._objects&&e._objects.forEach(t)})),n=0,o=d.length;n<o;n++)if(e=(t=d[n]).fontFamily,-1!==t.type.indexOf("text")&&!c[e]&&u[e]&&(c[e]=!0,t.styles))for(s in r=t.styles)for(a in i=r[s])!c[e=i[a].fontFamily]&&u[e]&&(c[e]=!0);for(var m in c)l+=["\t\t@font-face {\n","\t\t\tfont-family: '",m,"';\n","\t\t\tsrc: url('",u[m],"');\n","\t\t}\n"].join("");return l&&(l=['\t<style type="text/css">',"<![CDATA[\n",l,"]]>","</style>\n"].join("")),l},_setSVGObjects:function(t,e){var r,i,s,a=this._objects;for(i=0,s=a.length;i<s;i++)(r=a[i]).excludeFromExport||this._setSVGObject(t,r,e)},_setSVGObject:function(t,e,r){t.push(e.toSVG(r))},_setSVGBgOverlayImage:function(t,e,r){this[e]&&!this[e].excludeFromExport&&this[e].toSVG&&t.push(this[e].toSVG(r))},_setSVGBgOverlayColor:function(t,e){var r=this[e+"Color"],i=this.viewportTransform,s=this.width,a=this.height;if(r)if(r.toLive){var n=r.repeat,o=S.util.invertTransform(i),l=this[e+"Vpt"]?S.util.matrixToSVG(o):"";t.push('<rect transform="'+l+" translate(",s/2,",",a/2,')"',' x="',r.offsetX-s/2,'" y="',r.offsetY-a/2,'" ','width="',"repeat-y"===n||"no-repeat"===n?r.source.width:s,'" height="',"repeat-x"===n||"no-repeat"===n?r.source.height:a,'" fill="url(#SVGID_'+r.id+')"',"></rect>\n")}else t.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',"></rect>\n")},sendToBack:function(t){if(!t)return this;var e,i,s,a=this._activeObject;if(t===a&&"activeSelection"===t.type)for(e=(s=a._objects).length;e--;)i=s[e],r(this._objects,i),this._objects.unshift(i);else r(this._objects,t),this._objects.unshift(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(t){if(!t)return this;var e,i,s,a=this._activeObject;if(t===a&&"activeSelection"===t.type)for(s=a._objects,e=0;e<s.length;e++)i=s[e],r(this._objects,i),this._objects.push(i);else r(this._objects,t),this._objects.push(t);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(t,e){if(!t)return this;var i,s,a,n,o,l=this._activeObject,c=0;if(t===l&&"activeSelection"===t.type)for(o=l._objects,i=0;i<o.length;i++)s=o[i],(a=this._objects.indexOf(s))>0+c&&(n=a-1,r(this._objects,s),this._objects.splice(n,0,s)),c++;else 0!==(a=this._objects.indexOf(t))&&(n=this._findNewLowerIndex(t,a,e),r(this._objects,t),this._objects.splice(n,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(t,e,r){var i,s;if(r)for(i=e,s=e-1;s>=0;--s){if(t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t)){i=s;break}}else i=e-1;return i},bringForward:function(t,e){if(!t)return this;var i,s,a,n,o,l=this._activeObject,c=0;if(t===l&&"activeSelection"===t.type)for(i=(o=l._objects).length;i--;)s=o[i],(a=this._objects.indexOf(s))<this._objects.length-1-c&&(n=a+1,r(this._objects,s),this._objects.splice(n,0,s)),c++;else(a=this._objects.indexOf(t))!==this._objects.length-1&&(n=this._findNewUpperIndex(t,a,e),r(this._objects,t),this._objects.splice(n,0,t));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(t,e,r){var i,s,a;if(r)for(i=e,s=e+1,a=this._objects.length;s<a;++s){if(t.intersectsWithObject(this._objects[s])||t.isContainedWithinObject(this._objects[s])||this._objects[s].isContainedWithinObject(t)){i=s;break}}else i=e+1;return i},moveTo:function(t,e){return r(this._objects,t),this._objects.splice(e,0,t),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(S.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(t){t.dispose&&t.dispose()})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),this.lowerCanvasEl.style=this._originalCanvasStyle,delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),S.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(S.StaticCanvas.prototype,S.Observable),t(S.StaticCanvas.prototype,S.Collection),t(S.StaticCanvas.prototype,S.DataURLExporter),t(S.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(t){var e=o();if(!e||!e.getContext)return null;var r=e.getContext("2d");return r&&"setLineDash"===t?void 0!==r.setLineDash:null}}),S.StaticCanvas.prototype.toJSON=S.StaticCanvas.prototype.toObject,S.isLikelyNode&&(S.StaticCanvas.prototype.createPNGStream=function(){var t=n(this.lowerCanvasEl);return t&&t.createPNGStream()},S.StaticCanvas.prototype.createJPEGStream=function(t){var e=n(this.lowerCanvasEl);return e&&e.createJPEGStream(t)})}}(),S.BaseBrush=S.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(){var t=this.canvas.contextTop;t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas,e=this.shadow,r=t.contextTop,i=t.getZoom();t&&t._isRetinaScaling()&&(i*=S.devicePixelRatio),r.shadowColor=e.color,r.shadowBlur=e.blur*i,r.shadowOffsetX=e.offsetX*i,r.shadowOffsetY=e.offsetY*i}},needsFullRender:function(){return new S.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0},_isOutSideCanvas:function(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}}),S.PencilBrush=S.util.createClass(S.BaseBrush,{decimate:.4,initialize:function(t){this.canvas=t,this._points=[]},_drawSegment:function(t,e,r){var i=e.midPointFrom(r);return t.quadraticCurveTo(e.x,e.y,i.x,i.y),i},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){if(this.canvas._isMainEvent(e.e)&&(!0!==this.limitedToCanvasSize||!this._isOutSideCanvas(t))&&this._captureDrawingPath(t)&&this._points.length>1)if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var r=this._points,i=r.length,s=this.canvas.contextTop;this._saveAndTransform(s),this.oldEnd&&(s.beginPath(),s.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(s,r[i-2],r[i-1],!0),s.stroke(),s.restore()}},onMouseUp:function(t){return!this.canvas._isMainEvent(t.e)||(this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(t){var e=new S.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return!(this._points.length>1&&t.eq(this._points[this._points.length-1])||(this._points.push(t),0))},_reset:function(){this._points=[],this._setBrushStyles(),this._setShadow()},_captureDrawingPath:function(t){var e=new S.Point(t.x,t.y);return this._addPoint(e)},_render:function(){var t,e,r=this.canvas.contextTop,i=this._points[0],s=this._points[1];if(this._saveAndTransform(r),r.beginPath(),2===this._points.length&&i.x===s.x&&i.y===s.y){var a=this.width/1e3;i=new S.Point(i.x,i.y),s=new S.Point(s.x,s.y),i.x-=a,s.x+=a}for(r.moveTo(i.x,i.y),t=1,e=this._points.length;t<e;t++)this._drawSegment(r,i,s),i=this._points[t],s=this._points[t+1];r.lineTo(i.x,i.y),r.stroke(),r.restore()},convertPointsToSVGPath:function(t){var e=this.width/1e3;return S.util.getSmoothPathFromPoints(t,e)},_isEmptySVGPath:function(t){return"M 0 0 Q 0 0 0 0 L 0 0"===S.util.joinPath(t)},createPath:function(t){var e=new S.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new S.Shadow(this.shadow)),e},decimatePoints:function(t,e){if(t.length<=2)return t;var r,i=this.canvas.getZoom(),s=Math.pow(e/i,2),a=t.length-1,n=t[0],o=[n];for(r=1;r<a-1;r++)Math.pow(n.x-t[r].x,2)+Math.pow(n.y-t[r].y,2)>=s&&(n=t[r],o.push(n));return o.push(t[a]),o},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var t=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(t))this.canvas.requestRenderAll();else{var e=this.createPath(t);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:e}),this.canvas.add(e),this.canvas.requestRenderAll(),e.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:e})}}}),S.CircleBrush=S.util.createClass(S.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),r=this.canvas.contextTop;this._saveAndTransform(r),this.dot(r,e),r.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,2*Math.PI,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t,e,r=this.canvas.contextTop,i=this.points;for(this._saveAndTransform(r),t=0,e=i.length;t<e;t++)this.dot(r,i[t]);r.restore()},onMouseMove:function(t){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(t)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t))},onMouseUp:function(){var t,e,r=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var i=[];for(t=0,e=this.points.length;t<e;t++){var s=this.points[t],a=new S.Circle({radius:s.radius,left:s.x,top:s.y,originX:"center",originY:"center",fill:s.fill});this.shadow&&(a.shadow=new S.Shadow(this.shadow)),i.push(a)}var n=new S.Group(i);n.canvas=this.canvas,this.canvas.fire("before:path:created",{path:n}),this.canvas.add(n),this.canvas.fire("path:created",{path:n}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=r,this.canvas.requestRenderAll()},addPoint:function(t){var e=new S.Point(t.x,t.y),r=S.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,i=new S.Color(this.color).setAlpha(S.util.getRandomInt(0,100)/100).toRgba();return e.radius=r,e.fill=i,this.points.push(e),e}}),S.SprayBrush=S.util.createClass(S.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(t)||(this.addSprayChunk(t),this.render(this.sprayChunkPoints))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],r=0,i=this.sprayChunks.length;r<i;r++)for(var s=this.sprayChunks[r],a=0,n=s.length;a<n;a++){var o=new S.Rect({width:s[a].width,height:s[a].width,left:s[a].x+1,top:s[a].y+1,originX:"center",originY:"center",fill:this.color});e.push(o)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var l=new S.Group(e);this.shadow&&l.set("shadow",new S.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e,r,i,s={};for(r=0,i=t.length;r<i;r++)s[e=t[r].left+""+t[r].top]||(s[e]=t[r]);var a=[];for(e in s)a.push(s[e]);return a},render:function(t){var e,r,i=this.canvas.contextTop;for(i.fillStyle=this.color,this._saveAndTransform(i),e=0,r=t.length;e<r;e++){var s=t[e];void 0!==s.opacity&&(i.globalAlpha=s.opacity),i.fillRect(s.x,s.y,s.width,s.width)}i.restore()},_render:function(){var t,e,r=this.canvas.contextTop;for(r.fillStyle=this.color,this._saveAndTransform(r),t=0,e=this.sprayChunks.length;t<e;t++)this.render(this.sprayChunks[t]);r.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,r,i,s,a=this.width/2;for(s=0;s<this.density;s++){e=S.util.getRandomInt(t.x-a,t.x+a),r=S.util.getRandomInt(t.y-a,t.y+a),i=this.dotWidthVariance?S.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var n=new S.Point(e,r);n.width=i,this.randomOpacity&&(n.opacity=S.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(n)}this.sprayChunks.push(this.sprayChunkPoints)}}),S.PatternBrush=S.util.createClass(S.PencilBrush,{getPatternSrc:function(){var t=S.util.createCanvasElement(),e=t.getContext("2d");return t.width=t.height=25,e.fillStyle=this.color,e.beginPath(),e.arc(10,10,10,0,2*Math.PI,!1),e.closePath(),e.fill(),t},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles"),this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(t){var e=this.callSuper("createPath",t),r=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new S.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-r.x,offsetY:-r.y}),e}}),function(){var t=S.util.getPointer,e=S.util.degreesToRadians,r=S.util.isTouchEvent;for(var i in S.Canvas=S.util.createClass(S.StaticCanvas,{initialize:function(t,e){e||(e={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,e),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=S.PencilBrush&&new S.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,e,r,i=this.getActiveObjects();if(i.length>0&&!this.preserveObjectStacking){e=[],r=[];for(var s=0,a=this._objects.length;s<a;s++)t=this._objects[s],-1===i.indexOf(t)?e.push(t):r.push(t);i.length>1&&(this._activeObject._objects=r),e.push.apply(e,r)}else e=this._objects;return e},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&this.renderTopLayer(this.contextTop);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_normalizePointer:function(t,e){var r=t.calcTransformMatrix(),i=S.util.invertTransform(r),s=this.restorePointerVpt(e);return S.util.transformPoint(s,i)},isTargetTransparent:function(t,e,r){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var i=this._normalizePointer(t,{x:e,y:r}),s=Math.max(t.cacheTranslationX+i.x*t.zoomX,0),a=Math.max(t.cacheTranslationY+i.y*t.zoomY,0);return S.util.isTransparent(t._cacheContext,Math.round(s),Math.round(a),this.targetFindTolerance)}var n=this.contextCache,o=t.selectionBackgroundColor,l=this.viewportTransform;return t.selectionBackgroundColor="",this.clearContext(n),n.save(),n.transform(l[0],l[1],l[2],l[3],l[4],l[5]),t.render(n),n.restore(),t.selectionBackgroundColor=o,S.util.isTransparent(n,e,r,this.targetFindTolerance)},_isSelectionKeyPressed:function(t){return"[object Array]"===Object.prototype.toString.call(this.selectionKey)?!!this.selectionKey.find((function(e){return!0===t[e]})):t[this.selectionKey]},_shouldClearSelection:function(t,e){var r=this.getActiveObjects(),i=this._activeObject;return!e||e&&i&&r.length>1&&-1===r.indexOf(e)&&i!==e&&!this._isSelectionKeyPressed(t)||e&&!e.evented||e&&!e.selectable&&i&&i!==e},_shouldCenterTransform:function(t,e,r){var i;if(t)return"scale"===e||"scaleX"===e||"scaleY"===e||"resizing"===e?i=this.centeredScaling||t.centeredScaling:"rotate"===e&&(i=this.centeredRotation||t.centeredRotation),i?!r:r},_getOriginFromCorner:function(t,e){var r={x:t.originX,y:t.originY};return"ml"===e||"tl"===e||"bl"===e?r.x="right":"mr"!==e&&"tr"!==e&&"br"!==e||(r.x="left"),"tl"===e||"mt"===e||"tr"===e?r.y="bottom":"bl"!==e&&"mb"!==e&&"br"!==e||(r.y="top"),r},_getActionFromCorner:function(t,e,r,i){if(!e||!t)return"drag";var s=i.controls[e];return s.getActionName(r,s,i)},_setupCurrentTransform:function(t,r,i){if(r){var s=this.getPointer(t),a=r.__corner,n=r.controls[a],o=i&&a?n.getActionHandler(t,r,n):S.controlsUtils.dragHandler,l=this._getActionFromCorner(i,a,t,r),c=this._getOriginFromCorner(r,a),u=t[this.centeredKey],d={target:r,action:l,actionHandler:o,corner:a,scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,offsetX:s.x-r.left,offsetY:s.y-r.top,originX:c.x,originY:c.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:e(r.angle),width:r.width*r.scaleX,shiftKey:t.shiftKey,altKey:u,original:S.util.saveObjectTransform(r)};this._shouldCenterTransform(r,l,u)&&(d.originX="center",d.originY="center"),d.original.originX=c.x,d.original.originY=c.y,this._currentTransform=d,this._beforeTransform(t)}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var e=this._groupSelector,r=new S.Point(e.ex,e.ey),i=S.util.transformPoint(r,this.viewportTransform),s=new S.Point(e.ex+e.left,e.ey+e.top),a=S.util.transformPoint(s,this.viewportTransform),n=Math.min(i.x,a.x),o=Math.min(i.y,a.y),l=Math.max(i.x,a.x),c=Math.max(i.y,a.y),u=this.selectionLineWidth/2;this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(n,o,l-n,c-o)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,n+=u,o+=u,l-=u,c-=u,S.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(n,o,l-n,c-o))},findTarget:function(t,e){if(!this.skipTargetFind){var i,s,a=this.getPointer(t,!0),n=this._activeObject,o=this.getActiveObjects(),l=r(t),c=o.length>1&&!e||1===o.length;if(this.targets=[],c&&n._findTargetCorner(a,l))return n;if(o.length>1&&!e&&n===this._searchPossibleTargets([n],a))return n;if(1===o.length&&n===this._searchPossibleTargets([n],a)){if(!this.preserveObjectStacking)return n;i=n,s=this.targets,this.targets=[]}var u=this._searchPossibleTargets(this._objects,a);return t[this.altSelectionKey]&&u&&i&&u!==i&&(u=i,this.targets=s),u}},_checkTarget:function(t,e,r){if(e&&e.visible&&e.evented&&e.containsPoint(t)){if(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing)return!0;if(!this.isTargetTransparent(e,r.x,r.y))return!0}},_searchPossibleTargets:function(t,e){for(var r,i,s=t.length;s--;){var a=t[s],n=a.group?this._normalizePointer(a.group,e):e;if(this._checkTarget(n,a,e)){(r=t[s]).subTargetCheck&&r instanceof S.Group&&(i=this._searchPossibleTargets(r._objects,e))&&this.targets.push(i);break}}return r},restorePointerVpt:function(t){return S.util.transformPoint(t,S.util.invertTransform(this.viewportTransform))},getPointer:function(e,r){if(this._absolutePointer&&!r)return this._absolutePointer;if(this._pointer&&r)return this._pointer;var i,s=t(e),a=this.upperCanvasEl,n=a.getBoundingClientRect(),o=n.width||0,l=n.height||0;o&&l||("top"in n&&"bottom"in n&&(l=Math.abs(n.top-n.bottom)),"right"in n&&"left"in n&&(o=Math.abs(n.right-n.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,r||(s=this.restorePointerVpt(s));var c=this.getRetinaScaling();return 1!==c&&(s.x/=c,s.y/=c),i=0===o||0===l?{width:1,height:1}:{width:a.width/o,height:a.height/l},{x:s.x*i.width,y:s.y*i.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),e=this.lowerCanvasEl,r=this.upperCanvasEl;r?r.className="":(r=this._createCanvasElement(),this.upperCanvasEl=r),S.util.addClass(r,"upper-canvas "+t),this.wrapperEl.appendChild(r),this._copyCanvasStyle(e,r),this._applyCanvasStyle(r),this.contextTop=r.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=S.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),S.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),S.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var e=this.width||t.width,r=this.height||t.height;S.util.setStyle(t,{position:"absolute",width:e+"px",height:r+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=e,t.height=r,S.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,e){e.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?"activeSelection"===t.type&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),t===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,e){var r=!1,i=this.getActiveObjects(),s=[],a=[];t.forEach((function(t){-1===i.indexOf(t)&&(r=!0,t.fire("deselected",{e,target:t}),a.push(t))})),i.forEach((function(i){-1===t.indexOf(i)&&(r=!0,i.fire("selected",{e,target:i}),s.push(i))})),t.length>0&&i.length>0?r&&this.fire("selection:updated",{e,selected:s,deselected:a,updated:s[0]||a[0],target:this._activeObject}):i.length>0?this.fire("selection:created",{e,selected:s,target:this._activeObject}):t.length>0&&this.fire("selection:cleared",{e,deselected:a})},setActiveObject:function(t,e){var r=this.getActiveObjects();return this._setActiveObject(t,e),this._fireSelectionEvents(r,e),this},_setActiveObject:function(t,e){return this._activeObject!==t&&(!!this._discardActiveObject(e,t)&&(!t.onSelect({e})&&(this._activeObject=t,!0)))},_discardActiveObject:function(t,e){var r=this._activeObject;if(r){if(r.onDeselect({e:t,object:e}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var e=this.getActiveObjects(),r=this.getActiveObject();return e.length&&this.fire("before:selection:cleared",{target:r,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(e,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(t){S.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,S.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var e=this._activeObject;e&&e._renderControls(t)},_toObject:function(t,e,r){var i=this._realizeGroupTransformOnObject(t),s=this.callSuper("_toObject",t,e,r);return this._unwindGroupTransformOnObject(t,i),s},_realizeGroupTransformOnObject:function(t){if(t.group&&"activeSelection"===t.group.type&&this._activeObject===t.group){var e={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach((function(r){e[r]=t[r]})),S.util.addTransformToObject(t,this._activeObject.calcOwnMatrix()),e}return null},_unwindGroupTransformOnObject:function(t,e){e&&t.set(e)},_setSVGObject:function(t,e,r){var i=this._realizeGroupTransformOnObject(e);this.callSuper("_setSVGObject",t,e,r),this._unwindGroupTransformOnObject(e,i)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),S.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),S.StaticCanvas)"prototype"!==i&&(S.Canvas[i]=S.StaticCanvas[i])}(),function(){var t=S.util.addListener,e=S.util.removeListener,r={passive:!1};function i(t,e){return t.button&&t.button===e-1}S.util.object.extend(S.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(t,e){var i=this.upperCanvasEl,s=this._getEventPrefix();t(S.window,"resize",this._onResize),t(i,s+"down",this._onMouseDown),t(i,s+"move",this._onMouseMove,r),t(i,s+"out",this._onMouseOut),t(i,s+"enter",this._onMouseEnter),t(i,"wheel",this._onMouseWheel),t(i,"contextmenu",this._onContextMenu),t(i,"dblclick",this._onDoubleClick),t(i,"dragover",this._onDragOver),t(i,"dragenter",this._onDragEnter),t(i,"dragleave",this._onDragLeave),t(i,"drop",this._onDrop),this.enablePointerEvents||t(i,"touchstart",this._onTouchStart,r),"undefined"!=typeof eventjs&&e in eventjs&&(eventjs[e](i,"gesture",this._onGesture),eventjs[e](i,"drag",this._onDrag),eventjs[e](i,"orientation",this._onOrientationChange),eventjs[e](i,"shake",this._onShake),eventjs[e](i,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var t=this._getEventPrefix();e(S.document,t+"up",this._onMouseUp),e(S.document,"touchend",this._onTouchEnd,r),e(S.document,t+"move",this._onMouseMove,r),e(S.document,"touchmove",this._onMouseMove,r)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._simpleEventHandler.bind(this,"drop"),this.eventsBound=!0)},_onGesture:function(t,e){this.__onTransformGesture&&this.__onTransformGesture(t,e)},_onDrag:function(t,e){this.__onDrag&&this.__onDrag(t,e)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var e=this._hoveredTarget;this.fire("mouse:out",{target:e,e:t}),this._hoveredTarget=null,e&&e.fire("mouseout",{e:t});var r=this;this._hoveredTargets.forEach((function(i){r.fire("mouse:out",{target:e,e:t}),i&&e.fire("mouseout",{e:t})})),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach((function(t){t.isEditing&&t.hiddenTextarea.focus()}))},_onMouseEnter:function(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(t,e){this.__onOrientationChange&&this.__onOrientationChange(t,e)},_onShake:function(t,e){this.__onShake&&this.__onShake(t,e)},_onLongPress:function(t,e){this.__onLongPress&&this.__onLongPress(t,e)},_onDragOver:function(t){t.preventDefault();var e=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(e,t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},getPointerId:function(t){var e=t.changedTouches;return e?e[0]&&e[0].identifier:this.enablePointerEvents?t.pointerId:-1},_isMainEvent:function(t){return!0===t.isPrimary||!1!==t.isPrimary&&("touchend"===t.type&&0===t.touches.length||(!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId))},_onTouchStart:function(i){i.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(i)),this.__onMouseDown(i),this._resetTransformEventData();var s=this.upperCanvasEl,a=this._getEventPrefix();t(S.document,"touchend",this._onTouchEnd,r),t(S.document,"touchmove",this._onMouseMove,r),e(s,a+"down",this._onMouseDown)},_onMouseDown:function(i){this.__onMouseDown(i),this._resetTransformEventData();var s=this.upperCanvasEl,a=this._getEventPrefix();e(s,a+"move",this._onMouseMove,r),t(S.document,a+"up",this._onMouseUp),t(S.document,a+"move",this._onMouseMove,r)},_onTouchEnd:function(i){if(!(i.touches.length>0)){this.__onMouseUp(i),this._resetTransformEventData(),this.mainTouchId=null;var s=this._getEventPrefix();e(S.document,"touchend",this._onTouchEnd,r),e(S.document,"touchmove",this._onMouseMove,r);var a=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){t(a.upperCanvasEl,s+"down",a._onMouseDown),a._willAddMouseDown=0}),400)}},_onMouseUp:function(i){this.__onMouseUp(i),this._resetTransformEventData();var s=this.upperCanvasEl,a=this._getEventPrefix();this._isMainEvent(i)&&(e(S.document,a+"up",this._onMouseUp),e(S.document,a+"move",this._onMouseMove,r),t(s,a+"move",this._onMouseMove,r))},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t){var e=this._activeObject;return!!(!!e!=!!t||e&&t&&e!==t)||(e&&e.isEditing,!1)},__onMouseUp:function(t){var e,r=this._currentTransform,s=this._groupSelector,a=!1,n=!s||0===s.left&&0===s.top;if(this._cacheTransformEventData(t),e=this._target,this._handleEvent(t,"up:before"),i(t,3))this.fireRightClick&&this._handleEvent(t,"up",3,n);else{if(i(t,2))return this.fireMiddleClick&&this._handleEvent(t,"up",2,n),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(t);else if(this._isMainEvent(t)){if(r&&(this._finalizeCurrentTransform(t),a=r.actionPerformed),!n){var o=e===this._activeObject;this._maybeGroupObjects(t),a||(a=this._shouldRender(e)||!o&&e===this._activeObject)}if(e){if(e.selectable&&e!==this._activeObject&&"up"===e.activeOn)this.setActiveObject(e,t),a=!0;else{var l=e._findTargetCorner(this.getPointer(t,!0),S.util.isTouchEvent(t)),c=e.controls[l],u=c&&c.getMouseUpHandler(t,e,c);if(u){var d=this.getPointer(t);u(t,r,d.x,d.y)}}e.isMoving=!1}this._setCursorFromEvent(t,e),this._handleEvent(t,"up",1,n),this._groupSelector=null,this._currentTransform=null,e&&(e.__corner=0),a?this.requestRenderAll():n||this.renderTop()}}},_simpleEventHandler:function(t,e){var r=this.findTarget(e),i=this.targets,s={e,target:r,subTargets:i};if(this.fire(t,s),r&&r.fire(t,s),!i)return r;for(var a=0;a<i.length;a++)i[a].fire(t,s);return r},_handleEvent:function(t,e,r,i){var s=this._target,a=this.targets||[],n={e:t,target:s,subTargets:a,button:r||1,isClick:i||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===e&&(n.currentTarget=this.findTarget(t),n.currentSubTargets=this.targets),this.fire("mouse:"+e,n),s&&s.fire("mouse"+e,n);for(var o=0;o<a.length;o++)a[o].fire("mouse"+e,n)},_finalizeCurrentTransform:function(t){var e,r=this._currentTransform,i=r.target,s={e:t,target:i,transform:r,action:r.action};i._scaling&&(i._scaling=!1),i.setCoords(),(r.actionPerformed||this.stateful&&i.hasStateChanged())&&(r.actionPerformed&&(e=this._addEventOptions(s,r),this._fire(e,s)),this._fire("modified",s))},_addEventOptions:function(t,e){var r,i;switch(e.action){case"scaleX":r="scaled",i="x";break;case"scaleY":r="scaled",i="y";break;case"skewX":r="skewed",i="x";break;case"skewY":r="skewed",i="y";break;case"scale":r="scaled",i="equally";break;case"rotate":r="rotated";break;case"drag":r="moved"}return t.by=i,r},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll();var e=this.getPointer(t);this.freeDrawingBrush.onMouseDown(e,{e:t,pointer:e}),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var e=this.getPointer(t);this.freeDrawingBrush.onMouseMove(e,{e:t,pointer:e})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){var e=this.getPointer(t);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:t,pointer:e}),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var e=this._target;if(i(t,3))this.fireRightClick&&this._handleEvent(t,"down",3);else if(i(t,2))this.fireMiddleClick&&this._handleEvent(t,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(t);else if(this._isMainEvent(t)&&!this._currentTransform){var r=this._pointer;this._previousPointer=r;var s=this._shouldRender(e),a=this._shouldGroup(t,e);if(this._shouldClearSelection(t,e)?this.discardActiveObject(t):a&&(this._handleGrouping(t,e),e=this._activeObject),!this.selection||e&&(e.selectable||e.isEditing||e===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),e){var n=e===this._activeObject;e.selectable&&"down"===e.activeOn&&this.setActiveObject(e,t);var o=e._findTargetCorner(this.getPointer(t,!0),S.util.isTouchEvent(t));if(e.__corner=o,e===this._activeObject&&(o||!a)){this._setupCurrentTransform(t,e,n);var l=e.controls[o],c=(r=this.getPointer(t),l&&l.getMouseDownHandler(t,e,l));c&&c(t,this._currentTransform,r.x,r.y)}}this._handleEvent(t,"down"),(s||a)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var e=this._currentTransform;this.stateful&&e.target.saveState(),this.fire("before:transform",{e:t,transform:e})},__onMouseMove:function(t){var e,r;if(this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode)this._onMouseMoveInDrawingMode(t);else if(this._isMainEvent(t)){var i=this._groupSelector;i?(r=this._absolutePointer,i.left=r.x-i.ex,i.top=r.y-i.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(e=this.findTarget(t)||null,this._setCursorFromEvent(t,e),this._fireOverOutEvents(e,t)),this._handleEvent(t,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(t,e){var r=this._hoveredTarget,i=this._hoveredTargets,s=this.targets,a=Math.max(i.length,s.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:r,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var n=0;n<a;n++)this.fireSyntheticInOutEvents(s[n],e,{oldTarget:i[n],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(t,e){var r=this._draggedoverTarget,i=this._hoveredTargets,s=this.targets,a=Math.max(i.length,s.length);this.fireSyntheticInOutEvents(t,e,{oldTarget:r,evtOut:"dragleave",evtIn:"dragenter"});for(var n=0;n<a;n++)this.fireSyntheticInOutEvents(s[n],e,{oldTarget:i[n],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=t},fireSyntheticInOutEvents:function(t,e,r){var i,s,a,n=r.oldTarget,o=n!==t,l=r.canvasEvtIn,c=r.canvasEvtOut;o&&(i={e,target:t,previousTarget:n},s={e,target:n,nextTarget:t}),a=t&&o,n&&o&&(c&&this.fire(c,s),n.fire(r.evtOut,s)),a&&(l&&this.fire(l,i),t.fire(r.evtIn,i))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var e=this.getPointer(t),r=this._currentTransform;r.reset=!1,r.shiftKey=t.shiftKey,r.altKey=t[this.centeredKey],this._performTransformAction(t,r,e),r.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,e,r){var i=r.x,s=r.y,a=e.action,n=!1,o=e.actionHandler;o&&(n=o(t,e,i,s)),"drag"===a&&n&&(e.target.isMoving=!0,this.setCursor(e.target.moveCursor||this.moveCursor)),e.actionPerformed=e.actionPerformed||n},_fire:S.controlsUtils.fireEvent,_setCursorFromEvent:function(t,e){if(!e)return this.setCursor(this.defaultCursor),!1;var r=e.hoverCursor||this.hoverCursor,i=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,s=(!i||!i.contains(e))&&e._findTargetCorner(this.getPointer(t,!0));s?this.setCursor(this.getCornerCursor(s,e,t)):(e.subTargetCheck&&this.targets.concat().reverse().map((function(t){r=t.hoverCursor||r})),this.setCursor(r))},getCornerCursor:function(t,e,r){var i=e.controls[t];return i.cursorStyleHandler(r,i,e)}})}(),v=Math.min,g=Math.max,S.util.object.extend(S.Canvas.prototype,{_shouldGroup:function(t,e){var r=this._activeObject;return r&&this._isSelectionKeyPressed(t)&&e&&e.selectable&&this.selection&&(r!==e||"activeSelection"===r.type)&&!e.onSelect({e:t})},_handleGrouping:function(t,e){var r=this._activeObject;r.__corner||(e!==r||(e=this.findTarget(t,!0))&&e.selectable)&&(r&&"activeSelection"===r.type?this._updateActiveSelection(e,t):this._createActiveSelection(e,t))},_updateActiveSelection:function(t,e){var r=this._activeObject,i=r._objects.slice(0);r.contains(t)?(r.removeWithUpdate(t),this._hoveredTarget=t,this._hoveredTargets=this.targets.concat(),1===r.size()&&this._setActiveObject(r.item(0),e)):(r.addWithUpdate(t),this._hoveredTarget=r,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(i,e)},_createActiveSelection:function(t,e){var r=this.getActiveObjects(),i=this._createGroup(t);this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents(r,e)},_createGroup:function(t){var e=this._objects,r=e.indexOf(this._activeObject)<e.indexOf(t)?[this._activeObject,t]:[t,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new S.ActiveSelection(r,{canvas:this})},_groupSelectedObjects:function(t){var e,r=this._collectObjects(t);1===r.length?this.setActiveObject(r[0],t):r.length>1&&(e=new S.ActiveSelection(r.reverse(),{canvas:this}),this.setActiveObject(e,t))},_collectObjects:function(t){for(var e,r=[],i=this._groupSelector.ex,s=this._groupSelector.ey,a=i+this._groupSelector.left,n=s+this._groupSelector.top,o=new S.Point(v(i,a),v(s,n)),l=new S.Point(g(i,a),g(s,n)),c=!this.selectionFullyContained,u=i===a&&s===n,d=this._objects.length;d--&&!((e=this._objects[d])&&e.selectable&&e.visible&&(c&&e.intersectsWithRect(o,l,!0)||e.isContainedWithinRect(o,l,!0)||c&&e.containsPoint(o,null,!0)||c&&e.containsPoint(l,null,!0))&&(r.push(e),u)););return r.length>1&&(r=r.filter((function(e){return!e.onSelect({e:t})}))),r},_maybeGroupObjects:function(t){this.selection&&this._groupSelector&&this._groupSelectedObjects(t),this.setCursor(this.defaultCursor),this._groupSelector=null}}),S.util.object.extend(S.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",r=t.quality||1,i=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),s=this.toCanvasElement(i,t);return S.util.toDataURL(s,e,r)},toCanvasElement:function(t,e){t=t||1;var r=((e=e||{}).width||this.width)*t,i=(e.height||this.height)*t,s=this.getZoom(),a=this.width,n=this.height,o=s*t,l=this.viewportTransform,c=(l[4]-(e.left||0))*t,u=(l[5]-(e.top||0))*t,d=this.interactive,m=[o,0,0,o,c,u],h=this.enableRetinaScaling,p=S.util.createCanvasElement(),f=this.contextTop;return p.width=r,p.height=i,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=m,this.width=r,this.height=i,this.calcViewportBoundaries(),this.renderCanvas(p.getContext("2d"),this._objects),this.viewportTransform=l,this.width=a,this.height=n,this.calcViewportBoundaries(),this.interactive=d,this.enableRetinaScaling=h,this.contextTop=f,p}}),S.util.object.extend(S.StaticCanvas.prototype,{loadFromJSON:function(t,e,r){if(t){var i="string"==typeof t?JSON.parse(t):S.util.object.clone(t),s=this,a=i.clipPath,n=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete i.clipPath,this._enlivenObjects(i.objects,(function(t){s.clear(),s._setBgOverlay(i,(function(){a?s._enlivenObjects([a],(function(r){s.clipPath=r[0],s.__setupCanvas.call(s,i,t,n,e)})):s.__setupCanvas.call(s,i,t,n,e)}))}),r),this}},__setupCanvas:function(t,e,r,i){var s=this;e.forEach((function(t,e){s.insertAt(t,e)})),this.renderOnAddRemove=r,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),i&&i()},_setBgOverlay:function(t,e){var r={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(t.backgroundImage||t.overlayImage||t.background||t.overlay){var i=function(){r.backgroundImage&&r.overlayImage&&r.backgroundColor&&r.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,r,i),this.__setBgOverlay("overlayImage",t.overlayImage,r,i),this.__setBgOverlay("backgroundColor",t.background,r,i),this.__setBgOverlay("overlayColor",t.overlay,r,i)}else e&&e()},__setBgOverlay:function(t,e,r,i){var s=this;if(!e)return r[t]=!0,void(i&&i());"backgroundImage"===t||"overlayImage"===t?S.util.enlivenObjects([e],(function(e){s[t]=e[0],r[t]=!0,i&&i()})):this["set"+S.util.string.capitalize(t,!0)](e,(function(){r[t]=!0,i&&i()}))},_enlivenObjects:function(t,e,r){t&&0!==t.length?S.util.enlivenObjects(t,(function(t){e&&e(t)}),null,r):e&&e([])},_toDataURL:function(t,e){this.clone((function(r){e(r.toDataURL(t))}))},_toDataURLWithMultiplier:function(t,e,r){this.clone((function(i){r(i.toDataURLWithMultiplier(t,e))}))},clone:function(t,e){var r=JSON.stringify(this.toJSON(e));this.cloneWithoutData((function(e){e.loadFromJSON(r,(function(){t&&t(e)}))}))},cloneWithoutData:function(t){var e=S.util.createCanvasElement();e.width=this.width,e.height=this.height;var r=new S.Canvas(e);this.backgroundImage?(r.setBackgroundImage(this.backgroundImage.src,(function(){r.renderAll(),t&&t(r)})),r.backgroundImageOpacity=this.backgroundImageOpacity,r.backgroundImageStretch=this.backgroundImageStretch):t&&t(r)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,i=e.util.object.clone,s=e.util.toFixed,a=e.util.string.capitalize,n=e.util.degreesToRadians,o=!e.isLikelyNode;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:o,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(t){t&&this.setOptions(t)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(t){var r=e.perfLimitSizeTotal,i=t.width,s=t.height,a=e.maxCacheSideLimit,n=e.minCacheSideLimit;if(i<=a&&s<=a&&i*s<=r)return i<n&&(t.width=n),s<n&&(t.height=n),t;var o=i/s,l=e.util.limitDimsByArea(o,r),c=e.util.capValue,u=c(n,l.x,a),d=c(n,l.y,a);return i>u&&(t.zoomX/=i/u,t.width=u,t.capped=!0),s>d&&(t.zoomY/=s/d,t.height=d,t.capped=!0),t},_getCacheCanvasDimensions:function(){var t=this.getTotalObjectScaling(),e=this._getTransformedDimensions(0,0),r=e.x*t.scaleX/this.scaleX,i=e.y*t.scaleY/this.scaleY;return{width:r+2,height:i+2,zoomX:t.scaleX,zoomY:t.scaleY,x:r,y:i}},_updateCacheCanvas:function(){var t=this.canvas;if(this.noScaleCache&&t&&t._currentTransform){var r=t._currentTransform.target,i=t._currentTransform.action;if(this===r&&i.slice&&"scale"===i.slice(0,5))return!1}var s,a,n=this._cacheCanvas,o=this._limitCacheSize(this._getCacheCanvasDimensions()),l=e.minCacheSideLimit,c=o.width,u=o.height,d=o.zoomX,m=o.zoomY,h=c!==this.cacheWidth||u!==this.cacheHeight,p=this.zoomX!==d||this.zoomY!==m,f=h||p,_=0,v=0,g=!1;if(h){var b=this._cacheCanvas.width,y=this._cacheCanvas.height,x=c>b||u>y;g=x||(c<.9*b||u<.9*y)&&b>l&&y>l,x&&!o.capped&&(c>l||u>l)&&(_=.1*c,v=.1*u)}return this instanceof e.Text&&this.path&&(f=!0,g=!0,_+=this.getHeightOfLine(0)*this.zoomX,v+=this.getHeightOfLine(0)*this.zoomY),!!f&&(g?(n.width=Math.ceil(c+_),n.height=Math.ceil(u+v)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,n.width,n.height)),s=o.x/2,a=o.y/2,this.cacheTranslationX=Math.round(n.width/2-s)+s,this.cacheTranslationY=Math.round(n.height/2-a)+a,this.cacheWidth=c,this.cacheHeight=u,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(d,m),this.zoomX=d,this.zoomY=m,!0)},setOptions:function(t){this._setOptions(t),this._initGradient(t.fill,"fill"),this._initGradient(t.stroke,"stroke"),this._initPattern(t.fill,"fill"),this._initPattern(t.stroke,"stroke")},transform:function(t){var e=this.group&&!this.group._transformDone||this.group&&this.canvas&&t===this.canvas.contextTop,r=this.calcTransformMatrix(!e);t.transform(r[0],r[1],r[2],r[3],r[4],r[5])},toObject:function(t){var r=e.Object.NUM_FRACTION_DIGITS,i={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:s(this.left,r),top:s(this.top,r),width:s(this.width,r),height:s(this.height,r),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:s(this.strokeWidth,r),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:s(this.strokeMiterLimit,r),scaleX:s(this.scaleX,r),scaleY:s(this.scaleY,r),angle:s(this.angle,r),flipX:this.flipX,flipY:this.flipY,opacity:s(this.opacity,r),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:s(this.skewX,r),skewY:s(this.skewY,r)};return this.clipPath&&!this.clipPath.excludeFromExport&&(i.clipPath=this.clipPath.toObject(t),i.clipPath.inverted=this.clipPath.inverted,i.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,i,t),this.includeDefaultValues||(i=this._removeDefaultValues(i)),i},toDatalessObject:function(t){return this.toObject(t)},_removeDefaultValues:function(t){var r=e.util.getKlass(t.type).prototype;return r.stateProperties.forEach((function(e){"left"!==e&&"top"!==e&&(t[e]===r[e]&&delete t[e],"[object Array]"===Object.prototype.toString.call(t[e])&&"[object Array]"===Object.prototype.toString.call(r[e])&&0===t[e].length&&0===r[e].length&&delete t[e])})),t},toString:function(){return"#<fabric."+a(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var t=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(t.scaleX),scaleY:Math.abs(t.scaleY)}},getTotalObjectScaling:function(){var t=this.getObjectScaling(),e=t.scaleX,r=t.scaleY;if(this.canvas){var i=this.canvas.getZoom(),s=this.canvas.getRetinaScaling();e*=i*s,r*=i*s}return{scaleX:e,scaleY:r}},getObjectOpacity:function(){var t=this.opacity;return this.group&&(t*=this.group.getObjectOpacity()),t},_set:function(t,r){var i="scaleX"===t||"scaleY"===t,s=this[t]!==r,a=!1;return i&&(r=this._constrainScale(r)),"scaleX"===t&&r<0?(this.flipX=!this.flipX,r*=-1):"scaleY"===t&&r<0?(this.flipY=!this.flipY,r*=-1):"shadow"!==t||!r||r instanceof e.Shadow?"dirty"===t&&this.group&&this.group.set("dirty",r):r=new e.Shadow(r),this[t]=r,s&&(a=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(t)>-1?(this.dirty=!0,a&&this.group.set("dirty",!0)):a&&this.stateProperties.indexOf(t)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(t){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(t.save(),this._setupCompositeOperation(t),this.drawSelectionBackground(t),this.transform(t),this._setOpacity(t),this._setShadow(t,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(t)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(t),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),t.restore())},renderCache:function(t){t=t||{},this._cacheCanvas||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,t.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!=typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(t){var r=this.clipPath;if(t.save(),r.inverted?t.globalCompositeOperation="destination-out":t.globalCompositeOperation="destination-in",r.absolutePositioned){var i=e.util.invertTransform(this.calcTransformMatrix());t.transform(i[0],i[1],i[2],i[3],i[4],i[5])}r.transform(t),t.scale(1/r.zoomX,1/r.zoomY),t.drawImage(r._cacheCanvas,-r.cacheTranslationX,-r.cacheTranslationY),t.restore()},drawObject:function(t,e){var r=this.fill,i=this.stroke;e?(this.fill="black",this.stroke="",this._setClippingProperties(t)):this._renderBackground(t),this._render(t),this._drawClipPath(t),this.fill=r,this.stroke=i},_drawClipPath:function(t){var e=this.clipPath;e&&(e.canvas=this.canvas,e.shouldCache(),e._transformDone=!0,e.renderCache({forClipping:!0}),this.drawClipPathOnCache(t))},drawCacheOnCanvas:function(t){t.scale(1/this.zoomX,1/this.zoomY),t.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(t){if(this.isNotVisible())return!1;if(this._cacheCanvas&&!t&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&!t){var e=this.cacheWidth/this.zoomX,r=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-e/2,-r/2,e,r)}return!0}return!1},_renderBackground:function(t){if(this.backgroundColor){var e=this._getNonTransformedDimensions();t.fillStyle=this.backgroundColor,t.fillRect(-e.x/2,-e.y/2,e.x,e.y),this._removeShadow(t)}},_setOpacity:function(t){this.group&&!this.group._transformDone?t.globalAlpha=this.getObjectOpacity():t.globalAlpha*=this.opacity},_setStrokeStyles:function(t,e){var r=e.stroke;r&&(t.lineWidth=e.strokeWidth,t.lineCap=e.strokeLineCap,t.lineDashOffset=e.strokeDashOffset,t.lineJoin=e.strokeLineJoin,t.miterLimit=e.strokeMiterLimit,r.toLive?"percentage"===r.gradientUnits||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(t,r):(t.strokeStyle=r.toLive(t,this),this._applyPatternGradientTransform(t,r)):t.strokeStyle=e.stroke)},_setFillStyles:function(t,e){var r=e.fill;r&&(r.toLive?(t.fillStyle=r.toLive(t,this),this._applyPatternGradientTransform(t,e.fill)):t.fillStyle=r)},_setClippingProperties:function(t){t.globalAlpha=1,t.strokeStyle="transparent",t.fillStyle="#000000"},_setLineDash:function(t,e){e&&0!==e.length&&(1&e.length&&e.push.apply(e,e),t.setLineDash(e))},_renderControls:function(t,r){var i,s,a,o=this.getViewportTransform(),l=this.calcTransformMatrix();s=void 0!==(r=r||{}).hasBorders?r.hasBorders:this.hasBorders,a=void 0!==r.hasControls?r.hasControls:this.hasControls,l=e.util.multiplyTransformMatrices(o,l),i=e.util.qrDecompose(l),t.save(),t.translate(i.translateX,i.translateY),t.lineWidth=1*this.borderScaleFactor,this.group||(t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),t.rotate(n(i.angle)),r.forActiveSelection||this.group?s&&this.drawBordersInGroup(t,i,r):s&&this.drawBorders(t,r),a&&this.drawControls(t,r),t.restore()},_setShadow:function(t){if(this.shadow){var r,i=this.shadow,s=this.canvas,a=s&&s.viewportTransform[0]||1,n=s&&s.viewportTransform[3]||1;r=i.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),s&&s._isRetinaScaling()&&(a*=e.devicePixelRatio,n*=e.devicePixelRatio),t.shadowColor=i.color,t.shadowBlur=i.blur*e.browserShadowBlurConstant*(a+n)*(r.scaleX+r.scaleY)/4,t.shadowOffsetX=i.offsetX*a*r.scaleX,t.shadowOffsetY=i.offsetY*n*r.scaleY}},_removeShadow:function(t){this.shadow&&(t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0)},_applyPatternGradientTransform:function(t,e){if(!e||!e.toLive)return{offsetX:0,offsetY:0};var r=e.gradientTransform||e.patternTransform,i=-this.width/2+e.offsetX||0,s=-this.height/2+e.offsetY||0;return"percentage"===e.gradientUnits?t.transform(this.width,0,0,this.height,i,s):t.transform(1,0,0,1,i,s),r&&t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:i,offsetY:s}},_renderPaintInOrder:function(t){"stroke"===this.paintFirst?(this._renderStroke(t),this._renderFill(t)):(this._renderFill(t),this._renderStroke(t))},_render:function(){},_renderFill:function(t){this.fill&&(t.save(),this._setFillStyles(t,this),"evenodd"===this.fillRule?t.fill("evenodd"):t.fill(),t.restore())},_renderStroke:function(t){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this.strokeUniform&&this.group){var e=this.getObjectScaling();t.scale(1/e.scaleX,1/e.scaleY)}else this.strokeUniform&&t.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(t,this.strokeDashArray),this._setStrokeStyles(t,this),t.stroke(),t.restore()}},_applyPatternForTransformedGradient:function(t,r){var i,s=this._limitCacheSize(this._getCacheCanvasDimensions()),a=e.util.createCanvasElement(),n=this.canvas.getRetinaScaling(),o=s.x/this.scaleX/n,l=s.y/this.scaleY/n;a.width=o,a.height=l,(i=a.getContext("2d")).beginPath(),i.moveTo(0,0),i.lineTo(o,0),i.lineTo(o,l),i.lineTo(0,l),i.closePath(),i.translate(o/2,l/2),i.scale(s.zoomX/this.scaleX/n,s.zoomY/this.scaleY/n),this._applyPatternGradientTransform(i,r),i.fillStyle=r.toLive(t),i.fill(),t.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),t.scale(n*this.scaleX/s.zoomX,n*this.scaleY/s.zoomY),t.strokeStyle=i.createPattern(a,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var t=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",t.scaleX),this.set("scaleY",t.scaleY),this.angle=t.angle,this.skewX=t.skewX,this.skewY=0}},_removeTransformMatrix:function(t){var r=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),r=e.util.transformPoint(r,this.transformMatrix)),this.transformMatrix=null,t&&(this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this.cropX=t.cropX,this.cropY=t.cropY,r.x+=t.offsetLeft,r.y+=t.offsetTop,this.width=t.width,this.height=t.height),this.setPositionByOrigin(r,"center","center")},clone:function(t,r){var i=this.toObject(r);this.constructor.fromObject?this.constructor.fromObject(i,t):e.Object._fromObject("Object",i,t)},cloneAsImage:function(t,r){var i=this.toCanvasElement(r);return t&&t(new e.Image(i)),this},toCanvasElement:function(t){t||(t={});var r=e.util,i=r.saveObjectTransform(this),s=this.group,a=this.shadow,n=Math.abs,o=(t.multiplier||1)*(t.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,t.withoutTransform&&r.resetObjectTransform(this),t.withoutShadow&&(this.shadow=null);var l,c,u,d,m=e.util.createCanvasElement(),h=this.getBoundingRect(!0,!0),p=this.shadow,f={x:0,y:0};p&&(c=p.blur,l=p.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),f.x=2*Math.round(n(p.offsetX)+c)*n(l.scaleX),f.y=2*Math.round(n(p.offsetY)+c)*n(l.scaleY)),u=h.width+f.x,d=h.height+f.y,m.width=Math.ceil(u),m.height=Math.ceil(d);var _=new e.StaticCanvas(m,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===t.format&&(_.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(_.width/2,_.height/2),"center","center");var v=this.canvas;_.add(this);var g=_.toCanvasElement(o||1,t);return this.shadow=a,this.set("canvas",v),s&&(this.group=s),this.set(i).setCoords(),_._objects=[],_.dispose(),_=null,g},toDataURL:function(t){return t||(t={}),e.util.toDataURL(this.toCanvasElement(t),t.format||"png",t.quality||1)},isType:function(t){return this.type===t},complexity:function(){return 1},toJSON:function(t){return this.toObject(t)},rotate:function(t){var e=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return e&&this._setOriginToCenter(),this.set("angle",t),e&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(t,r){r=r||this.canvas.getPointer(t);var i=new e.Point(r.x,r.y),s=this._getLeftTopCoords();return this.angle&&(i=e.util.rotatePoint(i,s,n(-this.angle))),{x:i.x-s.x,y:i.y-s.y}},_setupCompositeOperation:function(t){this.globalCompositeOperation&&(t.globalCompositeOperation=this.globalCompositeOperation)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),r(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object._fromObject=function(t,r,s,a){var n=e[t];r=i(r,!0),e.util.enlivenPatterns([r.fill,r.stroke],(function(t){void 0!==t[0]&&(r.fill=t[0]),void 0!==t[1]&&(r.stroke=t[1]),e.util.enlivenObjects([r.clipPath],(function(t){r.clipPath=t[0];var e=a?new n(r[a],r):new n(r);s&&s(e)}))}))},e.Object.__uid=0)}(e),b=S.util.degreesToRadians,y={left:-.5,center:0,right:.5},x={top:-.5,center:0,bottom:.5},S.util.object.extend(S.Object.prototype,{translateToGivenOrigin:function(t,e,r,i,s){var a,n,o,l=t.x,c=t.y;return"string"==typeof e?e=y[e]:e-=.5,"string"==typeof i?i=y[i]:i-=.5,"string"==typeof r?r=x[r]:r-=.5,"string"==typeof s?s=x[s]:s-=.5,n=s-r,((a=i-e)||n)&&(o=this._getTransformedDimensions(),l=t.x+a*o.x,c=t.y+n*o.y),new S.Point(l,c)},translateToCenterPoint:function(t,e,r){var i=this.translateToGivenOrigin(t,e,r,"center","center");return this.angle?S.util.rotatePoint(i,t,b(this.angle)):i},translateToOriginPoint:function(t,e,r){var i=this.translateToGivenOrigin(t,"center","center",e,r);return this.angle?S.util.rotatePoint(i,t,b(this.angle)):i},getCenterPoint:function(){var t=new S.Point(this.left,this.top);return this.translateToCenterPoint(t,this.originX,this.originY)},getPointByOrigin:function(t,e){var r=this.getCenterPoint();return this.translateToOriginPoint(r,t,e)},toLocalPoint:function(t,e,r){var i,s,a=this.getCenterPoint();return i=void 0!==e&&void 0!==r?this.translateToGivenOrigin(a,"center","center",e,r):new S.Point(this.left,this.top),s=new S.Point(t.x,t.y),this.angle&&(s=S.util.rotatePoint(s,a,-b(this.angle))),s.subtractEquals(i)},setPositionByOrigin:function(t,e,r){var i=this.translateToCenterPoint(t,e,r),s=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",s.x),this.set("top",s.y)},adjustPosition:function(t){var e,r,i=b(this.angle),s=this.getScaledWidth(),a=S.util.cos(i)*s,n=S.util.sin(i)*s;e="string"==typeof this.originX?y[this.originX]:this.originX-.5,r="string"==typeof t?y[t]:t-.5,this.left+=a*(r-e),this.top+=n*(r-e),this.setCoords(),this.originX=t},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var t=this.getCenterPoint();this.originX="center",this.originY="center",this.left=t.x,this.top=t.y},_resetOrigin:function(){var t=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=t.x,this.top=t.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var t=S.util,e=t.degreesToRadians,r=t.multiplyTransformMatrices,i=t.transformPoint;t.object.extend(S.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(t,e){return e?t?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),t?this.aCoords:this.lineCoords)},getCoords:function(t,e){return r=this._getCoords(t,e),[new S.Point(r.tl.x,r.tl.y),new S.Point(r.tr.x,r.tr.y),new S.Point(r.br.x,r.br.y),new S.Point(r.bl.x,r.bl.y)];var r},intersectsWithRect:function(t,e,r,i){var s=this.getCoords(r,i);return"Intersection"===S.Intersection.intersectPolygonRectangle(s,t,e).status},intersectsWithObject:function(t,e,r){return"Intersection"===S.Intersection.intersectPolygonPolygon(this.getCoords(e,r),t.getCoords(e,r)).status||t.isContainedWithinObject(this,e,r)||this.isContainedWithinObject(t,e,r)},isContainedWithinObject:function(t,e,r){for(var i=this.getCoords(e,r),s=e?t.aCoords:t.lineCoords,a=0,n=t._getImageLines(s);a<4;a++)if(!t.containsPoint(i[a],n))return!1;return!0},isContainedWithinRect:function(t,e,r,i){var s=this.getBoundingRect(r,i);return s.left>=t.x&&s.left+s.width<=e.x&&s.top>=t.y&&s.top+s.height<=e.y},containsPoint:function(t,e,r,i){var s=this._getCoords(r,i),a=(e=e||this._getImageLines(s),this._findCrossPoints(t,e));return 0!==a&&a%2==1},isOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,r=this.canvas.vptCoords.br;return!!this.getCoords(!0,t).some((function(t){return t.x<=r.x&&t.x>=e.x&&t.y<=r.y&&t.y>=e.y}))||(!!this.intersectsWithRect(e,r,!0,t)||this._containsCenterOfCanvas(e,r,t))},_containsCenterOfCanvas:function(t,e,r){var i={x:(t.x+e.x)/2,y:(t.y+e.y)/2};return!!this.containsPoint(i,null,!0,r)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var e=this.canvas.vptCoords.tl,r=this.canvas.vptCoords.br;return!!this.intersectsWithRect(e,r,!0,t)||this.getCoords(!0,t).every((function(t){return(t.x>=r.x||t.x<=e.x)&&(t.y>=r.y||t.y<=e.y)}))&&this._containsCenterOfCanvas(e,r,t)},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,e){var r,i,s,a=0;for(var n in e)if(!((s=e[n]).o.y<t.y&&s.d.y<t.y||s.o.y>=t.y&&s.d.y>=t.y||(s.o.x===s.d.x&&s.o.x>=t.x?i=s.o.x:(0,r=(s.d.y-s.o.y)/(s.d.x-s.o.x),i=-(t.y-0*t.x-(s.o.y-r*s.o.x))/(0-r)),i>=t.x&&(a+=1),2!==a)))break;return a},getBoundingRect:function(e,r){var i=this.getCoords(e,r);return t.makeBoundingBoxFromPoints(i)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:0===t?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,e){var r=this.getBoundingRect(e).width/this.getScaledWidth();return this.scale(t/this.width/r)},scaleToHeight:function(t,e){var r=this.getBoundingRect(e).height/this.getScaledHeight();return this.scale(t/this.height/r)},calcCoords:function(t){return t?this.calcACoords():this.calcOCoords()},calcLineCoords:function(){var r=this.getViewportTransform(),s=this.padding,a=e(this.angle),n=t.cos(a)*s,o=t.sin(a)*s,l=n+o,c=n-o,u=this.calcACoords(),d={tl:i(u.tl,r),tr:i(u.tr,r),bl:i(u.bl,r),br:i(u.br,r)};return s&&(d.tl.x-=c,d.tl.y-=l,d.tr.x+=l,d.tr.y-=c,d.bl.x-=l,d.bl.y+=c,d.br.x+=c,d.br.y+=l),d},calcOCoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),i=this.getViewportTransform(),s=r(i,e),a=r(s,t),n=(a=r(a,[1/i[0],0,0,1/i[3],0,0]),this._calculateCurrentDimensions()),o={};return this.forEachControl((function(t,e,r){o[e]=t.positionHandler(n,a,r)})),o},calcACoords:function(){var t=this._calcRotateMatrix(),e=this._calcTranslateMatrix(),s=r(e,t),a=this._getTransformedDimensions(),n=a.x/2,o=a.y/2;return{tl:i({x:-n,y:-o},s),tr:i({x:n,y:-o},s),bl:i({x:-n,y:o},s),br:i({x:n,y:o},s)}},setCoords:function(t){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),t||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return t.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var e="_",r="";return!t&&this.group&&(r=this.group.transformMatrixKey(t)+e),r+this.top+e+this.left+e+this.scaleX+e+this.scaleY+e+this.skewX+e+this.skewY+e+this.angle+e+this.originX+e+this.originY+e+this.width+e+this.height+e+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){var e=this.calcOwnMatrix();if(t||!this.group)return e;var i=this.transformMatrixKey(t),s=this.matrixCache||(this.matrixCache={});return s.key===i?s.value:(this.group&&(e=r(this.group.calcTransformMatrix(!1),e)),s.key=i,s.value=e,e)},calcOwnMatrix:function(){var e=this.transformMatrixKey(!0),r=this.ownMatrixCache||(this.ownMatrixCache={});if(r.key===e)return r.value;var i=this._calcTranslateMatrix(),s={angle:this.angle,translateX:i[4],translateY:i[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return r.key=e,r.value=t.composeMatrix(s),r.value},_calcDimensionsTransformMatrix:function(e,r,i){return t.calcDimensionsMatrix({skewX:e,skewY:r,scaleX:this.scaleX*(i&&this.flipX?-1:1),scaleY:this.scaleY*(i&&this.flipY?-1:1)})},_getNonTransformedDimensions:function(){var t=this.strokeWidth;return{x:this.width+t,y:this.height+t}},_getTransformedDimensions:function(e,r){void 0===e&&(e=this.skewX),void 0===r&&(r=this.skewY);var i,s,a,n=0===e&&0===r;if(this.strokeUniform?(s=this.width,a=this.height):(s=(i=this._getNonTransformedDimensions()).x,a=i.y),n)return this._finalizeDimensions(s*this.scaleX,a*this.scaleY);var o=t.sizeAfterTransform(s,a,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:e,skewY:r});return this._finalizeDimensions(o.x,o.y)},_finalizeDimensions:function(t,e){return this.strokeUniform?{x:t+this.strokeWidth,y:e+this.strokeWidth}:{x:t,y:e}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),e=this._getTransformedDimensions();return i(e,t,!0).scalarAdd(2*this.padding)}})}(),S.util.object.extend(S.Object.prototype,{sendToBack:function(){return this.group?S.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?S.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?S.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?S.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&"activeSelection"!==this.group.type?S.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}}),function(){function t(t,e){if(e){if(e.toLive)return t+": url(#SVGID_"+e.id+"); ";var r=new S.Color(e),i=t+": "+r.toRgb()+"; ",s=r.getAlpha();return 1!==s&&(i+=t+"-opacity: "+s.toString()+"; "),i}return t+": none; "}var e=S.util.toFixed;S.util.object.extend(S.Object.prototype,{getSvgStyles:function(e){var r=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",a=this.strokeDashOffset?this.strokeDashOffset:"0",n=this.strokeLineCap?this.strokeLineCap:"butt",o=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=void 0!==this.opacity?this.opacity:"1",u=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),m=t("fill",this.fill);return[t("stroke",this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",n,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",o,"; ","stroke-miterlimit: ",l,"; ",m,"fill-rule: ",r,"; ","opacity: ",c,";",d,u].join("")},getSvgSpanStyles:function(e,r){var i="; ",s=e.fontFamily?"font-family: "+(-1===e.fontFamily.indexOf("'")&&-1===e.fontFamily.indexOf('"')?"'"+e.fontFamily+"'":e.fontFamily)+i:"",a=e.strokeWidth?"stroke-width: "+e.strokeWidth+i:"",n=(s=s,e.fontSize?"font-size: "+e.fontSize+"px"+i:""),o=e.fontStyle?"font-style: "+e.fontStyle+i:"",l=e.fontWeight?"font-weight: "+e.fontWeight+i:"",c=e.fill?t("fill",e.fill):"",u=e.stroke?t("stroke",e.stroke):"",d=this.getSvgTextDecoration(e);return d&&(d="text-decoration: "+d+i),[u,a,s,n,o,l,d,c,e.deltaY?"baseline-shift: "+-e.deltaY+"; ":"",r?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(t){return["overline","underline","line-through"].filter((function(e){return t[e.replace("-","")]})).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(t,e){var r=t?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+S.util.matrixToSVG(r)+(e||"")+'" '},_setSVGBg:function(t){if(this.backgroundColor){var r=S.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,r),'" y="',e(-this.height/2,r),'" width="',e(this.width,r),'" height="',e(this.height,r),'"></rect>\n')}},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(t),{reviver:t})},toClipPathSVG:function(t){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(t),{reviver:t})},_createBaseClipPathSVGMarkup:function(t,e){var r=(e=e||{}).reviver,i=e.additionalTransform||"",s=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),a=t.indexOf("COMMON_PARTS");return t[a]=s,r?r(t.join("")):t.join("")},_createBaseSVGMarkup:function(t,e){var r,i,s=(e=e||{}).noStyle,a=e.reviver,n=s?"":'style="'+this.getSvgStyles()+'" ',o=e.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,d=this.stroke,m=this.fill,h=this.shadow,p=[],f=t.indexOf("COMMON_PARTS"),_=e.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+S.Object.__uid++,i='<clipPath id="'+l.clipPathId+'" >\n'+l.toClipPathSVG(a)+"</clipPath>\n"),u&&p.push("<g ",o,this.getSvgCommons()," >\n"),p.push("<g ",this.getSvgTransform(!1),u?"":o+this.getSvgCommons()," >\n"),r=[n,c,s?"":this.addPaintOrder()," ",_?'transform="'+_+'" ':""].join(""),t[f]=r,m&&m.toLive&&p.push(m.toSVG(this)),d&&d.toLive&&p.push(d.toSVG(this)),h&&p.push(h.toSVG(this)),l&&p.push(i),p.push(t.join("")),p.push("</g>\n"),u&&p.push("</g>\n"),a?a(p.join("")):p.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var t=S.util.object.extend,e="stateProperties";function r(e,r,i){var s={};i.forEach((function(t){s[t]=e[t]})),t(e[r],s,!0)}function i(t,e,r){if(t===e)return!0;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var s=0,a=t.length;s<a;s++)if(!i(t[s],e[s]))return!1;return!0}if(t&&"object"==typeof t){var n,o=Object.keys(t);if(!e||"object"!=typeof e||!r&&o.length!==Object.keys(e).length)return!1;for(s=0,a=o.length;s<a;s++)if("canvas"!==(n=o[s])&&"group"!==n&&!i(t[n],e[n]))return!1;return!0}}S.util.object.extend(S.Object.prototype,{hasStateChanged:function(t){var r="_"+(t=t||e);return Object.keys(this[r]).length<this[t].length||!i(this[r],this,!0)},saveState:function(t){var i=t&&t.propertySet||e,s="_"+i;return this[s]?(r(this,s,this[i]),t&&t.stateProperties&&r(this,s,t.stateProperties),this):this.setupState(t)},setupState:function(t){var r=(t=t||{}).propertySet||e;return t.propertySet=r,this["_"+r]={},this.saveState(t),this}})}(),function(){var t=S.util.degreesToRadians;S.util.object.extend(S.Object.prototype,{_findTargetCorner:function(t,e){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var r,i,s,a=t.x,n=t.y,o=Object.keys(this.oCoords),l=o.length-1;for(this.__corner=0;l>=0;l--)if(s=o[l],this.isControlVisible(s)&&(i=this._getImageLines(e?this.oCoords[s].touchCorner:this.oCoords[s].corner),0!==(r=this._findCrossPoints({x:a,y:n},i))&&r%2==1))return this.__corner=s,s;return!1},forEachControl:function(t){for(var e in this.controls)t(this.controls[e],e,this)},_setCornerCoords:function(){var t=this.oCoords;for(var e in t){var r=this.controls[e];t[e].corner=r.calcCornerCoords(this.angle,this.cornerSize,t[e].x,t[e].y,!1),t[e].touchCorner=r.calcCornerCoords(this.angle,this.touchCornerSize,t[e].x,t[e].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var r=this.getCenterPoint(),i=this._calculateCurrentDimensions(),s=this.canvas.viewportTransform;return e.translate(r.x,r.y),e.scale(1/s[0],1/s[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-i.x/2,-i.y/2,i.x,i.y),e.restore(),this},drawBorders:function(t,e){e=e||{};var r=this._calculateCurrentDimensions(),i=this.borderScaleFactor,s=r.x+i,a=r.y+i,n=void 0!==e.hasControls?e.hasControls:this.hasControls,o=!1;return t.save(),t.strokeStyle=e.borderColor||this.borderColor,this._setLineDash(t,e.borderDashArray||this.borderDashArray),t.strokeRect(-s/2,-a/2,s,a),n&&(t.beginPath(),this.forEachControl((function(e,r,i){e.withConnection&&e.getVisibility(i,r)&&(o=!0,t.moveTo(e.x*s,e.y*a),t.lineTo(e.x*s+e.offsetX,e.y*a+e.offsetY))})),o&&t.stroke()),t.restore(),this},drawBordersInGroup:function(t,e,r){r=r||{};var i=S.util.sizeAfterTransform(this.width,this.height,e),s=this.strokeWidth,a=this.strokeUniform,n=this.borderScaleFactor,o=i.x+s*(a?this.canvas.getZoom():e.scaleX)+n,l=i.y+s*(a?this.canvas.getZoom():e.scaleY)+n;return t.save(),this._setLineDash(t,r.borderDashArray||this.borderDashArray),t.strokeStyle=r.borderColor||this.borderColor,t.strokeRect(-o/2,-l/2,o,l),t.restore(),this},drawControls:function(t,e){e=e||{},t.save();var r,i,s=this.canvas.getRetinaScaling();return t.setTransform(s,0,0,s,0,0),t.strokeStyle=t.fillStyle=e.cornerColor||this.cornerColor,this.transparentCorners||(t.strokeStyle=e.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(t,e.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(r=this.group.calcTransformMatrix()),this.forEachControl((function(s,a,n){i=n.oCoords[a],s.getVisibility(n,a)&&(r&&(i=S.util.transformPoint(i,r)),s.render(t,i.x,i.y,e,n))})),t.restore(),this},isControlVisible:function(t){return this.controls[t]&&this.controls[t].getVisibility(this,t)},setControlVisible:function(t,e){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[t]=e,this},setControlsVisibility:function(t){for(var e in t||(t={}),t)this.setControlVisible(e,t[e]);return this},onDeselect:function(){},onSelect:function(){}})}(),S.util.object.extend(S.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){var r=function(){},i=(e=e||{}).onComplete||r,s=e.onChange||r,a=this;return S.util.animate({startValue:t.left,endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(e){t.set("left",e),a.requestRenderAll(),s()},onComplete:function(){t.setCoords(),i()}}),this},fxCenterObjectV:function(t,e){var r=function(){},i=(e=e||{}).onComplete||r,s=e.onChange||r,a=this;return S.util.animate({startValue:t.top,endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(e){t.set("top",e),a.requestRenderAll(),s()},onComplete:function(){t.setCoords(),i()}}),this},fxRemove:function(t,e){var r=function(){},i=(e=e||{}).onComplete||r,s=e.onChange||r,a=this;return S.util.animate({startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(e){t.set("opacity",e),a.requestRenderAll(),s()},onComplete:function(){a.remove(t),i()}}),this}}),S.util.object.extend(S.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var t,e,r=[];for(t in arguments[0])r.push(t);for(var i=0,s=r.length;i<s;i++)t=r[i],e=i!==s-1,this._animate(t,arguments[0][t],arguments[1],e)}else this._animate.apply(this,arguments);return this},_animate:function(t,e,r,i){var s,a=this;e=e.toString(),r=r?S.util.object.clone(r):{},~t.indexOf(".")&&(s=t.split("."));var n=a.colorProperties.indexOf(t)>-1||s&&a.colorProperties.indexOf(s[1])>-1,o=s?this.get(s[0])[s[1]]:this.get(t);"from"in r||(r.from=o),n||(e=~e.indexOf("=")?o+parseFloat(e.replace("=","")):parseFloat(e));var l={startValue:r.from,endValue:e,byValue:r.by,easing:r.easing,duration:r.duration,abort:r.abort&&function(t,e,i){return r.abort.call(a,t,e,i)},onChange:function(e,n,o){s?a[s[0]][s[1]]=e:a.set(t,e),i||r.onChange&&r.onChange(e,n,o)},onComplete:function(t,e,s){i||(a.setCoords(),r.onComplete&&r.onComplete(t,e,s))}};return n?S.util.animateColor(l.startValue,l.endValue,l.duration,l):S.util.animate(l)}}),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,i=e.util.object.clone,s={x1:1,x2:1,y1:1,y2:1};function a(t,e){var r=t.origin,i=t.axis1,s=t.axis2,a=t.dimension,n=e.nearest,o=e.center,l=e.farthest;return function(){switch(this.get(r)){case n:return Math.min(this.get(i),this.get(s));case o:return Math.min(this.get(i),this.get(s))+.5*this.get(a);case l:return Math.max(this.get(i),this.get(s))}}}e.Line?e.warn("fabric.Line is already defined"):(e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(t,e){t||(t=[0,0,0,0]),this.callSuper("initialize",e),this.set("x1",t[0]),this.set("y1",t[1]),this.set("x2",t[2]),this.set("y2",t[3]),this._setWidthHeight(e)},_setWidthHeight:function(t){t||(t={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in t?t.left:this._getLeftToOriginX(),this.top="top"in t?t.top:this._getTopToOriginY()},_set:function(t,e){return this.callSuper("_set",t,e),void 0!==s[t]&&this._setWidthHeight(),this},_getLeftToOriginX:a({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:a({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(t){t.beginPath();var e=this.calcLinePoints();t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.lineWidth=this.strokeWidth;var r=t.strokeStyle;t.strokeStyle=this.stroke||t.fillStyle,this.stroke&&this._renderStroke(t),t.strokeStyle=r},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(t){return r(this.callSuper("toObject",t),this.calcLinePoints())},_getNonTransformedDimensions:function(){var t=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(t.y-=this.strokeWidth),0===this.height&&(t.x-=this.strokeWidth)),t},calcLinePoints:function(){var t=this.x1<=this.x2?-1:1,e=this.y1<=this.y2?-1:1,r=t*this.width*.5,i=e*this.height*.5;return{x1:r,x2:t*this.width*-.5,y1:i,y2:e*this.height*-.5}},_toSVG:function(){var t=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',t.x1,'" y1="',t.y1,'" x2="',t.x2,'" y2="',t.y2,'" />\n']}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(t,i,s){s=s||{};var a=e.parseAttributes(t,e.Line.ATTRIBUTE_NAMES),n=[a.x1||0,a.y1||0,a.x2||0,a.y2||0];i(new e.Line(n,r(a,s)))},e.Line.fromObject=function(t,r){var s=i(t,!0);s.points=[t.x1,t.y1,t.x2,t.y2],e.Object._fromObject("Line",s,(function(t){delete t.points,r&&r(t)}),"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=Math.PI;e.Circle?e.warn("fabric.Circle is already defined."):(e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*r,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(t,e){return this.callSuper("_set",t,e),"radius"===t&&this.setRadius(e),this},toObject:function(t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(t))},_toSVG:function(){var t,i=(this.endAngle-this.startAngle)%(2*r);if(0===i)t=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var s=e.util.cos(this.startAngle)*this.radius,a=e.util.sin(this.startAngle)*this.radius,n=e.util.cos(this.endAngle)*this.radius,o=e.util.sin(this.endAngle)*this.radius,l=i>r?"1":"0";t=['<path d="M '+s+" "+a," A "+this.radius+" "+this.radius," 0 ",+l+" 1"," "+n+" "+o,'" ',"COMMON_PARTS"," />\n"]}return t},_render:function(t){t.beginPath(),t.arc(0,0,this.radius,this.startAngle,this.endAngle,!1),this._renderPaintInOrder(t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(t){return this.radius=t,this.set("width",2*t).set("height",2*t)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(t,r){var i,s=e.parseAttributes(t,e.Circle.ATTRIBUTE_NAMES);if(!("radius"in(i=s)&&i.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");s.left=(s.left||0)-s.radius,s.top=(s.top||0)-s.radius,r(new e.Circle(s))},e.Circle.fromObject=function(t,r){e.Object._fromObject("Circle",t,r)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Triangle?e.warn("fabric.Triangle is already defined"):(e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(t){var e=this.width/2,r=this.height/2;t.beginPath(),t.moveTo(-e,r),t.lineTo(0,-r),t.lineTo(e,r),t.closePath(),this._renderPaintInOrder(t)},_toSVG:function(){var t=this.width/2,e=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-t+" "+e,"0 "+-e,t+" "+e].join(","),'" />']}}),e.Triangle.fromObject=function(t,r){return e.Object._fromObject("Triangle",t,r)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=2*Math.PI;e.Ellipse?e.warn("fabric.Ellipse is already defined."):(e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this.set("rx",t&&t.rx||0),this.set("ry",t&&t.ry||0)},_set:function(t,e){switch(this.callSuper("_set",t,e),t){case"rx":this.rx=e,this.set("width",2*e);break;case"ry":this.ry=e,this.set("height",2*e)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(t){t.beginPath(),t.save(),t.transform(1,0,0,this.ry/this.rx,0,0),t.arc(0,0,this.rx,0,r,!1),t.restore(),this._renderPaintInOrder(t)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(t,r){var i=e.parseAttributes(t,e.Ellipse.ATTRIBUTE_NAMES);i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,r(new e.Ellipse(i))},e.Ellipse.fromObject=function(t,r){e.Object._fromObject("Ellipse",t,r)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend;e.Rect?e.warn("fabric.Rect is already defined"):(e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(t){this.callSuper("initialize",t),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(t){var e=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,s=this.height,a=-this.width/2,n=-this.height/2,o=0!==e||0!==r,l=.4477152502;t.beginPath(),t.moveTo(a+e,n),t.lineTo(a+i-e,n),o&&t.bezierCurveTo(a+i-l*e,n,a+i,n+l*r,a+i,n+r),t.lineTo(a+i,n+s-r),o&&t.bezierCurveTo(a+i,n+s-l*r,a+i-l*e,n+s,a+i-e,n+s),t.lineTo(a+e,n+s),o&&t.bezierCurveTo(a+l*e,n+s,a,n+s-l*r,a,n+s-r),t.lineTo(a,n+r),o&&t.bezierCurveTo(a,n+l*r,a+l*e,n,a+e,n),t.closePath(),this._renderPaintInOrder(t)},toObject:function(t){return this.callSuper("toObject",["rx","ry"].concat(t))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(t,i,s){if(!t)return i(null);s=s||{};var a=e.parseAttributes(t,e.Rect.ATTRIBUTE_NAMES);a.left=a.left||0,a.top=a.top||0,a.height=a.height||0,a.width=a.width||0;var n=new e.Rect(r(s?e.util.object.clone(s):{},a));n.visible=n.visible&&n.width>0&&n.height>0,i(n)},e.Rect.fromObject=function(t,r){return e.Object._fromObject("Rect",t,r)})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,i=e.util.array.min,s=e.util.array.max,a=e.util.toFixed;e.Polyline?e.warn("fabric.Polyline is already defined"):(e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(t,e){e=e||{},this.points=t||[],this.callSuper("initialize",e),this._setPositionDimensions(e)},_setPositionDimensions:function(t){var e,r=this._calcDimensions(t);this.width=r.width,this.height=r.height,t.fromSVG||(e=this.translateToGivenOrigin({x:r.left-this.strokeWidth/2,y:r.top-this.strokeWidth/2},"left","top",this.originX,this.originY)),void 0===t.left&&(this.left=t.fromSVG?r.left:e.x),void 0===t.top&&(this.top=t.fromSVG?r.top:e.y),this.pathOffset={x:r.left+this.width/2,y:r.top+this.height/2}},_calcDimensions:function(){var t=this.points,e=i(t,"x")||0,r=i(t,"y")||0;return{left:e,top:r,width:(s(t,"x")||0)-e,height:(s(t,"y")||0)-r}},toObject:function(t){return r(this.callSuper("toObject",t),{points:this.points.concat()})},_toSVG:function(){for(var t=[],r=this.pathOffset.x,i=this.pathOffset.y,s=e.Object.NUM_FRACTION_DIGITS,n=0,o=this.points.length;n<o;n++)t.push(a(this.points[n].x-r,s),",",a(this.points[n].y-i,s)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',t.join(""),'" />\n']},commonRender:function(t){var e,r=this.points.length,i=this.pathOffset.x,s=this.pathOffset.y;if(!r||isNaN(this.points[r-1].y))return!1;t.beginPath(),t.moveTo(this.points[0].x-i,this.points[0].y-s);for(var a=0;a<r;a++)e=this.points[a],t.lineTo(e.x-i,e.y-s);return!0},_render:function(t){this.commonRender(t)&&this._renderPaintInOrder(t)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(t){return function(i,s,a){if(!i)return s(null);a||(a={});var n=e.parsePointsAttribute(i.getAttribute("points")),o=e.parseAttributes(i,e[t].ATTRIBUTE_NAMES);o.fromSVG=!0,s(new e[t](n,r(o,a)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(t,r){return e.Object._fromObject("Polyline",t,r,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Polygon?e.warn("fabric.Polygon is already defined"):(e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_render:function(t){this.commonRender(t)&&(t.closePath(),this._renderPaintInOrder(t))}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(t,r){e.Object._fromObject("Polygon",t,r,"points")})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.array.min,i=e.util.array.max,s=e.util.object.extend,a=Object.prototype.toString,n=e.util.toFixed;e.Path?e.warn("fabric.Path is already defined"):(e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(t,r){r=r||{},this.callSuper("initialize",r),t||(t=[]);var i="[object Array]"===a.call(t);this.path=e.util.makePathSimpler(i?t:e.util.parsePath(t)),this.path&&e.Polyline.prototype._setPositionDimensions.call(this,r)},_renderPathCommands:function(t){var e,r=0,i=0,s=0,a=0,n=0,o=0,l=-this.pathOffset.x,c=-this.pathOffset.y;t.beginPath();for(var u=0,d=this.path.length;u<d;++u)switch((e=this.path[u])[0]){case"L":s=e[1],a=e[2],t.lineTo(s+l,a+c);break;case"M":r=s=e[1],i=a=e[2],t.moveTo(s+l,a+c);break;case"C":s=e[5],a=e[6],n=e[3],o=e[4],t.bezierCurveTo(e[1]+l,e[2]+c,n+l,o+c,s+l,a+c);break;case"Q":t.quadraticCurveTo(e[1]+l,e[2]+c,e[3]+l,e[4]+c),s=e[3],a=e[4],n=e[1],o=e[2];break;case"z":case"Z":s=r,a=i,t.closePath()}},_render:function(t){this._renderPathCommands(t),this._renderPaintInOrder(t)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(t){return s(this.callSuper("toObject",t),{path:this.path.map((function(t){return t.slice()}))})},toDatalessObject:function(t){var e=this.toObject(["sourcePath"].concat(t));return e.sourcePath&&delete e.path,e},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',e.util.joinPath(this.path),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var t=e.Object.NUM_FRACTION_DIGITS;return" translate("+n(-this.pathOffset.x,t)+", "+n(-this.pathOffset.y,t)+")"},toClipPathSVG:function(t){var e=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},toSVG:function(t){var e=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,additionalTransform:e})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var t,s,a=[],n=[],o=0,l=0,c=0,u=0,d=0,m=this.path.length;d<m;++d){switch((t=this.path[d])[0]){case"L":c=t[1],u=t[2],s=[];break;case"M":o=c=t[1],l=u=t[2],s=[];break;case"C":s=e.util.getBoundsOfCurve(c,u,t[1],t[2],t[3],t[4],t[5],t[6]),c=t[5],u=t[6];break;case"Q":s=e.util.getBoundsOfCurve(c,u,t[1],t[2],t[1],t[2],t[3],t[4]),c=t[3],u=t[4];break;case"z":case"Z":c=o,u=l}s.forEach((function(t){a.push(t.x),n.push(t.y)})),a.push(c),n.push(u)}var h=r(a)||0,p=r(n)||0;return{left:h,top:p,width:(i(a)||0)-h,height:(i(n)||0)-p}}}),e.Path.fromObject=function(t,r){if("string"==typeof t.sourcePath){var i=t.sourcePath;e.loadSVGFromURL(i,(function(e){var i=e[0];i.setOptions(t),r&&r(i)}))}else e.Object._fromObject("Path",t,r,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(t,r,i){var a=e.parseAttributes(t,e.Path.ATTRIBUTE_NAMES);a.fromSVG=!0,r(new e.Path(a.d,s(a,i)))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.array.min,i=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,e,r){e=e||{},this._objects=[],r&&this.callSuper("initialize",e),this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;if(r)this._updateObjectsACoords();else{var s=e&&e.centerPoint;void 0!==e.originX&&(this.originX=e.originX),void 0!==e.originY&&(this.originY=e.originY),s||this._calcBounds(),this._updateObjectsCoords(s),delete e.centerPoint,this.callSuper("initialize",e)}this.setCoords()},_updateObjectsACoords:function(){for(var t=this._objects.length;t--;)this._objects[t].setCoords(true)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var e=this._objects.length;e--;)this._updateObjectCoords(this._objects[e],t)},_updateObjectCoords:function(t,e){var r=t.left,i=t.top;t.set({left:r-e.x,top:i-e.y}),t.group=this,t.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){var r=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),t&&(r&&e.util.removeTransformFromObject(t,this.group.calcTransformMatrix()),this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,r?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(t){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,r){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(t,r);if("canvas"===t)for(;i--;)this._objects[i]._set(t,r);e.Object.prototype._set.call(this,t,r)},toObject:function(t){var r=this.includeDefaultValues,i=this._objects.filter((function(t){return!t.excludeFromExport})).map((function(e){var i=e.includeDefaultValues;e.includeDefaultValues=r;var s=e.toObject(t);return e.includeDefaultValues=i,s})),s=e.Object.prototype.toObject.call(this,t);return s.objects=i,s},toDatalessObject:function(t){var r,i=this.sourcePath;if(i)r=i;else{var s=this.includeDefaultValues;r=this._objects.map((function(e){var r=e.includeDefaultValues;e.includeDefaultValues=s;var i=e.toDatalessObject(t);return e.includeDefaultValues=r,i}))}var a=e.Object.prototype.toDatalessObject.call(this,t);return a.objects=r,a},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=e.Object.prototype.shouldCache.call(this);if(t)for(var r=0,i=this._objects.length;r<i;r++)if(this._objects[r].willDrawShadow())return this.ownCaching=!1,!1;return t},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var t=0,r=this._objects.length;t<r;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var e=0,r=this._objects.length;e<r;e++)this._objects[e].render(t);this._drawClipPath(t)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var e=0,r=this._objects.length;e<r;e++)if(this._objects[e].isCacheDirty(!0)){if(this._cacheCanvas){var i=this.cacheWidth/this.zoomX,s=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-i/2,-s/2,i,s)}return!0}return!1},_restoreObjectsState:function(){var t=this.calcOwnMatrix();return this._objects.forEach((function(r){e.util.addTransformToObject(r,t),delete r.group,r.setCoords()})),this},realizeTransform:function(t,r){return e.util.addTransformToObject(t,r),t},destroy:function(){return this._objects.forEach((function(t){t.set("dirty",!0)})),this._restoreObjectsState()},toActiveSelection:function(){if(this.canvas){var t=this._objects,r=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var s=new e.ActiveSelection([]);return s.set(i),s.type="activeSelection",r.remove(this),t.forEach((function(t){t.group=s,t.dirty=!0,r.add(t)})),s.canvas=r,s._objects=t,r._activeObject=s,s.setCoords(),s}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject((function(t){t.setCoords(true)})),this},_calcBounds:function(t){for(var e,r,i,s,a=[],n=[],o=["tr","br","bl","tl"],l=0,c=this._objects.length,u=o.length;l<c;++l){for(i=(e=this._objects[l]).calcACoords(),s=0;s<u;s++)r=o[s],a.push(i[r].x),n.push(i[r].y);e.aCoords=i}this._getBounds(a,n,t)},_getBounds:function(t,s,a){var n=new e.Point(r(t),r(s)),o=new e.Point(i(t),i(s)),l=n.y||0,c=n.x||0,u=o.x-n.x||0,d=o.y-n.y||0;this.width=u,this.height=d,a||this.setPositionByOrigin({x:c,y:l},"left","top")},_toSVG:function(t){for(var e=["<g ","COMMON_PARTS"," >\n"],r=0,i=this._objects.length;r<i;r++)e.push("\t\t",this._objects[r].toSVG(t));return e.push("</g>\n"),e},getSvgStyles:function(){var t=void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",e=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),e].join("")},toClipPathSVG:function(t){for(var e=[],r=0,i=this._objects.length;r<i;r++)e.push("\t",this._objects[r].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(e,{reviver:t})}}),e.Group.fromObject=function(t,r){var i=t.objects,s=e.util.object.clone(t,!0);delete s.objects,"string"!=typeof i?e.util.enlivenObjects(i,(function(i){e.util.enlivenObjects([t.clipPath],(function(s){var a=e.util.object.clone(t,!0);a.clipPath=s[0],delete a.objects,r&&r(new e.Group(i,a,!0))}))})):e.loadSVGFromURL(i,(function(a){var n=e.util.groupSVGElements(a,t,i);n.set(s),r&&r(n)}))})}(e),function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(t,r){r=r||{},this._objects=t||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;r.originX&&(this.originX=r.originX),r.originY&&(this.originY=r.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,r),this.setCoords()},toGroup:function(){var t=this._objects.concat();this._objects=[];var r=e.Object.prototype.toObject.call(this),i=new e.Group([]);if(delete r.type,i.set(r),t.forEach((function(t){t.canvas.remove(t),t.group=i})),i._objects=t,!this.canvas)return i;var s=this.canvas;return s.add(i),s._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(t,e,r){t.save(),t.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",t,e),void 0===(r=r||{}).hasControls&&(r.hasControls=!1),r.forActiveSelection=!0;for(var i=0,s=this._objects.length;i<s;i++)this._objects[i]._renderControls(t,r);t.restore()}}),e.ActiveSelection.fromObject=function(t,r){e.util.enlivenObjects(t.objects,(function(i){delete t.objects,r&&r(new e.ActiveSelection(i,t,!0))}))})}(e),function(t){"use strict";var e=S.util.object.extend;t.fabric||(t.fabric={}),t.fabric.Image?S.warn("fabric.Image is already defined."):(S.Image=S.util.createClass(S.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:S.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:S.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(t,e){e||(e={}),this.filters=[],this.cacheKey="texture"+S.Object.__uid++,this.callSuper("initialize",e),this._initElement(t,e)},getElement:function(){return this._element||{}},setElement:function(t,e){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=t,this._originalElement=t,this._initConfig(e),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(t){var e=S.filterBackend;e&&e.evictCachesForKey&&e.evictCachesForKey(t)},dispose:function(){this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(t){S.util.cleanUpJsdomNode(this[t]),this[t]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var t=this.getElement();return{width:t.naturalWidth||t.width,height:t.naturalHeight||t.height}},_stroke:function(t){if(this.stroke&&0!==this.strokeWidth){var e=this.width/2,r=this.height/2;t.beginPath(),t.moveTo(-e,-r),t.lineTo(e,-r),t.lineTo(e,r),t.lineTo(-e,r),t.lineTo(-e,-r),t.closePath()}},toObject:function(t){var r=[];this.filters.forEach((function(t){t&&r.push(t.toObject())}));var i=e(this.callSuper("toObject",["cropX","cropY"].concat(t)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:r});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var t,e=[],r=[],i=this._element,s=-this.width/2,a=-this.height/2,n="",o="";if(!i)return[];if(this.hasCrop()){var l=S.Object.__uid++;e.push('<clipPath id="imageCrop_'+l+'">\n','\t<rect x="'+s+'" y="'+a+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),n=' clip-path="url(#imageCrop_'+l+')" '}if(this.imageSmoothing||(o='" image-rendering="optimizeSpeed'),r.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',s-this.cropX,'" y="',a-this.cropY,'" width="',i.width||i.naturalWidth,'" height="',i.height||i.height,o,'"',n,"></image>\n"),this.stroke||this.strokeDashArray){var c=this.fill;this.fill=null,t=["\t<rect ",'x="',s,'" y="',a,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=c}return e="fill"!==this.paintFirst?e.concat(t,r):e.concat(r,t)},getSrc:function(t){var e=t?this._element:this._originalElement;return e?e.toDataURL?e.toDataURL():this.srcFromAttribute?e.getAttribute("src"):e.src:this.src||""},setSrc:function(t,e,r){return S.util.loadImage(t,(function(t,i){this.setElement(t,r),this._setWidthHeight(),e&&e(this,i)}),this,r&&r.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var t=this.resizeFilter,e=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),i=r.scaleX,s=r.scaleY,a=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!t||i>e&&s>e)return this._element=a,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=s);S.filterBackend||(S.filterBackend=S.initFilterBackend());var n=S.util.createCanvasElement(),o=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,l=a.width,c=a.height;n.width=l,n.height=c,this._element=n,this._lastScaleX=t.scaleX=i,this._lastScaleY=t.scaleY=s,S.filterBackend.applyFilters([t],a,l,c,this._element,o),this._filterScalingX=n.width/this._originalElement.width,this._filterScalingY=n.height/this._originalElement.height},applyFilters:function(t){if(t=(t=t||this.filters||[]).filter((function(t){return t&&!t.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===t.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var e=this._originalElement,r=e.naturalWidth||e.width,i=e.naturalHeight||e.height;if(this._element===this._originalElement){var s=S.util.createCanvasElement();s.width=r,s.height=i,this._element=s,this._filteredEl=s}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,i),this._lastScaleX=1,this._lastScaleY=1;return S.filterBackend||(S.filterBackend=S.initFilterBackend()),S.filterBackend.applyFilters(t,this._originalElement,r,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(t){S.util.setImageSmoothing(t,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(t),this._renderPaintInOrder(t)},drawCacheOnCanvas:function(t){S.util.setImageSmoothing(t,this.imageSmoothing),S.Object.prototype.drawCacheOnCanvas.call(this,t)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(t){var e=this._element;if(e){var r=this._filterScalingX,i=this._filterScalingY,s=this.width,a=this.height,n=Math.min,o=Math.max,l=o(this.cropX,0),c=o(this.cropY,0),u=e.naturalWidth||e.width,d=e.naturalHeight||e.height,m=l*r,h=c*i,p=n(s*r,u-m),f=n(a*i,d-h),_=-s/2,v=-a/2,g=n(s,u/r-l),b=n(a,d/i-c);e&&t.drawImage(e,m,h,p,f,_,v,g,b)}},_needsResize:function(){var t=this.getTotalObjectScaling();return t.scaleX!==this._lastScaleX||t.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(t,e){this.setElement(S.util.getById(t),e),S.util.addClass(this.getElement(),S.Image.CSS_CANVAS)},_initConfig:function(t){t||(t={}),this.setOptions(t),this._setWidthHeight(t)},_initFilters:function(t,e){t&&t.length?S.util.enlivenObjects(t,(function(t){e&&e(t)}),"fabric.Image.filters"):e&&e()},_setWidthHeight:function(t){t||(t={});var e=this.getElement();this.width=t.width||e.naturalWidth||e.width||0,this.height=t.height||e.naturalHeight||e.height||0},parsePreserveAspectRatioAttribute:function(){var t,e=S.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),r=this._element.width,i=this._element.height,s=1,a=1,n=0,o=0,l=0,c=0,u=this.width,d=this.height,m={width:u,height:d};return!e||"none"===e.alignX&&"none"===e.alignY?(s=u/r,a=d/i):("meet"===e.meetOrSlice&&(t=(u-r*(s=a=S.util.findScaleToFit(this._element,m)))/2,"Min"===e.alignX&&(n=-t),"Max"===e.alignX&&(n=t),t=(d-i*a)/2,"Min"===e.alignY&&(o=-t),"Max"===e.alignY&&(o=t)),"slice"===e.meetOrSlice&&(t=r-u/(s=a=S.util.findScaleToCover(this._element,m)),"Mid"===e.alignX&&(l=t/2),"Max"===e.alignX&&(l=t),t=i-d/a,"Mid"===e.alignY&&(c=t/2),"Max"===e.alignY&&(c=t),r=u/s,i=d/a)),{width:r,height:i,scaleX:s,scaleY:a,offsetLeft:n,offsetTop:o,cropX:l,cropY:c}}}),S.Image.CSS_CANVAS="canvas-img",S.Image.prototype.getSvgSrc=S.Image.prototype.getSrc,S.Image.fromObject=function(t,e){var r=S.util.object.clone(t);S.util.loadImage(r.src,(function(t,i){i?e&&e(null,!0):S.Image.prototype._initFilters.call(r,r.filters,(function(i){r.filters=i||[],S.Image.prototype._initFilters.call(r,[r.resizeFilter],(function(i){r.resizeFilter=i[0],S.util.enlivenObjects([r.clipPath],(function(i){r.clipPath=i[0];var s=new S.Image(t,r);e(s,!1)}))}))}))}),null,r.crossOrigin)},S.Image.fromURL=function(t,e,r){S.util.loadImage(t,(function(t,i){e&&e(new S.Image(t,r),i)}),null,r&&r.crossOrigin)},S.Image.ATTRIBUTE_NAMES=S.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),S.Image.fromElement=function(t,r,i){var s=S.parseAttributes(t,S.Image.ATTRIBUTE_NAMES);S.Image.fromURL(s["xlink:href"],r,e(i?S.util.object.clone(i):{},s))})}(e),S.util.object.extend(S.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?90*Math.round((t-1)/90):90*Math.round(t/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten()),this},fxStraighten:function(t){var e=function(){},r=(t=t||{}).onComplete||e,i=t.onChange||e,s=this;return S.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(t){s.rotate(t),i()},onComplete:function(){s.setCoords(),r()}}),this}}),S.util.object.extend(S.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound}),this}}),function(){"use strict";function t(t,e){var r="precision "+e+" float;\nvoid main(){}",i=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(i,r),t.compileShader(i),!!t.getShaderParameter(i,t.COMPILE_STATUS)}function e(t){t&&t.tileSize&&(this.tileSize=t.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}S.isWebglSupported=function(e){if(S.isLikelyNode)return!1;e=e||S.WebglFilterBackend.prototype.tileSize;var r=document.createElement("canvas"),i=r.getContext("webgl")||r.getContext("experimental-webgl"),s=!1;if(i){S.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),s=S.maxTextureSize>=e;for(var a=["highp","mediump","lowp"],n=0;n<3;n++)if(t(i,a[n])){S.webGlPrecision=a[n];break}}return this.isSupported=s,s},S.WebglFilterBackend=e,e.prototype={tileSize:2048,resources:{},setupGLContext:function(t,e){this.dispose(),this.createWebGLCanvas(t,e),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(t,e)},chooseFastestCopyGLTo2DMethod:function(t,e){var r,i=void 0!==window.performance;try{new ImageData(1,1),r=!0}catch(t){r=!1}var s="undefined"!=typeof ArrayBuffer,a="undefined"!=typeof Uint8ClampedArray;if(i&&r&&s&&a){var n=S.util.createCanvasElement(),o=new ArrayBuffer(t*e*4);if(S.forceGLPutImageData)return this.imageBuffer=o,void(this.copyGLTo2D=F);var l,c,u={imageBuffer:o,destinationWidth:t,destinationHeight:e,targetCanvas:n};n.width=t,n.height=e,l=window.performance.now(),I.call(u,this.gl,u),c=window.performance.now()-l,l=window.performance.now(),F.call(u,this.gl,u),c>window.performance.now()-l?(this.imageBuffer=o,this.copyGLTo2D=F):this.copyGLTo2D=I}},createWebGLCanvas:function(t,e){var r=S.util.createCanvasElement();r.width=t,r.height=e;var i={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},s=r.getContext("webgl",i);s||(s=r.getContext("experimental-webgl",i)),s&&(s.clearColor(0,0,0,0),this.canvas=r,this.gl=s)},applyFilters:function(t,e,r,i,s,a){var n,o=this.gl;a&&(n=this.getCachedTexture(a,e));var l={originalWidth:e.width||e.originalWidth,originalHeight:e.height||e.originalHeight,sourceWidth:r,sourceHeight:i,destinationWidth:r,destinationHeight:i,context:o,sourceTexture:this.createTexture(o,r,i,!n&&e),targetTexture:this.createTexture(o,r,i),originalTexture:n||this.createTexture(o,r,i,!n&&e),passes:t.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},c=o.createFramebuffer();return o.bindFramebuffer(o.FRAMEBUFFER,c),t.forEach((function(t){t&&t.applyTo(l)})),function(t){var e=t.targetCanvas,r=e.width,i=e.height,s=t.destinationWidth,a=t.destinationHeight;r===s&&i===a||(e.width=s,e.height=a)}(l),this.copyGLTo2D(o,l),o.bindTexture(o.TEXTURE_2D,null),o.deleteTexture(l.sourceTexture),o.deleteTexture(l.targetTexture),o.deleteFramebuffer(c),s.getContext("2d").setTransform(1,0,0,1,0,0),l},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(t,e,r,i){var s=t.createTexture();return t.bindTexture(t.TEXTURE_2D,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),i?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,r,0,t.RGBA,t.UNSIGNED_BYTE,null),s},getCachedTexture:function(t,e){if(this.textureCache[t])return this.textureCache[t];var r=this.createTexture(this.gl,e.width,e.height,e);return this.textureCache[t]=r,r},evictCachesForKey:function(t){this.textureCache[t]&&(this.gl.deleteTexture(this.textureCache[t]),delete this.textureCache[t])},copyGLTo2D:I,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var t=this.gl,e={renderer:"",vendor:""};if(!t)return e;var r=t.getExtension("WEBGL_debug_renderer_info");if(r){var i=t.getParameter(r.UNMASKED_RENDERER_WEBGL),s=t.getParameter(r.UNMASKED_VENDOR_WEBGL);i&&(e.renderer=i.toLowerCase()),s&&(e.vendor=s.toLowerCase())}return this.gpuInfo=e,e}}}(),function(){"use strict";var t=function(){};function e(){}S.Canvas2dFilterBackend=e,e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(t,e,r,i,s){var a=s.getContext("2d");a.drawImage(e,0,0,r,i);var n={sourceWidth:r,sourceHeight:i,imageData:a.getImageData(0,0,r,i),originalEl:e,originalImageData:a.getImageData(0,0,r,i),canvasEl:s,ctx:a,filterBackend:this};return t.forEach((function(t){t.applyTo(n)})),n.imageData.width===r&&n.imageData.height===i||(s.width=n.imageData.width,s.height=n.imageData.height),a.putImageData(n.imageData,0,0),n}}}(),S.Image=S.Image||{},S.Image.filters=S.Image.filters||{},S.Image.filters.BaseFilter=S.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,r){e=e||this.fragmentSource,r=r||this.vertexSource,"highp"!==S.webGlPrecision&&(e=e.replace(/precision highp float/g,"precision "+S.webGlPrecision+" float"));var i=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(i,r),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(i));var s=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(s,e),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(s));var a=t.createProgram();if(t.attachShader(a,i),t.attachShader(a,s),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(a));var n=this.getAttributeLocations(t,a),o=this.getUniformLocations(t,a)||{};return o.uStepW=t.getUniformLocation(a,"uStepW"),o.uStepH=t.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:n,uniformLocations:o}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,r){var i=e.aPosition,s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.enableVertexAttribArray(i),t.vertexAttribPointer(i,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,r,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e,r,i=t.context;t.passes>1?(e=t.destinationWidth,r=t.destinationHeight,t.sourceWidth===e&&t.sourceHeight===r||(i.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(i,e,r)),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t.targetTexture,0)):(i.bindFramebuffer(i.FRAMEBUFFER,null),i.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=S.Image.filters[this.type].prototype;if(t){if(Array.isArray(e[t])){for(var r=e[t].length;r--;)if(this[t][r]!==e[t][r])return!1;return!0}return e[t]===this[t]}return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,r=this.retrieveShader(t);0===t.pass&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(r.program),this.sendAttributeData(e,r.attributeLocations,t.aPosition),e.uniform1f(r.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(r.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,r.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,r){t.activeTexture(r),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}}),S.Image.filters.BaseFilter.fromObject=function(t,e){var r=new S.Image.filters[t.type](t);return e&&e(r),r},function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.ColorMatrix=i(r.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){var e,r,i,s,a,n=t.imageData.data,o=n.length,l=this.matrix,c=this.colorsOnly;for(a=0;a<o;a+=4)e=n[a],r=n[a+1],i=n[a+2],c?(n[a]=e*l[0]+r*l[1]+i*l[2]+255*l[4],n[a+1]=e*l[5]+r*l[6]+i*l[7]+255*l[9],n[a+2]=e*l[10]+r*l[11]+i*l[12]+255*l[14]):(s=n[a+3],n[a]=e*l[0]+r*l[1]+i*l[2]+s*l[3]+255*l[4],n[a+1]=e*l[5]+r*l[6]+i*l[7]+s*l[8]+255*l[9],n[a+2]=e*l[10]+r*l[11]+i*l[12]+s*l[13]+255*l[14],n[a+3]=e*l[15]+r*l[16]+i*l[17]+s*l[18]+255*l[19])},getUniformLocations:function(t,e){return{uColorMatrix:t.getUniformLocation(e,"uColorMatrix"),uConstants:t.getUniformLocation(e,"uConstants")}},sendUniformData:function(t,e){var r=this.matrix,i=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],s=[r[4],r[9],r[14],r[19]];t.uniformMatrix4fv(e.uColorMatrix,!1,i),t.uniform4fv(e.uConstants,s)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Brightness=i(r.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(0!==this.brightness){var e,r=t.imageData.data,i=r.length,s=Math.round(255*this.brightness);for(e=0;e<i;e+=4)r[e]=r[e]+s,r[e+1]=r[e+1]+s,r[e+2]=r[e+2]+s}},getUniformLocations:function(t,e){return{uBrightness:t.getUniformLocation(e,"uBrightness")}},sendUniformData:function(t,e){t.uniform1f(e.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,i=e.Image.filters,s=e.util.createClass;i.Convolute=s(i.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(t){var e=Math.sqrt(this.matrix.length),r=this.type+"_"+e+"_"+(this.opaque?1:0),i=this.fragmentSource[r];return t.programCache.hasOwnProperty(r)||(t.programCache[r]=this.createProgram(t.context,i)),t.programCache[r]},applyTo2d:function(t){var e,r,i,s,a,n,o,l,c,u,d,m,h,p=t.imageData,f=p.data,_=this.matrix,v=Math.round(Math.sqrt(_.length)),g=Math.floor(v/2),b=p.width,y=p.height,x=t.ctx.createImageData(b,y),$=x.data,w=this.opaque?1:0;for(d=0;d<y;d++)for(u=0;u<b;u++){for(a=4*(d*b+u),e=0,r=0,i=0,s=0,h=0;h<v;h++)for(m=0;m<v;m++)n=u+m-g,(o=d+h-g)<0||o>=y||n<0||n>=b||(l=4*(o*b+n),c=_[h*v+m],e+=f[l]*c,r+=f[l+1]*c,i+=f[l+2]*c,w||(s+=f[l+3]*c));$[a]=e,$[a+1]=r,$[a+2]=i,$[a+3]=w?f[a+3]:s}t.imageData=x},getUniformLocations:function(t,e){return{uMatrix:t.getUniformLocation(e,"uMatrix"),uOpaque:t.getUniformLocation(e,"uOpaque"),uHalfSize:t.getUniformLocation(e,"uHalfSize"),uSize:t.getUniformLocation(e,"uSize")}},sendUniformData:function(t,e){t.uniform1fv(e.uMatrix,this.matrix)},toObject:function(){return r(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Grayscale=i(r.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(t){var e,r,i=t.imageData.data,s=i.length,a=this.mode;for(e=0;e<s;e+=4)"average"===a?r=(i[e]+i[e+1]+i[e+2])/3:"lightness"===a?r=(Math.min(i[e],i[e+1],i[e+2])+Math.max(i[e],i[e+1],i[e+2]))/2:"luminosity"===a&&(r=.21*i[e]+.72*i[e+1]+.07*i[e+2]),i[e]=r,i[e+1]=r,i[e+2]=r},retrieveShader:function(t){var e=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(e)){var r=this.fragmentSource[this.mode];t.programCache[e]=this.createProgram(t.context,r)}return t.programCache[e]},getUniformLocations:function(t,e){return{uMode:t.getUniformLocation(e,"uMode")}},sendUniformData:function(t,e){t.uniform1i(e.uMode,1)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Invert=i(r.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(t){var e,r=t.imageData.data,i=r.length;for(e=0;e<i;e+=4)r[e]=255-r[e],r[e+1]=255-r[e+1],r[e+2]=255-r[e+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,e){return{uInvert:t.getUniformLocation(e,"uInvert")}},sendUniformData:function(t,e){t.uniform1i(e.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,i=e.Image.filters,s=e.util.createClass;i.Noise=s(i.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(t){if(0!==this.noise){var e,r,i=t.imageData.data,s=i.length,a=this.noise;for(e=0,s=i.length;e<s;e+=4)r=(.5-Math.random())*a,i[e]+=r,i[e+1]+=r,i[e+2]+=r}},getUniformLocations:function(t,e){return{uNoise:t.getUniformLocation(e,"uNoise"),uSeed:t.getUniformLocation(e,"uSeed")}},sendUniformData:function(t,e){t.uniform1f(e.uNoise,this.noise/255),t.uniform1f(e.uSeed,Math.random())},toObject:function(){return r(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Pixelate=i(r.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(t){var e,r,i,s,a,n,o,l,c,u,d,m=t.imageData,h=m.data,p=m.height,f=m.width;for(r=0;r<p;r+=this.blocksize)for(i=0;i<f;i+=this.blocksize)for(s=h[e=4*r*f+4*i],a=h[e+1],n=h[e+2],o=h[e+3],u=Math.min(r+this.blocksize,p),d=Math.min(i+this.blocksize,f),l=r;l<u;l++)for(c=i;c<d;c++)h[e=4*l*f+4*c]=s,h[e+1]=a,h[e+2]=n,h[e+3]=o},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(t,e){return{uBlocksize:t.getUniformLocation(e,"uBlocksize"),uStepW:t.getUniformLocation(e,"uStepW"),uStepH:t.getUniformLocation(e,"uStepH")}},sendUniformData:function(t,e){t.uniform1f(e.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.extend,i=e.Image.filters,s=e.util.createClass;i.RemoveColor=s(i.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(t){var r,i,s,a,n=t.imageData.data,o=255*this.distance,l=new e.Color(this.color).getSource(),c=[l[0]-o,l[1]-o,l[2]-o],u=[l[0]+o,l[1]+o,l[2]+o];for(r=0;r<n.length;r+=4)i=n[r],s=n[r+1],a=n[r+2],i>c[0]&&s>c[1]&&a>c[2]&&i<u[0]&&s<u[1]&&a<u[2]&&(n[r+3]=0)},getUniformLocations:function(t,e){return{uLow:t.getUniformLocation(e,"uLow"),uHigh:t.getUniformLocation(e,"uHigh")}},sendUniformData:function(t,r){var i=new e.Color(this.color).getSource(),s=parseFloat(this.distance),a=[0+i[0]/255-s,0+i[1]/255-s,0+i[2]/255-s,1],n=[i[0]/255+s,i[1]/255+s,i[2]/255+s,1];t.uniform4fv(r.uLow,a),t.uniform4fv(r.uHigh,n)},toObject:function(){return r(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass,s={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var a in s)r[a]=i(r.ColorMatrix,{type:a,matrix:s[a],mainParameter:!1,colorsOnly:!0}),e.Image.filters[a].fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,r=e.Image.filters,i=e.util.createClass;r.BlendColor=i(r.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(t){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[t]+"}\n}"},retrieveShader:function(t){var e,r=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(r)||(e=this.buildSource(this.mode),t.programCache[r]=this.createProgram(t.context,e)),t.programCache[r]},applyTo2d:function(t){var r,i,s,a,n,o,l,c=t.imageData.data,u=c.length,d=1-this.alpha;r=(l=new e.Color(this.color).getSource())[0]*this.alpha,i=l[1]*this.alpha,s=l[2]*this.alpha;for(var m=0;m<u;m+=4)switch(a=c[m],n=c[m+1],o=c[m+2],this.mode){case"multiply":c[m]=a*r/255,c[m+1]=n*i/255,c[m+2]=o*s/255;break;case"screen":c[m]=255-(255-a)*(255-r)/255,c[m+1]=255-(255-n)*(255-i)/255,c[m+2]=255-(255-o)*(255-s)/255;break;case"add":c[m]=a+r,c[m+1]=n+i,c[m+2]=o+s;break;case"diff":case"difference":c[m]=Math.abs(a-r),c[m+1]=Math.abs(n-i),c[m+2]=Math.abs(o-s);break;case"subtract":c[m]=a-r,c[m+1]=n-i,c[m+2]=o-s;break;case"darken":c[m]=Math.min(a,r),c[m+1]=Math.min(n,i),c[m+2]=Math.min(o,s);break;case"lighten":c[m]=Math.max(a,r),c[m+1]=Math.max(n,i),c[m+2]=Math.max(o,s);break;case"overlay":c[m]=r<128?2*a*r/255:255-2*(255-a)*(255-r)/255,c[m+1]=i<128?2*n*i/255:255-2*(255-n)*(255-i)/255,c[m+2]=s<128?2*o*s/255:255-2*(255-o)*(255-s)/255;break;case"exclusion":c[m]=r+a-2*r*a/255,c[m+1]=i+n-2*i*n/255,c[m+2]=s+o-2*s*o/255;break;case"tint":c[m]=r+a*d,c[m+1]=i+n*d,c[m+2]=s+o*d}},getUniformLocations:function(t,e){return{uColor:t.getUniformLocation(e,"uColor")}},sendUniformData:function(t,r){var i=new e.Color(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,t.uniform4fv(r.uColor,i)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric,r=e.Image.filters,i=e.util.createClass;r.BlendImage=i(r.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(t){var e=this.type+"_"+this.mode,r=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(e)||(t.programCache[e]=this.createProgram(t.context,r)),t.programCache[e]},applyToWebGL:function(t){var e=t.context,r=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(e,r,e.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(e,e.TEXTURE1)},createTexture:function(t,e){return t.getCachedTexture(e.cacheKey,e._element)},calculateMatrix:function(){var t=this.image,e=t._element.width,r=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/e,-t.top/r,1]},applyTo2d:function(t){var r,i,s,a,n,o,l,c,u,d,m,h=t.imageData,p=t.filterBackend.resources,f=h.data,_=f.length,v=h.width,g=h.height,b=this.image;p.blendImage||(p.blendImage=e.util.createCanvasElement()),d=(u=p.blendImage).getContext("2d"),u.width!==v||u.height!==g?(u.width=v,u.height=g):d.clearRect(0,0,v,g),d.setTransform(b.scaleX,0,0,b.scaleY,b.left,b.top),d.drawImage(b._element,0,0,v,g),m=d.getImageData(0,0,v,g).data;for(var y=0;y<_;y+=4)switch(n=f[y],o=f[y+1],l=f[y+2],c=f[y+3],r=m[y],i=m[y+1],s=m[y+2],a=m[y+3],this.mode){case"multiply":f[y]=n*r/255,f[y+1]=o*i/255,f[y+2]=l*s/255,f[y+3]=c*a/255;break;case"mask":f[y+3]=a}},getUniformLocations:function(t,e){return{uTransformMatrix:t.getUniformLocation(e,"uTransformMatrix"),uImage:t.getUniformLocation(e,"uImage")}},sendUniformData:function(t,e){var r=this.calculateMatrix();t.uniform1i(e.uImage,1),t.uniformMatrix3fv(e.uTransformMatrix,!1,r)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(t,r){e.Image.fromObject(t.image,(function(i){var s=e.util.object.clone(t);s.image=i,r(new e.Image.filters.BlendImage(s))}))}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=Math.pow,i=Math.floor,s=Math.sqrt,a=Math.abs,n=Math.round,o=Math.sin,l=Math.ceil,c=e.Image.filters,u=e.util.createClass;c.Resize=u(c.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(t,e){return{uDelta:t.getUniformLocation(e,"uDelta"),uTaps:t.getUniformLocation(e,"uTaps")}},sendUniformData:function(t,e){t.uniform2fv(e.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),t.uniform1fv(e.uTaps,this.taps)},retrieveShader:function(t){var e=this.getFilterWindow(),r=this.type+"_"+e;if(!t.programCache.hasOwnProperty(r)){var i=this.generateShader(e);t.programCache[r]=this.createProgram(t.context,i)}return t.programCache[r]},getFilterWindow:function(){var t=this.tempScale;return Math.ceil(this.lanczosLobes/t)},getTaps:function(){for(var t=this.lanczosCreate(this.lanczosLobes),e=this.tempScale,r=this.getFilterWindow(),i=new Array(r),s=1;s<=r;s++)i[s-1]=t(s*e);return i},generateShader:function(t){for(var e=new Array(t),r=this.fragmentSourceTOP,i=1;i<=t;i++)e[i-1]=i+".0 * uDelta";return r+="uniform float uTaps["+t+"];\n",r+="void main() {\n",r+="  vec4 color = texture2D(uTexture, vTexCoord);\n",r+="  float sum = 1.0;\n",e.forEach((function(t,e){r+="  color += texture2D(uTexture, vTexCoord + "+t+") * uTaps["+e+"];\n",r+="  color += texture2D(uTexture, vTexCoord - "+t+") * uTaps["+e+"];\n",r+="  sum += 2.0 * uTaps["+e+"];\n"})),r+="  gl_FragColor = color / sum;\n",r+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(t){t.webgl?(t.passes++,this.width=t.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=t.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),t.destinationWidth=this.dW,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceWidth=t.destinationWidth,this.height=t.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),t.destinationHeight=this.dH,this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t),t.sourceHeight=t.destinationHeight):this.applyTo2d(t)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(t){return function(e){if(e>=t||e<=-t)return 0;if(e<1.1920929e-7&&e>-1.1920929e-7)return 1;var r=(e*=Math.PI)/t;return o(e)/e*o(r)/r}},applyTo2d:function(t){var e=t.imageData,r=this.scaleX,i=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/i;var s,a=e.width,o=e.height,l=n(a*r),c=n(o*i);"sliceHack"===this.resizeType?s=this.sliceByTwo(t,a,o,l,c):"hermite"===this.resizeType?s=this.hermiteFastResize(t,a,o,l,c):"bilinear"===this.resizeType?s=this.bilinearFiltering(t,a,o,l,c):"lanczos"===this.resizeType&&(s=this.lanczosResize(t,a,o,l,c)),t.imageData=s},sliceByTwo:function(t,r,s,a,n){var o,l,c=t.imageData,u=.5,d=!1,m=!1,h=r*u,p=s*u,f=e.filterBackend.resources,_=0,v=0,g=r,b=0;for(f.sliceByTwo||(f.sliceByTwo=document.createElement("canvas")),((o=f.sliceByTwo).width<1.5*r||o.height<s)&&(o.width=1.5*r,o.height=s),(l=o.getContext("2d")).clearRect(0,0,1.5*r,s),l.putImageData(c,0,0),a=i(a),n=i(n);!d||!m;)r=h,s=p,a<i(h*u)?h=i(h*u):(h=a,d=!0),n<i(p*u)?p=i(p*u):(p=n,m=!0),l.drawImage(o,_,v,r,s,g,b,h,p),_=g,v=b,b+=p;return l.getImageData(_,v,a,n)},lanczosResize:function(t,e,n,o,c){var u=t.imageData.data,d=t.ctx.createImageData(o,c),m=d.data,h=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,f=this.rcpScaleY,_=2/this.rcpScaleX,v=2/this.rcpScaleY,g=l(p*this.lanczosLobes/2),b=l(f*this.lanczosLobes/2),y={},x={},$={};return function t(l){var w,C,k,S,O,I,F,T,P,j,A;for(x.x=(l+.5)*p,$.x=i(x.x),w=0;w<c;w++){for(x.y=(w+.5)*f,$.y=i(x.y),O=0,I=0,F=0,T=0,P=0,C=$.x-g;C<=$.x+g;C++)if(!(C<0||C>=e)){j=i(1e3*a(C-x.x)),y[j]||(y[j]={});for(var D=$.y-b;D<=$.y+b;D++)D<0||D>=n||(A=i(1e3*a(D-x.y)),y[j][A]||(y[j][A]=h(s(r(j*_,2)+r(A*v,2))/1e3)),(k=y[j][A])>0&&(O+=k,I+=k*u[S=4*(D*e+C)],F+=k*u[S+1],T+=k*u[S+2],P+=k*u[S+3]))}m[S=4*(w*o+l)]=I/O,m[S+1]=F/O,m[S+2]=T/O,m[S+3]=P/O}return++l<o?t(l):d}(0)},bilinearFiltering:function(t,e,r,s,a){var n,o,l,c,u,d,m,h,p,f=0,_=this.rcpScaleX,v=this.rcpScaleY,g=4*(e-1),b=t.imageData.data,y=t.ctx.createImageData(s,a),x=y.data;for(l=0;l<a;l++)for(c=0;c<s;c++)for(u=_*c-(n=i(_*c)),d=v*l-(o=i(v*l)),p=4*(o*e+n),m=0;m<4;m++)h=b[p+m]*(1-u)*(1-d)+b[p+4+m]*u*(1-d)+b[p+g+m]*d*(1-u)+b[p+g+4+m]*u*d,x[f++]=h;return y},hermiteFastResize:function(t,e,r,n,o){for(var c=this.rcpScaleX,u=this.rcpScaleY,d=l(c/2),m=l(u/2),h=t.imageData.data,p=t.ctx.createImageData(n,o),f=p.data,_=0;_<o;_++)for(var v=0;v<n;v++){for(var g=4*(v+_*n),b=0,y=0,x=0,$=0,w=0,C=0,k=0,S=(_+.5)*u,O=i(_*u);O<(_+1)*u;O++)for(var I=a(S-(O+.5))/m,F=(v+.5)*c,T=I*I,P=i(v*c);P<(v+1)*c;P++){var j=a(F-(P+.5))/d,A=s(T+j*j);A>1&&A<-1||(b=2*A*A*A-3*A*A+1)>0&&(k+=b*h[(j=4*(P+O*e))+3],x+=b,h[j+3]<255&&(b=b*h[j+3]/250),$+=b*h[j],w+=b*h[j+1],C+=b*h[j+2],y+=b)}f[g]=$/y,f[g+1]=w/y,f[g+2]=C/y,f[g+3]=k/x}return p},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Contrast=i(r.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(0!==this.contrast){var e,r=t.imageData.data,i=r.length,s=Math.floor(255*this.contrast),a=259*(s+255)/(255*(259-s));for(e=0;e<i;e+=4)r[e]=a*(r[e]-128)+128,r[e+1]=a*(r[e+1]-128)+128,r[e+2]=a*(r[e+2]-128)+128}},getUniformLocations:function(t,e){return{uContrast:t.getUniformLocation(e,"uContrast")}},sendUniformData:function(t,e){t.uniform1f(e.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Saturation=i(r.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(0!==this.saturation){var e,r,i=t.imageData.data,s=i.length,a=-this.saturation;for(e=0;e<s;e+=4)r=Math.max(i[e],i[e+1],i[e+2]),i[e]+=r!==i[e]?(r-i[e])*a:0,i[e+1]+=r!==i[e+1]?(r-i[e+1])*a:0,i[e+2]+=r!==i[e+2]?(r-i[e+2])*a:0}},getUniformLocations:function(t,e){return{uSaturation:t.getUniformLocation(e,"uSaturation")}},sendUniformData:function(t,e){t.uniform1f(e.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Vibrance=i(r.BaseFilter,{type:"Vibrance",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uVibrance;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat max = max(color.r, max(color.g, color.b));\nfloat avg = (color.r + color.g + color.b) / 3.0;\nfloat amt = (abs(max - avg) * 2.0) * uVibrance;\ncolor.r += max != color.r ? (max - color.r) * amt : 0.00;\ncolor.g += max != color.g ? (max - color.g) * amt : 0.00;\ncolor.b += max != color.b ? (max - color.b) * amt : 0.00;\ngl_FragColor = color;\n}",vibrance:0,mainParameter:"vibrance",applyTo2d:function(t){if(0!==this.vibrance){var e,r,i,s,a=t.imageData.data,n=a.length,o=-this.vibrance;for(e=0;e<n;e+=4)r=Math.max(a[e],a[e+1],a[e+2]),i=(a[e]+a[e+1]+a[e+2])/3,s=2*Math.abs(r-i)/255*o,a[e]+=r!==a[e]?(r-a[e])*s:0,a[e+1]+=r!==a[e+1]?(r-a[e+1])*s:0,a[e+2]+=r!==a[e+2]?(r-a[e+2])*s:0}},getUniformLocations:function(t,e){return{uVibrance:t.getUniformLocation(e,"uVibrance")}},sendUniformData:function(t,e){t.uniform1f(e.uVibrance,-this.vibrance)}}),e.Image.filters.Vibrance.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Blur=i(r.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var r,i,s=t.filterBackend.resources,a=t.imageData.width,n=t.imageData.height;s.blurLayer1||(s.blurLayer1=e.util.createCanvasElement(),s.blurLayer2=e.util.createCanvasElement()),r=s.blurLayer1,i=s.blurLayer2,r.width===a&&r.height===n||(i.width=r.width=a,i.height=r.height=n);var o,l,c,u,d=r.getContext("2d"),m=i.getContext("2d"),h=15,p=.06*this.blur*.5;for(d.putImageData(t.imageData,0,0),m.clearRect(0,0,a,n),u=-15;u<=h;u++)c=p*(l=u/h)*a+(o=(Math.random()-.5)/4),m.globalAlpha=1-Math.abs(l),m.drawImage(r,c,o),d.drawImage(i,0,0),m.globalAlpha=1,m.clearRect(0,0,i.width,i.height);for(u=-15;u<=h;u++)c=p*(l=u/h)*n+(o=(Math.random()-.5)/4),m.globalAlpha=1-Math.abs(l),m.drawImage(r,o,c),d.drawImage(i,0,0),m.globalAlpha=1,m.clearRect(0,0,i.width,i.height);t.ctx.drawImage(r,0,0);var f=t.ctx.getImageData(0,0,r.width,r.height);return d.globalAlpha=1,d.clearRect(0,0,r.width,r.height),f},getUniformLocations:function(t,e){return{delta:t.getUniformLocation(e,"uDelta")}},sendUniformData:function(t,e){var r=this.chooseRightDelta();t.uniform2fv(e.delta,r)},chooseRightDelta:function(){var t,e=1,r=[0,0];return this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio),t=e*this.blur*.12,this.horizontal?r[0]=t:r[1]=t,r}}),r.Blur.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Gamma=i(r.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],r.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var e,r=t.imageData.data,i=this.gamma,s=r.length,a=1/i[0],n=1/i[1],o=1/i[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),e=0,s=256;e<s;e++)this.rVals[e]=255*Math.pow(e/255,a),this.gVals[e]=255*Math.pow(e/255,n),this.bVals[e]=255*Math.pow(e/255,o);for(e=0,s=r.length;e<s;e+=4)r[e]=this.rVals[r[e]],r[e+1]=this.gVals[r[e+1]],r[e+2]=this.bVals[r[e+2]]},getUniformLocations:function(t,e){return{uGamma:t.getUniformLocation(e,"uGamma")}},sendUniformData:function(t,e){t.uniform3fv(e.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.Composed=i(r.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach((function(e){e.applyTo(t)}))},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map((function(t){return t.toObject()}))})},isNeutralState:function(){return!this.subFilters.some((function(t){return!t.isNeutralState()}))}}),e.Image.filters.Composed.fromObject=function(t,r){var i=(t.subFilters||[]).map((function(t){return new e.Image.filters[t.type](t)})),s=new e.Image.filters.Composed({subFilters:i});return r&&r(s),s}}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.Image.filters,i=e.util.createClass;r.HueRotation=i(r.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,r=e.util.cos(t),i=e.util.sin(t),s=1/3,a=Math.sqrt(s)*i,n=1-r;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=r+n/3,this.matrix[1]=s*n-a,this.matrix[2]=s*n+a,this.matrix[5]=s*n+a,this.matrix[6]=r+s*n,this.matrix[7]=s*n-a,this.matrix[10]=s*n-a,this.matrix[11]=s*n+a,this.matrix[12]=r+s*n},isNeutralState:function(t){return this.calculateMatrix(),r.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),r.BaseFilter.prototype.applyTo.call(this,t)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject}(e),function(t){"use strict";var e=t.fabric||(t.fabric={}),r=e.util.object.clone;if(e.Text)e.warn("fabric.Text is already defined");else{var i="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(i),cacheProperties:e.Object.prototype.cacheProperties.concat(i),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,e){this.styles=e&&e.styles||{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",e),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var t=this.path;t&&(t.segmentsInfo=e.util.getPathSegmentsInfo(t.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,e,r,i,s,a,n,o=0,l=this._textLines.length;o<l;o++)if(("justify"===this.textAlign||o!==l-1&&!this.isEndOfWrapping(o))&&(i=0,s=this._textLines[o],(e=this.getLineWidth(o))<this.width&&(n=this.textLines[o].match(this._reSpacesAndTabs)))){r=n.length,t=(this.width-e)/r;for(var c=0,u=s.length;c<=u;c++)a=this.__charBounds[o][c],this._reSpaceAndTab.test(s[c])?(a.width+=t,a.kernedWidth+=t,a.left+=i,i+=t):a.left+=i}},isEndOfWrapping:function(t){return t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),e=this.fontSize;return t.width+=e*t.zoomX,t.height+=e*t.zoomY,t},_render:function(t){var e=this.path;e&&!e.isNotVisible()&&e._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){"stroke"===this.paintFirst?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,e,r){t.textBaseline="alphabetic",t.font=this._getFontDeclaration(e,r)},calcTextWidth:function(){for(var t=this.getLineWidth(0),e=1,r=this._textLines.length;e<r;e++){var i=this.getLineWidth(e);i>t&&(t=i)}return t},_renderTextLine:function(t,e,r,i,s,a){this._renderChars(t,e,r,i,s,a)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var e,r,i,s,a,n,o,l=t.fillStyle,c=this._getLeftOffset(),u=this._getTopOffset(),d=0,m=0,h=this.path,p=0,f=this._textLines.length;p<f;p++)if(e=this.getHeightOfLine(p),this.textBackgroundColor||this.styleHas("textBackgroundColor",p)){i=this._textLines[p],r=this._getLineLeftOffset(p),m=0,d=0,s=this.getValueOfPropertyAt(p,0,"textBackgroundColor");for(var _=0,v=i.length;_<v;_++)a=this.__charBounds[p][_],n=this.getValueOfPropertyAt(p,_,"textBackgroundColor"),h?(t.save(),t.translate(a.renderLeft,a.renderTop),t.rotate(a.angle),t.fillStyle=n,n&&t.fillRect(-a.width/2,-e/this.lineHeight*(1-this._fontSizeFraction),a.width,e/this.lineHeight),t.restore()):n!==s?(o=c+r+d,"rtl"===this.direction&&(o=this.width-o-m),t.fillStyle=s,s&&t.fillRect(o,u,m,e/this.lineHeight),d=a.left,m=a.width,s=n):m+=a.kernedWidth;n&&!h&&(o=c+r+d,"rtl"===this.direction&&(o=this.width-o-m),t.fillStyle=n,t.fillRect(o,u,m,e/this.lineHeight)),u+=e}else u+=e;t.fillStyle=l,this._removeShadow(t)}},getFontCache:function(t){var r=t.fontFamily.toLowerCase();e.charWidthsCache[r]||(e.charWidthsCache[r]={});var i=e.charWidthsCache[r],s=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return i[s]||(i[s]={}),i[s]},_measureChar:function(t,e,r,i){var s,a,n,o,l=this.getFontCache(e),c=r+t,u=this._getFontDeclaration(e)===this._getFontDeclaration(i),d=e.fontSize/this.CACHE_FONT_SIZE;if(r&&void 0!==l[r]&&(n=l[r]),void 0!==l[t]&&(o=s=l[t]),u&&void 0!==l[c]&&(o=(a=l[c])-n),void 0===s||void 0===n||void 0===a){var m=this.getMeasuringContext();this._setTextStyles(m,e,!0)}return void 0===s&&(o=s=m.measureText(t).width,l[t]=s),void 0===n&&u&&r&&(n=m.measureText(r).width,l[r]=n),u&&void 0===a&&(a=m.measureText(c).width,l[c]=a,o=a-n),{width:s*d,kernedWidth:o*d}},getHeightOfChar:function(t,e){return this.getValueOfPropertyAt(t,e,"fontSize")},measureLine:function(t){var e=this._measureLine(t);return 0!==this.charSpacing&&(e.width-=this._getWidthOfCharSpacing()),e.width<0&&(e.width=0),e},_measureLine:function(t){var r,i,s,a,n,o,l=0,c=this._textLines[t],u=new Array(c.length),d=0,m=this.path,h="right"===this.pathSide;for(this.__charBounds[t]=u,r=0;r<c.length;r++)i=c[r],a=this._getGraphemeBox(i,t,r,s),u[r]=a,l+=a.kernedWidth,s=i;if(u[r]={left:a?a.left+a.width:0,width:0,kernedWidth:0,height:this.fontSize},m){switch(o=m.segmentsInfo[m.segmentsInfo.length-1].length,(n=e.util.getPointOnPath(m.path,0,m.segmentsInfo)).x+=m.pathOffset.x,n.y+=m.pathOffset.y,this.textAlign){case"left":d=h?o-l:0;break;case"center":d=(o-l)/2;break;case"right":d=h?0:o-l}for(d+=this.pathStartOffset*(h?-1:1),r=h?c.length-1:0;h?r>=0:r<c.length;h?r--:r++)a=u[r],d>o?d%=o:d<0&&(d+=o),this._setGraphemeOnPath(d,a,n),d+=a.kernedWidth}return{width:l,numOfSpaces:0}},_setGraphemeOnPath:function(t,r,i){var s=t+r.kernedWidth/2,a=this.path,n=e.util.getPointOnPath(a.path,s,a.segmentsInfo);r.renderLeft=n.x-i.x,r.renderTop=n.y-i.y,r.angle=n.angle+("right"===this.pathSide?Math.PI:0)},_getGraphemeBox:function(t,e,r,i,s){var a,n=this.getCompleteStyleDeclaration(e,r),o=i?this.getCompleteStyleDeclaration(e,r-1):{},l=this._measureChar(t,n,i,o),c=l.kernedWidth,u=l.width;0!==this.charSpacing&&(u+=a=this._getWidthOfCharSpacing(),c+=a);var d={width:u,left:0,height:n.fontSize,kernedWidth:c,deltaY:n.deltaY};if(r>0&&!s){var m=this.__charBounds[e][r-1];d.left=m.left+m.width+l.kernedWidth-l.width}return d},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var e=this._textLines[t],r=this.getHeightOfChar(t,0),i=1,s=e.length;i<s;i++)r=Math.max(this.getHeightOfChar(t,i),r);return this.__lineHeights[t]=r*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,e=0,r=0,i=this._textLines.length;r<i;r++)t=this.getHeightOfLine(r),e+=r===i-1?t/this.lineHeight:t;return e},_getLeftOffset:function(){return"ltr"===this.direction?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,e){t.save();for(var r=0,i=this._getLeftOffset(),s=this._getTopOffset(),a=0,n=this._textLines.length;a<n;a++){var o=this.getHeightOfLine(a),l=o/this.lineHeight,c=this._getLineLeftOffset(a);this._renderTextLine(e,t,this._textLines[a],i+c,s+r+l,a),r+=o}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,e,r,i,s,a){var n,o,l,c,u,d=this.getHeightOfLine(a),m=-1!==this.textAlign.indexOf("justify"),h="",p=0,f=this.path,_=!m&&0===this.charSpacing&&this.isEmptyStyles(a)&&!f,v="ltr"===this.direction,g="ltr"===this.direction?1:-1;if(e.save(),s-=d*this._fontSizeFraction/this.lineHeight,_)return e.canvas.setAttribute("dir",v?"ltr":"rtl"),e.direction=v?"ltr":"rtl",e.textAlign=v?"left":"right",this._renderChar(t,e,a,0,r.join(""),i,s,d),void e.restore();for(var b=0,y=r.length-1;b<=y;b++)c=b===y||this.charSpacing||f,h+=r[b],l=this.__charBounds[a][b],0===p?(i+=g*(l.kernedWidth-l.width),p+=l.width):p+=l.kernedWidth,m&&!c&&this._reSpaceAndTab.test(r[b])&&(c=!0),c||(n=n||this.getCompleteStyleDeclaration(a,b),o=this.getCompleteStyleDeclaration(a,b+1),c=this._hasStyleChanged(n,o)),c&&(f?(e.save(),e.translate(l.renderLeft,l.renderTop),e.rotate(l.angle),this._renderChar(t,e,a,b,h,-p/2,0,d),e.restore()):(u=i,e.canvas.setAttribute("dir",v?"ltr":"rtl"),e.direction=v?"ltr":"rtl",e.textAlign=v?"left":"right",this._renderChar(t,e,a,b,h,u,s,d)),h="",n=o,i+=g*p,p=0);e.restore()},_applyPatternGradientTransformText:function(t){var r,i=e.util.createCanvasElement(),s=this.width+this.strokeWidth,a=this.height+this.strokeWidth;return i.width=s,i.height=a,(r=i.getContext("2d")).beginPath(),r.moveTo(0,0),r.lineTo(s,0),r.lineTo(s,a),r.lineTo(0,a),r.closePath(),r.translate(s/2,a/2),r.fillStyle=t.toLive(r),this._applyPatternGradientTransform(r,t),r.fill(),r.createPattern(i,"no-repeat")},handleFiller:function(t,e,r){var i,s;return r.toLive?"percentage"===r.gradientUnits||r.gradientTransform||r.patternTransform?(i=-this.width/2,s=-this.height/2,t.translate(i,s),t[e]=this._applyPatternGradientTransformText(r),{offsetX:i,offsetY:s}):(t[e]=r.toLive(t,this),this._applyPatternGradientTransform(t,r)):(t[e]=r,{offsetX:0,offsetY:0})},_setStrokeStyles:function(t,e){return t.lineWidth=e.strokeWidth,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",e.stroke)},_setFillStyles:function(t,e){return this.handleFiller(t,"fillStyle",e.fill)},_renderChar:function(t,e,r,i,s,a,n){var o,l,c=this._getStyleDeclaration(r,i),u=this.getCompleteStyleDeclaration(r,i),d="fillText"===t&&u.fill,m="strokeText"===t&&u.stroke&&u.strokeWidth;(m||d)&&(e.save(),d&&(o=this._setFillStyles(e,u)),m&&(l=this._setStrokeStyles(e,u)),e.font=this._getFontDeclaration(u),c&&c.textBackgroundColor&&this._removeShadow(e),c&&c.deltaY&&(n+=c.deltaY),d&&e.fillText(s,a-o.offsetX,n-o.offsetY),m&&e.strokeText(s,a-l.offsetX,n-l.offsetY),e.restore())},setSuperscript:function(t,e){return this._setScript(t,e,this.superscript)},setSubscript:function(t,e){return this._setScript(t,e,this.subscript)},_setScript:function(t,e,r){var i=this.get2DCursorLocation(t,!0),s=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),a=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),n={fontSize:s*r.size,deltaY:a+s*r.baseline};return this.setSelectionStyles(n,t,e),this},_hasStyleChanged:function(t,e){return t.fill!==e.fill||t.stroke!==e.stroke||t.strokeWidth!==e.strokeWidth||t.fontSize!==e.fontSize||t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight||t.fontStyle!==e.fontStyle||t.deltaY!==e.deltaY},_hasStyleChangedForSvg:function(t,e){return this._hasStyleChanged(t,e)||t.overline!==e.overline||t.underline!==e.underline||t.linethrough!==e.linethrough},_getLineLeftOffset:function(t){var e=this.getLineWidth(t),r=this.width-e,i=this.textAlign,s=this.direction,a=0,n=this.isEndOfWrapping(t);return"justify"===i||"justify-center"===i&&!n||"justify-right"===i&&!n||"justify-left"===i&&!n?0:("center"===i&&(a=r/2),"right"===i&&(a=r),"justify-center"===i&&(a=r/2),"justify-right"===i&&(a=r),"rtl"===s&&(a-=r),a)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){return this.__lineWidths[t]?this.__lineWidths[t]:(e=""===this._textLines[t]?0:this.measureLine(t).width,this.__lineWidths[t]=e,e);var e},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,e,r){var i=this._getStyleDeclaration(t,e);return i&&void 0!==i[r]?i[r]:this[r]},_renderTextDecoration:function(t,e){if(this[e]||this.styleHas(e)){for(var r,i,s,a,n,o,l,c,u,d,m,h,p,f,_,v,g=this._getLeftOffset(),b=this._getTopOffset(),y=this.path,x=this._getWidthOfCharSpacing(),$=this.offsets[e],w=0,C=this._textLines.length;w<C;w++)if(r=this.getHeightOfLine(w),this[e]||this.styleHas(e,w)){l=this._textLines[w],f=r/this.lineHeight,a=this._getLineLeftOffset(w),d=0,m=0,c=this.getValueOfPropertyAt(w,0,e),v=this.getValueOfPropertyAt(w,0,"fill"),u=b+f*(1-this._fontSizeFraction),i=this.getHeightOfChar(w,0),n=this.getValueOfPropertyAt(w,0,"deltaY");for(var k=0,S=l.length;k<S;k++)if(h=this.__charBounds[w][k],p=this.getValueOfPropertyAt(w,k,e),_=this.getValueOfPropertyAt(w,k,"fill"),s=this.getHeightOfChar(w,k),o=this.getValueOfPropertyAt(w,k,"deltaY"),y&&p&&_)t.save(),t.fillStyle=v,t.translate(h.renderLeft,h.renderTop),t.rotate(h.angle),t.fillRect(-h.kernedWidth/2,$*s+o,h.kernedWidth,this.fontSize/15),t.restore();else if((p!==c||_!==v||s!==i||o!==n)&&m>0){var O=g+a+d;"rtl"===this.direction&&(O=this.width-O-m),c&&v&&(t.fillStyle=v,t.fillRect(O,u+$*i+n,m,this.fontSize/15)),d=h.left,m=h.width,c=p,v=_,i=s,n=o}else m+=h.kernedWidth;O=g+a+d;"rtl"===this.direction&&(O=this.width-O-m),t.fillStyle=_,p&&_&&t.fillRect(O,u+$*i+n,m-x,this.fontSize/15),b+=r}else b+=r;this._removeShadow(t)}},_getFontDeclaration:function(t,r){var i=t||this,s=this.fontFamily,a=e.Text.genericFonts.indexOf(s.toLowerCase())>-1,n=void 0===s||s.indexOf("'")>-1||s.indexOf(",")>-1||s.indexOf('"')>-1||a?i.fontFamily:'"'+i.fontFamily+'"';return[e.isLikelyNode?i.fontWeight:i.fontStyle,e.isLikelyNode?i.fontStyle:i.fontWeight,r?this.CACHE_FONT_SIZE+"px":i.fontSize+"px",n].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var r=t.split(this._reNewline),i=new Array(r.length),s=["\n"],a=[],n=0;n<r.length;n++)i[n]=e.util.string.graphemeSplit(r[n]),a=a.concat(i[n],s);return a.pop(),{_unwrappedLines:i,lines:r,graphemeText:a,graphemeLines:i}},toObject:function(t){var e=i.concat(t),s=this.callSuper("toObject",e);return s.styles=r(this.styles,!0),s.path&&(s.path=this.path.toObject()),s},set:function(t,e){this.callSuper("set",t,e);var r=!1,i=!1;if("object"==typeof t)for(var s in t)"path"===s&&this.setPathInfo(),r=r||-1!==this._dimensionAffectingProps.indexOf(s),i=i||"path"===s;else r=-1!==this._dimensionAffectingProps.indexOf(t),i="path"===t;return i&&this.setPathInfo(),r&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(t,i,s){if(!t)return i(null);var a=e.parseAttributes(t,e.Text.ATTRIBUTE_NAMES),n=a.textAnchor||"left";if((s=e.util.object.extend(s?r(s):{},a)).top=s.top||0,s.left=s.left||0,a.textDecoration){var o=a.textDecoration;-1!==o.indexOf("underline")&&(s.underline=!0),-1!==o.indexOf("overline")&&(s.overline=!0),-1!==o.indexOf("line-through")&&(s.linethrough=!0),delete s.textDecoration}"dx"in a&&(s.left+=a.dx),"dy"in a&&(s.top+=a.dy),"fontSize"in s||(s.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var l="";"textContent"in t?l=t.textContent:"firstChild"in t&&null!==t.firstChild&&"data"in t.firstChild&&null!==t.firstChild.data&&(l=t.firstChild.data),l=l.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var c=s.strokeWidth;s.strokeWidth=0;var u=new e.Text(l,s),d=u.getScaledHeight()/u.height,m=((u.height+u.strokeWidth)*u.lineHeight-u.height)*d,h=u.getScaledHeight()+m,p=0;"center"===n&&(p=u.getScaledWidth()/2),"right"===n&&(p=u.getScaledWidth()),u.set({left:u.left-p,top:u.top-(h-u.fontSize*(.07+u._fontSizeFraction))/u.lineHeight,strokeWidth:void 0!==c?c:1}),i(u)},e.Text.fromObject=function(t,i){var s=r(t),a=t.path;return delete s.path,e.Object._fromObject("Text",s,(function(t){a?e.Object._fromObject("Path",a,(function(e){t.set("path",e),i(t)}),"path"):i(t)}),"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)}}(e),S.util.object.extend(S.Text.prototype,{isEmptyStyles:function(t){if(!this.styles)return!0;if(void 0!==t&&!this.styles[t])return!0;var e=void 0===t?this.styles:{line:this.styles[t]};for(var r in e)for(var i in e[r])for(var s in e[r][i])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||""===t)return!1;if(void 0!==e&&!this.styles[e])return!1;var r=void 0===e?this.styles:{0:this.styles[e]};for(var i in r)for(var s in r[i])if(void 0!==r[i][s][t])return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||""===t)return!1;var e,r,i=this.styles,s=0,a=!0,n=0;for(var o in i){for(var l in e=0,i[o]){var c;s++,(c=i[o][l]).hasOwnProperty(t)?(r?c[t]!==r&&(a=!1):r=c[t],c[t]===this[t]&&delete c[t]):a=!1,0!==Object.keys(c).length?e++:delete i[o][l]}0===e&&delete i[o]}for(var u=0;u<this._textLines.length;u++)n+=this._textLines[u].length;a&&s===n&&(this[t]=r,this.removeStyle(t))},removeStyle:function(t){if(this.styles&&t&&""!==t){var e,r,i,s=this.styles;for(r in s){for(i in e=s[r])delete e[i][t],0===Object.keys(e[i]).length&&delete e[i];0===Object.keys(e).length&&delete s[r]}}},_extendStyles:function(t,e){var r=this.get2DCursorLocation(t);this._getLineStyle(r.lineIndex)||this._setLineStyle(r.lineIndex),this._getStyleDeclaration(r.lineIndex,r.charIndex)||this._setStyleDeclaration(r.lineIndex,r.charIndex,{}),S.util.object.extend(this._getStyleDeclaration(r.lineIndex,r.charIndex),e)},get2DCursorLocation:function(t,e){void 0===t&&(t=this.selectionStart);for(var r=e?this._unwrappedTextLines:this._textLines,i=r.length,s=0;s<i;s++){if(t<=r[s].length)return{lineIndex:s,charIndex:t};t-=r[s].length+this.missingNewlineOffset(s)}return{lineIndex:s-1,charIndex:r[s-1].length<t?r[s-1].length:t}},getSelectionStyles:function(t,e,r){void 0===t&&(t=this.selectionStart||0),void 0===e&&(e=this.selectionEnd||t);for(var i=[],s=t;s<e;s++)i.push(this.getStyleAtPosition(s,r));return i},getStyleAtPosition:function(t,e){var r=this.get2DCursorLocation(t);return(e?this.getCompleteStyleDeclaration(r.lineIndex,r.charIndex):this._getStyleDeclaration(r.lineIndex,r.charIndex))||{}},setSelectionStyles:function(t,e,r){void 0===e&&(e=this.selectionStart||0),void 0===r&&(r=this.selectionEnd||e);for(var i=e;i<r;i++)this._extendStyles(i,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var r=this.styles&&this.styles[t];return r?r[e]:null},getCompleteStyleDeclaration:function(t,e){for(var r,i=this._getStyleDeclaration(t,e)||{},s={},a=0;a<this._styleProperties.length;a++)s[r=this._styleProperties[a]]=void 0===i[r]?this[r]:i[r];return s},_setStyleDeclaration:function(t,e,r){this.styles[t][e]=r},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}}),function(){function t(t){t.textDecoration&&(t.textDecoration.indexOf("underline")>-1&&(t.underline=!0),t.textDecoration.indexOf("line-through")>-1&&(t.linethrough=!0),t.textDecoration.indexOf("overline")>-1&&(t.overline=!0),delete t.textDecoration)}S.IText=S.util.createClass(S.Text,S.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(t,e){this.callSuper("initialize",t,e),this.initBehavior()},setSelectionStart:function(t){t=Math.max(t,0),this._updateAndFire("selectionStart",t)},setSelectionEnd:function(t){t=Math.min(t,this.text.length),this._updateAndFire("selectionEnd",t)},_updateAndFire:function(t,e){this[t]!==e&&(this._fireSelectionChanged(),this[t]=e),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(t){this.clearContextTop(),this.callSuper("render",t),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(t){this.callSuper("_render",t)},clearContextTop:function(t){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this.canvas.contextTop,r=this.canvas.viewportTransform;e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(e),this._clearTextArea(e),t||e.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this._getCursorBoundaries(),e=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(t,e):this.renderSelection(t,e),e.restore()}},_clearTextArea:function(t){var e=this.width+4,r=this.height+4;t.clearRect(-e/2,-r/2,e,r)},_getCursorBoundaries:function(t){void 0===t&&(t=this.selectionStart);var e=this._getLeftOffset(),r=this._getTopOffset(),i=this._getCursorBoundariesOffsets(t);return{left:e,top:r,leftOffset:i.left,topOffset:i.top}},_getCursorBoundariesOffsets:function(t){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var e,r,i,s,a=0,n=0,o=this.get2DCursorLocation(t);i=o.charIndex,r=o.lineIndex;for(var l=0;l<r;l++)a+=this.getHeightOfLine(l);e=this._getLineLeftOffset(r);var c=this.__charBounds[r][i];return c&&(n=c.left),0!==this.charSpacing&&i===this._textLines[r].length&&(n-=this._getWidthOfCharSpacing()),s={top:a,left:e+(n>0?n:0)},"rtl"===this.direction&&(s.left*=-1),this.cursorOffsetCache=s,this.cursorOffsetCache},renderCursor:function(t,e){var r=this.get2DCursorLocation(),i=r.lineIndex,s=r.charIndex>0?r.charIndex-1:0,a=this.getValueOfPropertyAt(i,s,"fontSize"),n=this.scaleX*this.canvas.getZoom(),o=this.cursorWidth/n,l=t.topOffset,c=this.getValueOfPropertyAt(i,s,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-a*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(t,e),e.fillStyle=this.cursorColor||this.getValueOfPropertyAt(i,s,"fill"),e.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-o/2,l+t.top+c,o,a)},renderSelection:function(t,e){for(var r=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,i=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=-1!==this.textAlign.indexOf("justify"),a=this.get2DCursorLocation(r),n=this.get2DCursorLocation(i),o=a.lineIndex,l=n.lineIndex,c=a.charIndex<0?0:a.charIndex,u=n.charIndex<0?0:n.charIndex,d=o;d<=l;d++){var m,h=this._getLineLeftOffset(d)||0,p=this.getHeightOfLine(d),f=0,_=0;if(d===o&&(f=this.__charBounds[o][c].left),d>=o&&d<l)_=s&&!this.isEndOfWrapping(d)?this.width:this.getLineWidth(d)||5;else if(d===l)if(0===u)_=this.__charBounds[l][u].left;else{var v=this._getWidthOfCharSpacing();_=this.__charBounds[l][u-1].left+this.__charBounds[l][u-1].width-v}m=p,(this.lineHeight<1||d===l&&this.lineHeight>1)&&(p/=this.lineHeight);var g=t.left+h+f,b=_-f,y=p,x=0;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",y=1,x=p):e.fillStyle=this.selectionColor,"rtl"===this.direction&&(g=this.width-g-b),e.fillRect(g,t.top+t.topOffset+x,b,y),t.topOffset+=m}},getCurrentCharFontSize:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fontSize")},getCurrentCharColor:function(){var t=this._getCurrentCharIndex();return this.getValueOfPropertyAt(t.l,t.c,"fill")},_getCurrentCharIndex:function(){var t=this.get2DCursorLocation(this.selectionStart,!0),e=t.charIndex>0?t.charIndex-1:0;return{l:t.lineIndex,c:e}}}),S.IText.fromObject=function(e,r){if(t(e),e.styles)for(var i in e.styles)for(var s in e.styles[i])t(e.styles[i][s]);S.Object._fromObject("IText",e,r,"text")}}(),$=S.util.object.clone,S.util.object.extend(S.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var t=this;this.on("added",(function(){var e=t.canvas;e&&(e._hasITextHandlers||(e._hasITextHandlers=!0,t._initCanvasHandlers(e)),e._iTextInstances=e._iTextInstances||[],e._iTextInstances.push(t))}))},initRemovedHandler:function(){var t=this;this.on("removed",(function(){var e=t.canvas;e&&(e._iTextInstances=e._iTextInstances||[],S.util.removeFromArray(e._iTextInstances,t),0===e._iTextInstances.length&&(e._hasITextHandlers=!1,t._removeCanvasHandlers(e)))}))},_initCanvasHandlers:function(t){t._mouseUpITextHandler=function(){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.__isMousedown=!1}))},t.on("mouse:up",t._mouseUpITextHandler)},_removeCanvasHandlers:function(t){t.off("mouse:up",t._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(t,e,r,i){var s;return s={isAborted:!1,abort:function(){this.isAborted=!0}},t.animate("_currentCursorOpacity",e,{duration:r,onComplete:function(){s.isAborted||t[i]()},onChange:function(){t.canvas&&t.selectionStart===t.selectionEnd&&t.renderCursorOrSelection()},abort:function(){return s.isAborted}}),s},_onTickComplete:function(){var t=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout((function(){t._currentTickCompleteState=t._animateCursor(t,0,this.cursorDuration/2,"_tick")}),100)},initDelayedCursor:function(t){var e=this,r=t?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout((function(){e._tick()}),r)},abortCursorAnimation:function(){var t=this._currentTickState||this._currentTickCompleteState,e=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,t&&e&&e.clearContext(e.contextTop||e.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(t){var e=0,r=t-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)e++,r--;for(;/\S/.test(this._text[r])&&r>-1;)e++,r--;return t-e},findWordBoundaryRight:function(t){var e=0,r=t;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)e++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)e++,r++;return t+e},findLineBoundaryLeft:function(t){for(var e=0,r=t-1;!/\n/.test(this._text[r])&&r>-1;)e++,r--;return t-e},findLineBoundaryRight:function(t){for(var e=0,r=t;!/\n/.test(this._text[r])&&r<this._text.length;)e++,r++;return t+e},searchWordBoundary:function(t,e){for(var r=this._text,i=this._reSpace.test(r[t])?t-1:t,s=r[i],a=S.reNonWord;!a.test(s)&&i>0&&i<r.length;)s=r[i+=e];return a.test(s)&&(i+=1===e?0:1),i},selectWord:function(t){t=t||this.selectionStart;var e=this.searchWordBoundary(t,-1),r=this.searchWordBoundary(t,1);this.selectionStart=e,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(t){t=t||this.selectionStart;var e=this.findLineBoundaryLeft(t),r=this.findLineBoundaryRight(t);return this.selectionStart=e,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(t){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(t),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(t){t._iTextInstances&&t._iTextInstances.forEach((function(t){t.selected=!1,t.isEditing&&t.exitEditing()}))},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(t){if(this.__isMousedown&&this.isEditing){var e=this.getSelectionStartFromPointer(t.e),r=this.selectionStart,i=this.selectionEnd;(e===this.__selectionStartOnMouseDown&&r!==i||r!==e&&i!==e)&&(e>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=e):(this.selectionStart=e,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===i||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(t,e,r){var i=r.slice(0,t),s=S.util.string.graphemeSplit(i).length;if(t===e)return{selectionStart:s,selectionEnd:s};var a=r.slice(t,e);return{selectionStart:s,selectionEnd:s+S.util.string.graphemeSplit(a).length}},fromGraphemeToStringSelection:function(t,e,r){var i=r.slice(0,t).join("").length;return t===e?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+r.slice(t,e).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var t=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=t.selectionStart,this.hiddenTextarea.selectionEnd=t.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var t=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var t=this._calcTextareaPosition();this.hiddenTextarea.style.left=t.left,this.hiddenTextarea.style.top=t.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var t=this.inCompositionMode?this.compositionStart:this.selectionStart,e=this._getCursorBoundaries(t),r=this.get2DCursorLocation(t),i=r.lineIndex,s=r.charIndex,a=this.getValueOfPropertyAt(i,s,"fontSize")*this.lineHeight,n=e.leftOffset,o=this.calcTransformMatrix(),l={x:e.left+n,y:e.top+e.topOffset+a},c=this.canvas.getRetinaScaling(),u=this.canvas.upperCanvasEl,d=u.width/c,m=u.height/c,h=d-a,p=m-a,f=u.clientWidth/d,_=u.clientHeight/m;return l=S.util.transformPoint(l,o),(l=S.util.transformPoint(l,this.canvas.viewportTransform)).x*=f,l.y*=_,l.x<0&&(l.x=0),l.x>h&&(l.x=h),l.y<0&&(l.y=0),l.y>p&&(l.y=p),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var t=this._textBeforeEdit!==this.text,e=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),t&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),t&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var t in this.styles)this._textLines[t]||delete this.styles[t]},removeStyleFromTo:function(t,e){var r,i,s=this.get2DCursorLocation(t,!0),a=this.get2DCursorLocation(e,!0),n=s.lineIndex,o=s.charIndex,l=a.lineIndex,c=a.charIndex;if(n!==l){if(this.styles[n])for(r=o;r<this._unwrappedTextLines[n].length;r++)delete this.styles[n][r];if(this.styles[l])for(r=c;r<this._unwrappedTextLines[l].length;r++)(i=this.styles[l][r])&&(this.styles[n]||(this.styles[n]={}),this.styles[n][o+r-c]=i);for(r=n+1;r<=l;r++)delete this.styles[r];this.shiftLineStyles(l,n-l)}else if(this.styles[n]){i=this.styles[n];var u,d,m=c-o;for(r=o;r<c;r++)delete i[r];for(d in this.styles[n])(u=parseInt(d,10))>=c&&(i[u-m]=i[d],delete i[d])}},shiftLineStyles:function(t,e){var r=$(this.styles);for(var i in this.styles){var s=parseInt(i,10);s>t&&(this.styles[s+e]=r[s],r[s-e]||delete this.styles[s])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(t,e,r,i){var s,a={},n=!1,o=this._unwrappedTextLines[t].length===e;for(var l in r||(r=1),this.shiftLineStyles(t,r),this.styles[t]&&(s=this.styles[t][0===e?e:e-1]),this.styles[t]){var c=parseInt(l,10);c>=e&&(n=!0,a[c-e]=this.styles[t][l],o&&0===e||delete this.styles[t][l])}var u=!1;for(n&&!o&&(this.styles[t+r]=a,u=!0),u&&r--;r>0;)i&&i[r-1]?this.styles[t+r]={0:$(i[r-1])}:s?this.styles[t+r]={0:$(s)}:delete this.styles[t+r],r--;this._forceClearCache=!0},insertCharStyleObject:function(t,e,r,i){this.styles||(this.styles={});var s=this.styles[t],a=s?$(s):{};for(var n in r||(r=1),a){var o=parseInt(n,10);o>=e&&(s[o+r]=a[o],a[o-r]||delete s[o])}if(this._forceClearCache=!0,i)for(;r--;)Object.keys(i[r]).length&&(this.styles[t]||(this.styles[t]={}),this.styles[t][e+r]=$(i[r]));else if(s)for(var l=s[e?e-1:1];l&&r--;)this.styles[t][e+r]=$(l)},insertNewStyleBlock:function(t,e,r){for(var i=this.get2DCursorLocation(e,!0),s=[0],a=0,n=0;n<t.length;n++)"\n"===t[n]?s[++a]=0:s[a]++;for(s[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,s[0],r),r=r&&r.slice(s[0]+1)),a&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+s[0],a),n=1;n<a;n++)s[n]>0?this.insertCharStyleObject(i.lineIndex+n,0,s[n],r):r&&(this.styles[i.lineIndex+n][0]=r[0]),r=r&&r.slice(s[n]+1);s[n]>0&&this.insertCharStyleObject(i.lineIndex+n,0,s[n],r)},setSelectionStartEndWithShift:function(t,e,r){r<=t?(e===t?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=t),this.selectionStart=r):r>t&&r<e?"right"===this._selectionDirection?this.selectionEnd=r:this.selectionStart=r:(e===t?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=e),this.selectionEnd=r)},setSelectionInBoundaries:function(){var t=this.text.length;this.selectionStart>t?this.selectionStart=t:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>t?this.selectionEnd=t:this.selectionEnd<0&&(this.selectionEnd=0)}}),S.util.object.extend(S.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))},tripleClickHandler:function(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&1!==t.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&1!==t.e.button)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),r=this.selectionStart,i=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(r,i,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e,r=this.getLocalPointer(t),i=0,s=0,a=0,n=0,o=0,l=0,c=this._textLines.length;l<c&&a<=r.y;l++)a+=this.getHeightOfLine(l)*this.scaleY,o=l,l>0&&(n+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));s=this._getLineLeftOffset(o)*this.scaleX,e=this._textLines[o],"rtl"===this.direction&&(r.x=this.width*this.scaleX-r.x+s);for(var u=0,d=e.length;u<d&&(i=s,(s+=this.__charBounds[o][u].kernedWidth*this.scaleX)<=r.x);u++)n++;return this._getNewSelectionStartFromOffset(r,i,s,n,d)},_getNewSelectionStartFromOffset:function(t,e,r,i,s){var a=t.x-e,n=r-t.x,o=i+(n>a||n<0?0:1);return this.flipX&&(o=s-o),o>this._text.length&&(o=this._text.length),o}}),S.util.object.extend(S.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=S.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; paddingtop: "+t.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):S.document.body.appendChild(this.hiddenTextarea),S.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),S.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),S.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),S.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),S.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),S.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(S.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){var e="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else{if(!(t.keyCode in this.ctrlKeysMapDown)||!t.ctrlKey&&!t.metaKey)return;this[this.ctrlKeysMapDown[t.keyCode]](t)}t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey)&&(this[this.ctrlKeysMapUp[t.keyCode]](t),t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),this.isEditing){var r,i,s,a,n,o=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,l=this._text.length,c=o.length,u=c-l,d=this.selectionStart,m=this.selectionEnd,h=d!==m;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var p=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),f=d>p.selectionStart;h?(r=this._text.slice(d,m),u+=m-d):c<l&&(r=f?this._text.slice(m+u,m):this._text.slice(d,d-u)),i=o.slice(p.selectionEnd-u,p.selectionEnd),r&&r.length&&(i.length&&(s=this.getSelectionStyles(d,d+1,!1),s=i.map((function(){return s[0]}))),h?(a=d,n=m):f?(a=m-r.length,n=m):(a=m,n=m+r.length),this.removeStyleFromTo(a,n)),i.length&&(e&&i.join("")===S.copiedText&&!S.disableStyleCopyPaste&&(s=S.copiedTextStyle),this.insertNewStyleBlock(i,d,s)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(S.copiedText=this.getSelectedText(),S.disableStyleCopyPaste?S.copiedTextStyle=null:S.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||S.window.clipboardData},_getWidthBeforeCursor:function(t,e){var r,i=this._getLineLeftOffset(t);return e>0&&(i+=(r=this.__charBounds[t][e-1]).left+r.width),i},getDownCursorOffset:function(t,e){var r=this._getSelectionForOffset(t,e),i=this.get2DCursorLocation(r),s=i.lineIndex;if(s===this._textLines.length-1||t.metaKey||34===t.keyCode)return this._text.length-r;var a=i.charIndex,n=this._getWidthBeforeCursor(s,a),o=this._getIndexOnLine(s+1,n);return this._textLines[s].slice(a).length+o+1+this.missingNewlineOffset(s)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var r=this._getSelectionForOffset(t,e),i=this.get2DCursorLocation(r),s=i.lineIndex;if(0===s||t.metaKey||33===t.keyCode)return-r;var a=i.charIndex,n=this._getWidthBeforeCursor(s,a),o=this._getIndexOnLine(s-1,n),l=this._textLines[s].slice(0,a),c=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+o-l.length+(1-c)},_getIndexOnLine:function(t,e){for(var r,i,s=this._textLines[t],a=this._getLineLeftOffset(t),n=0,o=0,l=s.length;o<l;o++)if((a+=r=this.__charBounds[t][o].width)>e){i=!0;var c=a-r,u=a,d=Math.abs(c-e);n=Math.abs(u-e)<d?o:o-1;break}return i||(n=s.length-1),n},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var r=this["get"+t+"CursorOffset"](e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),0!==r&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e="left"===this._selectionDirection?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),0!==t},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),0!==t},moveCursorLeft:function(t){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,r){var i;if(t.altKey)i=this["findWordBoundary"+r](this[e]);else{if(!t.metaKey&&35!==t.keyCode&&36!==t.keyCode)return this[e]+="Left"===r?-1:1,!0;i=this["findLineBoundary"+r](this[e])}if(void 0!==typeof i&&this[e]!==i)return this[e]=i,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(t,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(t,"selectionStart")):void 0},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var r="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?r+="Shift":r+="outShift",this[r](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(t,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(t,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){void 0===e&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,r,i){void 0===i&&(i=r),i>r&&this.removeStyleFromTo(r,i);var s=S.util.string.graphemeSplit(t);this.insertNewStyleBlock(s,r,e),this._text=[].concat(this._text.slice(0,r),s,this._text.slice(i)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),w=S.util.toFixed,C=/  +/g,S.util.object.extend(S.Text.prototype,{_toSVG:function(){var t=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(t.textTop,t.textLeft);return this._wrapSVGTextAndBg(e)},toSVG:function(t){return this._createBaseSVGMarkup(this._toSVG(),{reviver:t,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(t){var e=this.getSvgTextDecoration(this);return[t.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",e?'text-decoration="'+e+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(t,e){var r,i=[],s=[],a=t;this._setSVGBg(s);for(var n=0,o=this._textLines.length;n<o;n++)r=this._getLineLeftOffset(n),(this.textBackgroundColor||this.styleHas("textBackgroundColor",n))&&this._setSVGTextLineBg(s,n,e+r,a),this._setSVGTextLineText(i,n,e+r,a),a+=this.getHeightOfLine(n);return{textSpans:i,textBgRects:s}},_createTextCharSpan:function(t,e,r,i){var s=t!==t.trim()||t.match(C),a=this.getSvgSpanStyles(e,s),n=a?'style="'+a+'"':"",o=e.deltaY,l="",c=S.Object.NUM_FRACTION_DIGITS;return o&&(l=' dy="'+w(o,c)+'" '),['<tspan x="',w(r,c),'" y="',w(i,c),'" ',l,n,">",S.util.string.escapeXml(t),"</tspan>"].join("")},_setSVGTextLineText:function(t,e,r,i){var s,a,n,o,l,c=this.getHeightOfLine(e),u=-1!==this.textAlign.indexOf("justify"),d="",m=0,h=this._textLines[e];i+=c*(1-this._fontSizeFraction)/this.lineHeight;for(var p=0,f=h.length-1;p<=f;p++)l=p===f||this.charSpacing,d+=h[p],n=this.__charBounds[e][p],0===m?(r+=n.kernedWidth-n.width,m+=n.width):m+=n.kernedWidth,u&&!l&&this._reSpaceAndTab.test(h[p])&&(l=!0),l||(s=s||this.getCompleteStyleDeclaration(e,p),a=this.getCompleteStyleDeclaration(e,p+1),l=this._hasStyleChangedForSvg(s,a)),l&&(o=this._getStyleDeclaration(e,p)||{},t.push(this._createTextCharSpan(d,o,r,i)),d="",s=a,r+=m,m=0)},_pushTextBgRect:function(t,e,r,i,s,a){var n=S.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(e),' x="',w(r,n),'" y="',w(i,n),'" width="',w(s,n),'" height="',w(a,n),'"></rect>\n')},_setSVGTextLineBg:function(t,e,r,i){for(var s,a,n=this._textLines[e],o=this.getHeightOfLine(e)/this.lineHeight,l=0,c=0,u=this.getValueOfPropertyAt(e,0,"textBackgroundColor"),d=0,m=n.length;d<m;d++)s=this.__charBounds[e][d],(a=this.getValueOfPropertyAt(e,d,"textBackgroundColor"))!==u?(u&&this._pushTextBgRect(t,u,r+c,i,l,o),c=s.left,l=s.width,u=a):l+=s.kernedWidth;a&&this._pushTextBgRect(t,a,r+c,i,l,o)},_getFillAttributes:function(t){var e=t&&"string"==typeof t?new S.Color(t):"";return e&&e.getSource()&&1!==e.getAlpha()?'opacity="'+e.getAlpha()+'" fill="'+e.setAlpha(1).toRgb()+'"':'fill="'+t+'"'},_getSVGLineTopOffset:function(t){for(var e,r=0,i=0;i<t;i++)r+=this.getHeightOfLine(i);return e=this.getHeightOfLine(i),{lineTop:r,offset:(this._fontSizeMult-this._fontSizeFraction)*e/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(t){return S.Object.prototype.getSvgStyles.call(this,t)+" white-space: pre;"}}),function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(t){for(var e=0,r=0,i=0,s={},a=0;a<t.graphemeLines.length;a++)"\n"===t.graphemeText[i]&&a>0?(r=0,i++,e++):!this.splitByGrapheme&&this._reSpaceAndTab.test(t.graphemeText[i])&&a>0&&(r++,i++),s[a]={line:e,offset:r},i+=t.graphemeLines[a].length,r+=t.graphemeLines[a].length;return s},styleHas:function(t,r){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[r];i&&(r=i.line)}return e.Text.prototype.styleHas.call(this,t,r)},isEmptyStyles:function(t){if(!this.styles)return!0;var e,r,i=0,s=!1,a=this._styleMap[t],n=this._styleMap[t+1];for(var o in a&&(t=a.line,i=a.offset),n&&(s=n.line===t,e=n.offset),r=void 0===t?this.styles:{line:this.styles[t]})for(var l in r[o])if(l>=i&&(!s||l<e))for(var c in r[o][l])return!1;return!0},_getStyleDeclaration:function(t,e){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[t];if(!r)return null;t=r.line,e=r.offset+e}return this.callSuper("_getStyleDeclaration",t,e)},_setStyleDeclaration:function(t,e,r){var i=this._styleMap[t];t=i.line,e=i.offset+e,this.styles[t][e]=r},_deleteStyleDeclaration:function(t,e){var r=this._styleMap[t];t=r.line,e=r.offset+e,delete this.styles[t][e]},_getLineStyle:function(t){var e=this._styleMap[t];return!!this.styles[e.line]},_setLineStyle:function(t){var e=this._styleMap[t];this.styles[e.line]={}},_wrapText:function(t,e){var r,i=[];for(this.isWrapping=!0,r=0;r<t.length;r++)i=i.concat(this._wrapLine(t[r],r,e));return this.isWrapping=!1,i},_measureWord:function(t,e,r){var i,s=0;r=r||0;for(var a=0,n=t.length;a<n;a++){s+=this._getGraphemeBox(t[a],e,a+r,i,true).kernedWidth,i=t[a]}return s},_wrapLine:function(t,r,i,s){var a=0,n=this.splitByGrapheme,o=[],l=[],c=n?e.util.string.graphemeSplit(t):t.split(this._wordJoiners),u="",d=0,m=n?"":" ",h=0,p=0,f=0,_=!0,v=this._getWidthOfCharSpacing();s=s||0;0===c.length&&c.push([]),i-=s;for(var g=0;g<c.length;g++)u=n?c[g]:e.util.string.graphemeSplit(c[g]),h=this._measureWord(u,r,d),d+=u.length,(a+=p+h-v)>i&&!_?(o.push(l),l=[],a=h,_=!0):a+=v,_||n||l.push(m),l=l.concat(u),p=n?0:this._measureWord([m],r,d),d++,_=!1,h>f&&(f=h);return g&&o.push(l),f+s>this.dynamicMinWidth&&(this.dynamicMinWidth=f-v+s),o},isEndOfWrapping:function(t){return!this._styleMap[t+1]||this._styleMap[t+1].line!==this._styleMap[t].line},missingNewlineOffset:function(t){return this.splitByGrapheme?this.isEndOfWrapping(t)?1:0:1},_splitTextIntoLines:function(t){for(var r=e.Text.prototype._splitTextIntoLines.call(this,t),i=this._wrapText(r.lines,this.width),s=new Array(i.length),a=0;a<i.length;a++)s[a]=i[a].join("");return r.lines=s,r.graphemeLines=i,r},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var t={};for(var e in this._styleMap)this._textLines[e]&&(t[this._styleMap[e].line]=1);for(var e in this.styles)t[e]||delete this.styles[e]},toObject:function(t){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(t))}}),e.Textbox.fromObject=function(t,r){return e.Object._fromObject("Textbox",t,r,"text")}}(e),function(){var t=S.controlsUtils,e=t.scaleSkewCursorStyleHandler,r=t.scaleCursorStyleHandler,i=t.scalingEqually,s=t.scalingYOrSkewingX,a=t.scalingXOrSkewingY,n=t.scaleOrSkewActionName,o=S.Object.prototype.controls;if(o.ml=new S.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:a,getActionName:n}),o.mr=new S.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:a,getActionName:n}),o.mb=new S.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:s,getActionName:n}),o.mt=new S.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:s,getActionName:n}),o.tl=new S.Control({x:-.5,y:-.5,cursorStyleHandler:r,actionHandler:i}),o.tr=new S.Control({x:.5,y:-.5,cursorStyleHandler:r,actionHandler:i}),o.bl=new S.Control({x:-.5,y:.5,cursorStyleHandler:r,actionHandler:i}),o.br=new S.Control({x:.5,y:.5,cursorStyleHandler:r,actionHandler:i}),o.mtr=new S.Control({x:0,y:-.5,actionHandler:t.rotationWithSnapping,cursorStyleHandler:t.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),S.Textbox){var l=S.Textbox.prototype.controls={};l.mtr=o.mtr,l.tr=o.tr,l.br=o.br,l.tl=o.tl,l.bl=o.bl,l.mt=o.mt,l.mb=o.mb,l.mr=new S.Control({x:.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),l.ml=new S.Control({x:-.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}}()},70273:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".scroll--indicator-wrapper[data-v-98931c06]{width:100%}.scroll--indicator[data-v-98931c06]{height:100%;width:0}",""]);const a=s},70177:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".user-card{margin:0 auto 16px;max-width:250px;min-width:250px;padding-top:16px;text-align:center;width:250px}.user-card .qr-code{margin:16px auto 0;max-width:180px}",""]);const a=s},52080:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".stripe-card .StripeElement{border:1px solid #dcdee2!important;border-radius:4px!important;box-shadow:none!important}",""]);const a=s},5423:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".sr-info{background:#eee;border-radius:5px;padding:8px 16px}.sr-error{background:#ffafaf;color:#af0000}",""]);const a=s},51804:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".register .table-wrapper{padding:0!important;width:100%}.register .table td,.register .table th{border-bottom:1px solid #e8eaec;padding:5px 10px}",""]);const a=s},66489:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".flex-gap{--gap:12px;align-items:center;display:flex;display:inline-flex;margin:calc(var(--gap)*-1) 0 0 calc(var(--gap)*-1);width:calc(100% + var(--gap))}.flex-gap>*{display:inline-block;margin:var(--gap) 0 0 var(--gap)}.flex-gap .ivu-input-number{max-width:150px;min-width:75px}",""]);const a=s},12132:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".canvas-container{margin-left:auto}#canvas{border:1px solid #ccc;border-radius:6px}",""]);const a=s},99848:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".sr-info{background:#eee;border-radius:5px;padding:8px 16px}.sr-error{background:#ffafaf;color:#af0000}",""]);const a=s},66047:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".permissions .v-check{display:flex}.permissions .v-check .ivu-checkbox{margin-right:8px}.permissions .ivu-list-item-action{min-width:50%}",""]);const a=s},45991:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".input-number[data-v-a81d4f58]{align-items:center;background-color:#fff;border:1px solid #dcdee2;border-radius:4px;display:flex;flex-direction:row;justify-content:space-between;margin:0 auto;max-width:300px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:50%}.input-number .field-container[data-v-a81d4f58]{flex:1}.input-number .field-container input[data-v-a81d4f58]{border:none;font-size:15px;padding:3px;text-align:center;width:100px}.input-number .field-container input[data-v-a81d4f58]:focus{outline:none}.input-number .input-button[data-v-a81d4f58]{background-color:#f5f5f5;cursor:pointer;padding:4px 10px;width:50px}.input-number .input-button.first[data-v-a81d4f58]{border-radius:3px 0 0 3px;border-right:1px solid #dcdee2}.input-number .input-button.last[data-v-a81d4f58]{border-left:1px solid #dcdee2;border-radius:0 3px 3px 0}.input-number .input-button[data-v-a81d4f58]:active,.input-number .input-button[data-v-a81d4f58]:hover{background-color:#ddd}",""]);const a=s},19270:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".cardp{margin-bottom:16px}.cardp .ivu-card-body{padding-bottom:0}.ivu-radio-group-button .ivu-radio-wrapper{border-radius:0!important;height:auto!important;padding:5px 20px}.ivu-form .ivu-form-item-label{font-size:14px;font-weight:700}",""]);const a=s},82276:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".serials .ivu-cell-main{display:block!important}@media (max-width:480px){.serials .ivu-cell-main{display:inline-block!important}}",""]);const a=s},69199:(t,e,r)=>{"use strict";r.d(e,{Z:()=>a});var i=r(1519),s=r.n(i)()((function(t){return t[1]}));s.push([t.id,".calendar{border:1px solid #e8eaec;border-radius:4px;box-sizing:content-box;margin:0;padding:0;position:relative;transition:all 5s ease-in-out}.calendar .events{border-radius:4px;color:#fff;height:100%;position:absolute;top:0;transition:all .25s ease-in-out;width:100%}.calendar .event-enter-active{-webkit-animation:circleAnimation .25s ease-in forwards;animation:circleAnimation .25s ease-in forwards}.calendar .event-leave-active{animation:circleAnimation .25s ease-out reverse}@-webkit-keyframes circleAnimation{0%{-webkit-clip-path:circle(0 at 50% 50%);clip-path:circle(0 at 50% 50%)}to{-webkit-clip-path:circle(100%);clip-path:circle(100%)}}@keyframes circleAnimation{0%{-webkit-clip-path:circle(0 at 50% 50%);clip-path:circle(0 at 50% 50%)}to{-webkit-clip-path:circle(100%);clip-path:circle(100%)}}.calendar .got-event{background:#19be6b;border-radius:3px;height:6px;left:5px;position:absolute;top:10px;width:6px}.calendar .day-events{height:56.5217391304vh!important;min-height:315px;overflow:hidden;overflow-y:auto;padding-bottom:16px;width:100%}.calendar .event{color:#495060}.calendar .event h3{border-bottom:1px solid #e8eaec;margin:-16px -16px 8px;padding:8px 16px}.calendar .event p{margin-bottom:-8px;text-align:justify}.calendar .event .time{align-items:center;border-top:1px solid #e8eaec;display:flex;margin:16px -16px -16px}.calendar .event .time span{display:inline-block;padding:8px 16px}.calendar .event .time span:not(:first-child){border-left:1px solid #e8eaec}@media only screen and (max-width:767px){.calendar .event .time{display:block}.calendar .event .time span:not(:first-child){border-left:none}}.calendar .ivu-date-picker{width:100%}.calendar .ivu-select-dropdown{box-shadow:none!important;box-sizing:content-box;display:block;position:static!important;width:100%}.calendar .ivu-date-picker-header{box-sizing:content-box;padding-bottom:6px}.calendar .ivu-date-picker-header,.calendar .ivu-picker-panel-icon-btn{height:48px;line-height:48px}.calendar .ivu-picker-panel-icon-btn{width:48px}.calendar .ivu-date-picker-cells,.calendar .ivu-date-picker-cells-header,.calendar .ivu-picker-panel-body,.calendar .ivu-picker-panel-content{margin:0;width:100%}.calendar .ivu-date-picker-cells-header span{color:#495060;font-weight:700;height:36px!important;line-height:36px!important;margin:0}.calendar .ivu-date-picker-cells-header{background:#f5f5f5;display:flex;height:36px!important;line-height:36px!important}.calendar .ivu-date-picker-cells span{width:14.2857%}.calendar .ivu-date-picker-cells.ivu-date-picker-cells-month span,.calendar .ivu-date-picker-cells.ivu-date-picker-cells-year span{width:33.333%}.calendar .ivu-date-picker-cells-cell{border-top:1px solid #e8eaec;margin:0;padding:0;text-align:center}.calendar .ivu-date-picker-cells-cell-today:not(.ivu-date-picker-cells-focused) em{background:#f5f5f5;border:0}.calendar .ivu-date-picker-cells-cell-today em:after{display:none}.calendar span.ivu-date-picker-cells-cell{box-sizing:border-box;height:49px!important;padding:2px 1px 1px;position:relative}.calendar .ivu-date-picker-header-label{font-size:16px;font-weight:700}.calendar .ivu-date-picker-cells span{display:inline-block;height:9.0909090909vh!important;min-height:50px!important}.calendar .ivu-date-picker-cells span em{display:inline-block;height:8.6956521739vh!important;line-height:8.6956521739vh!important;margin:-1px 0 2px;min-height:47px!important;width:100%!important}.calendar .events *{background:#515a6e!important;border-color:#495060!important;color:#fff!important}.calendar .events * .red-text{color:red!important}.calendar .events * .red-bg,.calendar .events * .red-bg *{background:red!important;border-color:red!important}",""]);const a=s},18552:(t,e,r)=>{var i=r(10852)(r(55639),"DataView");t.exports=i},1989:(t,e,r)=>{var i=r(51789),s=r(80401),a=r(57667),n=r(21327),o=r(81866);function l(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=s,l.prototype.get=a,l.prototype.has=n,l.prototype.set=o,t.exports=l},38407:(t,e,r)=>{var i=r(27040),s=r(14125),a=r(82117),n=r(67518),o=r(54705);function l(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=s,l.prototype.get=a,l.prototype.has=n,l.prototype.set=o,t.exports=l},57071:(t,e,r)=>{var i=r(10852)(r(55639),"Map");t.exports=i},83369:(t,e,r)=>{var i=r(24785),s=r(11285),a=r(96e3),n=r(49916),o=r(95265);function l(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype.delete=s,l.prototype.get=a,l.prototype.has=n,l.prototype.set=o,t.exports=l},53818:(t,e,r)=>{var i=r(10852)(r(55639),"Promise");t.exports=i},58525:(t,e,r)=>{var i=r(10852)(r(55639),"Set");t.exports=i},88668:(t,e,r)=>{var i=r(83369),s=r(90619),a=r(72385);function n(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new i;++e<r;)this.add(t[e])}n.prototype.add=n.prototype.push=s,n.prototype.has=a,t.exports=n},46384:(t,e,r)=>{var i=r(38407),s=r(37465),a=r(63779),n=r(67599),o=r(44758),l=r(34309);function c(t){var e=this.__data__=new i(t);this.size=e.size}c.prototype.clear=s,c.prototype.delete=a,c.prototype.get=n,c.prototype.has=o,c.prototype.set=l,t.exports=c},11149:(t,e,r)=>{var i=r(55639).Uint8Array;t.exports=i},70577:(t,e,r)=>{var i=r(10852)(r(55639),"WeakMap");t.exports=i},96874:t=>{t.exports=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}},34963:t=>{t.exports=function(t,e){for(var r=-1,i=null==t?0:t.length,s=0,a=[];++r<i;){var n=t[r];e(n,r,t)&&(a[s++]=n)}return a}},14636:(t,e,r)=>{var i=r(22545),s=r(35694),a=r(1469),n=r(44144),o=r(65776),l=r(36719),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var r=a(t),u=!r&&s(t),d=!r&&!u&&n(t),m=!r&&!u&&!d&&l(t),h=r||u||d||m,p=h?i(t.length,String):[],f=p.length;for(var _ in t)!e&&!c.call(t,_)||h&&("length"==_||d&&("offset"==_||"parent"==_)||m&&("buffer"==_||"byteLength"==_||"byteOffset"==_)||o(_,f))||p.push(_);return p}},62488:t=>{t.exports=function(t,e){for(var r=-1,i=e.length,s=t.length;++r<i;)t[s+r]=e[r];return t}},82908:t=>{t.exports=function(t,e){for(var r=-1,i=null==t?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1}},18470:(t,e,r)=>{var i=r(77813);t.exports=function(t,e){for(var r=t.length;r--;)if(i(t[r][0],e))return r;return-1}},38845:t=>{t.exports=function(t,e,r){if("function"!=typeof t)throw new TypeError("Expected a function");return setTimeout((function(){t.apply(void 0,r)}),e)}},68866:(t,e,r)=>{var i=r(62488),s=r(1469);t.exports=function(t,e,r){var a=e(t);return s(t)?a:i(a,r(t))}},9454:(t,e,r)=>{var i=r(44239),s=r(37005);t.exports=function(t){return s(t)&&"[object Arguments]"==i(t)}},90939:(t,e,r)=>{var i=r(2492),s=r(37005);t.exports=function t(e,r,a,n,o){return e===r||(null==e||null==r||!s(e)&&!s(r)?e!=e&&r!=r:i(e,r,a,n,t,o))}},2492:(t,e,r)=>{var i=r(46384),s=r(67114),a=r(18351),n=r(16096),o=r(64160),l=r(1469),c=r(44144),u=r(36719),d="[object Arguments]",m="[object Array]",h="[object Object]",p=Object.prototype.hasOwnProperty;t.exports=function(t,e,r,f,_,v){var g=l(t),b=l(e),y=g?m:o(t),x=b?m:o(e),$=(y=y==d?h:y)==h,w=(x=x==d?h:x)==h,C=y==x;if(C&&c(t)){if(!c(e))return!1;g=!0,$=!1}if(C&&!$)return v||(v=new i),g||u(t)?s(t,e,r,f,_,v):a(t,e,y,r,f,_,v);if(!(1&r)){var k=$&&p.call(t,"__wrapped__"),S=w&&p.call(e,"__wrapped__");if(k||S){var O=k?t.value():t,I=S?e.value():e;return v||(v=new i),_(O,I,r,f,v)}}return!!C&&(v||(v=new i),n(t,e,r,f,_,v))}},79190:(t,e,r)=>{var i=r(23560),s=r(15346),a=r(13218),n=r(80346),o=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,d=c.hasOwnProperty,m=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||s(t))&&(i(t)?m:o).test(n(t))}},38749:(t,e,r)=>{var i=r(44239),s=r(41780),a=r(37005),n={};n["[object Float32Array]"]=n["[object Float64Array]"]=n["[object Int8Array]"]=n["[object Int16Array]"]=n["[object Int32Array]"]=n["[object Uint8Array]"]=n["[object Uint8ClampedArray]"]=n["[object Uint16Array]"]=n["[object Uint32Array]"]=!0,n["[object Arguments]"]=n["[object Array]"]=n["[object ArrayBuffer]"]=n["[object Boolean]"]=n["[object DataView]"]=n["[object Date]"]=n["[object Error]"]=n["[object Function]"]=n["[object Map]"]=n["[object Number]"]=n["[object Object]"]=n["[object RegExp]"]=n["[object Set]"]=n["[object String]"]=n["[object WeakMap]"]=!1,t.exports=function(t){return a(t)&&s(t.length)&&!!n[i(t)]}},280:(t,e,r)=>{var i=r(25726),s=r(86916),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return s(t);var e=[];for(var r in Object(t))a.call(t,r)&&"constructor"!=r&&e.push(r);return e}},5976:(t,e,r)=>{var i=r(6557),s=r(45357),a=r(30061);t.exports=function(t,e){return a(s(t,e,i),t+"")}},56560:(t,e,r)=>{var i=r(75703),s=r(38777),a=r(6557),n=s?function(t,e){return s(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:a;t.exports=n},22545:t=>{t.exports=function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}},7518:t=>{t.exports=function(t){return function(e){return t(e)}}},74757:t=>{t.exports=function(t,e){return t.has(e)}},14429:(t,e,r)=>{var i=r(55639)["__core-js_shared__"];t.exports=i},38777:(t,e,r)=>{var i=r(10852),s=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=s},67114:(t,e,r)=>{var i=r(88668),s=r(82908),a=r(74757);t.exports=function(t,e,r,n,o,l){var c=1&r,u=t.length,d=e.length;if(u!=d&&!(c&&d>u))return!1;var m=l.get(t),h=l.get(e);if(m&&h)return m==e&&h==t;var p=-1,f=!0,_=2&r?new i:void 0;for(l.set(t,e),l.set(e,t);++p<u;){var v=t[p],g=e[p];if(n)var b=c?n(g,v,p,e,t,l):n(v,g,p,t,e,l);if(void 0!==b){if(b)continue;f=!1;break}if(_){if(!s(e,(function(t,e){if(!a(_,e)&&(v===t||o(v,t,r,n,l)))return _.push(e)}))){f=!1;break}}else if(v!==g&&!o(v,g,r,n,l)){f=!1;break}}return l.delete(t),l.delete(e),f}},18351:(t,e,r)=>{var i=r(62705),s=r(11149),a=r(77813),n=r(67114),o=r(68776),l=r(21814),c=i?i.prototype:void 0,u=c?c.valueOf:void 0;t.exports=function(t,e,r,i,c,d,m){switch(r){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!d(new s(t),new s(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return a(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var h=o;case"[object Set]":var p=1&i;if(h||(h=l),t.size!=e.size&&!p)return!1;var f=m.get(t);if(f)return f==e;i|=2,m.set(t,e);var _=n(h(t),h(e),i,c,d,m);return m.delete(t),_;case"[object Symbol]":if(u)return u.call(t)==u.call(e)}return!1}},16096:(t,e,r)=>{var i=r(58234),s=Object.prototype.hasOwnProperty;t.exports=function(t,e,r,a,n,o){var l=1&r,c=i(t),u=c.length;if(u!=i(e).length&&!l)return!1;for(var d=u;d--;){var m=c[d];if(!(l?m in e:s.call(e,m)))return!1}var h=o.get(t),p=o.get(e);if(h&&p)return h==e&&p==t;var f=!0;o.set(t,e),o.set(e,t);for(var _=l;++d<u;){var v=t[m=c[d]],g=e[m];if(a)var b=l?a(g,v,m,e,t,o):a(v,g,m,t,e,o);if(!(void 0===b?v===g||n(v,g,r,a,o):b)){f=!1;break}_||(_="constructor"==m)}if(f&&!_){var y=t.constructor,x=e.constructor;y==x||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof x&&x instanceof x||(f=!1)}return o.delete(t),o.delete(e),f}},58234:(t,e,r)=>{var i=r(68866),s=r(99551),a=r(3674);t.exports=function(t){return i(t,a,s)}},45050:(t,e,r)=>{var i=r(37019);t.exports=function(t,e){var r=t.__data__;return i(e)?r["string"==typeof e?"string":"hash"]:r.map}},10852:(t,e,r)=>{var i=r(79190),s=r(47801);t.exports=function(t,e){var r=s(t,e);return i(r)?r:void 0}},99551:(t,e,r)=>{var i=r(34963),s=r(70479),a=Object.prototype.propertyIsEnumerable,n=Object.getOwnPropertySymbols,o=n?function(t){return null==t?[]:(t=Object(t),i(n(t),(function(e){return a.call(t,e)})))}:s;t.exports=o},64160:(t,e,r)=>{var i=r(18552),s=r(57071),a=r(53818),n=r(58525),o=r(70577),l=r(44239),c=r(80346),u="[object Map]",d="[object Promise]",m="[object Set]",h="[object WeakMap]",p="[object DataView]",f=c(i),_=c(s),v=c(a),g=c(n),b=c(o),y=l;(i&&y(new i(new ArrayBuffer(1)))!=p||s&&y(new s)!=u||a&&y(a.resolve())!=d||n&&y(new n)!=m||o&&y(new o)!=h)&&(y=function(t){var e=l(t),r="[object Object]"==e?t.constructor:void 0,i=r?c(r):"";if(i)switch(i){case f:return p;case _:return u;case v:return d;case g:return m;case b:return h}return e}),t.exports=y},47801:t=>{t.exports=function(t,e){return null==t?void 0:t[e]}},51789:(t,e,r)=>{var i=r(94536);t.exports=function(){this.__data__=i?i(null):{},this.size=0}},80401:t=>{t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},57667:(t,e,r)=>{var i=r(94536),s=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(i){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return s.call(e,t)?e[t]:void 0}},21327:(t,e,r)=>{var i=r(94536),s=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:s.call(e,t)}},81866:(t,e,r)=>{var i=r(94536);t.exports=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},65776:t=>{var e=/^(?:0|[1-9]\d*)$/;t.exports=function(t,r){var i=typeof t;return!!(r=null==r?9007199254740991:r)&&("number"==i||"symbol"!=i&&e.test(t))&&t>-1&&t%1==0&&t<r}},37019:t=>{t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},15346:(t,e,r)=>{var i,s=r(14429),a=(i=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(t){return!!a&&a in t}},25726:t=>{var e=Object.prototype;t.exports=function(t){var r=t&&t.constructor;return t===("function"==typeof r&&r.prototype||e)}},27040:t=>{t.exports=function(){this.__data__=[],this.size=0}},14125:(t,e,r)=>{var i=r(18470),s=Array.prototype.splice;t.exports=function(t){var e=this.__data__,r=i(e,t);return!(r<0)&&(r==e.length-1?e.pop():s.call(e,r,1),--this.size,!0)}},82117:(t,e,r)=>{var i=r(18470);t.exports=function(t){var e=this.__data__,r=i(e,t);return r<0?void 0:e[r][1]}},67518:(t,e,r)=>{var i=r(18470);t.exports=function(t){return i(this.__data__,t)>-1}},54705:(t,e,r)=>{var i=r(18470);t.exports=function(t,e){var r=this.__data__,s=i(r,t);return s<0?(++this.size,r.push([t,e])):r[s][1]=e,this}},24785:(t,e,r)=>{var i=r(1989),s=r(38407),a=r(57071);t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(a||s),string:new i}}},11285:(t,e,r)=>{var i=r(45050);t.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}},96e3:(t,e,r)=>{var i=r(45050);t.exports=function(t){return i(this,t).get(t)}},49916:(t,e,r)=>{var i=r(45050);t.exports=function(t){return i(this,t).has(t)}},95265:(t,e,r)=>{var i=r(45050);t.exports=function(t,e){var r=i(this,t),s=r.size;return r.set(t,e),this.size+=r.size==s?0:1,this}},68776:t=>{t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t,i){r[++e]=[i,t]})),r}},94536:(t,e,r)=>{var i=r(10852)(Object,"create");t.exports=i},86916:(t,e,r)=>{var i=r(5569)(Object.keys,Object);t.exports=i},31167:(t,e,r)=>{t=r.nmd(t);var i=r(31957),s=e&&!e.nodeType&&e,a=s&&t&&!t.nodeType&&t,n=a&&a.exports===s&&i.process,o=function(){try{var t=a&&a.require&&a.require("util").types;return t||n&&n.binding&&n.binding("util")}catch(t){}}();t.exports=o},5569:t=>{t.exports=function(t,e){return function(r){return t(e(r))}}},45357:(t,e,r)=>{var i=r(96874),s=Math.max;t.exports=function(t,e,r){return e=s(void 0===e?t.length-1:e,0),function(){for(var a=arguments,n=-1,o=s(a.length-e,0),l=Array(o);++n<o;)l[n]=a[e+n];n=-1;for(var c=Array(e+1);++n<e;)c[n]=a[n];return c[e]=r(l),i(t,this,c)}}},90619:t=>{t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},72385:t=>{t.exports=function(t){return this.__data__.has(t)}},21814:t=>{t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}},30061:(t,e,r)=>{var i=r(56560),s=r(21275)(i);t.exports=s},21275:t=>{var e=Date.now;t.exports=function(t){var r=0,i=0;return function(){var s=e(),a=16-(s-i);if(i=s,a>0){if(++r>=800)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}},37465:(t,e,r)=>{var i=r(38407);t.exports=function(){this.__data__=new i,this.size=0}},63779:t=>{t.exports=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}},67599:t=>{t.exports=function(t){return this.__data__.get(t)}},44758:t=>{t.exports=function(t){return this.__data__.has(t)}},34309:(t,e,r)=>{var i=r(38407),s=r(57071),a=r(83369);t.exports=function(t,e){var r=this.__data__;if(r instanceof i){var n=r.__data__;if(!s||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new a(n)}return r.set(t,e),this.size=r.size,this}},80346:t=>{var e=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return e.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},75703:t=>{t.exports=function(t){return function(){return t}}},98066:(t,e,r)=>{var i=r(38845),s=r(5976),a=r(14841),n=s((function(t,e,r){return i(t,a(e)||0,r)}));t.exports=n},77813:t=>{t.exports=function(t,e){return t===e||t!=t&&e!=e}},6557:t=>{t.exports=function(t){return t}},35694:(t,e,r)=>{var i=r(9454),s=r(37005),a=Object.prototype,n=a.hasOwnProperty,o=a.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(t){return s(t)&&n.call(t,"callee")&&!o.call(t,"callee")};t.exports=l},1469:t=>{var e=Array.isArray;t.exports=e},98612:(t,e,r)=>{var i=r(23560),s=r(41780);t.exports=function(t){return null!=t&&s(t.length)&&!i(t)}},44144:(t,e,r)=>{t=r.nmd(t);var i=r(55639),s=r(95062),a=e&&!e.nodeType&&e,n=a&&t&&!t.nodeType&&t,o=n&&n.exports===a?i.Buffer:void 0,l=(o?o.isBuffer:void 0)||s;t.exports=l},18446:(t,e,r)=>{var i=r(90939);t.exports=function(t,e){return i(t,e)}},23560:(t,e,r)=>{var i=r(44239),s=r(13218);t.exports=function(t){if(!s(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},41780:t=>{t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},36719:(t,e,r)=>{var i=r(38749),s=r(7518),a=r(31167),n=a&&a.isTypedArray,o=n?s(n):i;t.exports=o},3674:(t,e,r)=>{var i=r(14636),s=r(280),a=r(98612);t.exports=function(t){return a(t)?i(t):s(t)}},70479:t=>{t.exports=function(){return[]}},95062:t=>{t.exports=function(){return!1}},96192:(t,e)=>{var r,i,s,a=function(){var t=function(t,e){var r=t,i=u[e],s=null,a=0,n=null,o=[],l={},c=function(t,e){s=function(t){for(var e=new Array(t),r=0;r<t;r+=1){e[r]=new Array(t);for(var i=0;i<t;i+=1)e[r][i]=null}return e}(a=4*r+17),d(0,0),d(a-7,0),d(0,a-7),h(),m(),f(t,e),r>=7&&p(t),null==n&&(n=v(r,i,o)),_(n,e)},d=function(t,e){for(var r=-1;r<=7;r+=1)if(!(t+r<=-1||a<=t+r))for(var i=-1;i<=7;i+=1)e+i<=-1||a<=e+i||(s[t+r][e+i]=0<=r&&r<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==r||6==r)||2<=r&&r<=4&&2<=i&&i<=4)},m=function(){for(var t=8;t<a-8;t+=1)null==s[t][6]&&(s[t][6]=t%2==0);for(var e=8;e<a-8;e+=1)null==s[6][e]&&(s[6][e]=e%2==0)},h=function(){for(var t=b.getPatternPosition(r),e=0;e<t.length;e+=1)for(var i=0;i<t.length;i+=1){var a=t[e],n=t[i];if(null==s[a][n])for(var o=-2;o<=2;o+=1)for(var l=-2;l<=2;l+=1)s[a+o][n+l]=-2==o||2==o||-2==l||2==l||0==o&&0==l}},p=function(t){for(var e=b.getBCHTypeNumber(r),i=0;i<18;i+=1){var n=!t&&1==(e>>i&1);s[Math.floor(i/3)][i%3+a-8-3]=n}for(i=0;i<18;i+=1){n=!t&&1==(e>>i&1);s[i%3+a-8-3][Math.floor(i/3)]=n}},f=function(t,e){for(var r=i<<3|e,n=b.getBCHTypeInfo(r),o=0;o<15;o+=1){var l=!t&&1==(n>>o&1);o<6?s[o][8]=l:o<8?s[o+1][8]=l:s[a-15+o][8]=l}for(o=0;o<15;o+=1){l=!t&&1==(n>>o&1);o<8?s[8][a-o-1]=l:o<9?s[8][15-o-1+1]=l:s[8][15-o-1]=l}s[a-8][8]=!t},_=function(t,e){for(var r=-1,i=a-1,n=7,o=0,l=b.getMaskFunction(e),c=a-1;c>0;c-=2)for(6==c&&(c-=1);;){for(var u=0;u<2;u+=1)if(null==s[i][c-u]){var d=!1;o<t.length&&(d=1==(t[o]>>>n&1)),l(i,c-u)&&(d=!d),s[i][c-u]=d,-1==(n-=1)&&(o+=1,n=7)}if((i+=r)<0||a<=i){i-=r,r=-r;break}}},v=function(t,e,r){for(var i=$.getRSBlocks(t,e),s=w(),a=0;a<r.length;a+=1){var n=r[a];s.put(n.getMode(),4),s.put(n.getLength(),b.getLengthInBits(n.getMode(),t)),n.write(s)}var o=0;for(a=0;a<i.length;a+=1)o+=i[a].dataCount;if(s.getLengthInBits()>8*o)throw"code length overflow. ("+s.getLengthInBits()+">"+8*o+")";for(s.getLengthInBits()+4<=8*o&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=8*o||(s.put(236,8),s.getLengthInBits()>=8*o));)s.put(17,8);return function(t,e){for(var r=0,i=0,s=0,a=new Array(e.length),n=new Array(e.length),o=0;o<e.length;o+=1){var l=e[o].dataCount,c=e[o].totalCount-l;i=Math.max(i,l),s=Math.max(s,c),a[o]=new Array(l);for(var u=0;u<a[o].length;u+=1)a[o][u]=255&t.getBuffer()[u+r];r+=l;var d=b.getErrorCorrectPolynomial(c),m=x(a[o],d.getLength()-1).mod(d);for(n[o]=new Array(d.getLength()-1),u=0;u<n[o].length;u+=1){var h=u+m.getLength()-n[o].length;n[o][u]=h>=0?m.getAt(h):0}}var p=0;for(u=0;u<e.length;u+=1)p+=e[u].totalCount;var f=new Array(p),_=0;for(u=0;u<i;u+=1)for(o=0;o<e.length;o+=1)u<a[o].length&&(f[_]=a[o][u],_+=1);for(u=0;u<s;u+=1)for(o=0;o<e.length;o+=1)u<n[o].length&&(f[_]=n[o][u],_+=1);return f}(s,i)};l.addData=function(t,e){var r=null;switch(e=e||"Byte"){case"Numeric":r=C(t);break;case"Alphanumeric":r=k(t);break;case"Byte":r=S(t);break;case"Kanji":r=O(t);break;default:throw"mode:"+e}o.push(r),n=null},l.isDark=function(t,e){if(t<0||a<=t||e<0||a<=e)throw t+","+e;return s[t][e]},l.getModuleCount=function(){return a},l.make=function(){if(r<1){for(var t=1;t<40;t++){for(var e=$.getRSBlocks(t,i),s=w(),a=0;a<o.length;a++){var n=o[a];s.put(n.getMode(),4),s.put(n.getLength(),b.getLengthInBits(n.getMode(),t)),n.write(s)}var u=0;for(a=0;a<e.length;a++)u+=e[a].dataCount;if(s.getLengthInBits()<=8*u)break}r=t}c(!1,function(){for(var t=0,e=0,r=0;r<8;r+=1){c(!0,r);var i=b.getLostPoint(l);(0==r||t>i)&&(t=i,e=r)}return e}())},l.createTableTag=function(t,e){t=t||2;var r="";r+='<table style="',r+=" border-width: 0px; border-style: none;",r+=" border-collapse: collapse;",r+=" padding: 0px; margin: "+(e=void 0===e?4*t:e)+"px;",r+='">',r+="<tbody>";for(var i=0;i<l.getModuleCount();i+=1){r+="<tr>";for(var s=0;s<l.getModuleCount();s+=1)r+='<td style="',r+=" border-width: 0px; border-style: none;",r+=" border-collapse: collapse;",r+=" padding: 0px; margin: 0px;",r+=" width: "+t+"px;",r+=" height: "+t+"px;",r+=" background-color: ",r+=l.isDark(i,s)?"#000000":"#ffffff",r+=";",r+='"/>';r+="</tr>"}return r+="</tbody>",r+="</table>"},l.createSvgTag=function(t,e,r,i){var s={};"object"==typeof arguments[0]&&(t=(s=arguments[0]).cellSize,e=s.margin,r=s.alt,i=s.title),t=t||2,e=void 0===e?4*t:e,(r="string"==typeof r?{text:r}:r||{}).text=r.text||null,r.id=r.text?r.id||"qrcode-description":null,(i="string"==typeof i?{text:i}:i||{}).text=i.text||null,i.id=i.text?i.id||"qrcode-title":null;var a,n,o,c,u=l.getModuleCount()*t+2*e,d="";for(c="l"+t+",0 0,"+t+" -"+t+",0 0,-"+t+"z ",d+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',d+=s.scalable?"":' width="'+u+'px" height="'+u+'px"',d+=' viewBox="0 0 '+u+" "+u+'" ',d+=' preserveAspectRatio="xMinYMin meet"',d+=i.text||r.text?' role="img" aria-labelledby="'+g([i.id,r.id].join(" ").trim())+'"':"",d+=">",d+=i.text?'<title id="'+g(i.id)+'">'+g(i.text)+"</title>":"",d+=r.text?'<description id="'+g(r.id)+'">'+g(r.text)+"</description>":"",d+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',d+='<path d="',n=0;n<l.getModuleCount();n+=1)for(o=n*t+e,a=0;a<l.getModuleCount();a+=1)l.isDark(n,a)&&(d+="M"+(a*t+e)+","+o+c);return d+='" stroke="transparent" fill="black"/>',d+="</svg>"},l.createDataURL=function(t,e){t=t||2,e=void 0===e?4*t:e;var r=l.getModuleCount()*t+2*e,i=e,s=r-e;return T(r,r,(function(e,r){if(i<=e&&e<s&&i<=r&&r<s){var a=Math.floor((e-i)/t),n=Math.floor((r-i)/t);return l.isDark(n,a)?0:1}return 1}))},l.createImgTag=function(t,e,r){t=t||2,e=void 0===e?4*t:e;var i=l.getModuleCount()*t+2*e,s="";return s+="<img",s+=' src="',s+=l.createDataURL(t,e),s+='"',s+=' width="',s+=i,s+='"',s+=' height="',s+=i,s+='"',r&&(s+=' alt="',s+=g(r),s+='"'),s+="/>"};var g=function(t){for(var e="",r=0;r<t.length;r+=1){var i=t.charAt(r);switch(i){case"<":e+="&lt;";break;case">":e+="&gt;";break;case"&":e+="&amp;";break;case'"':e+="&quot;";break;default:e+=i}}return e};return l.createASCII=function(t,e){if((t=t||1)<2)return function(t){t=void 0===t?2:t;var e,r,i,s,a,n=1*l.getModuleCount()+2*t,o=t,c=n-t,u={"":""," ":""," ":"","  ":" "},d={"":""," ":""," ":" ","  ":" "},m="";for(e=0;e<n;e+=2){for(i=Math.floor((e-o)/1),s=Math.floor((e+1-o)/1),r=0;r<n;r+=1)a="",o<=r&&r<c&&o<=e&&e<c&&l.isDark(i,Math.floor((r-o)/1))&&(a=" "),o<=r&&r<c&&o<=e+1&&e+1<c&&l.isDark(s,Math.floor((r-o)/1))?a+=" ":a+="",m+=t<1&&e+1>=c?d[a]:u[a];m+="\n"}return n%2&&t>0?m.substring(0,m.length-n-1)+Array(n+1).join(""):m.substring(0,m.length-1)}(e);t-=1,e=void 0===e?2*t:e;var r,i,s,a,n=l.getModuleCount()*t+2*e,o=e,c=n-e,u=Array(t+1).join(""),d=Array(t+1).join("  "),m="",h="";for(r=0;r<n;r+=1){for(s=Math.floor((r-o)/t),h="",i=0;i<n;i+=1)a=1,o<=i&&i<c&&o<=r&&r<c&&l.isDark(s,Math.floor((i-o)/t))&&(a=0),h+=a?u:d;for(s=0;s<t;s+=1)m+=h+"\n"}return m.substring(0,m.length-1)},l.renderTo2dContext=function(t,e){e=e||2;for(var r=l.getModuleCount(),i=0;i<r;i++)for(var s=0;s<r;s++)t.fillStyle=l.isDark(i,s)?"black":"white",t.fillRect(i*e,s*e,e,e)},l};t.stringToBytes=(t.stringToBytesFuncs={default:function(t){for(var e=[],r=0;r<t.length;r+=1){var i=t.charCodeAt(r);e.push(255&i)}return e}}).default,t.createStringToBytes=function(t,e){var r=function(){for(var r=F(t),i=function(){var t=r.read();if(-1==t)throw"eof";return t},s=0,a={};;){var n=r.read();if(-1==n)break;var o=i(),l=i()<<8|i();a[String.fromCharCode(n<<8|o)]=l,s+=1}if(s!=e)throw s+" != "+e;return a}(),i="?".charCodeAt(0);return function(t){for(var e=[],s=0;s<t.length;s+=1){var a=t.charCodeAt(s);if(a<128)e.push(a);else{var n=r[t.charAt(s)];"number"==typeof n?(255&n)==n?e.push(n):(e.push(n>>>8),e.push(255&n)):e.push(i)}}return e}};var e,r,i,s,a,n=1,o=2,l=4,c=8,u={L:1,M:0,Q:3,H:2},d=0,m=1,h=2,p=3,f=4,_=5,v=6,g=7,b=(e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],r=1335,i=7973,a=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e},(s={}).getBCHTypeInfo=function(t){for(var e=t<<10;a(e)-a(r)>=0;)e^=r<<a(e)-a(r);return 21522^(t<<10|e)},s.getBCHTypeNumber=function(t){for(var e=t<<12;a(e)-a(i)>=0;)e^=i<<a(e)-a(i);return t<<12|e},s.getPatternPosition=function(t){return e[t-1]},s.getMaskFunction=function(t){switch(t){case d:return function(t,e){return(t+e)%2==0};case m:return function(t,e){return t%2==0};case h:return function(t,e){return e%3==0};case p:return function(t,e){return(t+e)%3==0};case f:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case _:return function(t,e){return t*e%2+t*e%3==0};case v:return function(t,e){return(t*e%2+t*e%3)%2==0};case g:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw"bad maskPattern:"+t}},s.getErrorCorrectPolynomial=function(t){for(var e=x([1],0),r=0;r<t;r+=1)e=e.multiply(x([1,y.gexp(r)],0));return e},s.getLengthInBits=function(t,e){if(1<=e&&e<10)switch(t){case n:return 10;case o:return 9;case l:case c:return 8;default:throw"mode:"+t}else if(e<27)switch(t){case n:return 12;case o:return 11;case l:return 16;case c:return 10;default:throw"mode:"+t}else{if(!(e<41))throw"type:"+e;switch(t){case n:return 14;case o:return 13;case l:return 16;case c:return 12;default:throw"mode:"+t}}},s.getLostPoint=function(t){for(var e=t.getModuleCount(),r=0,i=0;i<e;i+=1)for(var s=0;s<e;s+=1){for(var a=0,n=t.isDark(i,s),o=-1;o<=1;o+=1)if(!(i+o<0||e<=i+o))for(var l=-1;l<=1;l+=1)s+l<0||e<=s+l||0==o&&0==l||n==t.isDark(i+o,s+l)&&(a+=1);a>5&&(r+=3+a-5)}for(i=0;i<e-1;i+=1)for(s=0;s<e-1;s+=1){var c=0;t.isDark(i,s)&&(c+=1),t.isDark(i+1,s)&&(c+=1),t.isDark(i,s+1)&&(c+=1),t.isDark(i+1,s+1)&&(c+=1),0!=c&&4!=c||(r+=3)}for(i=0;i<e;i+=1)for(s=0;s<e-6;s+=1)t.isDark(i,s)&&!t.isDark(i,s+1)&&t.isDark(i,s+2)&&t.isDark(i,s+3)&&t.isDark(i,s+4)&&!t.isDark(i,s+5)&&t.isDark(i,s+6)&&(r+=40);for(s=0;s<e;s+=1)for(i=0;i<e-6;i+=1)t.isDark(i,s)&&!t.isDark(i+1,s)&&t.isDark(i+2,s)&&t.isDark(i+3,s)&&t.isDark(i+4,s)&&!t.isDark(i+5,s)&&t.isDark(i+6,s)&&(r+=40);var u=0;for(s=0;s<e;s+=1)for(i=0;i<e;i+=1)t.isDark(i,s)&&(u+=1);return r+=Math.abs(100*u/e/e-50)/5*10},s),y=function(){for(var t=new Array(256),e=new Array(256),r=0;r<8;r+=1)t[r]=1<<r;for(r=8;r<256;r+=1)t[r]=t[r-4]^t[r-5]^t[r-6]^t[r-8];for(r=0;r<255;r+=1)e[t[r]]=r;var i={glog:function(t){if(t<1)throw"glog("+t+")";return e[t]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return t[e]}};return i}();function x(t,e){if(void 0===t.length)throw t.length+"/"+e;var r=function(){for(var r=0;r<t.length&&0==t[r];)r+=1;for(var i=new Array(t.length-r+e),s=0;s<t.length-r;s+=1)i[s]=t[s+r];return i}(),i={getAt:function(t){return r[t]},getLength:function(){return r.length},multiply:function(t){for(var e=new Array(i.getLength()+t.getLength()-1),r=0;r<i.getLength();r+=1)for(var s=0;s<t.getLength();s+=1)e[r+s]^=y.gexp(y.glog(i.getAt(r))+y.glog(t.getAt(s)));return x(e,0)},mod:function(t){if(i.getLength()-t.getLength()<0)return i;for(var e=y.glog(i.getAt(0))-y.glog(t.getAt(0)),r=new Array(i.getLength()),s=0;s<i.getLength();s+=1)r[s]=i.getAt(s);for(s=0;s<t.getLength();s+=1)r[s]^=y.gexp(y.glog(t.getAt(s))+e);return x(r,0).mod(t)}};return i}var $=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var r={};return r.totalCount=t,r.dataCount=e,r},r={};return r.getRSBlocks=function(r,i){var s=function(e,r){switch(r){case u.L:return t[4*(e-1)+0];case u.M:return t[4*(e-1)+1];case u.Q:return t[4*(e-1)+2];case u.H:return t[4*(e-1)+3];default:return}}(r,i);if(void 0===s)throw"bad rs block @ typeNumber:"+r+"/errorCorrectionLevel:"+i;for(var a=s.length/3,n=[],o=0;o<a;o+=1)for(var l=s[3*o+0],c=s[3*o+1],d=s[3*o+2],m=0;m<l;m+=1)n.push(e(c,d));return n},r}(),w=function(){var t=[],e=0,r={getBuffer:function(){return t},getAt:function(e){var r=Math.floor(e/8);return 1==(t[r]>>>7-e%8&1)},put:function(t,e){for(var i=0;i<e;i+=1)r.putBit(1==(t>>>e-i-1&1))},getLengthInBits:function(){return e},putBit:function(r){var i=Math.floor(e/8);t.length<=i&&t.push(0),r&&(t[i]|=128>>>e%8),e+=1}};return r},C=function(t){var e=n,r=t,i={getMode:function(){return e},getLength:function(t){return r.length},write:function(t){for(var e=r,i=0;i+2<e.length;)t.put(s(e.substring(i,i+3)),10),i+=3;i<e.length&&(e.length-i==1?t.put(s(e.substring(i,i+1)),4):e.length-i==2&&t.put(s(e.substring(i,i+2)),7))}},s=function(t){for(var e=0,r=0;r<t.length;r+=1)e=10*e+a(t.charAt(r));return e},a=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+t};return i},k=function(t){var e=o,r=t,i={getMode:function(){return e},getLength:function(t){return r.length},write:function(t){for(var e=r,i=0;i+1<e.length;)t.put(45*s(e.charAt(i))+s(e.charAt(i+1)),11),i+=2;i<e.length&&t.put(s(e.charAt(i)),6)}},s=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);if("A"<=t&&t<="Z")return t.charCodeAt(0)-"A".charCodeAt(0)+10;switch(t){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+t}};return i},S=function(e){var r=l,i=t.stringToBytes(e),s={getMode:function(){return r},getLength:function(t){return i.length},write:function(t){for(var e=0;e<i.length;e+=1)t.put(i[e],8)}};return s},O=function(e){var r=c,i=t.stringToBytesFuncs.SJIS;if(!i)throw"sjis not supported.";!function(t,e){var r=i("");if(2!=r.length||38726!=(r[0]<<8|r[1]))throw"sjis not supported."}();var s=i(e),a={getMode:function(){return r},getLength:function(t){return~~(s.length/2)},write:function(t){for(var e=s,r=0;r+1<e.length;){var i=(255&e[r])<<8|255&e[r+1];if(33088<=i&&i<=40956)i-=33088;else{if(!(57408<=i&&i<=60351))throw"illegal char at "+(r+1)+"/"+i;i-=49472}i=192*(i>>>8&255)+(255&i),t.put(i,13),r+=2}if(r<e.length)throw"illegal char at "+(r+1)}};return a},I=function(){var t=[],e={writeByte:function(e){t.push(255&e)},writeShort:function(t){e.writeByte(t),e.writeByte(t>>>8)},writeBytes:function(t,r,i){r=r||0,i=i||t.length;for(var s=0;s<i;s+=1)e.writeByte(t[s+r])},writeString:function(t){for(var r=0;r<t.length;r+=1)e.writeByte(t.charCodeAt(r))},toByteArray:function(){return t},toString:function(){var e="";e+="[";for(var r=0;r<t.length;r+=1)r>0&&(e+=","),e+=t[r];return e+="]"}};return e},F=function(t){var e=t,r=0,i=0,s=0,a={read:function(){for(;s<8;){if(r>=e.length){if(0==s)return-1;throw"unexpected end of file./"+s}var t=e.charAt(r);if(r+=1,"="==t)return s=0,-1;t.match(/^\s$/)||(i=i<<6|n(t.charCodeAt(0)),s+=6)}var a=i>>>s-8&255;return s-=8,a}},n=function(t){if(65<=t&&t<=90)return t-65;if(97<=t&&t<=122)return t-97+26;if(48<=t&&t<=57)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw"c:"+t};return a},T=function(t,e,r){for(var i=function(t,e){var r=t,i=e,s=new Array(t*e),a={setPixel:function(t,e,i){s[e*r+t]=i},write:function(t){t.writeString("GIF87a"),t.writeShort(r),t.writeShort(i),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(","),t.writeShort(0),t.writeShort(0),t.writeShort(r),t.writeShort(i),t.writeByte(0);var e=n(2);t.writeByte(2);for(var s=0;e.length-s>255;)t.writeByte(255),t.writeBytes(e,s,255),s+=255;t.writeByte(e.length-s),t.writeBytes(e,s,e.length-s),t.writeByte(0),t.writeString(";")}},n=function(t){for(var e=1<<t,r=1+(1<<t),i=t+1,a=o(),n=0;n<e;n+=1)a.add(String.fromCharCode(n));a.add(String.fromCharCode(e)),a.add(String.fromCharCode(r));var l,c,u,d=I(),m=(l=d,c=0,u=0,{write:function(t,e){if(t>>>e!=0)throw"length over";for(;c+e>=8;)l.writeByte(255&(t<<c|u)),e-=8-c,t>>>=8-c,u=0,c=0;u|=t<<c,c+=e},flush:function(){c>0&&l.writeByte(u)}});m.write(e,i);var h=0,p=String.fromCharCode(s[h]);for(h+=1;h<s.length;){var f=String.fromCharCode(s[h]);h+=1,a.contains(p+f)?p+=f:(m.write(a.indexOf(p),i),a.size()<4095&&(a.size()==1<<i&&(i+=1),a.add(p+f)),p=f)}return m.write(a.indexOf(p),i),m.write(r,i),m.flush(),d.toByteArray()},o=function(){var t={},e=0,r={add:function(i){if(r.contains(i))throw"dup key:"+i;t[i]=e,e+=1},size:function(){return e},indexOf:function(e){return t[e]},contains:function(e){return void 0!==t[e]}};return r};return a}(t,e),s=0;s<e;s+=1)for(var a=0;a<t;a+=1)i.setPixel(a,s,r(a,s));var n=I();i.write(n);for(var o=function(){var t=0,e=0,r=0,i="",s={},a=function(t){i+=String.fromCharCode(n(63&t))},n=function(t){if(t<0);else{if(t<26)return 65+t;if(t<52)return t-26+97;if(t<62)return t-52+48;if(62==t)return 43;if(63==t)return 47}throw"n:"+t};return s.writeByte=function(i){for(t=t<<8|255&i,e+=8,r+=1;e>=6;)a(t>>>e-6),e-=6},s.flush=function(){if(e>0&&(a(t<<6-e),t=0,e=0),r%3!=0)for(var s=3-r%3,n=0;n<s;n+=1)i+="="},s.toString=function(){return i},s}(),l=n.toByteArray(),c=0;c<l.length;c+=1)o.writeByte(l[c]);return o.flush(),"data:image/gif;base64,"+o};return t}();a.stringToBytesFuncs["UTF-8"]=function(t){return function(t){for(var e=[],r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e.push(i):i<2048?e.push(192|i>>6,128|63&i):i<55296||i>=57344?e.push(224|i>>12,128|i>>6&63,128|63&i):(r++,i=65536+((1023&i)<<10|1023&t.charCodeAt(r)),e.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return e}(t)},i=[],void 0===(s="function"==typeof(r=function(){return a})?r.apply(e,i):r)||(t.exports=s)},46200:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(48921).Z)("account","app/accounts")],data:function(){return{accounts:[],categories:[],form:{id:"",name:"",type:"",reference:"",details:"",offline:"",fees:"",fixed:null,percentage:null,apply_to:"both",opening_balance:null},rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],reference:[{required:!0,message:this.$t("field_is_required",{field:this.$t("reference")}),trigger:"blur"}],type:[{required:!0,message:this.$t("field_is_required",{field:this.$t("type")}),trigger:"blur"}],opening_balance:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("opening_balance")}),trigger:"blur"}]}}},created:function(){var t=this;this.$http.get("app/accounts/search").then((function(e){return t.accounts=e.data})),this.$http.get("app/categories/search").then((function(e){return t.categories=e.data}))},methods:{fetch:function(t){var e=this;this.$http.get("app/accounts/".concat(t)).then((function(t){e.form=t.data,e.loading=!1}))}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("account")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/accounts"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("account",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"account",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("type"),prop:"type",error:t._f("a2s")(t.errors.form.type)}},[r("Input",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),t.form.id?t._e():r("FormItem",{attrs:{prop:"opening_balance",label:t.$t("opening_balance"),error:t._f("a2s")(t.errors.form.opening_balance)}},[r("InputNumber",{model:{value:t.form.opening_balance,callback:function(e){t.$set(t.form,"opening_balance",e)},expression:"form.opening_balance"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"offline",error:t._f("a2s")(t.errors.form.offline)}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.offline,callback:function(e){t.$set(t.form,"offline",e)},expression:"form.offline"}},[r("span",[t._v(t._s(t.$t("show_in_offline")))])])],1),t._v(" "),r("FormItem",{attrs:{prop:"fees",error:t._f("a2s")(t.errors.form.fees)}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.fees,callback:function(e){t.$set(t.form,"fees",e)},expression:"form.fees"}},[r("span",[t._v(t._s(t.$t("transaction_fees")))])])],1),t._v(" "),r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[1==t.form.fees?r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("fixed"),prop:"fixed",error:t._f("a2s")(t.errors.form.fixed)}},[r("InputNumber",{model:{value:t.form.fixed,callback:function(e){t.$set(t.form,"fixed",e)},expression:"form.fixed"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("percentage"),prop:"percentage",error:t._f("a2s")(t.errors.form.percentage)}},[r("InputNumber",{attrs:{formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:t.form.percentage,callback:function(e){t.$set(t.form,"percentage",e)},expression:"form.percentage"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("apply_to"),prop:"apply_to",error:t._f("a2s")(t.errors.form.apply_to)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.apply_to,callback:function(e){t.$set(t.form,"apply_to",e)},expression:"form.apply_to"}},[r("Option",{attrs:{value:"in"}},[t._v(t._s(t.$t("credit")))]),t._v(" "),r("Option",{attrs:{value:"out"}},[t._v(t._s(t.$t("debit")))]),t._v(" "),r("Option",{attrs:{value:"both"}},[t._v(t._s(t.$t("transaction_both")))])],1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1):t._e()],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("accounts")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("accounts",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},60560:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("account","app/accounts","name","reference")],data:function(){return{columns:[{title:"",width:50,key:"id",align:"center",fixed:"left",render:this.renderTransactions},{title:this.$t("name"),sortable:!0,key:"name",sortType:"asc",minWidth:200},{title:this.$tc("type"),sortable:!0,key:"type",width:150},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("balance"),sortable:!1,key:"journal",minWidth:120,render:this.renderBalance},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:250},{title:this.$t("offline"),sortable:!0,key:"offline",width:80,render:this.renderOfflineIcon},{title:this.$t("fees"),sortable:!0,key:"fees",width:70,render:this.renderFeesIcon},{title:this.$t("fixed"),sortable:!0,key:"fixed",width:80,render:this.renderFixed},{title:this.$t("percentage"),sortable:!0,key:"percentage",width:125,render:this.renderPercentage},{title:this.$t("apply_to"),sortable:!0,key:"apply_to",minWidth:150,render:this.renderApplyTo},{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"name",perPage:this.$store.state.settings.rows}}},methods:{renderTransactions:function(t,e){return t("transactions-icon-component",{props:{id:e.row.id,url:"/settings/accounts/transactions/"}})},renderFeesIcon:function(t,e){return this.renderBoolean(t,e,"fees")},renderOfflineIcon:function(t,e){return this.renderBoolean(t,e,"offline")},renderFixed:function(t,e){return t("div",{class:"text-right"},[this.formatNumber(e.row.fixed,this.$store.getters.settings.decimals)])},renderPercentage:function(t,e){return t("div",{class:"text-right"},[this.formatNumber(e.row.percentage,this.$store.getters.settings.decimals),"%"])},renderApplyTo:function(t,e){return e.row.apply_to?"in"==e.row.apply_to?t("div",[this.$t("credit")]):"out"==e.row.apply_to?t("div",[this.$t("debit")]):"both"==e.row.apply_to?t("div",[this.$t("transaction_both")]):void 0:""},renderBalance:function(t,e){return t("div",{class:"text-right"},[this.formatJournalBalance(e.row.journal?e.row.journal.balance.amount:"",this.$store.getters.settings.decimals)])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("account",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/accounts/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("account"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/accounts",columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords}})],1)],1)}),[],!1,null,null,null).exports},57199:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>d});var i=r(19996),s=r(25258),a=r(31197),n=r(24874);function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const u={components:{ExpenseViewComponent:a.Z,IncomeViewComponent:s.Z,PaymentViewComponent:n.Z,ReportFormComponent:i.Z},data:function(){return{url:"",data:{},refresh:1,updated:0,reportForm:{},loading:!1,showForm:!1,income:{},expense:{},payment:{},view_income:!1,view_expense:!1,view_payment:!1,fields:["created_at","customer_id","supplier_id","user_id"],columns:[{width:50,type:"expand",render:function(t,e){return t("pre",{style:{margin:"0"}},JSON.stringify(e.row.subject,null,"  "))}},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"asc",width:175,render:this.renderCreatedAt},{title:this.$tc("account"),sortable:!1,key:"account",minWidth:200,render:this.renderAccount},{title:this.$tc("subject"),sortable:!1,key:"subject",minWidth:200,render:this.renderSubject},{title:this.$tc("debit"),sortable:!0,key:"debit",width:150,render:this.renderDebit},{title:this.$tc("credit"),sortable:!0,key:"credit",width:150,render:this.renderCredit},{title:this.$t("type"),sortable:!1,key:"type",width:200,render:this.renderType}],options:{hideSearch:!0,showSummary:!0,orderBy:"created_at desc",summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.fields.map((function(e){t.reportForm[e]=""})),this.url="app/accounts/transactions/".concat(this.$route.params.id,"/table"),this.$http.get("app/accounts/transactions/".concat(this.$route.params.id),{params:l(l({},this.reportForm),{},{date:""})}).then((function(e){t.prepareData(e.data.transactions),t.reportForm.end_date=new Date(e.data.end_date),t.reportForm.start_date=new Date(e.data.start_date),t.reportForm.created_at=[new Date(e.data.start_date),new Date(e.data.end_date)],t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.created_at&&this.reportForm.created_at[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.created_at[0]).format(this.datetimeFormatString())),this.reportForm.created_at&&this.reportForm.created_at[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.created_at[1]).format(this.datetimeFormatString())),delete this.reportForm.created_at,this.url="app/accounts/transactions/".concat(this.$route.params.id,"/table?").concat(this.queryString(this.reportForm)),this.refresh++,this.$http.get("app/accounts/transactions/".concat(this.$route.params.id),{params:l(l({},this.reportForm),{},{date:""})}).then((function(t){e.prepareData(t.data.transactions),e.reportForm.created_at=[new Date(t.data.start_date),new Date(t.data.end_date)],e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.data=[{label:this.$t("start_balance"),value:t.start_balance},{label:this.$t("close_balance"),value:t.close_balance}]},showInfo:function(t){t.subject_type&&t.subject_type.includes("Payment")?this.viewPayment(t.subject_id):t.subject_type&&t.subject_type.includes("Expense")?this.viewExpense(t.subject_id):t.subject_type&&t.subject_type.includes("Income")&&this.viewIncome(t.subject_id)},renderType:function(t,e){var r=e.row.type.split("_"),i=r[0],s="opening"==i?"success":"primary",a=r[1],n="created"==a?"success":"updated"==a?"warning":"deleted"==a?"error":"default";return t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-".concat(s," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.capitalize(i)])]),t("div",{class:"ivu-tag ivu-tag-".concat(n," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ".concat("default"==n?"":"ivu-tag-color-white")},[this.capitalize(a)])])])},renderAccount:function(t,e){return t("div",[e.row.journal.morphed?e.row.journal.morphed.name+" ("+e.row.journal.morphed.reference+")":""])},renderSubject:function(t,e){if(e.row.subject_type){var r=e.row.subject_type.split("\\");return t("div",[r[r.length-1]+": "+e.row.subject_id])}},renderCredit:function(t,e){return t("div",{class:"text-right"},[this.formatJournalBalance(e.row.credit,this.$store.getters.settings.decimals)])},renderDebit:function(t,e){return t("div",{class:"text-right"},[this.formatJournalBalance(e.row.debit,this.$store.getters.settings.decimals)])},renderCreatedAt:function(t,e){return t("div",[this.$options.filters.formatDate(e.row.created_at,this.$store.state.settings.dateformat+" HH:mm A")])},rowClassName:function(t,e){return t.debit>0?"ivu-table-warning-row":t.credit>0?"ivu-table-success-row":t.credit||t.debit?"":"ivu-table-error-row"},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["debit","credit"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return t.void||t.draft?0:Number(e.formatDecimal(t[n]))}));if(!o.every((function(t){return isNaN(t)}))){var l=o.reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatJournalBalance(l)}}}else a[n]={key:n,value:""}})),a},viewPayment:function(t){var e=this;this.view_payment=!0,t!=this.payment.id&&(this.loading=!0,this.$http.get("app/payments/".concat(t)).then((function(t){return e.payment=t.data})).finally((function(){return e.loading=!1})))},viewIncome:function(t){var e=this;this.view_income=!0,t!=this.income.id&&(this.loading=!0,this.$http.get("app/incomes/".concat(t)).then((function(t){return e.income=t.data})).finally((function(){return e.loading=!1})))},viewExpense:function(t){var e=this;this.view_expense=!0,t!=this.expense.id&&(this.loading=!0,this.$http.get("app/expenses/".concat(t)).then((function(t){return e.expense=t.data})).finally((function(){return e.loading=!1})))}}};const d=(0,r(51900).Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("transactions"))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" - "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("router-link",{attrs:{to:"/settings/accounts"}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n        "+t._s(t.$t("list"))+" "+t._s(t.$tc("account",2))+"\n      ")],1),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n        "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n      ")],1)],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,updated:t.updated,reportForm:t.reportForm},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[r("Col",{key:i,attrs:{sm:12,md:12}},[r("div",{staticClass:"box static",class:"box"+(i+5)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatJournalBalance(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])])]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.showInfo,"row-class-name":t.rowClassName}})],1)]),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,title:t.$tc("payment")},model:{value:t.view_payment,callback:function(e){t.view_payment=e},expression:"view_payment"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("payment-view-component",{attrs:{payment:t.payment}})],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{title:t.$tc("income"),width:"750","footer-hide":!0},model:{value:t.view_income,callback:function(e){t.view_income=e},expression:"view_income"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("income-view-component",{attrs:{income:t.income}})],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{title:t.$tc("expense"),width:"750","footer-hide":!0},model:{value:t.view_expense,callback:function(e){t.view_expense=e},expression:"view_expense"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("expense-view-component",{attrs:{expense:t.expense}})],1)],1)}),[],!1,null,null,null).exports},58706:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>l});var i=r(48921);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var n=function(t,e){return t.order=t.order?parseFloat(t.order):null,e.form=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),e.form};const o={mixins:[(0,i.Z)("brand","app/brands",!1,n)],data:function(){return{brands:[],photo:null,form:{id:"",code:"",name:"",order:null,details:"",photo:null},rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}]}}},methods:{fetch:function(t){var e=this;this.$http.get("app/brands/".concat(t)).then((function(t){return n(t.data,e)})).finally((function(){return e.loading=!1}))},handleUpload:function(t){var e=this,r=new FileReader;return r.addEventListener("load",(function(){return e.photo=r.result}),!1),this.form.photo=t,r.readAsDataURL(t),!1},clearPhoto:function(){this.photo=null,this.form.photo=null}}};const l=(0,r(51900).Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("brand")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/brands"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("brand",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"brand",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:18,lg:12}},[r("FormItem",{attrs:{label:t.$tc("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("order"),prop:"order",error:t._f("a2s")(t.errors.form.order)}},[r("InputNumber",{model:{value:t.form.order,callback:function(e){t.$set(t.form,"order",e)},expression:"form.order"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("photo"),prop:"photo",error:t._f("a2s")(t.errors.form.photo)}},[r("Upload",{attrs:{"before-upload":t.handleUpload,"max-size":1024,action:"",accept:".png, .jpeg, .jpg, .gif"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("select_x",{x:t.$t("photo")})))])],1),t._v(" "),t.photo||t.form.photo?r("div",{staticClass:"primary"},[r("div",{staticStyle:{position:"relative","max-width":"160px","max-height":"110px"}},[t.photo?r("Button",{staticStyle:{position:"absolute",top:"5px",right:"5px"},attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.clearPhoto()}}}):t._e(),t._v(" "),t.photo||t.form.photo?r("img",{staticStyle:{"max-width":"160px","max-height":"110px","border-radius":"4px"},attrs:{alt:"photo",src:t.photo?t.photo:t.form.photo}}):t._e()],1),t._v(" "),t.photo?r("small",{staticClass:"warning"},[t._v(t._s(t.$t("not_uploaded_yet")))]):t._e()]):t._e()],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:6,lg:12}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("brands")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("brands",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},15690:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("brand","app/brands","name")],data:function(){return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("photo"),sortable:!1,key:"photo",width:60,render:this.renderPhoto},{title:this.$t("name"),sortable:!0,key:"name",minWidth:200},{title:this.$tc("code"),sortable:!0,key:"code",sortType:"asc",width:150},{title:this.$t("slug"),sortable:!0,key:"slug",minWidth:200},{title:this.$tc("order"),sortable:!0,key:"order",maxWidth:100,minWidth:80},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:250},{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"code",perPage:this.$store.state.settings.rows}}},methods:{renderPhoto:function(t,e){return e.row.photo?t("div",{style:"display:flex;align-items:center;justify-center:center;"},[t("img",{attrs:{src:e.row.photo,alt:""},style:"max-width:100%;max-height:100%;border-radius:2px"})]):""},renderBase:function(t,e){return t("div",[e.row.base_brand?e.row.base_brand.name:""])},renderOperator:function(t,e){return t("div",[e.row.operator?this.$t(e.row.operator):""])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("brand",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/brands/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("brand"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/brands",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},20450:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(48921).Z)("category","app/categories")],data:function(){return{cdata:[],photo:null,categories:[],form:{id:"",name:"",code:"",photo:null},rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"},{required:!0,pattern:/^([a-zA-Z0-9-_]{2,25})$/,message:this.$t("alpha_dash_error"),trigger:["blur","change"]}]}}},created:function(){var t=this;this.$http.get("app/all_categories/search").then((function(e){return t.categories=t.flattenDeep(e.data)}))},methods:{fetch:function(t){var e=this;this.$http.get("app/categories/".concat(t)).then((function(t){delete t.data.created_at,delete t.data.updated_at,e.form=t.data})).catch((function(t){e.$event.fire("appError",t.response)})).finally((function(){return e.loading=!1}))},handleUpload:function(t){var e=this,r=new FileReader;return r.addEventListener("load",(function(){return e.photo=r.result}),!1),this.form.photo=t,r.readAsDataURL(t),!1},clearPhoto:function(){this.photo=null,this.form.photo=null}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("category")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/categories"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("category",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"category",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:12}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("FormItem",{attrs:{label:t.$t("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),t.categories.length>0?r("FormItem",{attrs:{prop:"parent_id",label:t.$tc("parent_category"),error:t._f("a2s")(t.errors.form.parent_id)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.parent_id,callback:function(e){t.$set(t.form,"parent_id",e)},expression:"form.parent_id"}},t._l(t.categories,(function(e,i){return r("Option",{key:i,attrs:{value:e.id}},[t._v("\n                "+t._s(e.name)+"\n              ")])})),1)],1):t._e(),t._v(" "),r("FormItem",{attrs:{label:t.$tc("photo"),prop:"photo",error:t._f("a2s")(t.errors.form.photo)}},[r("Upload",{attrs:{"before-upload":t.handleUpload,"max-size":1024,action:"",accept:".png, .jpeg, .jpg, .gif"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("select_x",{x:t.$t("photo")})))])],1),t._v(" "),t.photo||t.form.photo?r("div",{staticClass:"primary"},[r("div",{staticStyle:{position:"relative","max-width":"160px","max-height":"110px"}},[t.photo?r("Button",{staticStyle:{position:"absolute",top:"5px",right:"5px"},attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.clearPhoto()}}}):t._e(),t._v(" "),t.photo||t.form.photo?r("img",{staticStyle:{"max-width":"160px","max-height":"110px","border-radius":"4px"},attrs:{alt:"photo",src:t.photo?t.photo:t.form.photo}}):t._e()],1),t._v(" "),t.photo?r("small",{staticClass:"warning"},[t._v(t._s(t.$t("not_uploaded_yet")))]):t._e()]):t._e()],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("categories")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("categories",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1),t._v(" "),r("Col",{attrs:{md:24,lg:12}})],1)],1)],1)],1)}),[],!1,null,null,null).exports},75419:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("category","app/categories","code","name")],data:function(){return{refresh:1,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("photo"),sortable:!1,key:"photo",width:60,render:this.renderPhoto},{title:this.$t("code"),sortable:!0,key:"code",width:200,sortType:"asc"},{title:this.$t("name"),sortable:!0,key:"name",minWidth:200},{title:this.$t("slug"),sortable:!0,key:"slug",minWidth:200},{title:this.$t("parent_category"),sortable:!0,key:"name",minWidth:200,render:this.renderParent},{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"code",perPage:this.$store.state.settings.rows}}},methods:{renderPhoto:function(t,e){return e.row.photo?t("div",{style:"display:flex;align-items:center;justify-center:center;"},[t("img",{attrs:{src:e.row.photo,alt:""},style:"max-width:100%;max-height:100%;border-radius:2px"})]):""},renderParent:function(t,e){return t("div",[e.row.parent?e.row.parent.name:""])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("category",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/categories/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("category"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/categories",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},34901:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var i=r(48921),s=function(t,e){return t.discount=parseFloat(t.discount),t};const a={mixins:[(0,i.Z)("customer_group","app/customer_groups",!1,s)],data:function(){return{form:{id:"",name:"",code:"",discount:null},rules:{name:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("name")})}],code:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("code")})}],discount:[{required:!0,type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("discount")})}]}}},methods:{fetch:function(t){var e=this;this.$http.get("app/customer_groups/".concat(t)).then((function(t){return e.form=s(t.data)})).finally((function(){return e.loading=!1}))}}};const n=(0,r(51900).Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("customer_group")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/customer_groups"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("customer_group",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"customer_group",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("discount"),prop:"discount",error:t._f("a2s")(t.errors.form.discount)}},[r("InputNumber",{attrs:{formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("customer_groups")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("customer_groups",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},42037:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("customer_group","app/customer_groups","name","code")],data:function(){return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",sortType:"asc",minWidth:150},{title:this.$t("code"),sortable:!0,key:"code",minWidth:150},{title:this.$tc("discount"),sortable:!0,key:"discount",minWidth:125,render:this.renderDiscount},{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"name",perPage:this.$store.state.settings.rows}}},methods:{renderDiscount:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatDecimal(e.row.discount,this.$store.getters.settings.decimals),"%"])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("customer_group",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/customer_groups/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("customer_group"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/customer_groups",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},70083:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(48921);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.customer_group_id=t.customer_group?t.customer_group.id:"",t.due_limit=t.due_limit?parseFloat(t.due_limit):null,delete t.customer_group,e.form=a(a({},t),t.extra_attributes),e.form};const l={mixins:[(0,i.Z)("customer","app/customers",!0,o)],data:function(){return{countries:[],attributes:[],searching:!1,customer_groups:[],states:[{value:"",label:this.$t("select_country")}],form:{id:"",name:"",email:"",phone:"",state:"",number:"",footer:"",address:"",country:"",show_tax:0,due_limit:null,show_discount:0,require_country:0,customer_group_id:"",opening_balance:null},rules:{name:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("name")})}],phone:[{required:!1,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("phone")})}],email:[{required:!1,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("email")})}],address:[{required:!1,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("address")})}],country:[{trigger:"change",required:this.$store.getters.require_country,message:this.$t("field_is_required",{field:this.$t("country")})}],state:[{trigger:"change",required:this.$store.getters.require_country,message:this.$t("field_is_required",{field:this.$t("state")})}],customer_group_id:[{required:!1,trigger:"change",message:this.$t("field_is_required",{field:this.$tc("customer_group")})}]}}},created:function(){var t=this;this.$http.get("app/countries").then((function(e){var r=e.data;return t.countries=r})),this.$http.get("app/customer_groups/search").then((function(e){var r=e.data;return t.customer_groups=r}))},methods:{create:function(){var t=this;this.$http.get("app/customers/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/customers/".concat(t)).then((function(t){return e.form=o(t.data,e)})).finally((function(){return e.loading=!1}))},countryChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t?(this.searching=!0,this.getStates(t,e),this.form.state=""):(this.form.state="",this.form.country="",this.states=[{value:"",label:this.$t("select_country")}])},getStates:function(t,e){var r=this;this.$http.get("app/states",{params:{country:t}}).then((function(t){r.states=t.data,e&&(r.form.state=r.states.find((function(t){return t.value==e})).value),r.searching=!1})).catch((function(t){return r.$event.fire("appError",t.response)}))}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("customer")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/customers"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("customer",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"customer",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("company"),prop:"company",error:t._f("a2s")(t.errors.form.company)}},[r("Input",{model:{value:t.form.company,callback:function(e){t.$set(t.form,"company",e)},expression:"form.company"}})],1),t._v(" "),t.form.id?t._e():r("FormItem",{attrs:{error:t._f("a2s")(t.errors.form.title),label:t.$t("opening_balance"),prop:"opening_balance"}},[r("InputNumber",{model:{value:t.form.opening_balance,callback:function(e){t.$set(t.form,"opening_balance",e)},expression:"form.opening_balance"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("phone"),prop:"phone",error:t._f("a2s")(t.errors.form.phone)}},[r("Input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("email"),prop:"email",error:t._f("a2s")(t.errors.form.email)}},[r("Input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("due_limit"),prop:"due_limit",error:t._f("a2s")(t.errors.form.due_limit)}},[r("InputNumber",{model:{value:t.form.due_limit,callback:function(e){t.$set(t.form,"due_limit",e)},expression:"form.due_limit"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("customer_group"),prop:"customer_group",error:t._f("a2s")(t.errors.form.customer_group)}},[r("Select",{attrs:{clearable:"",placeholder:t.$t("select_x",{x:t.$tc("customer_group")})},model:{value:t.form.customer_group_id,callback:function(e){t.$set(t.form,"customer_group_id",e)},expression:"form.customer_group_id"}},t._l(t.customer_groups,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("house_no"),prop:"house_no",error:t._f("a2s")(t.errors.form.house_no)}},[r("Input",{model:{value:t.form.house_no,callback:function(e){t.$set(t.form,"house_no",e)},expression:"form.house_no"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("street_no"),prop:"street_no",error:t._f("a2s")(t.errors.form.street_no)}},[r("Input",{model:{value:t.form.street_no,callback:function(e){t.$set(t.form,"street_no",e)},expression:"form.street_no"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("address"),prop:"address",error:t._f("a2s")(t.errors.form.address)}},[r("Input",{model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("city"),prop:"city",error:t._f("a2s")(t.errors.form.city)}},[r("Input",{model:{value:t.form.city,callback:function(e){t.$set(t.form,"city",e)},expression:"form.city"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("postal_code"),prop:"postal_code",error:t._f("a2s")(t.errors.form.postal_code)}},[r("Input",{model:{value:t.form.postal_code,callback:function(e){t.$set(t.form,"postal_code",e)},expression:"form.postal_code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("country"),prop:"country",error:t._f("a2s")(t.errors.form.country)}},[r("Select",{attrs:{placeholder:"",filterable:""},on:{"on-change":t.countryChange},model:{value:t.form.country,callback:function(e){t.$set(t.form,"country",e)},expression:"form.country"}},t._l(t.countries,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("state"),prop:"state",error:t._f("a2s")(t.errors.form.state)}},[r("Select",{attrs:{placeholder:"",filterable:"",loading:t.searching},model:{value:t.form.state,callback:function(e){t.$set(t.form,"state",e)},expression:"form.state"}},t._l(t.states,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("customers")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("customers",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},46433:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>d});var i=r(92704);const s={props:{customer_id:{required:!0},current:{required:!1}},data:function(){return{saving:!1,address:[],countries:[],attributes:[],searching:!1,customer_groups:[],errors:{message:"",form:{}},states:[{value:"",label:this.$t("select_country")}],form:{first_name:"",last_name:"",email:"",phone:"",country:"",state:"",house_no:"",street_no:"",company:"",address:"",city:"",postal_code:"",default:""},rules:{first_name:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("first_name")})}],last_name:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("last_name")})}],phone:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("phone")})}],email:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("email")})}],house_no:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("house_no")})}],street_no:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("street_no")})}],address:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("address")})}],country:[{required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("country")})}],state:[{required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("state")})}],city:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$tc("city")})}],postal_code:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$tc("postal_code")})}]}}},created:function(){var t=this;this.$http.get("app/countries").then((function(e){var r=e.data;return t.countries=r}))},watch:{current:function(t){t?(this.getStates(t.country,t.state),this.form=t):(this.form.id=null,this.$refs.address.resetFields())}},methods:{submit:function(){var t=this;this.$refs.address.validate((function(e){e&&(t.form.customer_id=t.customer_id,t.form.id?t.$http.put("app/customers/update_address/"+t.form.id,t.form).then((function(e){e.data.success?(t.$Notice.destroy(),t.$Notice.success({title:t.$tc("address")+" "+t.$t("updated"),desc:t.$t("record_updated")}),t.$emit("added",e.data.address)):t.$Notice.error({title:t.$t("failed"),desc:t.$t("failed_error_text")})})).catch((function(e){return t.errors=e})).finally((function(){return t.saving=!1})):t.$http.post("app/customers/add_address",t.form).then((function(e){e.data.success?(t.$Notice.destroy(),t.$Notice.success({title:t.$tc("address")+" "+t.$t("added"),desc:t.$t("record_added")}),t.$emit("added",e.data.address)):t.$Notice.error({title:t.$t("failed"),desc:t.$t("failed_error_text")})})).catch((function(e){return t.errors=e})).finally((function(){return t.saving=!1})))}))},handleReset:function(){this.$refs.address.resetFields(),this.saving=!1},countryChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t?(this.searching=!0,this.getStates(t,e),this.form.state=""):(this.form.state="",this.form.country="",this.states=[{value:"",label:this.$t("select_country")}])},getStates:function(t,e){var r=this;this.$http.get("app/states",{params:{country:t}}).then((function(t){r.states=t.data,e&&(r.form.state=r.states.find((function(t){return t.value==e})).value),r.searching=!1})).catch((function(t){return r.$event.fire("appError",t.response)}))}}};var a=r(51900);const n=(0,a.Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Form",{ref:"address",attrs:{model:t.form,rules:t.rules,"label-position":"top",autocomplete:"off"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("first_name"),prop:"first_name",error:t._f("a2s")(t.errors.form.first_name)}},[r("Input",{model:{value:t.form.first_name,callback:function(e){t.$set(t.form,"first_name",e)},expression:"form.first_name"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("last_name"),prop:"last_name",error:t._f("a2s")(t.errors.form.last_name)}},[r("Input",{model:{value:t.form.last_name,callback:function(e){t.$set(t.form,"last_name",e)},expression:"form.last_name"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("email"),prop:"email",error:t._f("a2s")(t.errors.form.email)}},[r("Input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("phone"),prop:"phone",error:t._f("a2s")(t.errors.form.phone)}},[r("Input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{attrs:{label:t.$tc("company"),prop:"company",error:t._f("a2s")(t.errors.form.company)}},[r("Input",{model:{value:t.form.company,callback:function(e){t.$set(t.form,"company",e)},expression:"form.company"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("house_no"),prop:"house_no",error:t._f("a2s")(t.errors.form.house_no)}},[r("Input",{model:{value:t.form.house_no,callback:function(e){t.$set(t.form,"house_no",e)},expression:"form.house_no"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("street_no"),prop:"street_no",error:t._f("a2s")(t.errors.form.street_no)}},[r("Input",{model:{value:t.form.street_no,callback:function(e){t.$set(t.form,"street_no",e)},expression:"form.street_no"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{attrs:{label:t.$t("address"),prop:"address",error:t._f("a2s")(t.errors.form.address)}},[r("Input",{model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("city"),prop:"city",error:t._f("a2s")(t.errors.form.city)}},[r("Input",{model:{value:t.form.city,callback:function(e){t.$set(t.form,"city",e)},expression:"form.city"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("postal_code"),prop:"postal_code",error:t._f("a2s")(t.errors.form.postal_code)}},[r("Input",{model:{value:t.form.postal_code,callback:function(e){t.$set(t.form,"postal_code",e)},expression:"form.postal_code"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("country"),prop:"country",error:t._f("a2s")(t.errors.form.country),autocomplete:"off"}},[r("Select",{attrs:{placeholder:"",filterable:""},on:{"on-change":t.countryChange},model:{value:t.form.country,callback:function(e){t.$set(t.form,"country",e)},expression:"form.country"}},t._l(t.countries,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("state"),prop:"state",error:t._f("a2s")(t.errors.form.state),autocomplete:"off"}},[r("Select",{attrs:{placeholder:"",filterable:"",loading:t.searching},model:{value:t.form.state,callback:function(e){t.$set(t.form,"state",e)},expression:"form.state"}},t._l(t.states,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.submit()}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports;const o={props:{customer:{required:!0},addUserFn:{type:Function,required:!1},addAddressFn:{type:Function,required:!1},listUsersFn:{type:Function,required:!1},listAddressesFn:{type:Function,required:!1}}};function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const u={components:{AddressFormComponent:n,CustomerViewComponent:(0,a.Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.customer?r("div",[r("div",{staticClass:"table-responsive mb16"},[r("div",{staticClass:"ivu-table-wrapper ivu-table-wrapper-with-border"},[r("div",{staticClass:"ivu-table ivu-table-default ivu-table-border"},[r("div",{staticClass:"ivu-table-body"},[r("table",{staticStyle:{width:"100%","min-width":"300px"},attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[r("tbody",{staticClass:"ivu-table-tbody"},[r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("name")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[r("strong",[t._v(t._s(t.customer.name))]),t._v(" "),t.customer.company?r("span",[t._v("("+t._s(t.customer.company)+")")]):t._e()])])]),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("phone")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[r("strong",[t._v(t._s(t.customer.phone))]),t._v(" "),t.customer.email?r("span",[t._v("("+t._s(t.customer.email)+")")]):t._e()])])]),t._v(" "),t.customer.journal&&t.customer.journal.balance?r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.customer.journal.balance.amount>0?t.$t("due"):t.$t("deposit")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v("\n                    "+t._s(t.customer.journal.balance.amount>0?t.$t("due"):t.$t("advance"))+":\n                    "),r("strong",[t._v(t._s(t.customer.journal?t.formatJournalBalance(t.customer.journal.balance.amount>0?t.customer.journal.balance.amount:0-t.customer.journal.balance.amount,t.$store.getters.settings.decimals):""))])])])]):t._e(),t._v(" "),t.customer.customer_group?r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$tc("customer_group")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[r("strong",[t._v(t._s(t.customer.customer_group?t.customer.customer_group.name:""))])])])]):t._e(),t._v(" "),t.customer.points?r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("loyalty_points")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[r("strong",[t._v(t._s(t.formatNumber(t.customer.points)))])])])]):t._e(),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("address")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v("\n                    "+t._s(t.customer.address+" "+t.customer.state_name+" "+t.customer.country_name)+"\n                  ")])])]),t._v(" "),t.customer.extra_attributes&&t.customer.extra_attributes.length?r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$tc("field",2)))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v("\n                    "+t._s(Object.entries(t.customer.extra_attributes).map((function(t){return t.join(": ")})).join(", "))+"\n                  ")])])]):t._e()])])])])])]),t._v(" "),r("div",{staticClass:"text-center"},[t.addUserFn?r("Button",{on:{click:function(e){return t.addUserFn(t.customer)}}},[t._v(t._s(t.$t("add_x",{x:t.$tc("user")})))]):t._e(),t._v(" "),t.listUsersFn?r("Button",{on:{click:function(e){return t.listUsersFn(t.customer)}}},[t._v(t._s(t.$t("list_x",{x:t.$tc("user",2)})))]):t._e(),t._v(" "),t.addAddressFn?r("Button",{on:{click:function(e){return t.addAddressFn(t.customer)}}},[t._v(t._s(t.$t("add_x",{x:t.$t("address")})))]):t._e(),t._v(" "),t.listAddressesFn?r("Button",{on:{click:function(e){return t.listAddressesFn(t.customer)}}},[t._v(t._s(t.$t("list_x",{x:t.$t("addresses")})))]):t._e()],1)]):t._e()}),[],!1,null,null,null).exports},mixins:[(0,i.Z)("customer","app/customers","name","company")],data:function(){var t=this,e=function(e,r,i){t.user_form.email||t.user_form.phone?i():i(new Error(t.$t("field_is_required",{field:t.$t("email_or_phone")})))};return{row:{},users:[],view:!1,current:null,addresses:[],saving:!1,loading:!1,add_user:!1,view_users:!1,add_address:!1,selected_user:null,view_addresses:!1,errors:{message:"",form:{}},user_form:{id:"",name:"",active:1,phone:"",email:"",employee:0,username:"",password:"",email_verified_at:1,password_confirmation:""},address_form:{},columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",sortType:"asc",minWidth:200},{title:this.$tc("company"),sortable:!0,key:"company",width:175},{title:this.$t("phone"),sortable:!0,key:"phone",width:150},{title:this.$t("email"),sortable:!0,key:"email",minWidth:200},{title:this.$t("points"),sortable:!1,key:"points",width:125,render:this.renderPoints},{title:this.$t("balance"),sortable:!1,key:"journal",width:125,render:this.renderBalance},{minWidth:150,key:"customer_group_id",title:this.$tc("customer_group"),render:this.renderCustomerGroup},{title:this.$t("address"),sortable:!0,key:"address",minWidth:200,render:this.renderAddress},{title:this.$t("state"),sortable:!0,key:"state_name",maxWidth:150,minWidth:150},{title:this.$t("country"),sortable:!0,key:"country_name",maxWidth:150,minWidth:150},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:200,render:this.renderExtras},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-dropdown-component",{props:{params:r,editFn:t.editRecord,listFn:t.listRecord,payFn:t.paymentRecord,listUsersFn:t.listUsers,deleteFn:t.deleteRecord,addUserFn:t.showUserForm,addAddressFn:t.showAddressForm,listAddressesFn:t.listAddresses,record:{model:"item",name:"name",title:t.$tc("customer")}}})}}],options:{orderBy:"name",perPage:this.$store.state.settings.rows},user_rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],username:[{required:!0,message:this.$t("field_is_required",{field:this.$t("username")}),trigger:"blur"}],phone:[{validator:e,required:!1,trigger:"change"}],email:[{validator:e,required:!1,trigger:"change"},{type:"email",message:this.$t("email_invalid"),trigger:["change","blur"]}],password:[{required:!this.selected_user,min:6,message:this.$t("password_error"),trigger:"blur"}],password_confirmation:[{trigger:"blur",required:!this.selected_user,message:this.$t("field_is_required",{field:this.$t("confirm_password")})},{validator:function(e,r,i){r!==t.user_form.password?i(new Error(t.$t("confirm_password_not_match"))):i()},required:!this.selected_user,trigger:"change"}]}}},computed:{url:function(){return"app/customers"+(this.$route.query.due_limit?"?due_limit="+parseInt(this.$route.query.due_limit):"")}},watch:{"$route.query.due_limit":function(){this.refresh++}},methods:{showInfo:function(t){this.row=t,this.view=!0},paymentRecord:function(t){this.$router.push("/payments/add?customer_id=".concat(t.id).concat(t.journal.balance.amount<0?"&amount="+(0-t.journal.balance.amount/100):""))},listRecord:function(t){this.$router.push("/customers/transactions/"+t.id)},showUserForm:function(t,e){this.row=t,e&&(this.user_form=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e)),this.add_user=!0},showAddressForm:function(t,e){this.row=t,this.current=e,this.add_address=!0},resetUserForm:function(t){var e=this;t||(this.selected_user=null,this.$refs.user_form.resetFields(),this.saving=!1,setTimeout((function(){e.user_form.id=null}),250))},addUser:function(){var t=this;this.$refs.user_form.validate((function(e){e?(t.saving=!0,t.user_form.customer_id=t.row.id,t.user_form.id?t.$http.put("app/customers/update_user/"+t.user_form.id,t.user_form).then((function(e){if(e.data&&e.data.success){t.add_user=!1;var r=e.data.user;t.selected_user=null,t.users=t.users.map((function(t){return t.id==r.id?r:t})),t.$Notice.success({title:t.$t("success"),desc:t.$t("record_updated")})}else t.$Notice.error({title:t.$t("failed"),desc:t.$t("failed_error_text"),duration:10})})).catch().finally((function(){return t.saving=!1})):t.$http.post("app/customers/add_user",t.user_form).then((function(e){e.data&&e.data.success?(t.add_user=!1,t.users.push(e.data.user),t.$Notice.success({title:t.$t("success"),desc:t.$t("record_added")})):t.$Notice.error({title:t.$t("failed"),desc:t.$t("failed_error_text"),duration:10})})).catch().finally((function(){return t.saving=!1}))):t.$Notice.error({title:t.$t("invalid_form"),desc:t.$t("invalid_form_error"),duration:10})}))},addressAdded:function(t){this.current?(this.current=null,this.addresses=this.addresses.map((function(e){return e.id==t.id?t:e}))):this.addresses.push(t),this.add_address=!1},listUsers:function(t){var e=this;this.view_users=!0,this.users.length||(this.loading=!0,this.$http.get("app/customers/users/"+t.id).then((function(t){return e.users=t.data})).catch().finally((function(){return e.loading=!1})))},listAddresses:function(t){var e=this;this.view_addresses=!0,this.addresses.length||(this.loading=!0,this.$http.get("app/customers/addresses/"+t.id).then((function(t){return e.addresses=t.data})).catch().finally((function(){return e.loading=!1})))},renderCustomerGroup:function(t,e){return t("div",[e.row.customer_group?e.row.customer_group.name:""])},renderTransactions:function(t,e){return t("transactions-icon-component",{props:{id:e.row.id,url:"/customers/transactions/"}})},renderPoints:function(t,e){return t("div",{class:"text-right"},[e.row.points?this.formatNumber(e.row.points):""])},renderBalance:function(t,e){return t("div",{class:"text-right"},[e.row.journal?this.formatJournalBalance(e.row.journal.balance.amount,this.$store.getters.settings.decimals):""])}}};const d=(0,a.Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("customer",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/customers/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("customer"))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("pre",{staticStyle:{"font-size":"10px"}},[t._v(t._s(t.$t("customer_balance_tip")))]),t._v(" "),r("Modal",{attrs:{"footer-hide":"",scrollable:"",width:750},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[r("p",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("\n        "+t._s(t.row.name)+"\n        "),t.row.company?r("span",[t._v("("+t._s(t.row.company)+")")]):t._e()])]),t._v(" "),r("customer-view-component",{attrs:{customer:t.row,listUsersFn:t.listUsers,addUserFn:t.showUserForm,addAddressFn:t.showAddressForm,listAddressesFn:t.listAddresses}})],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"500","footer-hide":"","mask-closable":!1,title:t.user_form.id?t.$t("edit_x",{x:t.$tc("user")}):t.$t("add_x",{x:t.$tc("user")})},on:{"on-visible-change":t.resetUserForm},model:{value:t.add_user,callback:function(e){t.add_user=e},expression:"add_user"}},[r("Form",{ref:"user_form",staticClass:"form-responsive",attrs:{model:t.user_form,rules:t.user_rules,"label-width":150}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.user_form.name,callback:function(e){t.$set(t.user_form,"name",e)},expression:"user_form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("phone"),prop:"phone",error:t._f("a2s")(t.errors.form.phone)}},[r("Input",{model:{value:t.user_form.phone,callback:function(e){t.$set(t.user_form,"phone",e)},expression:"user_form.phone"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("email"),prop:"email",error:t._f("a2s")(t.errors.form.email)}},[r("Input",{model:{value:t.user_form.email,callback:function(e){t.$set(t.user_form,"email",e)},expression:"user_form.email"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("username"),prop:"username",error:t._f("a2s")(t.errors.form.username)}},[r("Input",{model:{value:t.user_form.username,callback:function(e){t.$set(t.user_form,"username",e)},expression:"user_form.username"}})],1),t._v(" "),t.user_form.id?t._e():[r("FormItem",{attrs:{label:t.$t("new_password"),prop:"password",error:t._f("a2s")(t.errors.form.password)}},[r("Input",{attrs:{type:"password",password:""},model:{value:t.user_form.password,callback:function(e){t.$set(t.user_form,"password",e)},expression:"user_form.password"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"password_confirmation",label:t.$t("confirm_password"),error:t._f("a2s")(t.errors.form.password_confirmation)}},[r("Input",{attrs:{type:"password",password:""},model:{value:t.user_form.password_confirmation,callback:function(e){t.$set(t.user_form,"password_confirmation",e)},expression:"user_form.password_confirmation"}})],1)],t._v(" "),r("FormItem",{attrs:{prop:"active",error:t._f("a2s")(t.errors.form.active)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.user_form.active,callback:function(e){t.$set(t.user_form,"active",e)},expression:"user_form.active"}},[r("span",[t._v(t._s(t.$t("active")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.addUser()}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])])],1)],2)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"550","footer-hide":"","mask-closable":!1,title:t.current?t.$t("edit_x",{x:t.$t("address")}):t.$t("add_x",{x:t.$t("address")})},model:{value:t.add_address,callback:function(e){t.add_address=e},expression:"add_address"}},[r("address-form-component",{attrs:{current:t.current,customer_id:t.row.id},on:{added:t.addressAdded}})],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{title:t.$tc("user",2),width:t.users&&t.users.length?550:350,"footer-hide":""},model:{value:t.view_users,callback:function(e){t.view_users=e},expression:"view_users"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):r("div",[t.users&&t.users.length?r("div",[r("div",{staticStyle:{"margin-top":"-16px"}}),t._v(" "),t._l(t.users,(function(e,i){return[r("Button",{key:"u_"+i,staticClass:"mt16",staticStyle:{height:"auto","white-space":"normal",padding:"8px","text-align":"left"},attrs:{long:""},on:{click:function(r){return t.showUserForm(t.row,e)}}},[t._v("\n            "+t._s(e.name)+" ( "),r("strong",[t._v(t._s(e.username))]),t._v(" )\n            "),e.phone?r("div",[t._v(t._s(t.$t("phone"))+": "+t._s(e.phone))]):t._e(),t._v(" "),e.email?r("div",[t._v(t._s(t.$t("email"))+": "+t._s(e.email))]):t._e(),t._v(" "),r("div",[t._v(t._s(t.$t("active"))+": "+t._s(1==e.active?t.$t("yes"):t.$t("no")))])])]}))],2):r("h4",[t._v(t._s(t.$t("no_data")))])])]),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{"footer-hide":"",title:t.$t("addresses"),width:t.addresses&&t.addresses.length?550:350},model:{value:t.view_addresses,callback:function(e){t.view_addresses=e},expression:"view_addresses"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):r("div",[t.addresses&&t.addresses.length?r("div",[r("div",{staticStyle:{"margin-top":"-16px"}}),t._v(" "),t._l(t.addresses,(function(e,i){return[r("Button",{key:"a_"+i,staticClass:"mt16",staticStyle:{height:"auto","white-space":"normal",padding:"8px","text-align":"left"},attrs:{long:""},on:{click:function(r){return t.showAddressForm(t.row,e)}}},[t._v("\n            "+t._s(e.first_name)+" "+t._s(e.last_name)+" "),e.company?r("span",[t._v(" ("+t._s(e.company)+")")]):t._e(),r("br"),t._v("\n            "+t._s(e.house_no)+" "+t._s(e.street_no)+" "+t._s(e.address)+" "+t._s(e.city)+" "+t._s(e.postal_code)+"\n            "+t._s(e.state_name_name)+" "+t._s(e.country_name_name)+" "),r("br"),t._v(t._s(e.phone)+" "+t._s(e.email)+"\n          ")])]}))],2):r("h4",[t._v(t._s(t.$t("no_data")))])])])],1)}),[],!1,null,null,null).exports},96956:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>l});var i=r(19996);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const o={components:{PaymentViewComponent:r(24874).Z,ReportFormComponent:i.Z},data:function(){return{url:"",data:{},refresh:1,updated:0,reportForm:{},loading:!1,showForm:!1,payment:{},view_payment:!1,fields:["created_at","user_id"],columns:[{type:"expand",width:50,render:function(t,e){return t("pre",{style:{margin:"0"}},JSON.stringify(e.row.subject,null,"  "))}},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"asc",width:175,render:this.renderCreatedAt},{title:this.$tc("account"),sortable:!1,key:"account",render:this.renderAccount},{title:this.$tc("customer"),sortable:!1,key:"customer",render:this.renderCustomer},{title:this.$tc("debit"),sortable:!0,key:"debit",width:150,render:this.renderDebit},{title:this.$tc("credit"),sortable:!0,key:"credit",width:150,render:this.renderCredit},{title:this.$t("type"),sortable:!1,key:"type",width:200,render:this.renderType}],options:{hideSearch:!0,showSummary:!0,orderBy:"created_at desc",summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.fields.map((function(e){t.reportForm[e]=""})),this.url="app/customers/transactions/".concat(this.$route.params.id,"/table"),this.$http.get("app/customers/transactions/".concat(this.$route.params.id),{params:a(a({},this.reportForm),{},{date:""})}).then((function(e){t.prepareData(e.data.transactions),t.reportForm.end_date=new Date(e.data.end_date),t.reportForm.start_date=new Date(e.data.start_date),t.reportForm.created_at=[new Date(e.data.start_date),new Date(e.data.end_date)],t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.created_at&&this.reportForm.created_at[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.created_at[0]).format(this.datetimeFormatString())),this.reportForm.created_at&&this.reportForm.created_at[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.created_at[1]).format(this.datetimeFormatString())),delete this.reportForm.created_at,this.url="app/customers/transactions/".concat(this.$route.params.id,"/table?").concat(this.queryString(this.reportForm)),this.refresh++,this.$http.get("app/customers/transactions/".concat(this.$route.params.id),{params:a(a({},this.reportForm),{},{date:""})}).then((function(t){e.prepareData(t.data.transactions),e.reportForm.created_at=[new Date(t.data.start_date),new Date(t.data.end_date)],e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.data=[{label:this.$t("start_balance"),value:t.start_balance},{label:this.$t("close_balance"),value:t.close_balance}]},showInfo:function(t){t.subject_type&&t.subject_type.includes("Payment")&&this.viewPayment(t.subject_id)},viewPayment:function(t){var e=this;this.view_payment=!0,t!=this.payment.id&&(this.loading=!0,this.$http.get("app/payments/".concat(t)).then((function(t){return e.payment=t.data})).finally((function(){return e.loading=!1})))},renderType:function(t,e){var r=e.row.type.split("_"),i=r[0],s="opening"==i?"success":"primary",a=r[1],n="created"==a?"success":"updated"==a?"warning":"deleted"==a?"error":"default";return t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-".concat(s," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.capitalize(i)])]),t("div",{class:"ivu-tag ivu-tag-".concat(n," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ".concat("default"==n?"":"ivu-tag-color-white")},[this.capitalize(a)])])])},renderCustomer:function(t,e){return t("div",[e.row.journal.morphed?e.row.journal.morphed.name+" ("+e.row.journal.morphed.company+")":""])},renderAccount:function(t,e){return t("div",[e.row.subject&&e.row.subject.account?e.row.subject.account.name:""])},renderCredit:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatJournalBalance(e.row.credit,this.$store.getters.settings.decimals)])},renderDebit:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatJournalBalance(e.row.debit,this.$store.getters.settings.decimals)])},renderCreatedAt:function(t,e){return t("div",[this.$options.filters.formatDate(e.row.created_at,this.$store.state.settings.dateformat+" HH:mm A")])},rowClassName:function(t,e){return t.debit>0?"ivu-table-warning-row":t.credit>0?"ivu-table-success-row":""},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["debit","credit"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return t.void||t.draft?0:Number(e.formatDecimal(t[n]))}));if(!o.every((function(t){return isNaN(t)}))){var l=o.reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatJournalBalance(l)}}}else a[n]={key:n,value:""}})),a}}};const l=(0,r(51900).Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("transactions"))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" - "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("router-link",{attrs:{to:"/customers"}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n        "+t._s(t.$t("list"))+" "+t._s(t.$tc("customer",2))+"\n      ")],1),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n        "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n      ")],1)],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,updated:t.updated,reportForm:t.reportForm},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[r("Col",{key:i,attrs:{sm:12,md:12}},[r("div",{staticClass:"box static",class:"box"+(i+5)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatJournalBalance(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])])]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.showInfo,"row-class-name":t.rowClassName}})],1)]),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,title:t.$tc("payment")},model:{value:t.view_payment,callback:function(e){t.view_payment=e},expression:"view_payment"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("payment-view-component",{attrs:{payment:t.payment}})],1)],1)}),[],!1,null,null,null).exports},24885:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var i=r(48921),s=r(80223);function a(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var u=function(t,e){return t.items=t.items.map((function(t){return t.item.id=t.id,t.item.guid=e.guid(),t.item.item_id=t.item_id,t.item.unit_id=t.unit_id,t.item.batch_no=t.batch_no,t.item.delivery_item_id=t.id,t.item.sale_item_id=t.sale_item_id,t.item.item_unit_id=t.item.unit_id,t.item.quantity=parseFloat(t.quantity),t.item.expiry_date=new Date(t.expiry_date),t.item.selected={modifiers:[],serials:[],variations:[],portions:[]},t.modifier_options&&t.modifier_options.length&&(t.item.selected.modifiers=t.modifier_options.map((function(e){var r=t.item.modifiers.find((function(t){return t.id==e.modifier_id})),i=r.options.find((function(t){return t.id==e.id}));return{id:e.id,meta:e.meta,title:r.title,mId:e.modifier_id,option:i.name,quantity:parseFloat(e.pivot.quantity)}}))),t.variations&&t.variations.length&&(t.item.selected.variations=t.variations.map((function(t){return{id:t.id,meta:t.meta,quantity:parseFloat(t.pivot.quantity)}}))),t.portions&&t.portions.length&&(t.item.selected.portions=t.portions.map((function(t){return{id:t.id,name:t.name,quantity:parseFloat(t.pivot.quantity),choosables:t.pivot&&t.pivot.choosables?t.pivot.choosables.map((function(t){return{id:t.id,selected:t.item_id}})):[]}}))),t.item})),t.date&&(t.date=new Date(t.date)),t.delivered_at&&(t.delivered_at=new Date(t.delivered_at)),e.form=l({},t),e.form};const d={components:{AttachmentsComponent:s.Z},mixins:[(0,i.Z)("delivery","app/deliveries",!1,u)],data:function(){return{query:"",item:null,result:[],qty:!1,show:!1,saving:!1,loading:!1,searching:!1,variantModal:!1,form:{id:"",items:[],driver:"",sale_id:"",details:"",reference:"",attachments:[],customer_id:"",location_id:"",date:new Date,delivered_at:"",delivered_by:"",status:"preparing",new_attachments:[]},rules:{date:[{required:!0,type:"date",message:this.$t("field_is_required",{field:this.$t("date")}),trigger:"change"}],status:[{required:!0,message:this.$t("field_is_required",{field:this.$t("status")}),trigger:"change"}]}}},created:function(){var t=this;this.loading=!0,this.$route.query.sale_id?(this.form.sale_id=this.$route.query.sale_id,this.$http.get("app/sales/"+this.form.sale_id).then((function(e){e.data.draft&&(t.$Notice.warning({title:t.$tc("draft"),desc:t.$t("order_draft_text")}),t.$router.back()),t.form.customer_id=e.data.customer_id,t.form.location_id=e.data.location_id,t.form.items=e.data.items.map((function(t){return t.item.id=t.id,t.item.item_id=t.item_id,t.item.sale_item_id=t.id,t.item.unit_id=t.unit_id,t.item.batch_no=t.batch_no,t.item.item_unit_id=t.item.unit_id,t.item.quantity=parseFloat(t.quantity),t.item.expiry_date=new Date(t.expiry_date),t.item.selected={modifiers:[],serials:[],variations:[],portions:[]},t.modifier_options&&t.modifier_options.length&&(t.item.selected.modifiers=t.modifier_options.map((function(e){var r=t.item.modifiers.find((function(t){return t.id==e.modifier_id})),i=r.options.find((function(t){return t.id==e.id}));return{id:e.id,meta:e.meta,title:r.title,mId:e.modifier_id,option:i.name,quantity:parseFloat(e.pivot.quantity)}}))),t.variations&&t.variations.length&&(t.item.selected.variations=t.variations.map((function(t){return{id:t.id,meta:t.meta,quantity:parseFloat(t.pivot.quantity)}}))),t.portions&&t.portions.length&&(t.item.selected.portions=t.portions.map((function(t){return{id:t.id,name:t.name,quantity:parseFloat(t.pivot.quantity),choosables:t.pivot&&t.pivot.choosables?t.pivot.choosables.map((function(t){return{id:t.id,selected:t.item_id}})):[]}}))),t.item}))})).finally((function(){return t.loading=!1}))):this.$route.params.id||this.$router.push(this.$store.getters.previous("/"))},methods:{fetch:function(t){var e=this;this.$http.get("app/deliveries/".concat(t)).then((function(t){return u(t.data,e)})).catch((function(t){return console.log(t)})).finally((function(){return e.loading=!1}))},renderFileList:function(){fileList.forEach((function(t,e){console.log(e+1+": "+t.name)}))},addToOrder:function(t,e,r,i){if(this.qty=0,t.selected||(t.selected={variations:[],serials:[],portions:[],modifiers:[]}),t.meta||(t.meta={}),!r&&(t.serials&&t.serials.length||t.variants&&t.variants.length>0&&t.variations&&t.variations.length>0))return this.item=JSON.parse(JSON.stringify(t)),this.variantModal=!0,!1;var s={},n=this.form.items.length>0&&this.form.items.find((function(e){return e.id==t.id&&(!e.variation||e.variation&&t.variation&&e.variation.id==t.variation.id)}));n?(n.quantity=i?parseFloat(e):parseFloat(n.quantity)+(e?parseFloat(e):1),t.selected_variation&&n.selected.variations.push(t.selected_variation),this.alert(this.$root.$t("cart_item_updated",{item:t.name}))):(t.unit&&(t.allUnits=[l(l({},t.unit),{},{subunits:null})].concat(a(t.unit.subunits))),t.selected.variations.length&&t.selected.variations.push(t.selected_variation),s=l(l({},t),{},{id:"",comment:"",item_id:t.id,guid:this.guid(),selected:l({},t.selected),quantity:e?parseFloat(e):1}),this.form.items.push(s),this.alert(this.$root.$t("added_to_cart",{item:s.name})))},deleteItem:function(t){this.form.items=this.form.items.filter((function(e){return e.guid!==t.guid}))},deleteItemVariation:function(t,e){var r=this.form.items.find((function(e){return e.guid==t.guid}));r.selected_variation=null,r.selected.variations=r.selected.variations.filter((function(t){return t.id!==e.id})),r.quantity=r.selected.variations.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),r.selected.variations.length<=0&&this.deleteItem(r)},itemVariationQuantityChanged:function(t){t.selected_variation=null,t.quantity=t.selected.variations.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),this.addToOrder(t,t.quantity,!0,!0)},getPortionChoosable:function(t,e,r){return t.choosables.find((function(t){return t.id==e})).selected==r},handleUpload:function(t){this.form.attachments.push(t)},clearAttachments:function(){this.form.attachments=[],this.form.new_attachments=[]},addDelivery:function(t,e){var r=this;this.$refs.delivery.validate((function(i){if(i){r.saving=!0;var s="app/sales/".concat(r.form.sale_id,"/deliveries"),n="added";r.errors.message="";var o="record_added";r.form.id&&""!=r.form.id&&(n="updated",s="app/deliveries/"+r.form.id,o="record_updated",r.form._method="PUT"),s+=e?"?stay=1":"";var c=l({},r.form);if(c.items=c.items.map((function(t){var e={code:t.code,name:t.name,item_id:t.item_id,quantity:t.quantity,sale_item_id:t.sale_item_id,id:r.form.id?t.id:"",selected:(l({},t.selected),{modifiers:[],variations:[],portions:[]}),serials:t.selected.serials};return t.selected.modifiers.length&&(e.selected.modifiers=t.selected.modifiers.map((function(t){return{id:t.mId,selected:t.id,quantity:t.quantity}}))),t.selected.portions.length&&(e.selected.portions=t.selected.portions.map((function(t){return{id:t.id,quantity:t.quantity,choosables:t.choosables}}))),t.selected.variations.length&&(e.selected.variations=a(t.selected.variations)),e})),r.attributes&&r.attributes.length>0){var d=r.attributes.map((function(t){var e={};return delete c[t.slug],e[t.slug]=r.form[t.slug],e}));c.extra_attributes=Object.assign.apply(Object,a(d))}c.date&&(c.date=r.$moment(c.date).format(r.$moment.HTML5_FMT.DATE)),c.delivered_at&&(c.delivered_at=r.$moment(c.delivered_at).format(r.$moment.HTML5_FMT.DATE)),c=r.$form(c),r.$http.post(s,c).then((function(i){i.data.success?(r.$Notice.destroy(),r.$Notice.success({title:r.$tc("delivery")+" "+r.$t(n),desc:r.$t(o)}),e?"updated"==n?r.form=u(i.data.data,r):r.handleReset():r.$router.push({name:t+".list"})):r.$Notice.error({title:r.$t("failed"),desc:r.$t("failed_error_text")})})).catch((function(t){return r.errors=t})).finally((function(){return r.saving=!1}))}else r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10})}))}}};const m=(0,r(51900).Z)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("delivery")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/deliveries"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("delivery",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"delivery",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("status"),prop:"status",error:t._f("a2s")(t.errors.form.status)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[r("Option",{attrs:{value:"preparing"}},[t._v(t._s(t.$t("preparing")))]),t._v(" "),r("Option",{attrs:{value:"delivering"}},[t._v(t._s(t.$t("delivering")))]),t._v(" "),r("Option",{attrs:{value:"delivered"}},[t._v(t._s(t.$t("delivered")))])],1)],1),t._v(" "),r("FormItem",{attrs:{prop:"delivered_by",label:t.$tc("delivered_by"),error:t._f("a2s")(t.errors.form.delivered_by),rules:{trigger:"change",required:"delivered"==this.form.status,message:this.$t("field_is_required",{field:this.$t("delivered_at")})}}},[r("Input",{model:{value:t.form.delivered_by,callback:function(e){t.$set(t.form,"delivered_by",e)},expression:"form.delivered_by"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"delivered_at",label:t.$tc("delivered_at"),error:t._f("a2s")(t.errors.form.delivered_at),rules:{trigger:"change",required:"delivered"==this.form.status,message:this.$t("field_is_required",{field:this.$t("delivered_at")})}}},[r("Input",{model:{value:t.form.delivered_at,callback:function(e){t.$set(t.form,"delivered_at",e)},expression:"form.delivered_at"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("driver"),prop:"driver",error:t._f("a2s")(t.errors.form.driver)}},[r("Input",{model:{value:t.form.driver,callback:function(e){t.$set(t.form,"driver",e)},expression:"form.driver"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"received_by",label:t.$tc("received_by"),error:t._f("a2s")(t.errors.form.received_by),rules:{trigger:"change",required:"delivered"==this.form.status,message:this.$t("field_is_required",{field:this.$t("received_by")})}}},[r("Input",{model:{value:t.form.received_by,callback:function(e){t.$set(t.form,"received_by",e)},expression:"form.received_by"}})],1)],1)],1),t._v(" "),r("transition",{attrs:{mode:"out-in",name:"slide-in","enter-active-class":"animate__animated faster animate__fadeInDown","leave-active-class":"animate__animated fastest animate__fadeOutDown"}},[r("div",{staticClass:"order-contents"},[!t.form.items||t.form.items.length<1?r("div",[r("Alert",{attrs:{"show-icon":""}},[t._v("\n                    "+t._s(t.$t("empty_order"))+"\n                    "),r("template",{slot:"desc"},[t._v("\n                      "+t._s(t.$t("empty_order_text"))+"\n                    ")])],2)],1):r("div",[r("div",{staticClass:"order-items"},[r("div",{staticClass:"header"},[r("span",{staticClass:"index"},[t._v("#")]),t._v(" "),r("span",{staticClass:"details"},[t._v(t._s(t.$t("description")))]),t._v(" "),r("span",{staticClass:"quantity"},[t._v(t._s(t.$t("quantity")))])]),t._v(" "),t._l(t.form.items,(function(e,i){return r("div",{key:i+"_"+e.id,staticClass:"order-item"},[r("span",{staticClass:"item"},[r("span",{staticClass:"index"},[r("span",{staticClass:"number-rmdash"},[t._v(t._s(i+1))])]),t._v(" "),r("span",{staticClass:"details"},[r("strong",[t._v(t._s(e.name))])]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!0,size:e.selected.variations.length||e.selected.portions.length?"small":"default"},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"row.quantity"}})],1)]),t._v(" "),e.selected.variations&&e.selected.variations.length?t._l(e.selected.variations,(function(e,s){return r("div",{key:"svi_"+s,staticClass:"combo-item variation"},[r("span",{staticClass:"index"},[r("span",{staticClass:"number-rmdash"})]),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n                            "+t._s(s+1)+".\n                            "),r("span",{domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!0},on:{"on-change":function(e){return t.itemVariationQuantityChanged(t.form.items[i])}},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"sv.quantity"}})],1)])})):t._e(),t._v(" "),e.selected.portions.length?t._l(e.selected.portions,(function(s,a){return r("div",{key:"spi_"+a,staticClass:"combo"},t._l(e.portions.filter((function(t){return t.id==s.id})),(function(e){return r("div",{key:"pi_"+e.id,staticClass:"combo"},[r("div",{staticClass:"combo-item variation"},[r("span",{staticClass:"index"},[r("span",{staticClass:"number-rmdash"})]),t._v(" "),r("span",{staticClass:"details leading-medium"},[r("p",[t._v("\n                                  "+t._s(a+1)+". "+t._s(t.$tc("portion"))+":\n                                  "),r("strong",[t._v(t._s("regular"==e.name?t.$t("regular"):e.name))])])]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!0},on:{"on-change":function(e){return t.itemPortionQuantityChanged(t.form.items[i])}},model:{value:s.quantity,callback:function(e){t.$set(s,"quantity",e)},expression:"sp.quantity"}})],1)]),t._v(" "),t._l(e.essentials,(function(e,i){return r("div",{key:"ei_"+i,staticClass:"combo-item bt0",staticStyle:{"padding-top":"1px"}},[r("span",{staticClass:"remove"}),t._v(" "),r("span",{staticClass:"details"},[t._v(" #"+t._s(i+1)+" "+t._s(e.item.name)+" ")]),t._v(" "),r("span",{staticClass:"quantity input"},[t._v("\n                                "+t._s(parseFloat(e.quantity*s.quantity))+"\n                              ")])])})),t._v(" "),t._l(e.choosables,(function(i,a){return t._l(i.items,(function(n,o){return t.getPortionChoosable(s,i.id,n.item_id)?r("div",{key:"gii_"+o+"_"+a,staticClass:"combo-item bt0",staticStyle:{"padding-top":"1px"}},[r("span",{staticClass:"remove"}),t._v(" "),r("span",{staticClass:"details"},[t._v("\n                                  #"+t._s(a+1+e.essentials.length)+"\n                                  "+t._s(n.item.name)+"\n                                ")]),t._v(" "),r("span",{staticClass:"quantity input"},[t._v("\n                                  "+t._s(parseFloat(n.quantity*s.quantity))+"\n                                ")])]):t._e()}))}))],2)})),0)})):t._e(),t._v(" "),e.selected.modifiers.length?[r("div",{staticClass:"combo-item bg"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"details"},[r("p",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.$tc("modifier",2)))])]),t._v(" "),r("span",{staticClass:"quantity"},[t._v("")])]),t._v(" "),t._l(e.selected.modifiers,(function(e,i){return r("div",{key:"mi_"+i},[r("div",{staticClass:"combo-item pt pb"},[r("span",{staticClass:"index"},[r("span",{staticClass:"number-rmdash"})]),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n                              "+t._s(i+1)+". "),r("strong",[t._v(t._s(e.option))]),t._v(" ("+t._s(e.title)+")\n                            ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!0},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"m.quantity"}})],1)])])}))]:t._e()],2)}))],2)])])]),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}}),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.addDelivery("deliveries")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.addDelivery("deliveries",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},95990:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var i=r(92704);function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const a={components:{OrderViewComponent:r(82016).Z},mixins:[(0,i.Z)("delivery","app/deliveries","reference")],data:function(){var t,e=this;return{view:!1,loading:!1,delivery:{id:null,reference:null},columns:[{type:"selection",width:50,align:"center",fixed:"left"},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,sortable:!1,key:"delivered_by",render:this.renderDeliveredBy,title:this.$t("delivered_by")},{width:175,sortable:!1,key:"delivered_at",render:this.renderDeliveredAt,title:this.$t("delivered_at")},(t={title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0},s(t,"ellipsis",!0),s(t,"minWidth",250),s(t,"maxWidth",600),t),{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(t,r){return t("actions-component",{props:{params:r,viewFn:e.viewModal,editFn:e.editRecord,deleteFn:e.deleteRecord,record:{model:"delivery",name:"reference",title:e.$tc("delivery")}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.delivery.id&&(this.loading=!0,this.$http.get("app/deliveries/".concat(t.id)).then((function(t){return e.delivery=t.data})).finally((function(){return e.loading=!1})))},editRecord:function(t){this.$router.push({name:"deliveries.edit",params:{id:t.id}})},renderDeliveredBy:function(t,e){return t("div",[e.row.delivered_by&&e.row.delivered_by.name?e.row.delivered_by.name:e.row.delivered_by])},renderDeliveredAt:function(t,e){return t("div",[e.row.delivered_at?this.$options.filters.formatDate(e.row.delivered_at,this.$store.state.settings.dateformat+" HH:mm A"):""])}}};const n=(0,r(51900).Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("delivery",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/deliveries/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add_x",{x:t.$tc("delivery")}))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,url:"app/deliveries",bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("delivery")+" ("+t.delivery.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{"to-text":"",to:!1,field:"cost",extra:!1,payment:!1,"only-qty":!0,delivery:!0,record:t.delivery,heading:t.$tc("delivery")},on:{remove:function(e){return t.deleteAttachment(e,t.delivery)}}})],1)],1)}),[],!1,null,null,null).exports},46483:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var i=r(48921),s=r(44605);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var u=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.amount=parseFloat(t.amount),t.category_id=t.categories[0].id,t.recurring=1==t.recurring?"1":"0",e.attachments=t.attachments&&t.attachments.length?l(t.attachments):[],e.form=n(n({},t),t.extra_attributes),e.form};const d={mixins:[s.Z,(0,i.Z)("expense","app/expenses",!0,u)],data:function(){return{admins:[],accounts:[],categories:[],attributes:[],form:{id:"",title:"",details:"",amount:null,reference:"",account_id:"",category_id:"",approved_by_id:"",date:new Date,recurring:!1,repeat:"monthly",start_date:new Date,create_before:null},rules:{title:[{required:!0,message:this.$t("field_is_required",{field:this.$t("title")}),trigger:"blur"}],reference:[{required:!1,message:this.$t("field_is_required",{field:this.$t("reference")}),trigger:"blur"}],account_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("account")}),trigger:"change"}],category_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("category")}),trigger:"change"}],date:[{type:"date",required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("date")})}],approved_by_id:[{trigger:"change",required:!this.$store.getters.superAdmin,message:this.$t("field_is_required",{field:this.$t("require_approval_by")})}],amount:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("amount")}),trigger:"blur"}]}}},created:function(){var t=this;this.$http.get("app/accounts/search").then((function(e){return t.accounts=e.data})),this.$http.get("app/users/search?roles=admin").then((function(e){return t.admins=e.data})),this.$http.get("app/all_categories/search").then((function(e){return t.categories=t.flattenDeep(e.data)}))},methods:{create:function(){var t=this;this.$http.get("app/expenses/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/expenses/".concat(t)).then((function(t){return u(t.data,e)})).finally((function(){return e.loading=!1}))}}};const m=(0,r(51900).Z)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("expense")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/expenses"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("expense",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"expense",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("title"),prop:"title",error:t._f("a2s")(t.errors.form.title)}},[r("Input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("amount"),prop:"amount",error:t._f("a2s")(t.errors.form.amount)}},[r("InputNumber",{model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1)],1),t._v(" "),r("Col",{staticClass:"sm-pt-24",attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("account"),prop:"account_id",error:t._f("a2s")(t.errors.form.account_id)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.account_id,callback:function(e){t.$set(t.form,"account_id",e)},expression:"form.account_id"}},t._l(t.accounts,(function(e,i){return t.accounts.length>0?r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))]):t._e()})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("category"),prop:"category_id",error:t._f("a2s")(t.errors.form.category_id)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(e,i){return t.categories.length>0?r("Option",{key:i,attrs:{value:e.id}},[t._v("\n                    "+t._s(e.name)+"\n                  ")]):t._e()})),1)],1)],1)],1),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[t.$store.getters.superAdmin?t._e():r("FormItem",{attrs:{prop:"approved_by_id",label:t.$tc("require_approval_by"),error:t._f("a2s")(t.errors.form.approved_by_id)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.approved_by_id,callback:function(e){t.$set(t.form,"approved_by_id",e)},expression:"form.approved_by_id"}},[t.accounts.length>0?t._l(t.admins,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n                      "+t._s(e.label)+"\n                    ")])})):t._e()],2)],1)],1)],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"recurring"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.recurring,callback:function(e){t.$set(t.form,"recurring",e)},expression:"form.recurring"}},[r("span",[t._v(t._s(t.$t("recurring_expense_text")))])])],1),t._v(" "),r("transition",{attrs:{mode:"out-in",name:"slide-in","enter-active-class":"animate__animated faster animate__fadeInDown","leave-active-class":"animate__animated fastest animate__fadeOutDown"}},[1==t.form.recurring?r("div",[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("start_date"),prop:"start_date",error:t._f("a2s")(t.errors.form.start_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.start_date,callback:function(e){t.$set(t.form,"start_date",e)},expression:"form.start_date"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("repeat"),prop:"repeat",error:t._f("a2s")(t.errors.form.repeat)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.repeat,callback:function(e){t.$set(t.form,"repeat",e)},expression:"form.repeat"}},[r("Option",{attrs:{value:"daily"}},[t._v(t._s(t.$t("daily")))]),t._v(" "),r("Option",{attrs:{value:"weekly"}},[t._v(t._s(t.$t("weekly")))]),t._v(" "),r("Option",{attrs:{value:"monthly"}},[t._v(t._s(t.$t("monthly")))]),t._v(" "),r("Option",{attrs:{value:"quarterly"}},[t._v(t._s(t.$t("quarterly")))]),t._v(" "),r("Option",{attrs:{value:"semiannually"}},[t._v(t._s(t.$t("semiannually")))]),t._v(" "),r("Option",{attrs:{value:"annually"}},[t._v(t._s(t.$t("annually")))]),t._v(" "),r("Option",{attrs:{value:"biennially"}},[t._v(t._s(t.$t("biennially")))]),t._v(" "),r("Option",{attrs:{value:"triennially"}},[t._v(t._s(t.$t("triennially")))])],1)],1)],1)],1),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{prop:"approved_by_id",label:t.$tc("require_approval_by"),error:t._f("a2s")(t.errors.form.approved_by_id)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.approved_by_id,callback:function(e){t.$set(t.form,"approved_by_id",e)},expression:"form.approved_by_id"}},[t.accounts.length>0?t._l(t.admins,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n                          "+t._s(e.label)+"\n                        ")])})):t._e()],2)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("create_before"),prop:"create_before",error:t._f("a2s")(t.errors.form.create_before)}},[r("InputNumber",{model:{value:t.form.create_before,callback:function(e){t.$set(t.form,"create_before",e)},expression:"form.create_before"}})],1)],1)],1)],1):t._e()]),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("expenses")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("expenses",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},91757:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(92704),s=r(31197);const a={props:{expense:{required:!0},updateFn:{required:!0}},methods:{approve:function(){var t=this;this.$Modal.confirm({title:this.$t("approve_x",{x:this.$tc("expense")})+" ("+this.expense.reference+")",content:this.$t("approve_text")+"<br><br><strong>"+this.$t("r_u_sure")+"</strong>",okText:this.$t("yes"),cancelText:this.$t("cancel"),loading:!0,onOk:function(){t.$http.post("/app/expenses/".concat(t.expense.id,"/approve")).then((function(e){e.data.success?(t.updateFn(),t.$Notice.success({title:t.$t("success"),desc:e.data.message||t.$t("expense_approved_text")})):t.$Notice.error({title:t.$t("failed"),desc:e.data.message||t.$t("no_permissions"),duration:10})})).finally((function(){return t.$Modal.remove()}))}})}}};var n=r(51900);const o=(0,n.Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"text-center"},[r("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.approve()}}},[r("Icon",{attrs:{type:"ios-checkmark-circle"}})],1)],1)}),[],!1,null,null,null).exports,l={components:{ExpenseViewComponent:s.Z},mixins:[(0,i.Z)("expense","app/expenses","title","reference")],data:function(){var t=this;return{view:!1,loading:!1,expense:{id:null,reference:null},columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",minWidth:125,render:this.renderDate},{title:this.$t("title"),sortable:!0,key:"title",minWidth:200},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("amount"),sortable:!0,key:"amount",maxWidth:125,minWidth:125,render:this.renderAmount},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{title:this.$tc("category"),sortable:!1,key:"categories",minWidth:175,render:this.renderCategory},{title:this.$tc("account"),sortable:!1,key:"account",minWidth:175,render:this.renderAccount},{title:this.$tc("created_by"),sortable:!1,key:"user",minWidth:175,render:this.renderUser},{title:this.$tc("recurring"),sortable:!1,key:"recurring",minWidth:90,render:this.renderRecurring},{title:this.$tc("approved"),sortable:!1,key:"approved",minWidth:90,render:this.renderApproved},{title:this.$tc("approval"),sortable:!1,key:"approved_by",minWidth:175,render:this.renderApproval},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:250},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:250,render:this.renderExtras},{width:105,sortable:!0,sortType:"desc",key:"start_date",render:this.renderStartDate,title:this.$t("start_date")},{title:this.$t("repeat"),sortable:!0,key:"repeat",width:125,render:this.renderRepeat},{title:this.$t("before"),sortable:!0,key:"create_before",width:90},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"desc",minWidth:175,render:this.renderDateTime},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,viewFn:t.viewModal,editFn:t.editRecord,deleteFn:t.deleteRecord,record:{model:"expense",name:"reference",title:t.$tc("expense")}}})}}],options:{perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},computed:{url:function(){return"app/expenses"+(this.$route.query.require_approval?"?require_approval="+parseInt(this.$route.query.require_approval):"")}},watch:{"$route.query.require_approval":function(t){t?this.columns.splice(1,0,{width:50,title:"",fixed:"left",key:"approve",align:"center",render:this.renderApprovalNow}):this.columns=this.columns.filter((function(t){return"approve"!=t.key})),this.refresh++}},created:function(){var t=this;this.$route.query.require_approval?this.columns.splice(1,0,{title:"",width:50,key:"approve",align:"center",fixed:"left",render:this.renderApprovalNow}):this.columns=this.columns.filter((function(t){return"approve"!=t.key})),this.$event.listen("location:changed",(function(e){return t.refresh++}))},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.expense.id&&(this.loading=!0,this.$http.get("app/expenses/".concat(t.id)).then((function(t){return e.expense=t.data})).finally((function(){return e.loading=!1})))},reloadExpenses:function(){this.refresh++},renderApprovalNow:function(t,e){return t(o,{props:{expense:e.row,updateFn:this.reloadExpenses}})},renderAmount:function(t,e){return this.renderNumber(t,e,"amount")},renderAccount:function(t,e){return t("div",[e.row.account.name])},renderLocation:function(t,e){return t("div",[e.row.location.name])},renderCategory:function(t,e){return t("div",[e.row.categories.map((function(t){return t.name})).join("")])},renderRecurring:function(t,e){return this.renderBoolean(t,e,"recurring")},renderApproved:function(t,e){return this.renderBoolean(t,e,"approved")},renderApproval:function(t,e){return t("div",[e.row.approved_by?e.row.approved_by.name:""])},renderUser:function(t,e){return t("div",[e.row.user?e.row.user.name:""])},renderStartDate:function(t,e){return t("div",[e.row.start_date?this.date(e.row.start_date):""])},renderRepeat:function(t,e){return t("div",{class:"text-center"},[e.row.repeat?t("div",{class:"ivu-tag ivu-tag-".concat(this.repeatColor(e.row.repeat)," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.$t(e.row.repeat)])]):""])},repeatColor:function(t){var e={daily:"blue",weekly:"magenta",monthly:"primary",quarterly:"geekblue",semiannually:"purple",annually:"success",biennially:"green",triennially:"orange"};return e[t]?e[t]:"default"}}};const c=(0,n.Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("expense",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/expenses/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("expense"))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{title:t.$tc("expense"),width:"750","footer-hide":!0,"mask-closable":!1},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("expense-view-component",{attrs:{expense:t.expense},on:{remove:function(e){return t.deleteAttachment(e,t.expense)}}})],1)],1)}),[],!1,null,null,null).exports},31197:(t,e,r)=>{"use strict";r.d(e,{Z:()=>o});var i=r(7174),s=r.n(i),a=r(47401);const n={props:{expense:{type:Object,required:!0}},components:{VueBarcode:s(),ListAttachmentsComponent:a.Z},data:function(){return{loading:!1}},methods:{print:function(){window.print()},deleteAttachment:function(t){this.$emit("remove",t)}}};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{}},[t.expense.id?r("div",{staticClass:"order"},[r("div",{staticClass:"order-header"},[r("div",{staticClass:"details"},[r("img",{staticClass:"logo",attrs:{src:t.expense.location&&t.expense.location.logo?t.expense.location.logo:t.$store.state.settings.default_logo}}),t._v(" "),r("div",{staticClass:"header-text"},[r("ul",[r("li",[r("strong",[t._v(t._s(t.$store.getters.settings.name)+" ("+t._s(t.$store.getters.settings.short_name)+")")])]),t._v(" "),r("li",[r("strong",[t._v(t._s(t.$store.getters.settings.company))])]),t._v(" "),r("li",[t._v(t._s(t.$store.getters.settings.email)+" "),r("span",{staticClass:"text-muted"},[t._v("|")]),t._v(" "+t._s(t.$store.getters.settings.phone))]),t._v(" "),r("li",[t._v(t._s(t.$store.getters.settings.address))])])])]),t._v(" "),r("vue-barcode",{staticClass:"barcode",attrs:{width:1,margin:0,height:50,fontSize:12,"margin-top":0,format:"code39","margin-bottom":2,value:t.expense.reference}},[t._v("\n        "+t._s(t.$t("barcode_error"))+"\n      ")])],1),t._v(" "),r("Row",{staticClass:"border-t",attrs:{gutter:16}},[r("Col",{staticClass:"border-y py-2",attrs:{xs:24}},[r("h3",{staticClass:"text-center",staticStyle:{"text-transform":"uppercase"}},[t._v("\n          "+t._s(t.$tc("expense"))+"\n        ")])])],1),t._v(" "),r("Row",{staticClass:"border-y py-2",attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[t._v("\n        "+t._s(t.$t("date"))+": "),r("strong",[t._v(t._s(t._f("date")(t.expense.date)))]),t._v(" "),r("br"),t._v("\n        "+t._s(t.$t("reference"))+": "),r("strong",[t._v(t._s(t.expense.reference))]),t._v(" "),r("br"),t._v("\n        "+t._s(t.$t("created_by"))+": "),r("strong",[t._v(t._s(t.expense.user.name))])]),t._v(" "),r("Col",{attrs:{xs:24,sm:12}},[t._v("\n        "+t._s(t.$t("created_at"))+": "),r("strong",[t._v(t._s(t._f("datetime")(t.expense.created_at)))]),t._v(" "),r("br"),t._v("\n        "+t._s(t.$t("approval"))+": "),t.expense.approved_by?r("strong",[t._v(t._s(t._f("capitalize")(t.expense.approved_by.name)))]):t._e(),t._v(" "),r("br"),t._v("\n        "+t._s(t.$tc("approved"))+": "),r("span",{domProps:{innerHTML:t._s(t.booleanView(t.expense.approved))}})])],1),t._v(" "),r("Row",{staticClass:"mt16",attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[r("p",[t._v(t._s(t.$tc("store"))+":")]),t._v(" "),t.expense.location?r("div",[r("strong",[t._v(t._s(t.expense.location.name))]),r("br"),t._v(" "),t.expense.location.address?r("span",[t._v(t._s(t.expense.location.address))]):t._e(),t._v(" "),t.expense.location.state_name?r("span",[t._v(t._s(t.expense.location.state_name))]):t._e(),t._v(" "),t.expense.location.country_name?r("span",[t._v(t._s(t.expense.location.country_name))]):t._e(),r("br"),t._v(" "),t.expense.location.phone?r("span",[t._v(t._s(t.expense.location.phone))]):t._e(),r("br"),t._v(" "),t.expense.location.email?r("span",[t._v(t._s(t.expense.location.email))]):t._e(),r("br")]):t._e()])],1),t._v(" "),r("div",{staticClass:"table-wrapper"},[r("table",{staticClass:"table"},[r("tbody",[r("tr",[r("td",[t._v(t._s(t.$t("title")))]),t._v(" "),r("td",[t._v(t._s(t.expense.title))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$tc("account")))]),t._v(" "),r("td",[t._v(t._s(t.expense.account.name))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$tc("category")))]),t._v(" "),r("td",[t._v(t._s(t.expense.categories[0].name))])]),t._v(" "),r("tr",[r("td",{staticClass:"bold"},[t._v(t._s(t.$t("amount")))]),t._v(" "),r("td",{staticClass:"bold"},[t._v(t._s(t.formatNumber(t.expense.amount)))])])])])]),t._v(" "),t.checkExtraAttributes(t.expense.extra_attributes)?r("Card",{staticClass:"mt16",attrs:{"dis-hover":""}},[r("span",{domProps:{innerHTML:t._s(t.renderExtraAttributes(t.expense.extra_attributes,t.expense.attributes))}})]):t._e(),t._v(" "),r("list-attachments-component",{staticClass:"mt16",attrs:{attachments:t.expense.attachments},on:{remove:t.deleteAttachment}}),t._v(" "),t.expense.details?r("Card",{staticClass:"mt16",attrs:{"dis-hover":""}},[t._v(t._s(t.expense.details))]):t._e()],1):t._e(),t._v(" "),r("div",{staticClass:"np text-center"},[r("Button",{staticClass:"mt16 mx8",attrs:{type:"primary",loading:t.loading,disabled:t.loading,icon:"md-print"},on:{click:function(e){return t.print()}}},[t._v("\n      "+t._s(t.$t("print"))+"\n    ")])],1)])}),[],!1,null,null,null).exports},79557:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(48921).Z)("field","app/fields")],data:function(){return{form:{id:"",name:"",slug:"",type:"",order:null,required:0,description:"",options:[],entities:["customer","delivery","expense","income","item","location","payment","purchase","quotation","return_order","sale","stock_adjustment","stock_transfer","supplier"]},rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],slug:[{required:!0,message:this.$t("field_is_required",{field:this.$t("slug")}),trigger:"blur"},{required:!0,pattern:/^([a-zA-Z0-9-_]{2,25})$/,message:this.$t("alpha_dash_error"),trigger:["blur","change"]}],type:[{required:!0,message:this.$t("field_is_required",{field:this.$t("type")}),trigger:"change"}],entities:[{required:!0,type:"array",min:1,message:this.$t("select_entities"),trigger:"change"}],options:[{required:!0,message:this.$t("options")+" "+this.$t("are_required"),trigger:"blur"}]}}},computed:{reqiue_options:function(){return"select"==this.form.type||"checkbox"==this.form.type||"radio"==this.form.type}},methods:{fetch:function(t){var e=this;this.$http.get("app/fields/".concat(t)).then((function(t){delete t.data.created_at,delete t.data.updated_at,t.data.order=parseInt(t.data.order),t.data.required=parseInt(t.data.required),e.form=t.data})).catch((function(t){e.$event.fire("appError",t.response)})).finally((function(){return e.loading=!1}))}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("field")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/fields"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("field",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"field",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("slug"),prop:"slug",error:t._f("a2s")(t.errors.slug)}},[r("Input",{model:{value:t.form.slug,callback:function(e){t.$set(t.form,"slug",e)},expression:"form.slug"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("entities"),prop:"entities",error:t._f("a2s")(t.errors.entitise)}},[r("Select",{attrs:{multiple:""},model:{value:t.form.entities,callback:function(e){t.$set(t.form,"entities",e)},expression:"form.entities"}},[r("Option",{attrs:{value:"customer"}},[t._v(t._s(t.$tc("customer")))]),t._v(" "),r("Option",{attrs:{value:"delivery"}},[t._v(t._s(t.$tc("delivery")))]),t._v(" "),r("Option",{attrs:{value:"expense"}},[t._v(t._s(t.$tc("expense")))]),t._v(" "),r("Option",{attrs:{value:"income"}},[t._v(t._s(t.$tc("income")))]),t._v(" "),r("Option",{attrs:{value:"item"}},[t._v(t._s(t.$tc("item")))]),t._v(" "),r("Option",{attrs:{value:"location"}},[t._v(t._s(t.$tc("location")))]),t._v(" "),r("Option",{attrs:{value:"payment"}},[t._v(t._s(t.$tc("payment")))]),t._v(" "),r("Option",{attrs:{value:"purchase"}},[t._v(t._s(t.$tc("purchase")))]),t._v(" "),r("Option",{attrs:{value:"quotation"}},[t._v(t._s(t.$tc("quotation")))]),t._v(" "),r("Option",{attrs:{value:"return_order"}},[t._v(t._s(t.$tc("return_order")))]),t._v(" "),r("Option",{attrs:{value:"sale"}},[t._v(t._s(t.$tc("sale")))]),t._v(" "),r("Option",{attrs:{value:"stock_adjustment"}},[t._v(t._s(t.$tc("stock_adjustment")))]),t._v(" "),r("Option",{attrs:{value:"stock_transfer"}},[t._v(t._s(t.$tc("stock_transfer")))]),t._v(" "),r("Option",{attrs:{value:"supplier"}},[t._v(t._s(t.$tc("supplier")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("order_no"),prop:"order",error:t._f("a2s")(t.errors.form.order)}},[r("InputNumber",{model:{value:t.form.order,callback:function(e){t.$set(t.form,"order",e)},expression:"form.order"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("type"),prop:"type",error:t._f("a2s")(t.errors.type)}},[r("RadioGroup",{model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[r("Radio",{attrs:{label:"text","true-value":"text"}},[r("span",[t._v(t._s(t.$t("text")))])]),t._v(" "),r("Radio",{attrs:{label:"number","true-value":"number"}},[r("span",[t._v(t._s(t.$t("number")))])]),t._v(" "),r("Radio",{attrs:{label:"select","true-value":"select"}},[r("span",[t._v(t._s(t.$t("select")))])]),t._v(" "),r("Radio",{attrs:{label:"textarea","true-value":"textarea"}},[r("span",[t._v(t._s(t.$t("textarea")))])]),t._v(" "),r("Radio",{attrs:{label:"checkbox","true-value":"checkbox"}},[r("span",[t._v(t._s(t.$t("checkbox")))])]),t._v(" "),r("Radio",{attrs:{label:"radio","true-value":"radio"}},[r("span",[t._v(t._s(t.$t("radio")))])]),t._v(" "),r("Radio",{attrs:{label:"date","true-value":"date"}},[r("span",[t._v(t._s(t.$t("date")))])]),t._v(" "),r("Radio",{attrs:{label:"datetime","true-value":"datetime"}},[r("span",[t._v(t._s(t.$t("datetime")))])])],1)],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[t.reqiue_options?r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("options"),prop:"options",error:t._f("a2s")(t.errors.form.options)}},[r("Input",{attrs:{placeholder:"Option 1|Option 2|Option 3"},model:{value:t.form.options,callback:function(e){t.$set(t.form,"options",e)},expression:"form.options"}}),t._v(" "),r("small",[t._v(t._s(t.$t("opts_separated_by_pipe")))])],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1):t._e()],1),t._v(" "),r("FormItem",{attrs:{prop:"required"}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.required,callback:function(e){t.$set(t.form,"required",e)},expression:"form.required"}},[r("span",[t._v(t._s(t.$t("required")))])])],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("fields")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("fields",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},88544:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("field","app/fields","slug","name")],data:function(){return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",sortType:"asc",minWidth:150},{title:this.$t("slug"),sortable:!0,key:"slug",minWidth:120},{title:this.$t("type"),sortable:!0,key:"type",minWidth:100},{title:this.$t("options"),sortable:!0,key:"options",minWidth:200},{title:this.$tc("order"),sortable:!0,key:"order",width:100},{title:this.$t("required"),sortable:!0,key:"required",width:100,render:this.renderIcon},{title:this.$t("description"),sortable:!0,key:"description",minWidth:200},{title:this.$t("entities"),sortable:!1,key:"entities",minWidth:200,render:this.renderEntities},{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"name",perPage:this.$store.state.settings.rows}}},methods:{renderIcon:function(t,e){return this.renderBoolean(t,e,"required")},renderEntities:function(t,e){var r=this;return t("div",[e.row.entities.map((function(t){return r.capitalize(t)})).join(", ")])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("field",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/fields/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("field"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/fields",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},8800:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>u});var i=r(48921),s=r(23279),a=r.n(s);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=function(t,e){return t.amount=t.amount?parseFloat(t.amount):null,t.points=t.points?parseFloat(t.points):null,t.expiry_date=t.expiry_date?new Date(t.expiry_date):null,e.form=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),e.form};const c={mixins:[(0,i.Z)("gift_card","app/gift_cards",!1,l)],data:function(){var t=this;return{customer:{},customers:[],searching:!1,form:{id:"",number:"",amount:null,customer_id:null,points:null,expiry_date:null,details:""},rules:{number:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("number")}),trigger:"change"}],amount:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("amount")}),trigger:"change"}],points:[{validator:function(e,r,i){r&&t.customer&&t.customer.points&&parseFloat(r)>parseFloat(t.customer.points)?i(new Error(t.$t("low_points_error"))):i()},type:"number",trigger:"change"}]}}},created:function(){var t=new Date,e=t.getDate(),r=t.getMonth(),i=t.getFullYear();this.form.expiry_date=new Date(i+2,r,e)},methods:{fetch:function(t){var e=this;this.$http.get("app/gift_cards/".concat(t)).then((function(t){return l(t.data,e)})).finally((function(){return e.loading=!1}))},generateNumber:function(){this.form.number=Math.floor(1e9+9e9*Math.random())},customerChanged:function(t){this.customer=this.customers.find((function(e){return e.value==t})),this.customer.points||(this.form.points=null)},searchCustomers:function(t){""===t||this.customers.find((function(e){return e.label==t}))||this.getCustomers(t,this)},getCustomers:a()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/customers/search?q="+t).then((function(t){e.customers=t.data,e.form.customer_id&&(e.customer=e.customers.find((function(t){return t.value==e.form.customer_id})),e.customer.points=parseFloat(e.customer.points)+parseFloat(e.form.points))})).finally((function(){return e.searching=!1}))}),search_delay||250)}};const u=(0,r(51900).Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("gift_card")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/gift_cards"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("gift_card",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"gift_card",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:18,lg:12}},[t.form.id?[r("FormItem",{attrs:{label:t.$tc("number")}},[r("Alert",{staticClass:"mb0"},[t._v("\n                    "+t._s(t.form.number)+"\n                  ")])],1)]:[r("FormItem",{attrs:{label:t.$tc("number"),prop:"number",error:t._f("a2s")(t.errors.form.number)}},[r("Input",{model:{value:t.form.number,callback:function(e){t.$set(t.form,"number",e)},expression:"form.number"}},[r("Button",{attrs:{slot:"append",icon:"md-refresh"},on:{click:t.generateNumber},slot:"append"})],1)],1)],t._v(" "),r("FormItem",{attrs:{label:t.$t("amount"),prop:"amount",error:t._f("a2s")(t.errors.form.amount)}},[r("InputNumber",{model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("expiry_date"),prop:"expiry_date",error:t._f("a2s")(t.errors.form.expiry_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.expiry_date,callback:function(e){t.$set(t.form,"expiry_date",e)},expression:"form.expiry_date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("customer"),error:t._f("a2s")(t.errors.form.customer_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchCustomers,placeholder:t.$t("type_to_search",{x:t.$tc("customer")})},on:{"on-change":t.customerChanged},model:{value:t.form.customer_id,callback:function(e){t.$set(t.form,"customer_id",e)},expression:"form.customer_id"}},t._l(t.customers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("transition",{attrs:{mode:"out-in",name:"slide-fade","enter-active-class":"animate__animated faster animate__fadeInDown","leave-active-class":"animate__animated fastest animate__fadeOutDown"}},[t.customer&&t.customer.points?[r("div",[r("FormItem",{attrs:{label:t.$t("points"),prop:"points",error:t._f("a2s")(t.errors.form.points)}},[r("InputNumber",{model:{value:t.form.points,callback:function(e){t.$set(t.form,"points",e)},expression:"form.points"}})],1),t._v(" "),r("FormItem",[r("Alert",{staticClass:"mb0"},[t._v("\n                        "+t._s(t.$t("available_x",{x:t.$t("points")}))+": "+t._s(t.formatNumber(t.customer.points-t.form.points))+"\n                      ")])],1)],1)]:t._e()],2),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],2),t._v(" "),r("Col",{attrs:{sm:24,md:6,lg:12}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("gift_cards")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("gift_cards",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},70117:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("gift_card","app/gift_cards","name")],data:function(){var t=this;return{columns:[{title:"",width:50,key:"id",align:"center",fixed:"left",render:this.renderTransactions},{title:this.$t("created_at"),sortable:!0,sortType:"desc",key:"created_at",minWidth:175,render:this.renderCreatedAt},{title:this.$t("number"),sortable:!0,key:"number",minWidth:200},{title:this.$tc("amount"),sortable:!0,key:"amount",minWidth:90,maxWidth:125,render:this.renderAmount},{title:this.$t("balance"),sortable:!0,key:"balance",minWidth:90,maxWidth:125,render:this.renderBalance},{title:this.$t("points"),sortable:!0,key:"points",minWidth:80,maxWidth:125,render:this.renderPoints},{title:this.$tc("expiry_date"),sortable:!0,key:"expiry_date",width:125,render:this.renderExpiryDate},{title:this.$tc("customer"),sortable:!0,key:"customer",minWidth:150,maxWidth:250,render:this.renderCustomer},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:250},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,editFn:t.editRecord,deleteFn:t.deleteRecord,record:{model:"gift_card",name:"number",title:t.$tc("gift_card")}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},methods:{renderTransactions:function(t,e){return t("transactions-icon-component",{props:{id:e.row.id,url:"/gift_cards/logs/"}})},renderAmount:function(t,e){return this.renderNumber(t,e,"amount",!0)},renderBalance:function(t,e){return this.renderNumber(t,e,"balance",!0)},renderPoints:function(t,e){return this.renderNumber(t,e,"points",!0)},renderCustomer:function(t,e){return t("div",[e.row.customer?e.row.customer.name:""])},renderExpiryDate:function(t,e){return t("div",[e.row.expiry_date?this.$options.filters.formatDate(e.row.expiry_date,this.$store.state.settings.dateformat):""])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("gift_card",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/gift_cards/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("gift_card"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{columns:t.columns,options:t.options,url:"app/gift_cards",dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},33406:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={data:function(){return{refresh:1,columns:[{title:this.$t("created_at"),sortable:!0,sortType:"desc",key:"created_at",width:175,render:this.renderCreatedAt},{title:this.$tc("amount"),sortable:!0,key:"amount",minWidth:100,maxWidth:150,render:this.renderAmount},{title:this.$t("description"),sortable:!0,key:"description",minWidth:250}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},computed:{url:function(){return"app/gift_cards/logs/".concat(this.$route.params.id?this.$route.params.id:"")}},methods:{renderCreatedAt:function(t,e){return t("div",[this.$options.filters.formatDate(e.row.created_at,this.$store.state.settings.dateformat+" HH:mm A")])},renderAmount:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.amount,this.$store.getters.settings.decimals)])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("gift_card_log",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/gift_cards"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list_x",{x:t.$tc("gift_card",2)}))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},65483:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(48921);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.extra_attributes?e.form=a(a({},t),t.extra_attributes):e.form=a({},t),e.form};const l={mixins:[(0,i.Z)("hall","app/halls",!0,o)],data:function(){return{locations:[],attributes:[],form:{id:"",code:"",title:"",details:""},rules:{code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"}],title:[{required:!0,message:this.$t("field_is_required",{field:this.$t("title")}),trigger:"blur"}],location_id:[{required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("default_x",{x:this.$tc("location")})})}]}}},created:function(){var t=this;this.$http.get("app/locations/search").then((function(e){return t.locations=e.data}))},methods:{create:function(){var t=this;this.$http.get("app/halls/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/halls/".concat(t)).then((function(t){return o(t.data,e)})).finally((function(){return e.loading=!1}))}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("hall")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/halls"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("hall",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"hall",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("title"),prop:"title",error:t._f("a2s")(t.errors.form.title)}},[r("Input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"location_id",error:t._f("a2s")(t.errors.form.location_id),label:t.$t("default_x",{x:t.$tc("location")})}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.location_id,callback:function(e){t.$set(t.form,"location_id",e)},expression:"form.location_id"}},[t.locations.length>0?t._l(t.locations,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})):t._e()],2)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("halls")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("halls",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},39330:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("hall","app/halls","title")],data:function(){var t=this;return{menus:[],columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"asc",minWidth:150,render:this.renderDateTime},{title:this.$tc("code"),sortable:!0,key:"code",width:150},{title:this.$t("title"),sortable:!0,key:"title",sortType:"asc",minWidth:200},{title:this.$tc("location",2),sortable:!1,key:"locations",minWidth:200,render:this.renderLocation},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:250},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:200,render:this.renderExtras},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-dropdown-component",{props:{params:r,menus:t.menus,record:{model:"hall",name:"title",title:t.$tc("hall")}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},created:function(){this.menus=[{Fn:this.editRecord,iconType:"md-create",title:this.$t("edit_x",{x:this.$tc("hall")})},{divided:!0,Fn:this.listTables,iconType:"ios-grid",title:this.$t("list_x",{x:this.$tc("table",2)})},{Fn:this.addTable,iconType:"ios-grid-outline",title:this.$t("add_x",{x:this.$tc("table")})},{confirm:!0,divided:!0,iconType:"md-trash",Fn:this.deleteRecord,title:this.$t("delete_x",{x:this.$tc("hall")})}]},methods:{addTable:function(t){this.$router.push({name:"tables.add",params:{hall_id:t.id}})},listTables:function(t){this.$router.push({name:"tables.list",params:{hall_id:t.id}})},renderLocation:function(t,e){return t("div",[e.row.location?e.row.location.name:""])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("hall",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/halls/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("hall"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/halls",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},64443:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(48921);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),e.form=a(a({},t),t.extra_attributes),e.form};const l={mixins:[(0,i.Z)("table","app/tables",!0,o)],data:function(){return{hall:null,attributes:[],form:{id:"",code:"",title:"",details:"",hall_id:this.$route.params.hall_id},rules:{code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"}],title:[{required:!0,message:this.$t("field_is_required",{field:this.$t("title")}),trigger:"blur"}],location_id:[{required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("default_x",{x:this.$tc("location")})})}]}}},created:function(){var t=this;this.form.hall_id=this.$route.params.hall_id,this.$http.get("app/halls/search?q="+this.form.hall_id).then((function(e){return t.hall=e.data[0]}))},methods:{create:function(){var t=this;this.$http.get("app/tables/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/tables/".concat(t)).then((function(t){return o(t.data,e)})).finally((function(){return e.loading=!1}))}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("table"))+" "+t._s(t.hall?" - "+t.hall.label:""))]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("router-link",{attrs:{to:"/settings/halls"}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("hall",2))+"\n    ")],1),t._v(" "),r("router-link",{attrs:{to:"/settings/halls/"+t.form.hall_id+"/tables"}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("table",2))+"\n    ")],1)],1),t._v(" "),r("div",[r("Form",{ref:"table",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("title"),prop:"title",error:t._f("a2s")(t.errors.form.title)}},[r("Input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("tables")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("tables",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)])}),[],!1,null,null,null).exports},25415:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("table","app/tables","title","code")],data:function(){return{url:null,hall:null,hall_id:null,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"asc",minWidth:150,render:this.renderDateTime},{title:this.$tc("code"),sortable:!0,key:"code",width:150},{title:this.$t("title"),sortable:!0,key:"title",sortType:"asc",minWidth:200},{title:this.$tc("hall",2),sortable:!1,key:"halls",minWidth:200,render:this.renderHall},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:250},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:200,render:this.renderExtras},{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.hall_id=this.$route.params.hall_id,this.url="app/tables?hall="+this.hall_id,this.$http.get("app/halls/search?q="+this.hall_id).then((function(e){return t.hall=e.data[0]}))},methods:{renderHall:function(t,e){return t("div",[e.row.hall?e.row.hall.title:""])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("table",2))+" "+t._s(t.hall?" - "+t.hall.label:""))]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("router-link",{attrs:{to:"/settings/halls"}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("hall",2))+"\n    ")],1),t._v(" "),r("router-link",{attrs:{to:"/settings/halls/"+t.hall_id+"/tables/add"}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("table"))+"\n    ")],1)],1),t._v(" "),r("div",[r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)])}),[],!1,null,null,null).exports},80223:(t,e,r)=>{"use strict";r.d(e,{Z:()=>s});const i={props:["error"],data:function(){return{uploadList:[],rules:{}}},methods:{handleUpload:function(t){return this.uploadList.push(t),this.$emit("selected",t),!1},clearAttachments:function(){this.$emit("clear"),this.uploadList=[]},removeAttachment:function(t){var e=this.$refs.attachments.fileList;this.$refs.attachments.fileList.splice(e.indexOf(t),1)}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("FormItem",{attrs:{label:t.$tc("attachment",2),prop:"attachments",error:t.error}},[r("Upload",{ref:"attachments",attrs:{action:"",multiple:"",type:"drag","max-size":2048,"before-upload":t.handleUpload,accept:".png, .jpeg, .jpg, .gif"}},[r("div",{staticStyle:{height:"60px",display:"flex","align-items":"center","justify-content":"space-between",padding:"0 16px","line-height":"1.5"}},[r("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[r("Icon",{staticStyle:{color:"#3399ff","margin-right":"8px"},attrs:{type:"ios-cloud-upload",size:"32"}}),t._v(" "),r("p",[t._v("\n          "+t._s(t.$t("click_or_drag_files"))+"\n        ")])],1),t._v(" "),t.uploadList&&t.uploadList.length?r("div",{staticStyle:{"margin-left":"8px"}},[t._v("\n        "+t._s(t.$t("x_files_selected",{x:t.uploadList.length}))+"\n      ")]):t._e()])]),t._v(" "),t.uploadList&&t.uploadList.length?r("div",[r("div",{staticStyle:{display:"flex","align-items":"center","flex-wrap":"wrap"}},t._l(t.uploadList,(function(e,i){return r("div",{key:"attachment_"+i,staticStyle:{display:"inline-block","padding-right":"8px","line-height":"1.8"}},[r("strong",[t._v(t._s(i+1)+".")]),t._v(" "+t._s(e.name)+"\n      ")])})),0),t._v(" "),r("Button",{staticStyle:{"margin-bottom":"3px"},attrs:{type:"error",size:"small",icon:"ios-trash"},on:{click:t.clearAttachments}},[t._v("\n      "+t._s(t.$t("clear_x",{x:t.$tc("file",t.uploadList.length)}))+"\n    ")])],1):t._e(),t._v(" "),t._t("default")],2)}),[],!1,null,null,null).exports},6151:(t,e,r)=>{"use strict";r.d(e,{Z:()=>l});const i={props:{value:{type:[Number,String],default:0},step:{default:.1},min:{default:0,type:Number},max:{type:Number}},data:function(){return{newValue:0}},methods:{plus:function(){(void 0===this.max||this.newValue<this.max)&&(this.newValue=parseFloat(parseFloat(parseFloat(this.newValue)+parseFloat(this.step)).toFixed(2)),this.$emit("input",this.newValue))},minus:function(){this.newValue>this.min&&(this.newValue=parseFloat(parseFloat(parseFloat(this.newValue)-parseFloat(this.step)).toFixed(2)),this.$emit("input",this.newValue))}},watch:{value:{handler:function(t,e){this.newValue=t}}},created:function(){this.newValue=parseFloat(this.value)}};var s=r(93379),a=r.n(s),n=r(45991),o={insert:"head",singleton:!1};a()(n.Z,o);n.Z.locals;const l=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"input-number text-center"},[r("div",{staticClass:"input-button first",on:{click:function(e){return t.minus()}}},[r("Icon",{attrs:{type:"md-remove",size:"16"}})],1),t._v(" "),r("div",{staticClass:"field-container"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.newValue,expression:"newValue"}],staticStyle:{width:"100%"},attrs:{step:t.step,type:"number"},domProps:{value:t.newValue},on:{input:[function(e){e.target.composing||(t.newValue=e.target.value)},function(e){return t.$emit("input",t.newValue)}]}})]),t._v(" "),r("div",{staticClass:"input-button last",on:{click:function(e){return t.plus()}}},[r("Icon",{attrs:{type:"md-add",size:"16"}})],1)])}),[],!1,null,"a81d4f58",null).exports},85290:(t,e,r)=>{"use strict";r.d(e,{Z:()=>s});const i={props:{payments:{required:!0}},data:function(){return{columns1:[{width:175,sortable:!1,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("reference"),className:"reference",sortable:!1,key:"reference",width:150},{title:this.$t("amount"),sortable:!1,key:"amount",minWidth:90,maxWidth:150,render:this.renderAmount},{title:this.$t("received"),sortable:!1,key:"received",width:100,render:this.renderIconReceived},{title:this.$t("gateway"),sortable:!1,key:"gateway",minWidth:100,maxWidth:150},{title:this.$tc("account"),sortable:!1,key:"for",maxWidth:300,minWidth:150,render:this.renderAccount},{title:this.$tc("created_for"),sortable:!1,key:"for",maxWidth:300,minWidth:150,render:this.renderPayable},{title:this.$t("payment_amount"),sortable:!1,key:"amount",minWidth:150,maxWidth:175,render:this.renderPaymentAmount},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")}]}},methods:{renderAccount:function(t,e){return t("div",[e.row.account.name])},renderPayable:function(t,e){return t("div",[e.row.payable.name])},renderUser:function(t,e){return t("div",[e.row.user.name])},renderAmount:function(t,e){return t("div",{class:"text-right bold"},[this.$options.filters.formatNumber(e.row.pivot.amount,this.$store.getters.settings.decimals)])},renderPaymentAmount:function(t,e){return t("div",{class:"text-right bold"},[this.$options.filters.formatNumber(e.row.amount,this.$store.getters.settings.decimals)])},renderCreatedAt:function(t,e){return t("div",[this.$options.filters.formatDate(e.row.created_at,this.$store.state.settings.dateformat+" HH:mm A")])},renderIconReceived:function(t,e){return t("div",{style:"text-align:center;"},[1==e.row.received?t("i",{class:"ivu-icon ivu-icon-md-checkmark",style:"font-size: 16px; color: #19be6b;"}):t("i",{class:"ivu-icon ivu-icon-md-close",style:"font-size: 16px; color: #ed4014;"})])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[!t.payments||t.payments.length<1?r("p",[t._v("\n    "+t._s(t.$t("no_payment_added"))+"\n  ")]):r("div",{staticClass:"bordered"},[r("Table",{attrs:{stripe:"",columns:t.columns1,data:t.payments}})],1)])}),[],!1,null,null,null).exports},22254:(t,e,r)=>{"use strict";r.d(e,{Z:()=>f});var i=r(18446),s=r.n(i);function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var i,s,a=[],n=!0,o=!1;try{for(r=r.call(t);!(n=(i=r.next()).done)&&(a.push(i.value),!e||a.length!==e);n=!0);}catch(t){o=!0,s=t}finally{try{n||null==r.return||r.return()}finally{if(o)throw s}}return a}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const u={components:{InputNumberComponent:r(6151).Z},props:{item:{required:!0},purchase:{type:Boolean,default:!1,required:!1}},data:function(){return{show:!1,form:{quantity:1,portion_id:null,variation_id:null,meta:{},portion:null,modifiers:[],serials:[]}}},watch:{item:function(t){this.setPortion()}},mounted:function(){this.setPortion()},methods:{setPortion:function(){var t=this;this.form={quantity:1,portion_id:null,variation_id:null,meta:{},portion:null,modifiers:[],serials:[]},this.$nextTick((function(){if(t.item.portions&&t.item.portions.length){var e=t.item.portions.find((function(t){return"regular"==t.name}));t.form.portion=l({},e),t.form.portion_id=e.id,t.form.portion.essentials.map((function(t){if(t.variation_id)for(var e=t.item.variations.find((function(e){return e.id==t.variation_id})),r=0,i=Object.entries(e.meta);r<i.length;r++){var s=a(i[r],2),n=s[0],o=s[1];t[n]=o}})),t.form.portion.choosables.map((function(t){t.items.map((function(e){if(e.variation_id)for(var r=e.item.variations.find((function(t){return t.id==e.variation_id})),i=0,s=Object.entries(r.meta);i<s.length;i++){var n=a(s[i],2),o=n[0],l=n[1];t[o]=l}}))}))}}))},modOptLabel:function(t){return t.item.name+" (+"+this.formatDecimal(t.item.price)+")"},selectChoosableVariant:function(t){this.form.portion.choosables=this.form.portion.choosables.map((function(e){return e.selected&&e.id==t&&(e.items=e.items.map((function(t){if(t.item.id==e.selected){var r={};if(t&&t.item.variants){t.item.variants.map((function(e){return t[e.name]?r[e.name]=t[e.name]:""}));var i=t.item.variations.find((function(t){return s()(t.meta,r)}));t.variation_id=i?i.id:null}}return t}))),e}))},selectPortionItemVariant:function(t){this.form.portion.portion_items=this.form.portion.portion_items.map((function(e){if(e.id==t){var r={};e.item.variants.map((function(t){return e[t.name]?r[t.name]=e[t.name]:""}));var i=e.item.variations.find((function(t){return s()(t.meta,r)}));e.variation_id=i?i.id:null}return e}))},selectEssentialVariant:function(t){this.form.portion.essentials=this.form.portion.essentials.map((function(e){if(e.id==t){var r={};e.item.variants.map((function(t){return e[t.name]?r[t.name]=e[t.name]:""}));var i=e.item.variations.find((function(t){return s()(t.meta,r)}));e.variation_id=i?i.id:null}return e}))},selectVariant:function(){var t=this,e=this.item.variations.find((function(e){return s()(e.meta,t.form.meta)}));e&&(this.qty=this.formatDecimal(e.location_stock[0].quantity),this.show=!0,this.form.variation_id=e.id)},portionChanged:function(t){var e=t?this.item.portions.find((function(e){return e.id==t})):{};this.form.portion=l({},e)},submit:function(){var t=this;this.$refs.form.validate((function(e){if(e){if(t.item.serials&&t.item.serials.length&&t.form.serials.length!=t.form.quantity)return t.$Notice.error({title:t.$t("invalid_form"),desc:t.$t("invalid_form_error"),duration:10}),!1;if(t.item.modifiers&&t.item.modifiers.length&&t.item.modifiers.map((function(e){e.selected&&("checkbox"==e.show_as||"select_multiple"==e.show_as?e.selected.map((function(r){e.options.map((function(i){r==i.id&&t.form.modifiers.push({id:i.id,mId:e.id,quantity:1,cost:i.item.cost,option:i.item.name,price:i.item.price,title:e.title})}))})):e.options.map((function(r){e.selected==r.id&&t.form.modifiers.push({id:r.id,mId:e.id,quantity:1,cost:r.item.cost,option:r.item.name,price:r.item.price,title:e.title})})))})),t.form.portion){var r={choosables:[],essentials:[],portion_items:[],id:t.form.portion.id,name:t.form.portion.name,quantity:t.form.quantity,cost:t.form.portion.cost,price:t.form.portion.price};t.form.portion.portion_items.map((function(t){var e=t.item.variations.find((function(e){return e.id==t.variation_id}));r.portion_items.push({id:t.id,item_id:t.item.id,variants:t.item.variants,variation_id:t.variation_id,variations:t.item.variations,meta:e?e.meta:null})})),t.form.portion.essentials.map((function(t){var e=t.item.variations.find((function(e){return e.id==t.variation_id}));r.essentials.push({id:t.id,item_id:t.item.id,variants:t.item.variants,variation_id:t.variation_id,variations:t.item.variations,meta:e?e.meta:null})})),t.form.portion.choosables.map((function(t){var e=t.items.find((function(e){return e.item_id==t.selected})),i=e.item.variations.find((function(t){return t.id==e.variation_id}));r.choosables.push({id:t.id,selected:t.selected,variants:e.item.variants,variation_id:e.variation_id,variations:e.item.variations,meta:i?i.meta:null})})),t.form.selected_portion=r}else t.form.selected_portion=null;if(t.form.variation_id){var i=t.item.variations?t.item.variations.find((function(e){return e.id==t.form.variation_id})):null,s=i?{id:i.id,meta:i.meta,quantity:t.form.quantity,cost:i.location_stock[0].cost,price:i.location_stock[0].price,available:t.formatDecimal(i.location_stock[0].quantity)}:null;t.form.selected_variation=i?s:null}else t.form.selected_variation=null;t.$emit("on-submit",t.form)}else t.$Notice.error({title:t.$t("invalid_form"),desc:t.$t("invalid_form_error"),duration:10})}))}}};var d=r(93379),m=r.n(d),h=r(19270),p={insert:"head",singleton:!1};m()(h.Z,p);h.Z.locals;const f=(0,r(51900).Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Form",{ref:"form",attrs:{model:t.form,"label-position":"top"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{staticClass:"text-center",attrs:{label:t.$t("quantity")}},[r("InputNumber",{attrs:{size:"large"},model:{value:t.form.quantity,callback:function(e){t.$set(t.form,"quantity",e)},expression:"form.quantity"}})],1)],1),t._v(" "),t.item.serials&&t.item.serials.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.item.serials.length?r("FormItem",{attrs:{label:t.$tc("serial_number",2),prop:"serials",rules:[{required:!0,type:"array",size:t.form.quantity,message:t.$t("field_are_required",{field:t.$tc("serial_number",2)}),trigger:"change"}]}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.form.serials,callback:function(e){t.$set(t.form,"serials",e)},expression:"form.serials"}},t._l(t.item.serials,(function(e,i){return r("Option",{key:"serial_"+i,attrs:{value:e.id}},[t._v("\n                "+t._s(e.number)+"\n              ")])})),1)],1):t._e()],1)]:t._e(),t._v(" "),t.item.portions&&t.item.portions.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("Card",{staticClass:"cardp",attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"ios-option"}}),t._v("\n              "+t._s(t.$tc("portion"))+":\n              "+t._s(t.item&&t.form.portion_id?" ("+("regular"==t.form.portion.name?t.$t("regular"):t.form.portion.name)+")":"")+"\n            ")],1),t._v(" "),r("Row",[t.item.portions.length>1?[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("RadioGroup",{staticClass:"mb16",attrs:{type:"button"},on:{"on-change":t.portionChanged},model:{value:t.form.portion_id,callback:function(e){t.$set(t.form,"portion_id",e)},expression:"form.portion_id"}},t._l(t.item.portions,(function(e,i){return r("Radio",{key:"pi_"+i,attrs:{label:e.id}},[t._v("\n                      "+t._s("regular"==e.name?t.$t("regular"):e.name)+"\n                    ")])})),1)],1)]:t._e(),t._v(" "),t.form.portion_id?r("Col",{attrs:{sm:24,md:24,lg:24}},[t.form.portion.portion_items&&t.form.portion.portion_items.length?[r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                      "+t._s(t.$tc("item",t.form.portion.portion_items.length))+"\n                    ")])]),t._v(" "),r("p",{staticStyle:{"margin-bottom":"8px","font-weight":"bold"}},[t._v("\n                    "+t._s(t.form.portion.portion_items.map((function(t){return t.item.name})).join(", "))+"\n                  ")])]:t._e(),t._v(" "),t.form.portion.essentials&&t.form.portion.essentials.length?r("span",[r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                      "+t._s(t.$t("essential_items"))+"\n                    ")])]),t._v(" "),r("p",{staticStyle:{"margin-bottom":"8px","font-weight":"bold"}},[t._v("\n                    "+t._s(t.form.portion.essentials.map((function(t){return t.item.name})).join(", "))+"\n                  ")])],1):t._e(),t._v(" "),t.form.portion.choosables&&t.form.portion.choosables.length?r("span",[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                      "+t._s(t.$t("choosable_items"))+"\n                    ")])]),t._v(" "),t._l(t.form.portion.choosables,(function(e,i){return r("div",{key:"gi_"+i},[r("FormItem",{attrs:{label:e.name,prop:"portion.choosables."+i+".selected",rules:{required:!0,trigger:"change",message:t.$t("select_x",{x:t.$tc("item")})}}},[r("RadioGroup",{attrs:{vertical:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"g.selected"}},t._l(e.items,(function(e,i){return r("Radio",{key:"gii_"+i,attrs:{"false-value":"",label:e.item_id,"true-value":e.item_id}},[t._v("\n                          "+t._s(e.item.name)+"\n                        ")])})),1)],1)],1)}))],2):t._e(),t._v(" "),t.form.portion.portion_items&&t.form.portion.portion_items.length?t._l(t.form.portion.portion_items,(function(e,i){return r("div",{key:"eiv_"+i},[e.item.variants&&e.item.variants.length?[r("div",{key:"t_"+i,staticClass:"mb16"},[r("span",{staticClass:"bold"},[t._v(t._s(e.item.name)+" ("+t._s(t.$tc("variation"))+")")])]),t._v(" "),r("Row",{key:"r_"+i,attrs:{gutter:16}},t._l(e.item.variants,(function(s,a){return r("Col",{key:"pcsv_"+a,attrs:{xs:24,sm:12}},[r("FormItem",{key:"picsvf_"+s.id,attrs:{label:s.name,prop:"portion.portion_items["+i+"]."+s.name,rules:{required:!0,trigger:"change",message:t.$t("select_x",{x:t.$tc("variant")})}}},[r("Select",{on:{"on-change":function(r){return t.selectPortionItemVariant(e.id)}},model:{value:e[s.name],callback:function(r){t.$set(e,s.name,r)},expression:"e[v.name]"}},t._l(s.options,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)})),1)]:t._e()],2)})):t._e(),t._v(" "),t.form.portion.essentials&&t.form.portion.essentials.length?t._l(t.form.portion.essentials,(function(e,i){return r("div",{key:"eiv_"+i},[e.item.variants&&e.item.variants.length?[r("div",{key:"t_"+i,staticClass:"mb16"},[r("span",{staticClass:"bold"},[t._v(t._s(e.item.name)+" ("+t._s(t.$tc("variation"))+")")])]),t._v(" "),r("Row",{key:"r_"+i,attrs:{gutter:16}},t._l(e.item.variants,(function(s,a){return r("Col",{key:"pcsv_"+a,attrs:{xs:24,sm:12}},[r("FormItem",{key:"pcsvf_"+s.id,attrs:{label:s.name,prop:"portion.essentials["+i+"]."+s.name,rules:{required:!0,trigger:"change",message:t.$t("select_x",{x:t.$tc("variant")})}}},[r("Select",{on:{"on-change":function(r){return t.selectEssentialVariant(e.id)}},model:{value:e[s.name],callback:function(r){t.$set(e,s.name,r)},expression:"e[v.name]"}},t._l(s.options,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)})),1)]:t._e()],2)})):t._e(),t._v(" "),t.form.portion.choosables&&t.form.portion.choosables.length?t._l(t.form.portion.choosables,(function(e,i){return r("div",{key:"giv_"+i},[t._l(e.items,(function(s,a){return[e.selected&&e.selected==s.item.id&&s.item.variants&&s.item.variants.length?[r("div",{key:"t_"+i,staticClass:"mb16"},[r("span",{staticClass:"bold"},[t._v(t._s(e.name))]),t._v(": "+t._s(s.item.name)+" ("+t._s(t.$tc("variation"))+")\n                        ")]),t._v(" "),r("Row",{key:"r_"+i,attrs:{gutter:16}},t._l(s.item.variants,(function(s,n){return r("Col",{key:"pcsv_"+n,attrs:{xs:24,sm:12}},[r("FormItem",{key:"pcsvf_"+s.id,attrs:{label:s.name,prop:"portion.choosables["+i+"].items["+a+"]."+s.name,rules:{required:!0,trigger:"change",message:t.$t("select_x",{x:t.$tc("variant")})}}},[r("Select",{on:{"on-change":function(r){return t.selectChoosableVariant(e.id)}},model:{value:e.items[a][s.name],callback:function(r){t.$set(e.items[a],s.name,r)},expression:"g.items[optionI][v.name]"}},t._l(s.options,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)})),1)]:t._e()]}))],2)})):t._e()],2):t._e()],2)],1)],1)]:t._e(),t._v(" "),t.item.variants&&t.item.variants.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n              "+t._s(t.$tc("variant",2))+"\n            ")])])],1),t._v(" "),t._l(t.item.variants,(function(e,i){return r("Col",{key:"sv_"+i,attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:e.name,prop:"meta."+e.name,rules:{required:!0,trigger:"change",message:t.$t("select_x",{x:t.$tc("variant")})}}},[r("Select",{on:{"on-change":t.selectVariant},model:{value:t.form.meta[e.name],callback:function(r){t.$set(t.form.meta,e.name,r)},expression:"form.meta[v.name]"}},t._l(e.options,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)})),t._v(" "),t.item.variants.length%2==1?r("Col",{attrs:{sm:24,md:12,lg:12}}):t._e(),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}},[t.show?r("Alert",{staticClass:"mb16",attrs:{type:"info","show-icon":""}},[r("strong",[t.purchase?r("span",[t._v(t._s(this.$t("current_stock")))]):r("span",[t._v(t._s(this.$t("available_x",{x:this.$t("quantity")})))]),t._v(": "+t._s(this.qty))])]):t._e()],1)]:t._e(),t._v(" "),!t.purchase&&t.item.modifiers&&t.item.modifiers.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n              "+t._s(t.$tc("modifier",2))+"\n            ")])])],1),t._v(" "),t._l(t.item.modifiers,(function(e,i){return r("Col",{key:"mi_"+i,attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:e.title,prop:"modifiers"}},["radio"==e.show_as?r("span",[r("RadioGroup",{attrs:{vertical:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"checkbox"==e.show_as?r("span",[r("CheckboxGroup",{attrs:{vertical:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"select"==e.show_as?r("span",[r("Select",{model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"select_multiple"==e.show_as?r("span",[r("Select",{attrs:{multiple:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):t._e()])],1)}))]:t._e()],2)],1),t._v(" "),r("div",{staticClass:"text-right"},[r("Button",{attrs:{long:"",type:"primary",disabled:t.form.quantity<1},on:{click:t.submit}},[t._v("\n      "+t._s(this.$t("add"))+"\n    ")])],1)],1)}),[],!1,null,null,null).exports},41077:(t,e,r)=>{"use strict";r.d(e,{Z:()=>u});var i=r(96192),s=r.n(i);const a={props:["u"],data:function(){return{qr:"",image:null,loading:!1,qrcode:s()}},computed:{user:function(){return this.u?this.u:this.$store.getters.user}},watch:{u:function(t){this.loadCard()}},mounted:function(){this.loadCard()},methods:{loadCard:function(){var t=this;this.user.active&&this.user.can_impersonate&&(this.loading=!0,this.$http.post("/app/impersonate/".concat(this.user.username,"/url")).then((function(e){e.data.success&&(t.qr=t.qrcode(0,"L"),t.qr.addData(e.data.url),t.qr.make(),t.image=t.qr.createSvgTag({scalable:!0}))})).catch((function(){return t.$emit("close",!0)})).finally((function(){return t.loading=!1})))},print:function(){window.print()}}};var n=r(93379),o=r.n(n),l=r(70177),c={insert:"head",singleton:!1};o()(l.Z,c);l.Z.locals;const u=(0,r(51900).Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{staticClass:"user-card",attrs:{"dis-hover":""}},[t.user.avatar?r("Avatar",{staticClass:"mb16 mt16",attrs:{src:t.user.avatar,size:"120"}}):t._e(),t._v(" "),r("h3",[t._v(t._s(t.user.name))]),t._v(" "),r("p",{staticClass:"mt16"},[t._v("\n      "+t._s(t.user.username)),r("br"),t._v("\n      "+t._s(t.user.phone)+"\n    ")]),t._v(" "),t.loading?r("div",{staticStyle:{height:"180px"}},[r("Loading")],1):r("div",{staticClass:"qr-code",domProps:{innerHTML:t._s(t.image)}})],1),t._v(" "),r("Button",{staticClass:"np",attrs:{type:"primary",icon:"ios-print",long:""},on:{click:function(e){return t.print()}}},[t._v("Print")])],1)}),[],!1,null,null,null).exports},53715:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var i=r(48921),s=r(44605);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var u=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.amount=parseFloat(t.amount),t.category_id=t.categories[0].id,e.attachments=t.attachments&&t.attachments.length?l(t.attachments):[],e.form=n(n({},t),t.extra_attributes),e.form};const d={mixins:[s.Z,(0,i.Z)("income","app/incomes",!0,u)],data:function(){return{accounts:[],categories:[],attributes:[],form:{id:"",date:new Date,title:"",reference:"",amount:null,details:"",account_id:"",category_id:""},rules:{title:[{required:!0,message:this.$t("field_is_required",{field:this.$t("title")}),trigger:"blur"}],reference:[{required:!1,message:this.$t("field_is_required",{field:this.$t("reference")}),trigger:"blur"}],account_id:[{required:!0,message:this.$t("field_is_required",{field:this.$t("account")}),trigger:"change"}],category_id:[{required:!0,message:this.$t("field_is_required",{field:this.$t("category")}),trigger:"change"}],date:[{type:"date",required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("date")})}],amount:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("amount")}),trigger:"blur"}]}}},created:function(){var t=this;this.$http.get("app/accounts/search").then((function(e){return t.accounts=e.data})),this.$http.get("app/all_categories/search").then((function(e){return t.categories=t.flattenDeep(e.data)}))},methods:{create:function(){var t=this;this.$http.get("app/incomes/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/incomes/".concat(t)).then((function(t){return u(t.data,e)})).finally((function(){return e.loading=!1}))}}};const m=(0,r(51900).Z)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("income")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/incomes"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("income",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"income",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("title"),prop:"title",error:t._f("a2s")(t.errors.form.title)}},[r("Input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("amount"),prop:"amount",error:t._f("a2s")(t.errors.form.amount)}},[r("InputNumber",{model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1)],1),t._v(" "),r("Col",{staticClass:"sm-pt-24",attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("account"),prop:"account_id",error:t._f("a2s")(t.errors.form.account_id)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.account_id,callback:function(e){t.$set(t.form,"account_id",e)},expression:"form.account_id"}},t._l(t.accounts,(function(e,i){return t.accounts.length>0?r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))]):t._e()})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("category"),prop:"category_id",error:t._f("a2s")(t.errors.form.category_id)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(e,i){return t.categories.length>0?r("Option",{key:i,attrs:{value:e.id}},[t._v("\n                    "+t._s(e.name)+"\n                  ")]):t._e()})),1)],1)],1)],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("incomes")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("incomes",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},30183:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(92704);const s={components:{IncomeViewComponent:r(25258).Z},mixins:[(0,i.Z)("income","app/incomes","title","reference")],data:function(){var t=this;return{view:!1,loading:!1,income:{id:null,reference:null},columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",minWidth:125,render:this.renderDate},{title:this.$t("title"),sortable:!0,key:"title",minWidth:200},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("amount"),sortable:!0,key:"amount",maxWidth:125,minWidth:125,render:this.renderAmount},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{title:this.$tc("category"),sortable:!1,key:"categories",minWidth:175,render:this.renderCategory},{title:this.$tc("account"),sortable:!1,key:"account",minWidth:175,render:this.renderAccount},{title:this.$tc("created_by"),sortable:!1,key:"user",minWidth:175,render:this.renderUser},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:300},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:250,render:this.renderExtras},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"desc",minWidth:175,render:this.renderDateTime},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,viewFn:t.viewModal,editFn:t.editRecord,deleteFn:t.deleteRecord,record:{model:"income",name:"reference",title:t.$tc("income")}}})}}],options:{perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.income.id&&(this.loading=!0,this.$http.get("app/incomes/".concat(t.id)).then((function(t){return e.income=t.data})).finally((function(){return e.loading=!1})))},renderAmount:function(t,e){return this.renderNumber(t,e,"amount")},renderAccount:function(t,e){return t("div",[e.row.account.name])},renderLocation:function(t,e){return t("div",[e.row.location.name])},renderCategory:function(t,e){return t("div",[e.row.categories.map((function(t){return t.name})).join("")])},renderUser:function(t,e){return t("div",[e.row.user?e.row.user.name:""])}}};const a=(0,r(51900).Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("income",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/incomes/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("income"))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/incomes",columns:t.columns,options:t.options,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{title:t.$tc("income"),width:"750","footer-hide":!0,"mask-closable":!1},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("income-view-component",{attrs:{income:t.income},on:{remove:function(e){return t.deleteAttachment(e,t.income)}}})],1)],1)}),[],!1,null,null,null).exports},25258:(t,e,r)=>{"use strict";r.d(e,{Z:()=>o});var i=r(7174),s=r.n(i),a=r(47401);const n={props:{income:{type:Object,required:!0}},components:{VueBarcode:s(),ListAttachmentsComponent:a.Z},data:function(){return{loading:!1}},methods:{print:function(){window.print()},deleteAttachment:function(t){this.$emit("remove",t)}}};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{}},[t.income.id?r("div",{staticClass:"order"},[r("div",{staticClass:"order-header"},[r("div",{staticClass:"details"},[r("img",{staticClass:"logo",attrs:{src:t.income.location&&t.income.location.logo?t.income.location.logo:t.$store.state.settings.default_logo}}),t._v(" "),r("div",{staticClass:"header-text"},[r("ul",[r("li",[r("strong",[t._v(t._s(t.$store.getters.settings.name)+" ("+t._s(t.$store.getters.settings.short_name)+")")])]),t._v(" "),r("li",[r("strong",[t._v(t._s(t.$store.getters.settings.company))])]),t._v(" "),r("li",[t._v(t._s(t.$store.getters.settings.email)+" "),r("span",{staticClass:"text-muted"},[t._v("|")]),t._v(" "+t._s(t.$store.getters.settings.phone))]),t._v(" "),r("li",[t._v(t._s(t.$store.getters.settings.address))])])])]),t._v(" "),r("vue-barcode",{staticClass:"barcode",attrs:{width:1,margin:0,height:50,fontSize:12,"margin-top":0,format:"code39","margin-bottom":2,value:t.income.reference}},[t._v("\n        "+t._s(t.$t("barcode_error"))+"\n      ")])],1),t._v(" "),r("Row",{staticClass:"border-t",attrs:{gutter:16}},[r("Col",{staticClass:"border-y py-2",attrs:{xs:24}},[r("h3",{staticClass:"text-center",staticStyle:{"text-transform":"uppercase"}},[t._v("\n          "+t._s(t.$tc("income"))+"\n        ")])])],1),t._v(" "),r("Row",{staticClass:"border-y py-2",attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[t._v("\n        "+t._s(t.$t("date"))+": "),r("strong",[t._v(t._s(t._f("date")(t.income.date)))]),t._v(" "),r("br"),t._v("\n        "+t._s(t.$t("reference"))+": "),r("strong",[t._v(t._s(t.income.reference))])]),t._v(" "),r("Col",{attrs:{xs:24,sm:12}},[t._v("\n        "+t._s(t.$t("created_at"))+": "),r("strong",[t._v(t._s(t._f("datetime")(t.income.created_at)))]),t._v(" "),r("br"),t._v("\n        "+t._s(t.$t("created_by"))+": "),r("strong",[t._v(t._s(t.income.user.name))])])],1),t._v(" "),r("Row",{staticClass:"mt16",attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[r("p",[t._v(t._s(t.$tc("store"))+":")]),t._v(" "),t.income.location?r("div",[r("strong",[t._v(t._s(t.income.location.name))]),r("br"),t._v(" "),t.income.location.address?r("span",[t._v(t._s(t.income.location.address))]):t._e(),t._v(" "),t.income.location.state_name?r("span",[t._v(t._s(t.income.location.state_name))]):t._e(),t._v(" "),t.income.location.country_name?r("span",[t._v(t._s(t.income.location.country_name))]):t._e(),r("br"),t._v(" "),t.income.location.phone?r("span",[t._v(t._s(t.income.location.phone))]):t._e(),r("br"),t._v(" "),t.income.location.email?r("span",[t._v(t._s(t.income.location.email))]):t._e(),r("br")]):t._e()])],1),t._v(" "),r("div",{staticClass:"table-wrapper"},[r("table",{staticClass:"table"},[r("tbody",[r("tr",[r("td",[t._v(t._s(t.$t("title")))]),t._v(" "),r("td",[t._v(t._s(t.income.title))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$tc("account")))]),t._v(" "),r("td",[t._v(t._s(t.income.account.name))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$tc("category")))]),t._v(" "),r("td",[t._v(t._s(t.income.categories[0].name))])]),t._v(" "),r("tr",[r("td",{staticClass:"bold"},[t._v(t._s(t.$t("amount")))]),t._v(" "),r("td",{staticClass:"bold"},[t._v(t._s(t.formatNumber(t.income.amount)))])])])])]),t._v(" "),t.checkExtraAttributes(t.income.extra_attributes)?r("Card",{staticClass:"mt16",attrs:{"dis-hover":""}},[r("span",{domProps:{innerHTML:t._s(t.renderExtraAttributes(t.income.extra_attributes,t.income.attributes))}})]):t._e(),t._v(" "),r("list-attachments-component",{staticClass:"mt16",attrs:{attachments:t.income.attachments},on:{remove:t.deleteAttachment}}),t._v(" "),t.income.details?r("Card",{staticClass:"mt16",attrs:{"dis-hover":""}},[t._v(t._s(t.income.details))]):t._e()],1):t._e(),t._v(" "),r("div",{staticClass:"np text-center"},[r("Button",{staticClass:"mt16 mx8",attrs:{type:"primary",loading:t.loading,disabled:t.loading,icon:"md-print"},on:{click:function(e){return t.print()}}},[t._v("\n      "+t._s(t.$t("print"))+"\n    ")])],1)])}),[],!1,null,null,null).exports},25720:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>y});var i=r(48921),s=r(23279);function a(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const u={props:{pportions:{type:Array,required:!0},loading:{type:Boolean,required:!0}},data:function(){return{local:[],result:[],portions:[],group:!1,minCost:null,saving:!1,option:!1,searching:!1,current:{name:""},choosable_group_type:{name:""},portionRules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}]},groupRules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}]}}},created:function(){var t=this;this.pportions.map((function(e){e.essentials.map((function(e){e.item?t.local.push(l(l({},e.item),{},{id:e.item_id,value:e.item_id,label:e.item.name})):t.local.push(l(l({},e),{},{id:e.item_id,value:e.item_id,label:e.name}))})),e.choosables.map((function(e){return e.items.map((function(e){e.item?t.local.push(l(l({},e.item),{},{id:e.item_id,value:e.item_id,label:e.item.name})):t.local.push(l(l({},e),{},{id:e.item_id,value:e.item_id,label:e.name}))}))}))})),this.result=a(this.local),this.portions=this.pportions.map((function(t){return t.cost=t.cost?parseFloat(t.cost):null,t.price=t.price?parseFloat(t.price):null,t.essentials&&t.essentials.length&&(t.essentials=t.essentials.map((function(t){return t.quantity=t.quantity?parseFloat(t.quantity):null,t.item&&(t.sku=t.item.sku,t.name=t.item.name,t.cost=t.item.cost,t.item_id=t.item.id,delete t.item),t}))),t.choosables&&t.choosables.length&&(t.choosables=t.choosables.map((function(t){return t.items&&t.items.length&&(t.items=t.items.map((function(t){return t.quantity=t.quantity?parseFloat(t.quantity):null,t.item&&(t.id=t.item.id,t.sku=t.item.sku,t.name=t.item.name,t.cost=t.item.cost,t.item_id=t.item.id,delete t.item),t}))),t}))),t}))},methods:{modalChanged:function(t){t?window&&this.$nextTick((function(){document.querySelector("#group_name").focus(),document.querySelector("#portion_name").focus()})):(this.$refs.group.resetFields(),this.$refs.current.resetFields())},addItemRow:function(t,e,r){t.essentials.push({quantity:1})},addPortion:function(){var t=this;this.$refs.current.validate((function(e){if(e){if(t.current.name){var r=t.portions.find((function(t){return"regular"==t.name})),i=JSON.parse(JSON.stringify(l(l({},r),{},{name:t.current.name})));i.id=null,i.sku=t.sku(),t.portions.push(i),t.$refs.current.resetFields(),t.option=!1}}else t.$Notice.error({title:t.$t("invalid_input"),desc:t.$t("invalid_input_error"),duration:10})}))},addChoosableTypeGroup:function(){var t=this;this.$refs.group.validate((function(e){e?t.choosable_group_type.name&&(t.portions=t.portions.map((function(e){return e.choosables.push({name:t.choosable_group_type.name,items:[{quantity:1}]}),e})),t.$refs.group.resetFields(),t.group=!1):t.$Notice.error({title:t.$t("invalid_input"),desc:t.$t("invalid_input_error"),duration:10})}))},addChoosableRow:function(t,e,r){t&&e&&e.items.push({quantity:1})},removePortion:function(t){this.portions.splice(t,1)},portionCost:function(t,e){var r=0;if(t.essentials.length&&(r+=t.essentials.reduce((function(t,e){return t+(e.cost?parseFloat(e.cost)*parseFloat(e.quantity):0)}),0)),t.choosables.length){var i=0;t.choosables.map((function(t){var e=t.items.reduce((function(t,e){return t.cost>e.cost?t:e}),{cost:0});i+=e.cost?parseFloat(e.cost):0}));r+=i}return r},searchItems:function(t){""===(t=t.trim())||this.result.find((function(e){return e.id==t||e.name==t}))||this.getItems(t,this)},getItems:r.n(s)()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/items/search?with=variations&cost=yes&q="+t).then((function(t){e.result=t.data,e.result=[].concat(a(e.result),a(e.local))})).finally((function(){return e.searching=!1}))}),search_delay||250),itemChanged:function(t,e,r,i){if(t){var s=this.result.find((function(e){return e.id==t})),a={quantity:1,id:s.id,sku:s.sku,cost:s.cost,name:s.name,variation_id:null,item_id:s.item_id?s.item_id:s.id,variations:s.variations.map((function(t){return{id:t.id,variation_id:t.id,sku:t.sku,meta:t.meta}}))};!1!==i?e.choosables[r].items.splice(i,1,a):e.essentials.splice(r,1,a)}this.portionCost(e)},goToStep:function(t){this.$emit("step-changed",t)},onReset:function(){this.$emit("on-reset")},onSubmit:function(t,e){var r=this;this.$emit("portions-changed",this.portions),this.$nextTick((function(){r.$emit("on-submit",{page:t,stay:e})}))}}};var d=r(51900);const m=(0,d.Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Row",{attrs:{gutter:16}},t._l(t.portions,(function(e,i){return r("Col",{key:"portion_"+i,attrs:{sm:24,md:12,lg:12}},[r("Card",{staticClass:"portion-card dark-border",staticStyle:{"line-height":"1em"},attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s("regular"==e.name?t.$t("regular"):e.name))]),t._v(" "),i?r("Button",{attrs:{slot:"extra",size:"small",type:"error"},on:{click:function(e){return t.removePortion(i)}},slot:"extra"},[r("Icon",{attrs:{type:"ios-trash"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("delete_x",{x:t.$tc("portion")})))])],1):r("Button",{attrs:{slot:"extra",size:"small",type:"success"},on:{click:function(e){t.option=!0}},slot:"extra"},[r("Icon",{attrs:{type:"ios-options"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("add_x",{x:t.$tc("portion")})))])],1),t._v(" "),r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("essential_items")))]),t._v(" "),r("Button",{attrs:{slot:"extra",size:"small",type:"primary"},on:{click:function(r){return t.addItemRow(e,i,!0)}},slot:"extra"},[r("Icon",{attrs:{type:"ios-add-circle"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("add_x",{x:t.$tc("item")})))])],1),t._v(" "),r("div",{staticClass:"variant-table mb16"},[r("table",{staticClass:"table"},[r("thead",[r("tr",[r("th",[t._v(t._s(t.$t("name")))]),t._v(" "),r("th",[t._v(t._s(t.$tc("variation")))]),t._v(" "),r("th",[t._v(t._s(t.$t("quantity")))])])]),t._v(" "),r("tbody",t._l(e.essentials,(function(i,s){return r("tr",{key:"ei_"+s},[r("td",{attrs:{width:"40%"}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchItems,label:e.essentials.map((function(t){return t.name}))},on:{"on-change":function(r){return t.itemChanged(r,e,s,!1)}},model:{value:i.id,callback:function(e){t.$set(i,"id",e)},expression:"essential.id"}},t._l(t.result,(function(t,e){return r("Option",{key:"eioi_"+e,attrs:{value:t.id,label:t.name}})})),1)],1),t._v(" "),r("td",{attrs:{width:"40%"}},[i.variations&&i.variations.length?[r("Select",{attrs:{filterable:"",clearable:""},model:{value:i.variation_id,callback:function(e){t.$set(i,"variation_id",e)},expression:"essential.variation_id"}},t._l(i.variations,(function(e,i){return r("Option",{key:"eivoi_"+i,attrs:{value:e.id,label:t.metaString(e.meta,!0)}})})),1)]:t._e()],2),t._v(" "),r("td",[r("InputNumber",{model:{value:i.quantity,callback:function(e){t.$set(i,"quantity",e)},expression:"essential.quantity"}})],1)])})),0)])])],1),t._v(" "),r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("choosable_items")))]),t._v(" "),r("Button",{attrs:{slot:"extra",size:"small",type:"primary"},on:{click:function(e){t.group=!0}},slot:"extra"},[r("Icon",{attrs:{type:"ios-folder"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("add_x",{x:t.$tc("group_type")})))])],1),t._v(" "),t._l(e.choosables,(function(i,s){return r("Card",{key:"gi_"+s,staticClass:"mb16",attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(i.name))]),t._v(" "),r("Button",{attrs:{slot:"extra",size:"small",type:"primary"},on:{click:function(r){return t.addChoosableRow(e,i,s)}},slot:"extra"},[r("Icon",{attrs:{type:"ios-add-circle"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("add_x",{x:t.$tc("item")})))])],1),t._v(" "),r("div",{staticClass:"variant-table mb16"},[r("table",{staticClass:"table"},[r("thead",[r("tr",[r("th",[t._v(t._s(t.$t("name")))]),t._v(" "),r("th",[t._v(t._s(t.$tc("variation")))]),t._v(" "),r("th",[t._v(t._s(t.$t("quantity")))])])]),t._v(" "),r("tbody",t._l(i.items,(function(i,a){return r("tr",{key:"gii_"+a},[r("td",{attrs:{width:"40%"}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"filter-by-label":!0,"remote-method":t.searchItems},on:{"on-change":function(r){return t.itemChanged(r,e,s,a)}},model:{value:i.id,callback:function(e){t.$set(i,"id",e)},expression:"gItem.id"}},t._l(t.result,(function(t,e){return r("Option",{key:"giioi_"+e,attrs:{value:t.id,label:t.name}})})),1)],1),t._v(" "),r("td",{attrs:{width:"40%"}},[i.variations&&i.variations.length?[r("Select",{attrs:{filterable:""},model:{value:i.variation_id,callback:function(e){t.$set(i,"variation_id",e)},expression:"gItem.variation_id"}},t._l(i.variations,(function(e,i){return r("Option",{key:"giivoi_"+i,attrs:{value:e.id,label:t.metaString(e.meta,!0)}})})),1)]:t._e()],2),t._v(" "),r("td",[r("InputNumber",{model:{value:i.quantity,callback:function(e){t.$set(i,"quantity",e)},expression:"gItem.quantity"}})],1)])})),0)])])],1)}))],2),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"input-tip smaller-label",attrs:{label:t.$t("cost")}},[r("InputNumber",{model:{value:e.cost,callback:function(r){t.$set(e,"cost",r)},expression:"portion.cost"}}),t._v(" "),r("small",{staticClass:"text-primary"},[t._v(t._s(t.$t("min_cost_error",{min:t.portionCost(e)})))])],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"input-tip smaller-label",attrs:{label:t.$t("price")}},[r("InputNumber",{model:{value:e.price,callback:function(r){t.$set(e,"price",r)},expression:"portion.price"}}),t._v(" "),r("small",{staticClass:"text-primary"},[t._v(t._s(t.$t("price_tip")))])],1)],1)],1)],1)],1)})),1),t._v(" "),r("div",{staticClass:"mb16"},[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.onSubmit("items")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.onSubmit("items",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.goToStep(0)}}},[t._v(t._s(t.$t("back")))]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"error",ghost:""},on:{click:t.onReset}},[t._v(t._s(t.$t("reset")))])],1),t._v(" "),r("Modal",{attrs:{"footer-hide":"",width:"300",title:t.$t("add_x",{x:t.$tc("portion")})},on:{"on-visible-change":t.modalChanged},model:{value:t.option,callback:function(e){t.option=e},expression:"option"}},[r("Form",{ref:"current",attrs:{model:t.current,rules:t.portionRules,"label-position":"top"},nativeOn:{submit:function(e){return e.preventDefault(),t.addPortion.apply(null,arguments)}}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name"}},[r("Input",{attrs:{placeholder:t.$t("name"),"element-id":"portion_name"},model:{value:t.current.name,callback:function(e){t.$set(t.current,"name",e)},expression:"current.name"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary",long:""},on:{click:t.addPortion}},[t._v(t._s(t.$t("add")))])],1)],1)],1),t._v(" "),r("Modal",{attrs:{"footer-hide":"",width:"300",title:t.$t("add_x",{x:t.$t("group_type")})},on:{"on-visible-change":t.modalChanged},model:{value:t.group,callback:function(e){t.group=e},expression:"group"}},[r("Form",{ref:"group",attrs:{rules:t.groupRules,"label-position":"top",model:t.choosable_group_type},nativeOn:{submit:function(e){return e.preventDefault(),t.addChoosableTypeGroup.apply(null,arguments)}}},[r("FormItem",{attrs:{label:t.$t("group_type"),prop:"name"}},[r("Input",{attrs:{placeholder:t.$t("group_type"),"element-id":"group_name"},model:{value:t.choosable_group_type.name,callback:function(e){t.$set(t.choosable_group_type,"name",e)},expression:"choosable_group_type.name"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary",long:""},on:{click:t.addChoosableTypeGroup}},[t._v(t._s(t.$t("add")))])],1)],1)],1)],1)}),[],!1,null,null,null).exports;function h(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach((function(e){v(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var g=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.images=[],delete t.photo,t.location_stock&&delete t.location_stock,t.valid_promotions&&delete t.valid_promotions,t.cost=parseFloat(t.cost),t.price=parseFloat(t.price),t.category_id=t.categories[0].id,t.sku=t.sku?t.sku:e.sku(),t.max_price=t.max_price?parseFloat(t.max_price):null,t.min_price=t.min_price?parseFloat(t.min_price):null,t.max_discount=t.max_discount?parseFloat(t.max_discount):null,t.taxes=t.taxes.map((function(t){return t.id})),t.modifiers||(t.modifiers=[]),t.modifiers=t.modifiers.map((function(t){return t.id})),(!t.portions||t.portions.length<1)&&(t.portions=[{sku:e.sku(),name:"regular",essentials:[{}],choosables:[],cost:null,price:null}]),t.portions=t.portions.map((function(t,r){return t.cost=t.cost?parseFloat(t.cost):null,t.price=t.price?parseFloat(t.price):null,t.essentials&&t.essentials.length&&(t.essentials=t.essentials.map((function(t,e){return t.item&&(t.id=t.item_id,t.sku=t.item.sku,t.name=t.item.name,t.cost=t.item.cost,t.variations=t.item.variations,t.variation=t.item.variations&&t.item.variations.length?t.item.variations.find((function(e){return e.id==t.variation_id})):null),t}))),e.errors.form.portions.push({price:null}),t})),e.attributes.filter((function(t){return"number"==t.type})).map((function(e){t.extra_attributes[e.slug]=t.extra_attributes[e.slug]?parseFloat(t.extra_attributes[e.slug]):null})),e.form=_(_({},t),t.extra_attributes),e.form};const b={components:{ComboPortionComponent:m},mixins:[(0,i.Z)("item","app/items",!0,g,"combos")],data:function(){var t=this,e=function(e,r,i){r&&parseFloat(r)<parseFloat(t.minCost)?i(new Error(t.$t("min_cost_error",{min:parseFloat(t.minCost)}))):i()},r=function(e,r,i){r&&parseFloat(r)<parseFloat(t.minCost)?i(new Error(t.$t("min_price_error",{min:parseFloat(t.minCost)}))):i()};return{step:0,taxes:[],photo:null,costV:e,modifiers:[],priceV:r,categories:[],attributes:[],new_photo:null,sloading:!1,searching:!1,minCost:null,form:{id:"",code:"",name:"",stock:{},taxes:[],cost:null,details:"",photo:null,summary:"",images:[],video:null,price:null,is_stock:0,alt_name:"",weight:null,changeable:0,modifiers:[],dimensions:"",type:"combo",has_serials:0,has_variants:0,min_price:null,max_price:null,sku:this.sku(),tax_included:"",category_id:null,supplier_id:null,max_discount:null,supplier_item_id:"",portions:[{sku:this.sku(),name:"regular",essentials:[{}],choosables:[],cost:null,price:null}]},rules:{type:[{required:!0,message:this.$t("field_is_required",{field:this.$t("type")}),trigger:"change"}],name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"},{required:!0,trigger:["blur","change"],pattern:/^([a-zA-Z0-9-_]{2,25})$/,message:this.$t("alpha_dash_error")}],category_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("category")}),trigger:"change"}],symbology:[{required:!0,message:this.$t("field_is_required",{field:this.$t("symbology")}),trigger:"change"}],taxes:[{type:"array",trigger:"change",message:this.$t("field_are_required",{field:this.$tc("tax",2)})}],combo_items:[{type:"array",required:!0,trigger:"change",message:this.$t("field_are_required",{field:this.$tc("combo_item",2)})}],portions:{type:"array",fields:{0:{type:"object",fields:{cost:[{validator:e,type:"number",trigger:["change","blur"]},{required:!0,type:"number",trigger:["change","blur"],message:this.$t("field_is_required",{field:this.$t("cost")})}],price:[{validator:r,type:"number",trigger:["change","blur"]},{required:!0,type:"number",trigger:["change","blur"],message:this.$t("field_is_required",{field:this.$t("price")})}]}}}}}}},created:function(){var t=this;this.$http.get("app/taxes/search").then((function(e){return t.taxes=e.data})),this.$http.get("app/modifiers/search").then((function(e){return t.modifiers=e.data})),this.$http.get("app/all_categories/search").then((function(e){return t.categories=t.flattenDeep(e.data)})),this.errors.form.portions=[{}]},methods:{create:function(){var t=this;this.$http.get("app/items/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/items/".concat(t)).then((function(t){return e.form=g(t.data,e)})).finally((function(){return e.loading=!1}))},goToStep:function(t,e,r){var i=this;this.sloading=!0,1==t&&e?this.$refs.item.validate((function(e){e?(i.step=parseInt(t),i.sloading=!1,window.scrollTo(0,0)):(i.sloading=!1,i.$Notice.error({title:i.$t("invalid_form"),desc:i.$t("invalid_form_error"),duration:10}))})):(window.scrollTo(0,0),this.sloading=!1,this.step=parseInt(t)),r&&this.handleReset()},handleImages:function(t){var e=new FileReader;return this.form.images.push(t),e.readAsDataURL(t),!1},deleteImage:function(t){this.form.images.splice(t,1)},handleUpload:function(t){var e=this,r=new FileReader;return r.addEventListener("load",(function(){return e.new_photo=r.result}),!1),this.form.photo=t,r.readAsDataURL(t),!1},clearPhoto:function(){this.new_photo=null,this.form.photo=null},portionsChanged:function(t){this.form.portions=t.map((function(t){return t.essentials&&t.essentials.length&&(t.essentials=t.essentials.map((function(t){return delete t.variants,delete t.variation,delete t.variations,t}))),t.choosables&&t.choosables.length&&(t.choosables=t.choosables.map((function(t){return t.items&&t.items.length&&(t.items=t.items.map((function(t){return delete t.variants,delete t.variation,delete t.variations,delete t.portion_choosable_id,t}))),t}))),t}))},onSubmit:function(t){this.submit(t.page,t.stay)},submit:function(t,e){var r=this,i="app/items",s="added";this.errors.message="";var a="record_added";this.form.id&&""!=this.form.id&&(s="updated",i="app/items/"+this.form.id,a="record_updated",this.form._method="PUT");var n=this.form.portions.find((function(t){return"regular"==t.name}));this.form.cost=n&&n.cost?n.cost:0,this.form.price=n&&n.price?n.price:0;var o=_({},this.form);if(this.attributes.length>0){var l=this.attributes.map((function(t){var e={};return delete o[t.slug],e[t.slug]=r.form[t.slug],e}));o.extra_attributes=Object.assign.apply(Object,h(l))}o=this.$form(o),this.$http.post(i,o).then((function(i){i.data.success?(r.$Notice.destroy(),r.$Notice.success({title:r.$tc("item")+" "+r.$t(s),desc:r.$t(a)}),e?("updated"==s||r.handleReset(),r.step=0):r.$router.push({name:t+".combos.list"})):r.$Notice.error({title:r.$t("failed"),desc:r.$t("failed_error_text")})})).catch((function(t){return r.errors=t})).finally((function(){return r.loading=!1}))}}};const y=(0,d.Z)(b,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("combo")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/items/combos"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("combo",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"item",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),r("div",{staticStyle:{margin:"-16px -16px 16px -16px","border-bottom":"1px solid #e8eaec",padding:"16px"}},[r("Steps",{attrs:{current:t.step,status:"wait"}},[r("Step",{attrs:{title:t.$t("general_step"),content:t.$t("general_step_text")}}),t._v(" "),r("Step",{attrs:{title:t.$t("combo_items_step"),content:t.$t("combo_items_step_text")}})],1)],1),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),0==t.step?r("div",[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}}),t._v(" "),r("small",[t._v(t._s(t.$t("item_code_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("symbology"),prop:"symbology",error:t._f("a2s")(t.errors.form.symbology)}},[r("Select",{model:{value:t.form.symbology,callback:function(e){t.$set(t.form,"symbology",e)},expression:"form.symbology"}},[r("Option",{attrs:{value:"code128"}},[t._v("Code128")]),t._v(" "),r("Option",{attrs:{value:"code39"}},[t._v("Code39")]),t._v(" "),r("Option",{attrs:{value:"ean5"}},[t._v("EAN5")]),t._v(" "),r("Option",{attrs:{value:"ean8"}},[t._v("EAN8")]),t._v(" "),r("Option",{attrs:{value:"ean13"}},[t._v("EAN13")]),t._v(" "),r("Option",{attrs:{value:"upce"}},[t._v("UPC (E)")]),t._v(" "),r("Option",{attrs:{value:"upca"}},[t._v("UPC (A)")])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("category"),prop:"category_id",error:t._f("a2s")(t.errors.form.category_id)}},[r("Select",{model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(e){return r("Option",{key:"cat_"+e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("taxes"),prop:"taxes",error:t._f("a2s")(t.errors.form.taxes)}},[r("Select",{attrs:{filterable:"",multiple:""},model:{value:t.form.taxes,callback:function(e){t.$set(t.form,"taxes",e)},expression:"form.taxes"}},t._l(t.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("sku"),prop:"sku",error:t._f("a2s")(t.errors.form.sku)}},[r("Input",{attrs:{readonly:""},model:{value:t.form.sku,callback:function(e){t.$set(t.form,"sku",e)},expression:"form.sku"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("alt_name"),prop:"alt_name",error:t._f("a2s")(t.errors.form.alt_name)}},[r("Input",{model:{value:t.form.alt_name,callback:function(e){t.$set(t.form,"alt_name",e)},expression:"form.alt_name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("hsn_number"),prop:"hsn_number",error:t._f("a2s")(t.errors.form.hsn_number)}},[r("Input",{model:{value:t.form.hsn_number,callback:function(e){t.$set(t.form,"hsn_number",e)},expression:"form.hsn_number"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{prop:"max_discount",label:t.$t("max_discount"),error:t._f("a2s")(t.errors.form.max_discount)}},[r("InputNumber",{attrs:{formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:t.form.max_discount,callback:function(e){t.$set(t.form,"max_discount",e)},expression:"form.max_discount"}}),t._v(" "),r("small",[t._v(t._s(t.$t("max_discount_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("modifier",2),prop:"modifier",error:t._f("a2s")(t.errors.form.modifier)}},[r("Select",{attrs:{clearable:"",multiple:""},model:{value:t.form.modifiers,callback:function(e){t.$set(t.form,"modifiers",e)},expression:"form.modifiers"}},t._l(t.modifiers,(function(e){return r("Option",{key:"modifier_"+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",{attrs:{label:t.$tc("photo"),prop:"photo",error:t._f("a2s")(t.errors.form.photo)}},[r("Upload",{attrs:{"before-upload":t.handleUpload,"max-size":1024,action:"",accept:".png, .jpeg, .jpg, .gif"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("select_x",{x:t.$t("photo")})))])],1),t._v(" "),t.photo||t.new_photo?r("div",{staticClass:"primary",staticStyle:{"margin-bottom":"16px"}},[t.form.photo?r("span",[r("span",{staticStyle:{margin:"10px 10px 10px 0"}},[t._v(t._s(t.$t("selected_file"))+": "+t._s(t.form.photo.name))]),t._v(" "),r("Button",{attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.clearPhoto()}}})],1):t._e(),t._v(" "),r("br"),t._v(" "),t.photo||t.new_photo?r("img",{staticStyle:{"max-width":"160px","max-height":"110px","border-radius":"4px 4px 0 0"},attrs:{alt:"photo",src:t.new_photo?t.new_photo:t.photo}}):t._e()]):t._e()],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("gallery_images"),prop:"images",error:t._f("a2s")(t.errors.form.images)}},[r("Upload",{attrs:{multiple:"","before-upload":t.handleImages,"max-size":2048,action:"",accept:".png, .jpeg, .jpg"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("\n                    "+t._s(t.$t("select_x",{x:t.$t("gallery_images")}))+"\n                  ")])],1),t._v(" "),t.form.images.length?[r("span",{staticStyle:{margin:"10px 10px 10px 0"}},[t._v(t._s(t.$t("selected_file")))]),t._v(" "),t._l(t.form.images,(function(e,i){return r("span",{key:"gallery_"+i,staticClass:"primary",staticStyle:{margin:"0 16px 16px 0"}},[t._v("\n                    "+t._s(i+1)+". "+t._s(e.name)+"\n                    "),r("Button",{attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.deleteImage(i)}}})],1)}))]:t._e()],2),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("video_url"),prop:"video",error:t._f("a2s")(t.errors.form.video)}},[r("Input",{model:{value:t.form.video,callback:function(e){t.$set(t.form,"video",e)},expression:"form.video"}}),t._v(" "),r("small",[t._v(t._s(t.$t("video_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("summary"),prop:"summary",error:t._f("a2s")(t.errors.form.summary)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.summary,callback:function(e){t.$set(t.form,"summary",e)},expression:"form.summary"}})],1),t._v(" "),r("FormItem",{staticStyle:{"margin-bottom":"16px"},attrs:{prop:"details",label:t.$t("details"),error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:12}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.sloading},on:{click:function(e){return t.goToStep(1,!0)}}},[t._v(t._s(t.$t("next")))])],1)],1):1==t.step?r("div",[r("div",{staticClass:"mb16"},[r("combo-portion-component",{attrs:{loading:t.loading,pportions:t.form.portions},on:{"on-submit":t.onSubmit,"portions-changed":t.portionsChanged,"step-changed":t.goToStep,"on-reset":function(e){return t.goToStep(0,!1,!0)}}})],1)]):t._e()],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},29615:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(7174),s=r.n(i),a=r(92704);const n={components:{ItemViewComponent:r(41944).Z,VueBarcode:s()},mixins:[(0,a.Z)("item","app/items","name","code","combos")],data:function(){var t=this;return{row:{},view:!1,barModal:!1,barcodeSVG:null,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",width:200},{title:this.$t("code"),sortable:!0,key:"code",sortType:"asc",minWidth:150},{title:this.$t("cost"),sortable:!0,key:"cost",minWidth:125,render:this.renderCost},{title:this.$t("price"),sortable:!0,key:"price",minWidth:125,render:this.renderPrice},{title:this.$t("alt_name"),sortable:!0,key:"alt_name",minWidth:175},{title:this.$tc("category"),sortable:!1,key:"categories",minWidth:175,render:this.renderCategory},{title:this.$tc("taxes"),sortable:!1,key:"taxes",minWidth:200,render:this.renderTaxes},{title:this.$tc("portion",2),sortable:!1,key:"portions",minWidth:200,render:this.renderPortion},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("changeable"),sortable:!0,key:"changeable",minWidth:120,render:this.renderChangeable},{title:this.$t("min_price"),sortable:!0,key:"min_price",minWidth:150,render:this.renderMinPrice},{title:this.$t("max_price"),sortable:!0,key:"max_price",minWidth:150,render:this.renderMaxPrice},{title:this.$t("max_discount"),sortable:!0,key:"max_discount",minWidth:150,render:this.renderMaxDiscount},{title:this.$t("summary"),sortable:!0,key:"summary",ellipsis:!0,minWidth:400},{title:this.$t("created_at"),sortable:!0,key:"created_at",minWidth:175,render:this.renderCreatedAt},{title:this.$t("updated_at"),sortable:!0,key:"updated_at",minWidth:175,render:this.renderUpdatedAt},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,editFn:t.editRecord,labelFn:t.labelModal,deleteFn:t.deleteRecord,record:{model:"item",name:"name"}}})}}],options:{orderBy:"code",perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},mounted:function(){this.$store.getters.stock||(this.columns=this.columns.filter((function(t){return"stock"!=t.key})))},methods:{showInfo:function(t){this.row=t,this.view=!0},labelModal:function(t){var e=this;this.row=t,this.barModal=!0,this.barcodeSVG=this.$store.state.settings.svg_string.replace("--- Item Name ---",this.row.name).replace("--- Other info for item. ---",this.row.alt_name).replace("--- Price: 1,000.00 ---",this.$t("price")+": "+this.formatNumber(this.row.price)),this.$nextTick((function(){document.getElementById("replace-barcode").innerHTML="",document.getElementById("replace-barcode").removeAttribute("transform");var t=document.getElementById("drawBarcode").childNodes[0].cloneNode(!0);document.getElementById("replace-barcode").setAttribute("transform","matrix(1 0 0 1 10 "+(e.$store.state.settings.label_height-60)+")"),document.getElementById("replace-barcode").appendChild(t),1==e.$store.getters.settings.print_dialog&&setTimeout((function(){window.print()}),400)}))},print:function(){window.print()},renderChangeable:function(t,e){return this.renderBoolean(t,e,"changeable")},renderPortion:function(t,e){var r=this;return t("div",[e.row.portions.map((function(t){return r.$t(t.name)})).join(", ")])},renderMinPrice:function(t,e){return this.renderNumber(t,e,"min_price")},renderMaxPrice:function(t,e){return this.renderNumber(t,e,"max_price")},renderMaxDiscount:function(t,e){return this.renderNumber(t,e,"max_discount")},renderCategory:function(t,e){return t("div",[e.row.categories.map((function(t){return t.name})).join("")])},renderCost:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.location_stock.length>0&&e.row.location_stock[0].cost?e.row.location_stock[0].cost:e.row.cost,this.$store.getters.settings.decimals)])},renderPrice:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.location_stock.length>0&&e.row.location_stock[0].price?e.row.location_stock[0].price:e.row.price,this.$store.getters.settings.decimals)])},renderStock:function(t,e){return t("div",{class:"text-center"},[e.row.location_stock.length>0?this.$options.filters.formatNumber(e.row.location_stock[0].quantity,this.$store.getters.settings.decimals):this.$options.filters.formatNumber(e.row.stock.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),this.$store.getters.settings.decimals)])},renderRack:function(t,e){return t("div",[e.row.location_stock.length>0&&e.row.location_stock[0].rack?e.row.location_stock[0].rack:e.row.location])},renderTaxMethod:function(t,e){return 1==e.row.tax_included?t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-success ivu-tag-border ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-success"},[this.$t("inclusive")])])]):t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-primary ivu-tag-border ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-primary"},[this.$t("exclusive")])])])},renderTaxes:function(t,e){return t("div",[e.row.taxes.map((function(t){return t.name})).join(", ")])}}};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("combo",2)))]),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/items?type=combo",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)]),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"500","footer-hide":!0,"mask-closable":!1,title:t.$t("print_x",{x:t.$t("barcode")})},model:{value:t.barModal,callback:function(e){t.barModal=e},expression:"barModal"}},[r("div",{staticClass:"label text-center",domProps:{innerHTML:t._s(t.barcodeSVG)}}),t._v(" "),r("div",{staticClass:"np"},[r("Divider",{attrs:{dashed:""}}),t._v(" "),r("div",{staticClass:"text-center",staticStyle:{display:"none"}},[r("vue-barcode",{attrs:{width:1,margin:0,height:30,fontSize:12,"margin-top":0,id:"drawBarcode",value:t.row.code,"margin-bottom":4,format:t.row.symbology}},[t._v("\n          "+t._s(t.$t("barcode_error"))+"\n        ")])],1),t._v(" "),r("Alert",{domProps:{innerHTML:t._s(t.$t("label_print_instructions"))}}),t._v(" "),r("Button",{staticClass:"np",attrs:{type:"primary",icon:"ios-print",long:""},on:{click:function(e){return t.print()}}},[t._v(t._s(t.$t("print")))])],1)]),t._v(" "),r("Modal",{attrs:{"footer-hide":"",scrollable:"",width:750},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[r("p",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("\n        "+t._s(t.row.name)+"\n        ("+t._s(t.row.code)+")\n      ")])]),t._v(" "),r("item-view-component",{attrs:{item:t.row}})],1)],1)}),[],!1,null,null,null).exports},37962:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>R});r(98066);var i=r(48921),s=r(23279),a=r.n(s);const n={props:{serials:{type:Array,twoWay:!0,required:!0},hasVariants:{required:!0},totalVariationsQty:{type:Number,required:!0},totalStockQty:{type:Number,required:!0}},computed:{provided:function(){var t=this;return this.serials.reduce((function(e,r){return e+t.countSerials(r.number,r.till)}),0)}},methods:{countSerials:function(t,e){if(!t&&!e)return 0;if(t&&!e)return 1;var r=e-t;return r>0?r+1:e==t?1:"?"},addNew:function(t){t==this.serials.length-1&&this.serials.push({number:"",till:""})}}};var o=r(93379),l=r.n(o),c=r(82276),u={insert:"head",singleton:!1};l()(c.Z,u);c.Z.locals;var d=r(51900);const m=(0,d.Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"serials form-responsive"},[r("CellGroup",[t._l(t.serials,(function(e,i){return r("Cell",{key:"serial_"+i},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:9,lg:9}},[r("FormItem",{staticClass:"mb0",attrs:{label:t.$tc("serial_number"),prop:"serial"}},[r("Input",{on:{"on-focus":function(e){return t.addNew(i)}},model:{value:e.number,callback:function(r){t.$set(e,"number",r)},expression:"serial.number"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:9,lg:9}},[r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("till"),prop:"serial"}},[r("Input",{model:{value:e.till,callback:function(r){t.$set(e,"till",r)},expression:"serial.till"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:6,lg:6}},[e.number||e.till&&e.number<e.till?r("span",[r("p",{staticStyle:{"line-height":"34px"}},[r("strong",[t._v(t._s(t.countSerials(e.number,e.till)))]),t._v("\n              "+t._s(t.$tc("serial_number",t.countSerials(e.number,e.till)))+"\n            ")])]):t._e()])],1)],1)})),t._v(" "),r("Cell",[r("p",[t._v("\n        "+t._s(t.$t("total_serials",{n:t.provided,serials:t.$tc("serial_number",t.provided),total:this.hasVariants?this.totalVariationsQty:this.totalStockQty}))+"\n      ")])])],2)],1)}),[],!1,null,null,null).exports;const h={props:{height:{type:String,default:"2px",required:!1},color:{type:String,required:!1,default:"linear-gradient(to right, #ec008c, #fc6767)"},background:{type:String,required:!1,default:"#eaeaea"},selector:{type:String,required:!0}},data:function(){return{width:"",elWidth:"",scrolled:""}},created:function(){var t=this;this.$nextTick((function(){document.querySelector(t.selector).addEventListener("load",t.scrollHandler),document.querySelector(t.selector).addEventListener("scroll",t.scrollHandler)}))},destroyed:function(){document.querySelector(this.selector)&&(document.querySelector(this.selector).removeEventListener("load",this.scrollHandler),document.querySelector(this.selector).removeEventListener("scroll",this.scrollHandler))},methods:{scrollHandler:function(){this.scrolled=document.querySelector(this.selector).scrollLeft,this.elWidth=document.querySelector(this.selector).scrollWidth-document.querySelector(this.selector).clientWidth,this.width=this.scrolled/this.elWidth*100+"%"}}};var p=r(70273),f={insert:"head",singleton:!1};l()(p.Z,f);p.Z.locals;function _(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_(Object(r),!0).forEach((function(e){g(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}const x={components:{HScrollIndicatorComponent:(0,d.Z)(h,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"scroll--indicator-wrapper",style:{height:t.height,background:t.background}},[r("div",{staticClass:"scroll--indicator",style:{background:t.color,width:t.width}})])}),[],!1,null,"98931c06",null).exports},props:{ivariants:{type:Array,required:!0},ivariations:{type:Array,required:!0},hasVariants:{required:!0}},data:function(){var t=this;return{option:!1,variants:[],variations:[],has_variants:0,current:{name:"",options:""},variantsColumns:[{key:"sku",slot:"sku",width:150,sortable:!1,title:this.$t("sku")},{key:"code",slot:"code",minWidth:150,sortable:!1,title:this.$t("code")},{width:125,key:"cost",slot:"cost",sortable:!1,title:this.$t("cost")},{width:125,key:"price",slot:"price",sortable:!1,title:this.$t("price")},{width:125,key:"rack",slot:"rack",sortable:!1,title:this.$t("rack")},{width:125,key:"weight",slot:"weight",sortable:!1,title:this.$t("weight")},{width:150,key:"dimensions",slot:"dimensions",sortable:!1,title:this.$t("dimensions")},{width:50,key:"del",slot:"del",title:" ",align:"center",sortable:!1}],variantRules:{name:[{validator:function(e,r,i){t.variants.find((function(t){return t.name==r}))?i(new Error(t.$t("variant_exists"))):i()},trigger:"blur"},{required:!0,message:this.$t("field_is_required",{field:this.$t("variant_name")}),trigger:"blur"}]}}},created:function(){var t=this;this.has_variants=this.hasVariants,this.variants=b(this.ivariants),this.variations=b(this.ivariations),this.$store.getters.stock&&this.variantsColumns.splice(4,0,{width:125,key:"quantity",slot:"quantity",sortable:!1,title:this.$t("quantity")}),this.$nextTick((function(){t.variants.length>0&&t.variants.map((function(e){t.variantsColumns.splice(t.variantsColumns.length-1,0,{minWidth:150,sortable:!1,key:e.name,slot:e.name,title:e.name})}))}))},methods:{modalChanged:function(t){t?window&&this.$nextTick((function(){document.querySelector("#variant_name").focus()})):this.$refs.current.resetFields()},hasVariantChanged:function(t){this.$emit("has-variants-changed",t)},goToStep:function(t){2==t&&(this.$emit("variants-changed",b(this.variants)),this.$emit("variations-changed",b(this.variations))),this.$emit("step-changed",t)},addVariantOption:function(){var t=this;this.$refs.current.validate((function(e){if(e){var r=v({},t.current);if(r.name){t.variantsColumns.splice(t.variantsColumns.length-1,0,{minWidth:150,sortable:!1,key:r.name,slot:r.name,title:r.name}),r.options&&(r.options=r.options.split("|"));var i=b(t.variations);r.options&&r.options.length>0?r.options.map((function(e,s){if(s){var a={sku:t.sku(!0),code:"",cost:null,price:null,quantity:null,weight:null,dimensions:"",del:null,meta:[]};a.meta[r.name]=e,i.push(a)}else i=i.map((function(t){return t.meta[r.name]=e,t}))})):i=i.map((function(t){return t.meta[r.name]="",t})),t.variations=b(i),t.variants=[].concat(b(t.variants),[r]),t.option=!1,setTimeout((function(){t.current.name="",t.current.options="",t.$refs.current.resetFields()}),50)}}else t.$Notice.error({title:t.$t("invalid_variant"),desc:t.$t("invalid_variant_error"),duration:10})}))},doAllVariations:function(){var t=this;this.variants.length>1?this.$Modal.confirm({title:this.$t("generate_variations"),content:this.$t("generate_variations_text"),onOk:function(){var e=[],r=[];t.variants.map((function(t){var r={};r[t.name]=t.options,e.push(r)})),t.variants.map((function(i){e.map((function(s){s[i.name]&&s[i.name].length>0&&s[i.name].map((function(s){t.variants.map((function(a){e.map((function(e){e[a.name]&&e[a.name].length>0&&e[a.name].map((function(e){if(a.name!=i.name&&s!=e&&!r.find((function(t){return t.meta[i.name]==s&&t.meta[a.name]==e}))){var n={sku:t.sku(!0),code:"",cost:null,price:null,quantity:null,weight:null,dimensions:"",del:null,meta:[]};n.meta[i.name]=s,n.meta[a.name]=e,r.push(n)}}))}))}))}))}))})),t.variations=[].concat(r)}}):this.$Modal.info({title:this.$t("invalid_variants"),content:this.$t("invalid_variants_error")})},addVariantRow:function(){var t={sku:this.sku(),code:"",cost:null,price:null,quantity:null,weight:null,dimensions:"",del:null,meta:[]};t.stock=this.$store.getters.locations.map((function(t){return v(v({},t),{},{location_id:t.value,price:null,cost:null,quantity:null,rack:""})})),this.variants.map((function(e){return t[e.name]=""})),this.variations.splice(this.variations.length,0,t)},removeVariant:function(t){this.variations.splice(t,1)},colStyle:function(t){var e={};return t.width&&(e.width=t.width+"px",e.minWidth=t.width+"px"),t.minWidth&&(e.minWidth=t.minWidth+"px"),t.maxWidth&&(e.maxWidth=t.maxWidth+"px"),e}}};const $=(0,d.Z)(x,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"mb16"},[r("Checkbox",{attrs:{label:"price_variants","true-value":1,"false-value":0},on:{"on-change":t.hasVariantChanged},model:{value:t.has_variants,callback:function(e){t.has_variants=e},expression:"has_variants"}},[t._v("\n      "+t._s(t.$t("item_has_variants"))+"\n    ")])],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[1==t.has_variants?r("div",{staticStyle:{"margin-top":"16px"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24}},[r("Card",{staticStyle:{"margin-bottom":"16px","line-height":"1em"},attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("variant")))]),t._v(" "),r("ButtonGroup",{attrs:{slot:"extra",size:"small"},slot:"extra"},[r("Button",{attrs:{size:"small",type:"success"},on:{click:function(e){t.option=!0}}},[r("Icon",{attrs:{type:"ios-options"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("add_x",{x:t.$tc("option")})))])],1),t._v(" "),r("Button",{attrs:{size:"small",type:"warning"},on:{click:t.doAllVariations}},[r("Icon",{attrs:{type:"ios-shuffle"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("generate")))])],1),t._v(" "),r("Button",{attrs:{size:"small",type:"primary"},on:{click:t.addVariantRow}},[r("Icon",{attrs:{type:"ios-list-box-outline"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("add_x",{x:t.$t("row")})))])],1)],1),t._v(" "),r("div",{staticClass:"variants-form"},[r("h-scroll-indicator-component",{attrs:{height:"1px",color:"#2b85e4",background:"#ffffff",selector:".variant-table"}}),t._v(" "),r("div",{staticClass:"table-responsive variant-table"},[r("table",{staticClass:"table"},[r("thead",[r("tr",t._l(t.variantsColumns,(function(e,i){return r("th",{key:"col_"+i,style:t.colStyle(e)},["del"==e.key?r("span",[r("Icon",{attrs:{size:"16",type:"md-trash"}})],1):r("span",[t._v(t._s(e.title))])])})),0)]),t._v(" "),r("tbody",t._l(t.variations,(function(e,i){return r("tr",{key:"variation_"+i},[r("td",[r("Input",{attrs:{readonly:""},model:{value:e.sku,callback:function(r){t.$set(e,"sku",r)},expression:"variation.sku"}})],1),t._v(" "),r("td",[r("Input",{model:{value:e.code,callback:function(r){t.$set(e,"code",r)},expression:"variation.code"}})],1),t._v(" "),r("td",[r("InputNumber",{model:{value:e.cost,callback:function(r){t.$set(e,"cost",r)},expression:"variation.cost"}})],1),t._v(" "),r("td",[r("InputNumber",{model:{value:e.price,callback:function(r){t.$set(e,"price",r)},expression:"variation.price"}})],1),t._v(" "),t.$store.getters.stock?r("td",[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"variation.quantity"}})],1):t._e(),t._v(" "),r("td",[r("Input",{model:{value:e.rack,callback:function(r){t.$set(e,"rack",r)},expression:"variation.rack"}})],1),t._v(" "),r("td",[r("InputNumber",{model:{value:e.weight,callback:function(r){t.$set(e,"weight",r)},expression:"variation.weight"}})],1),t._v(" "),r("td",[r("Input",{attrs:{placeholder:t.$t("dimensions_tip")},model:{value:e.dimensions,callback:function(r){t.$set(e,"dimensions",r)},expression:"variation.dimensions"}})],1),t._v(" "),t.variations.length?t._l(t.variants,(function(i,s){return r("td",{key:"option"+s},[i.options?r("span",[r("Select",{model:{value:e.meta[i.name],callback:function(r){t.$set(e.meta,i.name,r)},expression:"variation.meta[va.name]"}},t._l(i.options,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1):r("span",[r("Input",{model:{value:e[i.name],callback:function(r){t.$set(e,i.name,r)},expression:"variation[va.name]"}})],1)])})):t._e(),t._v(" "),r("td",{staticClass:"text-center"},[r("Icon",{staticClass:"pointer",attrs:{size:"16",color:"#ed3f14",type:"md-trash"},on:{click:function(e){return t.removeVariant(i)}}})],1)],2)})),0)])])],1)],1)],1)],1)],1):t._e()]),t._v(" "),r("div",[r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.goToStep(2)}}},[t._v(t._s(t.$t("next")))]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"warning"},on:{click:function(e){return t.goToStep(0)}}},[t._v(t._s(t.$t("back")))])],1),t._v(" "),r("Modal",{attrs:{"footer-hide":"",width:"300",title:t.$t("add_x",{x:t.$tc("variant")})},on:{"on-visible-change":t.modalChanged},model:{value:t.option,callback:function(e){t.option=e},expression:"option"}},[r("Form",{ref:"current",attrs:{model:t.current,rules:t.variantRules,"label-position":"top"}},[r("FormItem",{attrs:{label:t.$tc("variant_name"),prop:"name"}},[r("Input",{attrs:{placeholder:t.$t("variant_name_tip"),"element-id":"variant_name"},model:{value:t.current.name,callback:function(e){t.$set(t.current,"name",e)},expression:"current.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("variant_options"),prop:"options"}},[r("Input",{attrs:{placeholder:t.$t("variant_options_tip")},model:{value:t.current.options,callback:function(e){t.$set(t.current,"options",e)},expression:"current.options"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary",long:""},on:{click:t.addVariantOption}},[t._v(t._s(t.$t("add")))])],1)],1)],1)],1)}),[],!1,null,null,null).exports;function w(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function C(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?w(Object(r),!0).forEach((function(e){k(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function k(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function S(t){return function(t){if(Array.isArray(t))return O(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return O(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return O(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}const I={props:{istock:{type:Array,required:!0},isStock:{type:Number,required:!0},variants:{type:Array,required:!0},ivariations:{type:Array,required:!0},hasVariants:{required:!0}},data:function(){return{stock:[],option:!1,variations:[],is_stock:!1,current:{name:"",options:""},variantsColumns:[{key:"sku",slot:"sku",width:150,sortable:!1,title:this.$t("sku")},{minWidth:125,key:"cost",slot:"cost",sortable:!1,title:this.$t("cost")},{minWidth:125,key:"price",slot:"price",sortable:!1,title:this.$t("price")},{minWidth:125,key:"rack",slot:"rack",sortable:!1,title:this.$t("rack")}]}},created:function(){var t=this;this.is_stock=this.isStock,this.stock=JSON.parse(JSON.stringify(this.istock)),this.variations=S(this.ivariations),this.variations=this.variations.map((function(e){return e.stock||(e.stock=t.$store.getters.locations.map((function(t){return C(C({},t),{},{location_id:t.value,price:null,cost:null,quantity:null,rack:""})}))),e})),this.$store.getters.stock&&this.variantsColumns.splice(3,0,{minWidth:125,key:"quantity",slot:"quantity",sortable:!1,title:this.$t("quantity")}),this.$nextTick((function(){t.variants.length>0&&t.variants.map((function(e){t.variantsColumns.splice(t.variantsColumns.length,0,{minWidth:150,sortable:!1,key:e.name,slot:e.name,title:e.name})}))}))},methods:{isStockChanged:function(t){this.$emit("is-stock-changed",t)},goToStep:function(t){var e=this;this.is_stock&&3==t&&1==this.hasVariants?this.variations.reduce((function(t,e){return t+e.quantity}),0)==this.variations.reduce((function(t,e){return t+e.stock.reduce((function(t,e){return t+e.quantity}),0)}),0)?(this.$emit("variations-changed",S(this.variations)),this.$emit("step-changed",t)):this.$Modal.confirm({title:this.$t("variations_qty_error"),content:this.$t("variations_qty_error_text"),okText:this.$t("auto_adjust"),onOk:function(){e.autoAdjustQty(),e.$emit("variations-changed",S(e.variations)),e.$emit("step-changed",t)}}):(this.$emit("stock-changed",S(this.stock)),this.$emit("step-changed",t))},autoAdjustQty:function(){this.variations=this.variations.map((function(t){return t.quantity=t.stock.reduce((function(t,e){return t+e.quantity}),0),t}))},colStyle:function(t){var e={};return t.width&&(e.width=t.width+"px",e.minWidth=t.width+"px"),t.minWidth&&(e.minWidth=t.minWidth+"px"),t.maxWidth&&(e.maxWidth=t.maxWidth+"px"),e}}};const F=(0,d.Z)(I,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{},[r("div",{staticClass:"mb16"},[r("Checkbox",{attrs:{label:"different_price","true-value":1,"false-value":0},on:{"on-change":t.isStockChanged},model:{value:t.is_stock,callback:function(e){t.is_stock=e},expression:"is_stock"}},[t._v("\n      "+t._s(t.$t("set_different_text",{values:t.$store.getters.stock?t.$t("rack")+", "+t.$t("quantity")+" & "+t.$t("price"):t.$t("rack")+" & "+t.$t("price")}))+"\n    ")])],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[t.is_stock?r("div",{staticStyle:{"margin-top":"16px","margin-bottom":"16px"}},[1==t.hasVariants?r("span",t._l(t.$store.getters.locations,(function(e,i){return r("div",{key:e.value},[r("h4",{staticStyle:{margin:"8px 0"}},[t._v("#"+t._s(i+1)+" "+t._s(e.label))]),t._v(" "),r("div",{staticClass:"variant-table"},[r("table",{staticClass:"table"},[r("thead",[r("tr",t._l(t.variantsColumns,(function(e,i){return r("th",{key:"col_"+i,style:t.colStyle(e)},[t._v("\n                    "+t._s(e.title)+"\n                  ")])})),0)]),t._v(" "),r("tbody",t._l(t.variations,(function(e,s){return r("tr",{key:"variation_"+s},[r("td",[r("Input",{attrs:{readonly:""},model:{value:e.sku,callback:function(r){t.$set(e,"sku",r)},expression:"variation.sku"}})],1),t._v(" "),r("td",[r("InputNumber",{model:{value:e.stock[i].cost,callback:function(r){t.$set(e.stock[i],"cost",r)},expression:"variation.stock[li].cost"}})],1),t._v(" "),r("td",[r("InputNumber",{model:{value:e.stock[i].price,callback:function(r){t.$set(e.stock[i],"price",r)},expression:"variation.stock[li].price"}})],1),t._v(" "),t.$store.getters.stock?r("td",[r("InputNumber",{model:{value:e.stock[i].quantity,callback:function(r){t.$set(e.stock[i],"quantity",r)},expression:"variation.stock[li].quantity"}})],1):t._e(),t._v(" "),r("td",[r("Input",{model:{value:e.stock[i].rack,callback:function(r){t.$set(e.stock[i],"rack",r)},expression:"variation.stock[li].rack"}})],1),t._v(" "),t.variants.length?t._l(t.variants,(function(i,s){return r("td",{key:"option"+s},[i.options?r("span",[r("Input",{attrs:{readonly:""},model:{value:e.meta[i.name],callback:function(r){t.$set(e.meta,i.name,r)},expression:"variation.meta[va.name]"}})],1):r("span",[r("Input",{attrs:{readonly:""},model:{value:e[i.name],callback:function(r){t.$set(e,i.name,r)},expression:"variation[va.name]"}})],1)])})):t._e()],2)})),0)])])])})),0):r("span",[t.isStock?r("Row",{attrs:{gutter:16}},t._l(t.$store.getters.locations,(function(e,i){return r("Col",{key:e.value,attrs:{sm:24,md:12,lg:12}},[r("Card",{staticStyle:{"margin-bottom":"16px"},attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.label))]),t._v(" "),r("div",{staticClass:"ivu-form-label-top ivu-form-inline"},[t.$store.getters.stock?[r("FormItem",{attrs:{label:t.$t("quantity"),prop:"stock"}},[r("InputNumber",{model:{value:t.stock[i].quantity,callback:function(e){t.$set(t.stock[i],"quantity",e)},expression:"stock[index].quantity"}})],1)]:t._e(),t._v(" "),r("FormItem",{attrs:{label:t.$t("cost"),prop:"lcost"}},[r("InputNumber",{model:{value:t.stock[i].cost,callback:function(e){t.$set(t.stock[i],"cost",e)},expression:"stock[index].cost"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("price"),prop:"lprice"}},[r("InputNumber",{model:{value:t.stock[i].price,callback:function(e){t.$set(t.stock[i],"price",e)},expression:"stock[index].price"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("rack_location"),prop:"lrack"}},[r("Input",{model:{value:t.stock[i].rack,callback:function(e){t.$set(t.stock[i],"rack",e)},expression:"stock[index].rack"}})],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[t.stock[i].units&&t.stock[i].units.length?r("div",t._l(t.stock[i].units,(function(e,s){return r("Card",{key:"loc_unit_"+e.id,attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name)+" ("+t._s(e.code)+")")]),t._v(" "),r("FormItem",{attrs:{label:t.$t("cost")}},[r("InputNumber",{model:{value:t.stock[i].units[s].cost,callback:function(e){t.$set(t.stock[i].units[s],"cost",e)},expression:"stock[index].units[ui].cost"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("price")}},[r("InputNumber",{model:{value:t.stock[i].units[s].price,callback:function(e){t.$set(t.stock[i].units[s],"price",e)},expression:"stock[index].units[ui].price"}})],1)],1)})),1):t._e()])],2)])],1)})),1):t._e()],1)]):t._e()]),t._v(" "),r("div",[r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.goToStep(3)}}},[t._v(t._s(t.$t("next")))]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"warning"},on:{click:function(e){return t.goToStep(1)}}},[t._v(t._s(t.$t("back")))])],1)],1)}),[],!1,null,null,null).exports;function T(t){return function(t){if(Array.isArray(t))return P(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return P(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function j(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function A(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?j(Object(r),!0).forEach((function(e){D(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function D(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var q=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.images=[],delete t.photo,t.location_stock&&delete t.location_stock,t.valid_promotions&&delete t.valid_promotions,t.cost=parseFloat(t.cost),t.price=parseFloat(t.price),t.category_id=t.categories[0].id,t.sku=t.sku?t.sku:e.sku(),t.hide_in_pos=1==t.hide_in_pos?1:0,t.hide_in_shop=1==t.hide_in_shop?1:0,t.max_price=t.max_price?parseFloat(t.max_price):null,t.min_price=t.min_price?parseFloat(t.min_price):null,t.max_discount=t.max_discount?parseFloat(t.max_discount):null,t.taxes=t.taxes.map((function(t){return t.id})),t.stock=t.stock.map((function(t){return{rack:t.rack,location_id:t.location_id,cost:t.cost?parseFloat(t.cost):null,price:t.price?parseFloat(t.price):null,quantity:t.quantity?parseFloat(t.quantity):null}})),t.serials||(t.serials=[{number:"",till:""}]),t.modifiers||(t.modifiers=[]),t.variants||(t.variants=[]),(!t.variations||t.variations.length<1)&&(t.variations=[{sku:e.sku(),code:"",cost:null,price:null,quantity:null,weight:null,dimensions:"",del:null,meta:[]}]),t.modifiers=t.modifiers.map((function(t){return t.id})),t.variations=t.variations.map((function(t){return t.cost=t.cost?parseFloat(t.cost):null,t.price=t.price?parseFloat(t.price):null,t.weight=t.weight?parseFloat(t.weight):null,t.quantity=t.quantity?parseFloat(t.quantity):null,t.stock?t.stock=t.stock.map((function(t){return t.cost=t.cost?parseFloat(t.cost):null,t.price=t.price?parseFloat(t.price):null,t.quantity=t.quantity?parseFloat(t.quantity):null,t})):t.stock=e.$store.getters.locations.map((function(t){return A(A({},t),{},{location_id:t.value,price:null,cost:null,quantity:null,rack:""})})),t})),t.stock=e.$store.getters.locations.map((function(e){return t.unit&&t.unit.subunits.length&&(t.unit.subunits=t.unit.subunits.map((function(t){return t.price||(t.price=null),t.cost||(t.cost=null),t}))),A(A({},e),{},{rack:"",cost:null,price:null,quantity:null,location_id:e.value,units:t.unit&&t.unit.subunits.length?t.unit.subunits:null})})),t.variations=t.variations.map((function(t){return t.stock=e.$store.getters.locations.map((function(t){return A(A({},t),{},{location_id:t.value,price:null,cost:null,quantity:null,rack:""})})),t})),e.form=A(A({},t),t.extra_attributes),e.form};const E={components:{ItemSerialComponent:m,ItemVariationComponent:$,ItemLocationDataComponent:F},mixins:[(0,i.Z)("item","app/items",!0,q)],data:function(){return{step:0,taxes:[],photo:null,units:[],brands:[],modifiers:[],suppliers:[],categories:[],attributes:[],new_photo:null,sloading:!1,searching:!1,form:{id:"",code:"",name:"",stock:[],expiry:0,taxes:[],cost:null,images:[],details:"",unit_id:"",brand_id:"",photo:null,video:null,summary:"",price:null,is_stock:0,alt_name:"",weight:null,changeable:0,dimensions:"",has_serials:0,has_variants:0,min_price:null,max_price:null,type:"standard",tax_included:"",sale_unit_id:"",sale_unit_price:"",category_id:null,supplier_id:null,max_discount:null,purchase_unit_id:"",purchase_unit_price:"",supplier_item_id:"",sku:this.sku(),variations:[{sku:this.sku(),code:"",cost:null,price:null,quantity:null,weight:null,dimensions:"",del:null,meta:[]}],serials:[{number:"",till:""}],variants:[],modifiers:[]},rules:{type:[{required:!0,message:this.$t("field_is_required",{field:this.$t("type")}),trigger:"change"}],name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"},{required:!0,pattern:/^([a-zA-Z0-9-_]{2,25})$/,message:this.$t("alpha_dash_error"),trigger:["blur","change"]}],cost:[{required:!0,type:"number",trigger:["change","blur"],message:this.$t("field_is_required",{field:this.$t("cost")})}],price:[{required:!0,type:"number",trigger:["change","blur"],message:this.$t("field_is_required",{field:this.$t("price")})}],category_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("category")}),trigger:"change"}],symbology:[{required:!0,message:this.$t("field_is_required",{field:this.$t("symbology")}),trigger:"change"}],taxes:[{type:"array",trigger:"change",message:this.$t("field_are_required",{field:this.$tc("tax",2)})}]}}},computed:{totalVariationsQty:function(){return this.form.variations.reduce((function(t,e){return t+e.quantity}),0)},totalStockQty:function(){return this.form.stock.reduce((function(t,e){return t+e.quantity}),0)},isQtyOk:function(){return this.totalVariationsQty==this.totalStockQty}},created:function(){var t=this;this.$http.get("app/taxes/search").then((function(e){return t.taxes=e.data})),this.$http.get("app/units/search").then((function(e){return t.units=e.data})),this.$http.get("app/brands/search").then((function(e){return t.brands=e.data})),this.$http.get("app/modifiers/search").then((function(e){return t.modifiers=e.data})),this.$http.get("app/all_categories/search").then((function(e){return t.categories=t.flattenDeep(e.data)})),this.form.stock=this.$store.getters.locations.map((function(e){return A(A({},e),{},{rack:"",cost:null,price:null,quantity:null,location_id:e.value,units:t.form.unit&&t.form.unit.subunits.length?t.form.unit.subunits:null})}))},methods:{create:function(){var t=this;this.$http.get("app/items/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/items/".concat(t)).then((function(t){return e.form=q(t.data,e)})).finally((function(){return e.loading=!1}))},setHasVariants:function(t){this.form.has_variants=t},setIsStock:function(t){this.form.is_stock=t},setStock:function(t){this.form.stock=t},setVariants:function(t){this.form.variants=t},setVariations:function(t){this.form.variations=t},goToStep:function(t,e){var r=this;this.sloading=!0,1==t&&e?this.$refs.item.validate((function(e){e?(r.step=parseInt(t),r.sloading=!1,window.scrollTo(0,0)):(r.sloading=!1,r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10}))})):(window.scrollTo(0,0),this.sloading=!1,this.step=parseInt(t))},unitChanged:function(t){var e=this;t?(this.loading=!0,this.$http.get("app/units/"+t).then((function(t){e.form.unit=t.data,e.form.unit.subunits=e.form.unit.subunits.map((function(t){return t.price||(t.price=null),t.cost||(t.cost=null),t})),e.form.stock=e.form.stock.map((function(t){return t.units=e.form.unit.subunits.length?e.form.unit.subunits.map((function(t){return{id:t.id,cost:null,price:null}})):null,t}))})).finally((function(){return e.loading=!1}))):(this.form.unit=null,this.form.stock=this.form.stock.map((function(t){return t.units=null,t})))},handleImages:function(t){var e=new FileReader;return this.form.images.push(t),e.readAsDataURL(t),!1},deleteImage:function(t){this.form.images.splice(t,1)},handleUpload:function(t){var e=this,r=new FileReader;return r.addEventListener("load",(function(){return e.new_photo=r.result}),!1),this.form.photo=t,r.readAsDataURL(t),!1},clearPhoto:function(){this.new_photo=null,this.form.photo=null},searchSuppliers:function(t){""===t||this.suppliers.find((function(e){return e.label==t}))||this.getSuppliers(t,this)},getSuppliers:a()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/suppliers/search?q="+t).then((function(t){return e.suppliers=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),submit:function(t,e){var r=this,i="app/items",s="added";this.errors.message="";var a="record_added";this.form.id&&""!=this.form.id&&(s="updated",i="app/items/"+this.form.id,a="record_updated",this.form._method="PUT");var n=A({},this.form);if(this.attributes.length>0){var o=this.attributes.map((function(t){var e={};return delete n[t.slug],e[t.slug]=r.form[t.slug],e}));n.extra_attributes=Object.assign.apply(Object,T(o))}n=this.$form(n),this.$http.post(i,n).then((function(i){i.data.success?(r.$Notice.destroy(),r.$Notice.success({title:r.$tc("item")+" "+r.$t(s),desc:r.$t(a)}),e?("updated"==s||r.handleReset(),r.step=0):r.$router.push({name:t+".list"})):r.$Notice.error({title:r.$t("failed"),desc:r.$t("failed_error_text")})})).catch((function(t){return r.errors=t})).finally((function(){return r.loading=!1}))}}};const R=(0,d.Z)(E,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("item")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/items"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("item",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"item",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),r("div",{staticClass:"hidden-sm",staticStyle:{margin:"-16px -16px 16px -16px","border-bottom":"1px solid #e8eaec",padding:"16px"}},[r("Steps",{attrs:{current:t.step,status:"wait"}},[r("Step",{attrs:{title:t.$t("general_step"),content:t.$t("general_step_text")}}),t._v(" "),r("Step",{attrs:{title:t.$t("variants_step"),content:t.$t("variants_step_text")}}),t._v(" "),r("Step",{attrs:{title:t.$t("location_step"),content:t.$t("location_step_text")}}),t._v(" "),r("Step",{attrs:{title:t.$t("serials_step"),content:t.$t("serials_step_text")}})],1)],1),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),0==t.step?r("div",[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("sku"),prop:"sku",error:t._f("a2s")(t.errors.form.sku)}},[r("Input",{attrs:{readonly:""},model:{value:t.form.sku,callback:function(e){t.$set(t.form,"sku",e)},expression:"form.sku"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("alt_name"),prop:"alt_name",error:t._f("a2s")(t.errors.form.alt_name)}},[r("Input",{model:{value:t.form.alt_name,callback:function(e){t.$set(t.form,"alt_name",e)},expression:"form.alt_name"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}}),t._v(" "),r("small",[t._v(t._s(t.$t("item_code_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("symbology"),prop:"symbology",error:t._f("a2s")(t.errors.form.symbology)}},[r("Select",{model:{value:t.form.symbology,callback:function(e){t.$set(t.form,"symbology",e)},expression:"form.symbology"}},[r("Option",{attrs:{value:"code128"}},[t._v("Code128")]),t._v(" "),r("Option",{attrs:{value:"code39"}},[t._v("Code39")]),t._v(" "),r("Option",{attrs:{value:"ean5"}},[t._v("EAN5")]),t._v(" "),r("Option",{attrs:{value:"ean8"}},[t._v("EAN8")]),t._v(" "),r("Option",{attrs:{value:"ean13"}},[t._v("EAN13")]),t._v(" "),r("Option",{attrs:{value:"upce"}},[t._v("UPC (E)")]),t._v(" "),r("Option",{attrs:{value:"upca"}},[t._v("UPC (A)")])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("category"),prop:"category_id",error:t._f("a2s")(t.errors.form.category_id)}},[r("Select",{model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(e){return r("Option",{key:e.value,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("cost"),prop:"cost",error:t._f("a2s")(t.errors.form.cost)}},[r("InputNumber",{model:{value:t.form.cost,callback:function(e){t.$set(t.form,"cost",e)},expression:"form.cost"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("price"),prop:"price",error:t._f("a2s")(t.errors.form.price)}},[r("InputNumber",{model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("tax",2),prop:"taxes",error:t._f("a2s")(t.errors.form.taxes)}},[r("Select",{attrs:{multiple:""},model:{value:t.form.taxes,callback:function(e){t.$set(t.form,"taxes",e)},expression:"form.taxes"}},t._l(t.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("brand"),prop:"brand",error:t._f("a2s")(t.errors.form.brand)}},[r("Select",{attrs:{clearable:""},model:{value:t.form.brand_id,callback:function(e){t.$set(t.form,"brand_id",e)},expression:"form.brand_id"}},t._l(t.brands,(function(e){return r("Option",{key:"brand_"+e.id,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("modifier",2),prop:"modifier",error:t._f("a2s")(t.errors.form.modifier)}},[r("Select",{attrs:{clearable:"",multiple:""},model:{value:t.form.modifiers,callback:function(e){t.$set(t.form,"modifiers",e)},expression:"form.modifiers"}},t._l(t.modifiers,(function(e){return r("Option",{key:"modifier_"+e.value,attrs:{value:e.value}},[t._v("\n                        "+t._s(e.label)+"\n                      ")])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("hsn_number"),prop:"hsn_number",error:t._f("a2s")(t.errors.form.hsn_number)}},[r("Input",{model:{value:t.form.hsn_number,callback:function(e){t.$set(t.form,"hsn_number",e)},expression:"form.hsn_number"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("weight"),prop:"weight",error:t._f("a2s")(t.errors.form.weight)}},[r("InputNumber",{model:{value:t.form.weight,callback:function(e){t.$set(t.form,"weight",e)},expression:"form.weight"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("dimensions"),prop:"dimensions",error:t._f("a2s")(t.errors.form.dimensions)}},[r("Input",{attrs:{placeholder:t.$t("dimensions_tip")},model:{value:t.form.dimensions,callback:function(e){t.$set(t.form,"dimensions",e)},expression:"form.dimensions"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("rack_location"),prop:"location",error:t._f("a2s")(t.errors.form.rack)}},[r("Input",{model:{value:t.form.rack,callback:function(e){t.$set(t.form,"rack",e)},expression:"form.rack"}}),t._v(" "),r("small",[t._v(t._s(t.$t("rack_location_tip")))])],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{prop:"max_discount",label:t.$t("max_discount"),error:t._f("a2s")(t.errors.form.max_discount)}},[r("InputNumber",{attrs:{formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:t.form.max_discount,callback:function(e){t.$set(t.form,"max_discount",e)},expression:"form.max_discount"}}),t._v(" "),r("small",[t._v(t._s(t.$t("max_discount_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("supplier"),prop:"supplier_id",error:t._f("a2s")(t.errors.form.supplier_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchSuppliers,placeholder:t.$t("type_to_search_x",{x:t.$tc("supplier")})},model:{value:t.form.supplier_id,callback:function(e){t.$set(t.form,"supplier_id",e)},expression:"form.supplier_id"}},t._l(t.suppliers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),t.form.supplier_id?r("FormItem",{attrs:{prop:"supplier_item_id",label:t.$t("supplier_item_id"),error:t._f("a2s")(t.errors.form.supplier_item_id)}},[r("Input",{model:{value:t.form.supplier_item_id,callback:function(e){t.$set(t.form,"supplier_item_id",e)},expression:"form.supplier_item_id"}})],1):t._e()],1)],1),t._v(" "),r("Row",[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{attrs:{label:t.$tc("unit"),prop:"unit",error:t._f("a2s")(t.errors.form.unit)}},[r("Select",{attrs:{clearable:""},on:{"on-change":t.unitChanged},model:{value:t.form.unit_id,callback:function(e){t.$set(t.form,"unit_id",e)},expression:"form.unit_id"}},t._l(t.units,(function(e){return r("Option",{key:"unit_"+e.id,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])})),1)],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[t.form.unit&&t.form.unit.subunits.length?r("div",[r("Row",[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("sale_unit"),prop:"unit",error:t._f("a2s")(t.errors.form.unit)}},[r("Select",{attrs:{clearable:""},model:{value:t.form.sale_unit_id,callback:function(e){t.$set(t.form,"sale_unit_id",e)},expression:"form.sale_unit_id"}},t._l(t.form.unit.subunits,(function(e,i){return r("Option",{key:"sunit_"+i,attrs:{value:e.id}},[t._v("\n                                "+t._s(e.name)+"\n                              ")])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("purchase_unit"),prop:"unit",error:t._f("a2s")(t.errors.form.unit)}},[r("Select",{attrs:{clearable:""},model:{value:t.form.purchase_unit_id,callback:function(e){t.$set(t.form,"purchase_unit_id",e)},expression:"form.purchase_unit_id"}},t._l(t.form.unit.subunits,(function(e,i){return r("Option",{key:"punit_"+i,attrs:{value:e.id}},[t._v("\n                                "+t._s(e.name)+"\n                              ")])})),1)],1)],1)],1),t._v(" "),r("FormItem",{attrs:{label:""}},t._l(t.form.unit.subunits,(function(e,i){return r("Card",{key:"unit_"+e.id,attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name)+" ("+t._s(e.code)+")")]),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("span",[t._v(t._s(t.$t("cost")))]),t._v(" "),r("InputNumber",{model:{value:t.form.unit.subunits[i].cost,callback:function(e){t.$set(t.form.unit.subunits[i],"cost",e)},expression:"form.unit.subunits[ui].cost"}})],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("span",[t._v(t._s(t.$t("price")))]),t._v(" "),r("InputNumber",{model:{value:t.form.unit.subunits[i].price,callback:function(e){t.$set(t.form.unit.subunits[i],"price",e)},expression:"form.unit.subunits[ui].price"}})],1)],1)],1)})),1)],1):t._e()])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Checkbox",{attrs:{label:"tax_included","true-value":1,"false-value":0},model:{value:t.form.tax_included,callback:function(e){t.$set(t.form,"tax_included",e)},expression:"form.tax_included"}},[t._v("\n                  "+t._s(t.$t("tax_inclusive"))+"\n                ")])],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Checkbox",{attrs:{label:"price_changeable","true-value":1,"false-value":0},model:{value:t.form.changeable,callback:function(e){t.$set(t.form,"changeable",e)},expression:"form.changeable"}},[t._v("\n                  "+t._s(t.$t("allow_price_change"))+"\n                ")])],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.expiry,callback:function(e){t.$set(t.form,"expiry",e)},expression:"form.expiry"}},[t._v("\n                  "+t._s(t.$t("item_has_expiry_date"))+"\n                ")])],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[t.form.changeable?r("div",{staticStyle:{"margin-top":"16px"}},[r("Row",[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("min_price"),prop:"min_price",error:t._f("a2s")(t.errors.form.min_price)}},[r("InputNumber",{model:{value:t.form.min_price,callback:function(e){t.$set(t.form,"min_price",e)},expression:"form.min_price"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("max_price"),prop:"max_price",error:t._f("a2s")(t.errors.form.max_price)}},[r("InputNumber",{model:{value:t.form.max_price,callback:function(e){t.$set(t.form,"max_price",e)},expression:"form.max_price"}})],1)],1)],1)],1):t._e()]),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",{attrs:{label:t.$tc("photo"),prop:"photo",error:t._f("a2s")(t.errors.form.photo)}},[r("Upload",{attrs:{"before-upload":t.handleUpload,"max-size":1024,action:"",accept:".png, .jpeg, .jpg, .gif"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("select_x",{x:t.$t("photo")})))])],1),t._v(" "),t.photo||t.new_photo?r("div",{staticClass:"primary",staticStyle:{"margin-bottom":"16px"}},[t.form.photo?r("span",[r("span",{staticStyle:{margin:"10px 10px 10px 0"}},[t._v(t._s(t.$t("selected_file"))+": "+t._s(t.form.photo.name))]),t._v(" "),r("Button",{attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.clearPhoto()}}})],1):t._e(),t._v(" "),r("br"),t._v(" "),t.photo||t.new_photo?r("img",{staticStyle:{"max-width":"160px","max-height":"110px","border-radius":"4px 4px 0 0"},attrs:{alt:"photo",src:t.new_photo?t.new_photo:t.photo}}):t._e(),t._v(" "),r("div",[t.new_photo?r("small",{staticClass:"warning"},[t._v(t._s(t.$t("not_uploaded_yet")))]):t._e()])]):t._e()],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("gallery_images"),prop:"images",error:t._f("a2s")(t.errors.form.images)}},[r("Upload",{attrs:{multiple:"","before-upload":t.handleImages,"max-size":2048,action:"",accept:".png, .jpeg, .jpg"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("\n                    "+t._s(t.$t("select_x",{x:t.$t("gallery_images")}))+"\n                  ")])],1),t._v(" "),t.form.images.length?[r("span",{staticStyle:{margin:"10px 10px 10px 0"}},[t._v(t._s(t.$t("selected_file")))]),t._v(" "),t._l(t.form.images,(function(e,i){return r("span",{key:"gallery_"+i,staticClass:"primary",staticStyle:{margin:"0 16px 16px 0"}},[t._v("\n                    "+t._s(i+1)+". "+t._s(e.name)+"\n                    "),r("Button",{attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.deleteImage(i)}}})],1)}))]:t._e()],2),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("video_url"),prop:"video",error:t._f("a2s")(t.errors.form.video)}},[r("Input",{model:{value:t.form.video,callback:function(e){t.$set(t.form,"video",e)},expression:"form.video"}}),t._v(" "),r("small",[t._v(t._s(t.$t("video_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("summary"),prop:"summary",error:t._f("a2s")(t.errors.form.summary)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.summary,callback:function(e){t.$set(t.form,"summary",e)},expression:"form.summary"}})],1),t._v(" "),r("FormItem",{staticStyle:{"margin-bottom":"16px"},attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:12}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("hide_in_x",{x:t.$t("pos")})}},[r("i-switch",{attrs:{"true-value":1,"false-value":0,size:"large"},model:{value:t.form.hide_in_pos,callback:function(e){t.$set(t.form,"hide_in_pos",e)},expression:"form.hide_in_pos"}},[r("span",{attrs:{slot:"open"},slot:"open"},[t._v(t._s(t.$t("yes")))]),t._v(" "),r("span",{attrs:{slot:"close"},slot:"close"},[t._v(t._s(t.$t("no")))])])],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("hide_in_x",{x:t.$t("shop")})}},[r("i-switch",{attrs:{"true-value":1,"false-value":0,size:"large"},model:{value:t.form.hide_in_shop,callback:function(e){t.$set(t.form,"hide_in_shop",e)},expression:"form.hide_in_shop"}},[r("span",{attrs:{slot:"open"},slot:"open"},[t._v(t._s(t.$t("yes")))]),t._v(" "),r("span",{attrs:{slot:"close"},slot:"close"},[t._v(t._s(t.$t("no")))])])],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.submit("items")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save")))])]),t._v(" "),r("Button",{attrs:{type:"primary",loading:t.sloading},on:{click:function(e){return t.goToStep(1,!0)}}},[t._v(t._s(t.$t("next")))])],1)],1):1==t.step?r("div",[r("item-variation-component",{attrs:{ivariants:t.form.variants,ivariations:t.form.variations,hasVariants:t.form.has_variants},on:{"step-changed":t.goToStep,"variants-changed":t.setVariants,"variations-changed":t.setVariations,"has-variants-changed":t.setHasVariants}})],1):2==t.step?r("div",[r("item-location-data-component",{attrs:{istock:t.form.stock,isStock:t.form.is_stock,variants:t.form.variants,ivariations:t.form.variations,hasVariants:t.form.has_variants},on:{"step-changed":t.goToStep,"stock-changed":t.setStock,"is-stock-changed":t.setIsStock,"variations-changed":t.setVariations}})],1):3==t.step?r("div",[r("div",{staticClass:"mb16"},[r("Checkbox",{attrs:{label:"has_serials","true-value":1,"false-value":0},model:{value:t.form.has_serials,callback:function(e){t.$set(t.form,"has_serials",e)},expression:"form.has_serials"}},[t._v("\n                  "+t._s(t.$t("item_has_serial"))+"\n                ")])],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[1==t.form.has_serials?r("div",{staticClass:"mb16",staticStyle:{"margin-top":"16px","margin-bottom":"0"}},[r("item-serial-component",{attrs:{serials:t.form.serials,totalStockQty:t.totalStockQty,hasVariants:t.form.has_variants,totalVariationsQty:t.totalVariationsQty}})],1):t._e()]),t._v(" "),r("div",{staticClass:"mb16"},[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.submit("items")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.submit("items",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.goToStep(2)}}},[t._v("\n                  "+t._s(t.$t("back"))+"\n                ")]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"error",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1):t._e()],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},29913:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(7174),s=r.n(i),a=r(92704);const n={components:{ItemViewComponent:r(41944).Z,VueBarcode:s()},mixins:[(0,a.Z)("item","app/items")],data:function(){var t=this;return{row:{},view:!1,barModal:!1,barcodeSVG:null,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",width:200},{title:this.$t("code"),sortable:!0,key:"code",sortType:"asc",minWidth:150},{title:this.$t("cost"),sortable:!0,key:"cost",minWidth:125,render:this.renderCost},{title:this.$t("price"),sortable:!0,key:"price",minWidth:125,render:this.renderPrice},{title:this.$t("quantity"),sortable:!0,key:"stock",minWidth:125,render:this.renderStock},{title:this.$t("rack_location"),sortable:!0,key:"location",minWidth:130,render:this.renderRack},{title:this.$t("alt_name"),sortable:!0,key:"alt_name",minWidth:175},{title:this.$tc("category"),sortable:!1,key:"categories",minWidth:175,render:this.renderCategory},{title:this.$tc("taxes"),sortable:!1,key:"taxes",minWidth:200,render:this.renderTaxes},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("tax_method"),sortable:!0,key:"tax_included",minWidth:120,render:this.renderTaxMethod},{title:this.$t("changeable"),sortable:!0,key:"changeable",minWidth:120,render:this.renderChangeable},{title:this.$tc("serial",2),sortable:!0,key:"has_serials",minWidth:90,render:this.renderHasSerials},{title:this.$tc("variant",2),sortable:!0,key:"has_variants",minWidth:90,render:this.renderHasVariants},{title:this.$t("min_price"),sortable:!0,key:"min_price",minWidth:120,render:this.renderMinPrice},{title:this.$t("max_price"),sortable:!0,key:"max_price",minWidth:120,render:this.renderMaxPrice},{title:this.$t("max_discount"),sortable:!0,key:"max_discount",minWidth:150,render:this.renderMaxDiscount},{title:this.$t("summary"),sortable:!0,key:"summary",ellipsis:!0,minWidth:400},{title:this.$t("created_at"),sortable:!0,key:"created_at",minWidth:175,render:this.renderCreatedAt},{title:this.$t("updated_at"),sortable:!0,key:"updated_at",minWidth:175,render:this.renderUpdatedAt},{width:120,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,editFn:t.editRecord,labelFn:t.labelModal,deleteFn:t.deleteRecord,record:{model:"item",name:"name"},trailsFn:function(e){t.$router.push("/items/trails/"+e)}}})}}],options:{orderBy:"code",perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},mounted:function(){this.$store.getters.stock||(this.columns=this.columns.filter((function(t){return"stock"!=t.key})))},methods:{showInfo:function(t){this.row=t,this.view=!0},labelModal:function(t){var e=this;this.row=t,this.barModal=!0,this.barcodeSVG=this.$store.state.settings.svg_string.replace("--- Item Name ---",this.row.name).replace("--- Other info for item. ---",this.row.alt_name).replace("--- Price: 1,000.00 ---",this.$t("price")+": "+this.formatNumber(this.row.price)),this.$nextTick((function(){document.getElementById("replace-barcode").innerHTML="",document.getElementById("replace-barcode").removeAttribute("transform");var t=document.getElementById("drawBarcode").childNodes[0].cloneNode(!0);document.getElementById("replace-barcode").setAttribute("transform","matrix(1 0 0 1 10 "+(e.$store.state.settings.label_height-60)+")"),document.getElementById("replace-barcode").appendChild(t),1==e.$store.getters.settings.print_dialog&&setTimeout((function(){window.print()}),400)}))},print:function(){window.print()},renderChangeable:function(t,e){return this.renderBoolean(t,e,"changeable")},renderHasSerials:function(t,e){return this.renderBoolean(t,e,"has_serials")},renderHasVariants:function(t,e){return this.renderBoolean(t,e,"has_variants")},renderMinPrice:function(t,e){return this.renderNumber(t,e,"min_price")},renderMaxPrice:function(t,e){return this.renderNumber(t,e,"max_price")},renderMaxDiscount:function(t,e){return this.renderNumber(t,e,"max_discount")},renderCategory:function(t,e){return t("div",[e.row.categories.map((function(t){return t.name})).join("")])},renderCost:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.location_stock.length>0&&e.row.location_stock[0].cost?e.row.location_stock[0].cost:e.row.cost,this.$store.getters.settings.decimals)])},renderPrice:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.location_stock.length>0&&e.row.location_stock[0].price?e.row.location_stock[0].price:e.row.price,this.$store.getters.settings.decimals)])},renderStock:function(t,e){return t("div",{class:"text-center"},[e.row.location_stock.length>0?this.$options.filters.formatNumber(e.row.location_stock[0].quantity,this.$store.getters.settings.decimals):this.$options.filters.formatNumber(e.row.stock.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),this.$store.getters.settings.decimals)])},renderRack:function(t,e){return t("div",[e.row.location_stock.length>0&&e.row.location_stock[0].rack?e.row.location_stock[0].rack:e.row.location])},renderTaxMethod:function(t,e){return 1==e.row.tax_included?t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-success ivu-tag-border ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-success"},[this.$t("inclusive")])])]):t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-primary ivu-tag-border ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-primary"},[this.$t("exclusive")])])])},renderTaxes:function(t,e){return t("div",[e.row.taxes.map((function(t){return t.name})).join(", ")])}}};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("item",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/items/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add_x",{x:t.$tc("item")}))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/items",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"500","footer-hide":!0,"mask-closable":!1,title:t.$t("print_x",{x:t.$t("barcode")})},model:{value:t.barModal,callback:function(e){t.barModal=e},expression:"barModal"}},[r("div",{staticClass:"label text-center",domProps:{innerHTML:t._s(t.barcodeSVG)}}),t._v(" "),r("div",{staticClass:"np"},[r("Divider",{attrs:{dashed:""}}),t._v(" "),r("div",{staticClass:"text-center",staticStyle:{display:"none"}},[r("vue-barcode",{attrs:{width:1,margin:0,height:30,fontSize:12,"margin-top":0,id:"drawBarcode",value:t.row.code,"margin-bottom":4,format:t.row.symbology}},[t._v("\n          "+t._s(t.$t("barcode_error"))+"\n        ")])],1),t._v(" "),r("Alert",{domProps:{innerHTML:t._s(t.$t("label_print_instructions"))}}),t._v(" "),r("Button",{staticClass:"np",attrs:{type:"primary",icon:"ios-print",long:""},on:{click:function(e){return t.print()}}},[t._v(t._s(t.$t("print")))])],1)]),t._v(" "),r("Modal",{attrs:{"footer-hide":"",scrollable:"",width:750},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[r("p",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("\n        "+t._s(t.row.name)+"\n        ("+t._s(t.row.code)+")\n      ")])]),t._v(" "),r("item-view-component",{attrs:{item:t.row}})],1)],1)}),[],!1,null,null,null).exports},43501:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(36940),s=r.n(i);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const l={components:{ReportFormComponent:r(19996).Z},data:function(){return{url:"",data:{},refresh:1,updated:0,reportForm:{},loading:!1,showForm:!1,fields:["created_at","location_id"],columns:[{minWidth:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("type"),sortable:!0,key:"memo",width:150},{title:this.$tc("item"),sortable:!1,key:"item",minWidth:250,render:this.renderItem},{title:this.$t("quantity"),sortable:!1,key:"quantity",minWidth:125,render:this.renderQuantity},{title:this.$tc("unit"),sortable:!1,key:"unit",minWidth:150,render:this.renderUnit},{title:this.$tc("location"),sortable:!1,key:"location",minWidth:150,render:this.renderLocation},{title:this.$tc("variation"),sortable:!1,key:"variation",minWidth:250,render:this.renderVariation}],options:{hideSearch:!0,showSummary:!0,orderBy:"created_at desc",summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.fields.map((function(e){t.reportForm[e]=""})),this.url="app/items/trails/".concat(this.$route.params.id,"/table"),this.$event.listen("location:changed",(function(e){return t.refresh++})),this.$http.get("app/items/trails/".concat(this.$route.params.id),{params:n(n({},this.reportForm),{},{date:""})}).then((function(e){t.prepareData(e.data.stock),t.reportForm.end_date=new Date(e.data.end_date),t.reportForm.start_date=new Date(e.data.start_date),t.reportForm.created_at=[new Date(e.data.start_date),new Date(e.data.end_date)],t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.created_at&&this.reportForm.created_at[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.created_at[0]).format(this.datetimeFormatString())),this.reportForm.created_at&&this.reportForm.created_at[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.created_at[1]).format(this.datetimeFormatString())),delete this.reportForm.created_at,this.url="app/items/trails/".concat(this.$route.params.id,"/table?").concat(this.queryString(this.reportForm)),this.refresh++,this.$http.get("app/items/trails/".concat(this.$route.params.id),{params:n(n({},this.reportForm),{},{date:""})}).then((function(t){e.prepareData(t.data.stock),e.reportForm.created_at=[new Date(t.data.start_date),new Date(t.data.end_date)],e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.data=[{label:this.$t("start_stock"),value:t.start_stock},{label:this.$t("close_stock"),value:t.close_stock}]},renderLocation:function(t,e){return t("div",[e.row.location?e.row.location.name:""])},renderItem:function(t,e){return t("div",[e.row.item?e.row.item.name:""])},renderUnit:function(t,e){return t("div",[e.row.unit?e.row.unit.name:""])},renderPortion:function(t,e){return t("div",[e.row.portion?e.row.portion.name:""])},renderVariation:function(t,e){return t("div",[e.row.variation?e.row.variation.code:""])},renderCreatedAt:function(t,e){return t("div",[this.$options.filters.formatDate(e.row.created_at,this.$store.state.settings.dateformat+" HH:mm A")])},renderQuantity:function(t,e){return t("div",{class:"text-center"},[this.$options.filters.formatNumber(e.row.quantity,this.$store.getters.settings.decimals)])},renderType:function(t,e){return t("div",[s().humanize(e.row.type)])},rowClassName:function(t,e){return t.quantity<0?"ivu-table-warning-row":t.quantity>0?"ivu-table-success-row":""},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["quantity"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return t.void||t.draft?0:Number(e.formatDecimal(t[n]))}));if(!o.every((function(t){return isNaN(t)}))){var l=o.reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatNumber(l)}}}else a[n]={key:n,value:""}})),a}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n    "+t._s(t.$t("item_trails"))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" - "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n  ")]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("router-link",{attrs:{to:"/items"}},[r("Button",{attrs:{type:"text",ghost:""}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n        "+t._s(t.$t("list"))+" "+t._s(t.$tc("item",2))+"\n      ")],1)],1),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1)],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,updated:t.updated,reportForm:t.reportForm},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[r("Col",{key:i,attrs:{sm:12,md:12}},[r("div",{staticClass:"box static",class:"box"+(i+5)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])])]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,"row-class-name":t.rowClassName}})],1)])}),[],!1,null,null,null).exports},41944:(t,e,r)=>{"use strict";r.d(e,{Z:()=>s});const i={props:{item:{required:!0}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.item?r("div",{staticClass:"table-responsive"},[r("div",{staticClass:"ivu-table-wrapper ivu-table-wrapper-with-border"},[r("div",{staticClass:"ivu-table ivu-table-default ivu-table-border"},[r("div",{staticClass:"ivu-table-body"},[r("table",{staticStyle:{width:"100%","min-width":"300px"},attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[r("tbody",{staticClass:"ivu-table-tbody"},[r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("code")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[r("strong",[t._v(t._s(t.item.code))]),t._v(" "),r("span",{staticStyle:{"text-transform":"uppercase"}},[t._v("("+t._s(t.item.symbology)+")")])])])]),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("name")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[r("strong",[t._v(t._s(t.item.name))]),t._v(" "),t.item.alt_name?r("span",[t._v("("+t._s(t.item.alt_name)+")")]):t._e()])])]),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("sku")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v(t._s(t.item.sku))])])]),t._v(" "),t.item.photo||t.item.video?r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("photo"))+" / "+t._s(t.$t("video")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell",staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[t.item.photo?r("a",{attrs:{href:t.item.photo,target:"_blank"}},[r("img",{staticStyle:{"max-width":"100px","max-height":"50px","margin-top":"5px","border-radius":"5px"},attrs:{alt:t.item.name,src:t.item.photo}})]):t._e(),t._v(" "),t.item.video?r("Button",{attrs:{to:t.item.video,target:"_blank"}},[t._v(t._s(t.$t("view_x",{x:t.$t("video")})))]):t._e()],1)])]):t._e(),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("cost")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v("\n                  "+t._s(t.formatNumber(t.item.cost))+"\n                ")])])]),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("price")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v("\n                  "+t._s(t.formatNumber(t.item.price))+"\n                  "),t.item.min_price||t.item.max_price?r("small",[t._v("\n                    ("+t._s(t.$t("min_price")+": "+t.formatNumber(t.item.min_price)+" - "+t.$t("max_price")+": "+t.formatNumber(t.item.max_price))+")\n                  ")]):t._e()])])]),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("max_discount")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v(t._s(t.formatNumber(t.item.max_discount))+"%")])])]),t._v(" "),t.item.categories&&t.item.categories.length?r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$tc("category")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v("\n                  "+t._s(t.item.categories[0].name)+"\n                ")])])]):t._e(),t._v(" "),t.item.unit?[r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$tc("unit")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v(t._s(t.item.unit.name)+" ("+t._s(t.item.unit.code)+")")])])])]:t._e(),t._v(" "),"recipe"==t.item.type&&t.item.portions?[r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$tc("portion",2)))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell",staticStyle:{margin:"5px 0"}},t._l(t.item.portions,(function(e){return r("div",{key:e.id},[r("div",[r("strong",[t._v(t._s(t.$t(e.name)))]),t._v(" "),r("div",t._l(e.portion_items,(function(e,i){return r("div",{key:e.id,staticStyle:{"padding-left":"16px"}},[t._v("\n                            #"+t._s(i+1)+"  "+t._s(e.item.name)+"  "+t._s(t.$t("qty"))+" "+t._s(t.formatQuantity(e.quantity))+"\n                            ")])})),0)])])})),0)])])]:t._e(),t._v(" "),"combo"==t.item.type&&t.item.portions?[r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$tc("portion",2)))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell",staticStyle:{margin:"5px 0"}},t._l(t.item.portions,(function(e){return r("div",{key:e.id},[r("div",[r("strong",[t._v(t._s(t.$t(e.name)))]),t._v(" ("+t._s(t.$t("price"))+" "+t._s(t.formatNumber(e.price))+")\n                        "),r("div",t._l(e.essentials,(function(e,i){return r("div",{key:e.id,staticStyle:{"padding-left":"16px"}},[t._v("\n                            #"+t._s(i+1)+"  "+t._s(e.item.name)+"  "+t._s(t.$t("qty"))+" "+t._s(t.formatQuantity(e.quantity))+"\n                            ")])})),0),t._v(" "),r("div",t._l(e.choosables,(function(i,s){return r("div",{key:i.id,staticStyle:{"padding-left":"16px"}},[t._v("\n                            #"+t._s(e.essentials.length+s+1)+"  "+t._s(i.name)+"\n                            "),t._l(i.items,(function(e,i){return r("div",{key:e.id,staticStyle:{"padding-left":"16px"}},[r("small",[t._v("\n                                #"+t._s(i+1)+"  "+t._s(e.item.name)+"  "+t._s(t.$t("qty"))+"\n                                "+t._s(t.formatQuantity(e.quantity))+"\n                                ")])])}))],2)})),0)])])})),0)])])]:t._e(),t._v(" "),t.item.taxes&&t.item.taxes.length?[r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$tc("tax",2)))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[t._v("\n                    "+t._s(t.item.taxes.map((function(t){return t.name})).join(", "))+"\n                  ")])])]),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$tc("tax_method")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell"},[1==t.item.tax_included?r("div",{staticClass:"ivu-tag ivu-tag-success ivu-tag-border ivu-tag-checked"},[r("span",{staticClass:"ivu-tag-text ivu-tag-color-success"},[t._v(t._s(t.$t("inclusive")))])]):r("div",{staticClass:"ivu-tag ivu-tag-primary ivu-tag-border ivu-tag-checked"},[r("span",{staticClass:"ivu-tag-text ivu-tag-color-primary"},[t._v(t._s(t.$t("exclusive")))])])])])])]:t._e(),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("misc")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell",staticStyle:{margin:"5px 0"}},[r("div",[1==t.item.changeable?r("Icon",{attrs:{type:"md-checkmark",size:"16",color:"#19be6b"}}):r("Icon",{attrs:{type:"md-close",size:"16",color:"#ed4014"}}),t._v("\n                    "+t._s(t.$t("allow_price_change"))+"\n                  ")],1),t._v(" "),"standard"==t.item.type?r("div",[1==t.item.has_variants?r("Icon",{attrs:{type:"md-checkmark",size:"16",color:"#19be6b"}}):r("Icon",{attrs:{type:"md-close",size:"16",color:"#ed4014"}}),t._v("\n                    "+t._s(t.$t("item_has_variants"))+"\n                  ")],1):t._e(),t._v(" "),"standard"==t.item.type?r("div",[1==t.item.has_serials?r("Icon",{attrs:{type:"md-checkmark",size:"16",color:"#19be6b"}}):r("Icon",{attrs:{type:"md-close",size:"16",color:"#ed4014"}}),t._v("\n                    "+t._s(t.$t("item_has_serial"))+"\n                  ")],1):t._e()])])]),t._v(" "),t.item.is_stock&&"standard"==t.item.type&&t.item.stock?r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("current_stock")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell",staticStyle:{margin:"5px 0"}},t._l(t.item.stock,(function(e){return r("div",{key:e.id},[r("div",[t._v("\n                      "+t._s(e.location.name)+": "),r("strong",[t._v(t._s(t.formatQuantity(e.quantity)))]),t._v(" "),t.item.unit?r("span",[t._v(t._s(t.item.unit.name))]):t._e()])])})),0)])]):t._e(),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("created_at")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell",staticStyle:{margin:"5px 0"}},[t._v(t._s(t.datetime(t.item.created_at)))])])]),t._v(" "),r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("updated_at")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell",staticStyle:{margin:"5px 0"}},[t._v(t._s(t.datetime(t.item.updated_at)))])])]),t._v(" "),t.item.summary?r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("summary")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell",staticStyle:{margin:"5px 0"}},[t._v(t._s(t.item.summary))])])]):t._e(),t._v(" "),t.item.details?r("tr",{staticClass:"ivu-table-row"},[r("td",{staticStyle:{width:"40%","min-width":"100px"}},[r("div",{staticClass:"ivu-table-cell"},[r("div",{staticClass:"ivu-table-cell-slot"},[t._v(t._s(t.$t("details")))])])]),t._v(" "),r("td",{staticStyle:{width:"60%","min-width":"200px"}},[r("div",{staticClass:"ivu-table-cell",staticStyle:{margin:"5px 0"}},[t._v(t._s(t.item.details))])])]):t._e()],2)])])])])]):t._e()}),[],!1,null,null,null).exports},87518:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>y});var i=r(48921),s=r(23279);function a(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const u={props:{pportions:{type:Array,required:!0},loading:{type:Boolean,required:!0}},data:function(){var t=this;return{local:[],result:[],portions:[],group:!1,costV:function(e,r,i){r&&parseFloat(r)<parseFloat(t.minCost)?i(new Error(t.$t("min_cost_error",{min:parseFloat(t.minCost)}))):i()},minCost:null,saving:!1,option:!1,priceV:function(e,r,i){r&&parseFloat(r)<parseFloat(t.minCost)?i(new Error(t.$t("min_price_error",{min:parseFloat(t.minCost)}))):i()},sloading:!1,searching:!1,can_search:!1,form:{},current:{name:""},errors:{message:"",form:{portions:[{price:null}]}},portionRules:{name:[{required:!0,trigger:"blur",message:this.$t("field_is_required",{field:this.$t("name")})}]},rules:{}}},created:function(){var t=this;this.pportions?(this.pportions.map((function(e){e.portion_items.map((function(e){return e.item?t.local.push(l(l({},e.item),{},{value:e.item_id,label:e.item.name})):t.local.push(l(l({},e),{},{value:e.item_id,label:e.name}))}))})),this.result=a(this.local),this.form.portions=this.pportions.map((function(e,r){return e.cost=e.cost?parseFloat(e.cost):null,e.price=e.price?parseFloat(e.price):null,e.portion_items&&e.portion_items.length&&(e.portion_items=e.portion_items.map((function(t){return t.quantity=t.quantity?parseFloat(t.quantity):null,t.item&&(t.id=t.item.id,t.sku=t.item.sku,t.name=t.item.name,t.cost=t.item.cost,t.item_id=t.item.id,delete t.item),t}))),t.errors.form.portions[r]||(t.errors.form.portions[r]={}),t.errors.form.portions[r].cost="",t.errors.form.portions[r].price="",t.errors.form.portions[r].item=[],e}))):this.form.portions=[{sku:this.sku(),name:this.$t("regular"),portion_items:[{name:"",item_id:null,quantity:1}],cost:null,price:null}],this.can_search=!0},methods:{modalChanged:function(t){t?window&&this.$nextTick((function(){document.querySelector("#portion_name").focus()})):this.$refs.current.resetFields()},addPortion:function(){var t=this;this.$refs.current.validate((function(e){if(e){if(t.current.name){var r=t.form.portions.find((function(t){return"regular"==t.name})),i={cost:null,price:null,sku:t.sku(),name:t.current.name,portion_items:r.portion_items.map((function(t){return l({},t)}))};t.form.portions.push(i),t.errors.form.portions.push({price:null}),t.$refs.current.resetFields(),t.option=!1}}else t.$Notice.error({title:t.$t("invalid_input"),desc:t.$t("invalid_input_error"),duration:10})}))},addItemRow:function(){this.form.portions=this.form.portions.map((function(t){return t.portion_items.push({quantity:1}),t}))},deleteItemRow:function(t){this.form.portions=this.form.portions.map((function(e){return e.portion_items.splice(t,1),e}))},removePortion:function(t){var e=this;this.form.portions.splice(t,1),this.saving=!0,this.$nextTick((function(){return e.saving=!1}))},itemChanged:function(t,e,r){if(t){var i=this.result.find((function(e){return e.id==t}));e.portion_items=e.portion_items.map((function(e){return e.item_id==t&&(e.cost=i.cost,e.name=i.name,e.item_name=i.name),e}))}this.portionCost(e,r)},portionCost:function(t,e){return t.portion_items.reduce((function(t,e){return t+(e.cost?parseFloat(e.cost)*parseFloat(e.quantity):0)}),0)},searchItems:function(t){this.can_search&&(""===(t=t.trim())||this.result.find((function(e){return e.id==t||e.name==t}))||this.getItems(t,this))},getItems:r.n(s)()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/items/search?cost=yes&q="+t).then((function(t){e.result=t.data,e.result=[].concat(a(e.result),a(e.local))})).finally((function(){return e.searching=!1}))}),search_delay||250),goToStep:function(t){this.$emit("portions-changed",this.form.portions),this.$emit("step-changed",t)},onReset:function(){this.$emit("on-reset"),this.$emit("step-changed",0)},onSubmit:function(t,e){var r=this,i=!1;this.form.portions.map((function(t,e){if(null===t.cost&&(i=!0,r.errors.form.portions[e].cost=r.$t("field_is_required",{field:r.$t("cost")})),null===t.price&&(i=!0,r.errors.form.portions[e].price=r.$t("field_is_required",{field:r.$t("price")})),t.portion_items&&t.portion_items.length){var s=[];t.portion_items.map((function(t){t.item_id||(i=!0,s.push(r.$t("field_is_required",{field:r.$tc("item")+(e+1)}))),t.quantity||(i=!0,s.push(r.$t("field_is_required",{field:r.$tc("item")+(e+1)+"("+r.$t("quantity")+")"})))})),r.errors.form.portions[e].item=s}})),i||this.$refs.portionsForm.validate((function(i){i?(r.$emit("portions-changed",r.form.portions),r.$nextTick((function(){r.$emit("on-submit",{page:t,stay:e})}))):r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10})}))}}};var d=r(51900);const m=(0,d.Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Form",{ref:"portionsForm",attrs:{model:t.form,"label-position":"top"}},[r("div",{staticClass:"mb16"},[r("Row",{attrs:{gutter:16}},t._l(t.form.portions,(function(e,i){return r("Col",{key:"portion_"+i,attrs:{sm:24,md:12,lg:12}},[r("Card",{staticStyle:{"margin-bottom":"16px","line-height":"1em"},attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s("regular"==e.name?t.$t("regular"):e.name))]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[i?r("Button",{attrs:{slot:"extra",size:"small",type:"error"},on:{click:function(e){return t.removePortion(i)}},slot:"extra"},[r("Icon",{attrs:{type:"ios-trash"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("delete_x",{x:t.$tc("portion")})))])],1):r("Button",{attrs:{size:"small",type:"success"},on:{click:function(e){t.option=!0}}},[r("Icon",{attrs:{type:"ios-options"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("add_x",{x:t.$tc("portion")})))])],1),t._v(" "),i?t._e():r("Button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.addItemRow()}}},[r("Icon",{attrs:{type:"ios-add-circle"}}),t._v(" "),r("span",{staticClass:"hidden-sm"},[t._v(t._s(t.$t("add_x",{x:t.$tc("item")})))])],1)],1),t._v(" "),r("div",{staticClass:"variant-table"},[r("table",{staticClass:"table"},[r("thead",[r("tr",[r("th",[t._v(t._s(t.$t("name")))]),t._v(" "),r("th",[t._v(t._s(t.$t("quantity")))]),t._v(" "),r("th",{staticStyle:{padding:"0","max-width":"40px","min-width":"40px",width:"40px"}},[r("icon",{attrs:{type:"md-trash"}})],1)])]),t._v(" "),r("tbody",t._l(e.portion_items,(function(s,a){return r("tr",{key:"item_"+a},[r("td",{attrs:{width:"70%"}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",label:s.name,loading:t.searching,"remote-method":t.searchItems},on:{"on-change":function(r){return t.itemChanged(r,e,i)}},model:{value:s.item_id,callback:function(e){t.$set(s,"item_id",e)},expression:"item.item_id"}},t._l(t.result,(function(t,e){return r("Option",{key:"item_"+e,attrs:{value:t.id,label:t.name}})})),1)],1),t._v(" "),r("td",[r("InputNumber",{on:{"on-change":function(r){return t.itemChanged(null,e,i)}},model:{value:s.quantity,callback:function(e){t.$set(s,"quantity",e)},expression:"item.quantity"}}),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:s.cost,expression:"item.cost"}],attrs:{type:"hidden"},domProps:{value:s.cost},on:{input:function(e){e.target.composing||t.$set(s,"cost",e.target.value)}}}),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:s.name,expression:"item.name"}],attrs:{type:"hidden"},domProps:{value:s.name},on:{input:function(e){e.target.composing||t.$set(s,"name",e.target.value)}}}),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:s.item_name,expression:"item.item_name"}],attrs:{type:"hidden"},domProps:{value:s.item_name},on:{input:function(e){e.target.composing||t.$set(s,"item_name",e.target.value)}}})],1),t._v(" "),r("td",{staticClass:"text-center"},[a?r("Icon",{staticClass:"pointer",attrs:{size:"16",color:"#ed3f14",type:"md-trash"},on:{click:function(e){return t.deleteItemRow(a)}}}):t._e()],1)])})),0)])]),t._v(" "),t.errors.form.portions[i]&&t.errors.form.portions[i].item&&t.errors.form.portions[i].item.length?r("Alert",{staticClass:"mt16",attrs:{type:"error"},domProps:{innerHTML:t._s(t.errors.form.portions[i].item.join("<br />"))}}):t._e(),t._v(" "),r("Row",{staticClass:"mt16",attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("cost"),prop:"portions."+i+".cost",error:t.errors.form.portions[i].cost,rules:{validator:t.costV,type:"number",trigger:"change"}}},[r("InputNumber",{model:{value:e.cost,callback:function(r){t.$set(e,"cost",r)},expression:"portion.cost"}}),t._v(" "),r("small",[t._v(t._s(t.$t("min_cost_error",{min:t.portionCost(e,i)})))])],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("price"),prop:"portions."+i+".price",error:t.errors.form.portions[i].price,rules:{validator:t.priceV,type:"number",trigger:"change"}}},[r("InputNumber",{model:{value:e.price,callback:function(r){t.$set(e,"price",r)},expression:"portion.price"}})],1)],1)],1)],1)],1)})),1)],1),t._v(" "),r("div",{staticClass:"mb16"},[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.onSubmit("items")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.onSubmit("items",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.goToStep(0)}}},[t._v("\n        "+t._s(t.$t("back"))+"\n      ")]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"error",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)]),t._v(" "),r("Modal",{attrs:{"footer-hide":"",width:"300",title:t.$t("add_x",{x:t.$tc("portion")})},on:{"on-visible-change":t.modalChanged},model:{value:t.option,callback:function(e){t.option=e},expression:"option"}},[r("Form",{ref:"current",attrs:{model:t.current,rules:t.portionRules,"label-position":"top"},nativeOn:{submit:function(e){return e.preventDefault(),t.addPortion.apply(null,arguments)}}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name"}},[r("Input",{attrs:{placeholder:t.$t("name"),"element-id":"portion_name"},model:{value:t.current.name,callback:function(e){t.$set(t.current,"name",e)},expression:"current.name"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary",long:""},on:{click:t.addPortion}},[t._v(t._s(t.$t("add")))])],1)],1)],1)],1)}),[],!1,null,null,null).exports;function h(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function _(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach((function(e){v(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var g=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.images=[],delete t.photo,t.location_stock&&delete t.location_stock,t.valid_promotions&&delete t.valid_promotions,t.cost=parseFloat(t.cost),t.price=parseFloat(t.price),t.category_id=t.categories[0].id,t.sku=t.sku?t.sku:e.sku(),t.max_price=t.max_price?parseFloat(t.max_price):null,t.min_price=t.min_price?parseFloat(t.min_price):null,t.max_discount=t.max_discount?parseFloat(t.max_discount):null,t.taxes=t.taxes.map((function(t){return t.id})),t.modifiers||(t.modifiers=[]),t.items||(t.items=[]),t.portions||(t.portions=[{sku:e.sku(),name:"regular",portion_items:[],cost:null,price:null}]),t.modifiers=t.modifiers.map((function(t){return t.id})),t.items=t.items.map((function(t){return t.id})),t.portions=t.portions.map((function(t){return t.cost=t.cost?parseFloat(t.cost):null,t.price=t.price?parseFloat(t.price):null,t.portion_items&&t.portion_items.length?t.portion_items=t.portion_items.map((function(t){return e.result.push(t.item),t.item_name=t.item.name,t.cost=parseFloat(t.item.cost),t.quantity=t.quantity?parseFloat(t.quantity):null,t})):t.portion_items=[],e.errors.form.portions.push({price:null}),t})),e.attributes.filter((function(t){return"number"==t.type})).map((function(e){t.extra_attributes[e.slug]=t.extra_attributes[e.slug]?parseFloat(t.extra_attributes[e.slug]):null})),e.form=_(_({},t),t.extra_attributes),e.form};const b={components:{RecipePortionComponent:m},mixins:[(0,i.Z)("item","app/items",!0,g,"recipes")],data:function(){return{step:0,taxes:[],result:[],photo:null,option:!1,modifiers:[],categories:[],attributes:[],new_photo:null,sloading:!1,searching:!1,form:{id:"",code:"",name:"",stock:{},taxes:[],cost:null,details:"",photo:null,summary:"",images:[],video:null,price:null,is_stock:0,alt_name:"",weight:null,changeable:0,modifiers:[],dimensions:"",type:"recipe",has_serials:0,has_variants:0,min_price:null,max_price:null,sku:this.sku(),tax_included:"",category_id:null,supplier_id:null,max_discount:null,supplier_item_id:"",portions:[{sku:this.sku(),name:"regular",portion_items:[{name:"",item_id:null,quantity:1}],cost:null,price:null}]},current:{name:""},rules:{type:[{required:!0,message:this.$t("field_is_required",{field:this.$t("type")}),trigger:"change"}],name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"},{required:!0,trigger:["blur","change"],pattern:/^([a-zA-Z0-9-_]{2,25})$/,message:this.$t("alpha_dash_error")}],category_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("category")}),trigger:"change"}],symbology:[{required:!0,message:this.$t("field_is_required",{field:this.$t("symbology")}),trigger:"change"}],taxes:[{type:"array",trigger:"change",message:this.$t("field_are_required",{field:this.$tc("tax",2)})}]},variantRules:{quantity:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("quantity")}),trigger:"blur"}],name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}]}}},created:function(){var t=this;this.$http.get("app/taxes/search").then((function(e){return t.taxes=e.data})),this.$http.get("app/modifiers/search").then((function(e){return t.modifiers=e.data})),this.$http.get("app/all_categories/search").then((function(e){return t.categories=t.flattenDeep(e.data)})),this.errors.form.portions=[{}]},methods:{create:function(){var t=this;this.$http.get("app/items/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/items/".concat(t)).then((function(t){return e.form=g(t.data,e)})).finally((function(){return e.loading=!1}))},goToStep:function(t,e){var r=this;this.sloading=!0,1==t&&e?this.$refs.item.validate((function(e){e?(r.step=parseInt(t),r.sloading=!1,window.scrollTo(0,0)):(r.sloading=!1,r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10}))})):(window.scrollTo(0,0),this.sloading=!1,this.step=parseInt(t))},handleImages:function(t){var e=new FileReader;return this.form.images.push(t),e.readAsDataURL(t),!1},deleteImage:function(t){this.form.images.splice(t,1)},handleUpload:function(t){var e=this,r=new FileReader;return r.addEventListener("load",(function(){return e.new_photo=r.result}),!1),this.form.photo=t,r.readAsDataURL(t),!1},clearPhoto:function(){this.new_photo=null,this.form.photo=null},portionsChanged:function(t){this.form.portions=t},onSubmit:function(t){this.submit(t.page,t.stay)},submit:function(t,e){var r=this,i="app/items",s="added";this.errors.message="";var a="record_added";this.form.id&&""!=this.form.id&&(s="updated",i="app/items/"+this.form.id,a="record_updated",this.form._method="PUT");var n=this.form.portions.find((function(t){return"regular"==t.name}));this.form.cost=n.cost,this.form.price=n.price;var o=_({},this.form);if(this.attributes.length>0){var l=this.attributes.map((function(t){var e={};return delete o[t.slug],e[t.slug]=r.form[t.slug],e}));o.extra_attributes=Object.assign.apply(Object,h(l))}o.portions=o.portions.map((function(t){return t.portion_items=t.portion_items.map((function(t){return{item_id:t.item_id,quantity:t.quantity}})),t})),o=this.$form(o),this.$http.post(i,o).then((function(i){i.data.success?(r.$Notice.destroy(),r.$Notice.success({title:r.$tc("item")+" "+r.$t(s),desc:r.$t(a)}),e?("updated"==s||r.handleReset(),r.step=0):r.$router.push({name:t+".recipes.list"})):r.$Notice.error({title:r.$t("failed"),desc:r.$t("failed_error_text")})})).catch((function(t){return r.errors=t})).finally((function(){return r.loading=!1}))}}};const y=(0,d.Z)(b,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("recipe")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/items/recipes"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("recipe",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"item",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),r("div",{staticStyle:{margin:"-16px -16px 16px -16px","border-bottom":"1px solid #e8eaec",padding:"16px"}},[r("Steps",{attrs:{current:t.step,status:"wait"}},[r("Step",{attrs:{title:t.$t("general_step"),content:t.$t("general_step_text")}}),t._v(" "),r("Step",{attrs:{title:t.$t("variations_step"),content:t.$t("variations_step_text")}})],1)],1),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),0==t.step?r("div",[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}}),t._v(" "),r("small",[t._v(t._s(t.$t("item_code_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("symbology"),prop:"symbology",error:t._f("a2s")(t.errors.form.symbology)}},[r("Select",{model:{value:t.form.symbology,callback:function(e){t.$set(t.form,"symbology",e)},expression:"form.symbology"}},[r("Option",{attrs:{value:"code128"}},[t._v("Code128")]),t._v(" "),r("Option",{attrs:{value:"code39"}},[t._v("Code39")]),t._v(" "),r("Option",{attrs:{value:"ean5"}},[t._v("EAN5")]),t._v(" "),r("Option",{attrs:{value:"ean8"}},[t._v("EAN8")]),t._v(" "),r("Option",{attrs:{value:"ean13"}},[t._v("EAN13")]),t._v(" "),r("Option",{attrs:{value:"upce"}},[t._v("UPC (E)")]),t._v(" "),r("Option",{attrs:{value:"upca"}},[t._v("UPC (A)")])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("category"),prop:"category_id",error:t._f("a2s")(t.errors.form.category_id)}},[r("Select",{model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(e){return r("Option",{key:e.value,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("taxes"),prop:"taxes",error:t._f("a2s")(t.errors.form.taxes)}},[r("Select",{attrs:{filterable:"",multiple:""},model:{value:t.form.taxes,callback:function(e){t.$set(t.form,"taxes",e)},expression:"form.taxes"}},t._l(t.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n                        "+t._s(e.name)+"\n                      ")])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("sku"),prop:"sku",error:t._f("a2s")(t.errors.form.sku)}},[r("Input",{attrs:{readonly:""},model:{value:t.form.sku,callback:function(e){t.$set(t.form,"sku",e)},expression:"form.sku"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("alt_name"),prop:"alt_name",error:t._f("a2s")(t.errors.form.alt_name)}},[r("Input",{model:{value:t.form.alt_name,callback:function(e){t.$set(t.form,"alt_name",e)},expression:"form.alt_name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("hsn_number"),prop:"hsn_number",error:t._f("a2s")(t.errors.form.hsn_number)}},[r("Input",{model:{value:t.form.hsn_number,callback:function(e){t.$set(t.form,"hsn_number",e)},expression:"form.hsn_number"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{prop:"max_discount",label:t.$t("max_discount"),error:t._f("a2s")(t.errors.form.max_discount)}},[r("InputNumber",{attrs:{formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:t.form.max_discount,callback:function(e){t.$set(t.form,"max_discount",e)},expression:"form.max_discount"}}),t._v(" "),r("small",[t._v(t._s(t.$t("max_discount_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("modifier",2),prop:"modifier",error:t._f("a2s")(t.errors.form.modifier)}},[r("Select",{attrs:{clearable:"",multiple:""},model:{value:t.form.modifiers,callback:function(e){t.$set(t.form,"modifiers",e)},expression:"form.modifiers"}},t._l(t.modifiers,(function(e){return r("Option",{key:"modifier_"+e.value,attrs:{value:e.value}},[t._v("\n                        "+t._s(e.label)+"\n                      ")])})),1)],1)],1)],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",{attrs:{label:t.$tc("photo"),prop:"photo",error:t._f("a2s")(t.errors.form.photo)}},[r("Upload",{attrs:{"before-upload":t.handleUpload,"max-size":1024,action:"",accept:".png, .jpeg, .jpg, .gif"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("select_x",{x:t.$t("photo")})))])],1),t._v(" "),t.photo||t.new_photo?r("div",{staticClass:"primary",staticStyle:{"margin-bottom":"16px"}},[t.form.photo?r("span",[r("span",{staticStyle:{margin:"10px 10px 10px 0"}},[t._v(t._s(t.$t("selected_file"))+": "+t._s(t.form.photo.name))]),t._v(" "),r("Button",{attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.clearPhoto()}}})],1):t._e(),t._v(" "),r("br"),t._v(" "),t.photo||t.new_photo?r("img",{staticStyle:{"max-width":"160px","max-height":"110px","border-radius":"4px 4px 0 0"},attrs:{alt:"photo",src:t.new_photo?t.new_photo:t.photo}}):t._e()]):t._e()],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("gallery_images"),prop:"images",error:t._f("a2s")(t.errors.form.images)}},[r("Upload",{attrs:{multiple:"","before-upload":t.handleImages,"max-size":2048,action:"",accept:".png, .jpeg, .jpg"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("\n                    "+t._s(t.$t("select_x",{x:t.$t("gallery_images")}))+"\n                  ")])],1),t._v(" "),t.form.images.length?[r("span",{staticStyle:{margin:"10px 10px 10px 0"}},[t._v(t._s(t.$t("selected_file")))]),t._v(" "),t._l(t.form.images,(function(e,i){return r("span",{key:"gallery_"+i,staticClass:"primary",staticStyle:{margin:"0 16px 16px 0"}},[t._v("\n                    "+t._s(i+1)+". "+t._s(e.name)+"\n                    "),r("Button",{attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.deleteImage(i)}}})],1)}))]:t._e()],2),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("video_url"),prop:"video",error:t._f("a2s")(t.errors.form.video)}},[r("Input",{model:{value:t.form.video,callback:function(e){t.$set(t.form,"video",e)},expression:"form.video"}}),t._v(" "),r("small",[t._v(t._s(t.$t("video_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("summary"),prop:"summary",error:t._f("a2s")(t.errors.form.summary)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.summary,callback:function(e){t.$set(t.form,"summary",e)},expression:"form.summary"}})],1),t._v(" "),r("FormItem",{staticStyle:{"margin-bottom":"16px"},attrs:{prop:"details",label:t.$t("details"),error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:12}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.sloading},on:{click:function(e){return t.goToStep(1,!0)}}},[t._v(t._s(t.$t("next")))])],1)],1):1==t.step?r("div",[r("div",{staticClass:"mb16"},[r("recipe-portion-component",{attrs:{loading:t.loading,pportions:t.form.portions},on:{"on-submit":t.onSubmit,"step-changed":t.goToStep,"portions-changed":t.portionsChanged,"on-reset":function(e){return t.goToStep(0,!1,!0)}}})],1)]):t._e()],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},1932:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(7174),s=r.n(i),a=r(92704);const n={components:{ItemViewComponent:r(41944).Z,VueBarcode:s()},mixins:[(0,a.Z)("item","app/items","name","code","recipes")],data:function(){var t=this;return{row:{},view:!1,barModal:!1,barcodeSVG:null,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",width:200},{title:this.$t("code"),sortable:!0,key:"code",sortType:"asc",minWidth:150},{title:this.$t("cost"),sortable:!0,key:"cost",minWidth:125,render:this.renderCost},{title:this.$t("price"),sortable:!0,key:"price",minWidth:125,render:this.renderPrice},{title:this.$t("alt_name"),sortable:!0,key:"alt_name",minWidth:175},{title:this.$tc("category"),sortable:!1,key:"categories",minWidth:175,render:this.renderCategory},{title:this.$tc("taxes"),sortable:!1,key:"taxes",minWidth:200,render:this.renderTaxes},{title:this.$tc("portion",2),sortable:!1,key:"portions",minWidth:200,render:this.renderPortion},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("changeable"),sortable:!0,key:"changeable",minWidth:120,render:this.renderChangeable},{title:this.$t("min_price"),sortable:!0,key:"min_price",minWidth:150,render:this.renderMinPrice},{title:this.$t("max_price"),sortable:!0,key:"max_price",minWidth:150,render:this.renderMaxPrice},{title:this.$t("max_discount"),sortable:!0,key:"max_discount",minWidth:150,render:this.renderMaxDiscount},{title:this.$t("summary"),sortable:!0,key:"summary",ellipsis:!0,minWidth:400},{title:this.$t("created_at"),sortable:!0,key:"created_at",minWidth:175,render:this.renderCreatedAt},{title:this.$t("updated_at"),sortable:!0,key:"updated_at",minWidth:175,render:this.renderUpdatedAt},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,editFn:t.editRecord,labelFn:t.labelModal,deleteFn:t.deleteRecord,record:{model:"item",name:"name"}}})}}],options:{orderBy:"code",perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},mounted:function(){this.$store.getters.stock||(this.columns=this.columns.filter((function(t){return"stock"!=t.key})))},methods:{showInfo:function(t){this.row=t,this.view=!0},labelModal:function(t){var e=this;this.row=t,this.barModal=!0,this.barcodeSVG=this.$store.state.settings.svg_string.replace("--- Item Name ---",this.row.name).replace("--- Other info for item. ---",this.row.alt_name).replace("--- Price: 1,000.00 ---",this.$t("price")+": "+this.formatNumber(this.row.price)),this.$nextTick((function(){document.getElementById("replace-barcode").innerHTML="",document.getElementById("replace-barcode").removeAttribute("transform");var t=document.getElementById("drawBarcode").childNodes[0].cloneNode(!0);document.getElementById("replace-barcode").setAttribute("transform","matrix(1 0 0 1 10 "+(e.$store.state.settings.label_height-60)+")"),document.getElementById("replace-barcode").appendChild(t),1==e.$store.getters.settings.print_dialog&&setTimeout((function(){window.print()}),400)}))},print:function(){window.print()},renderChangeable:function(t,e){return this.renderBoolean(t,e,"changeable")},renderMinPrice:function(t,e){return this.renderNumber(t,e,"min_price")},renderPortion:function(t,e){var r=this;return t("div",[e.row.portions.map((function(t){return r.$t(t.name)})).join(", ")])},renderMaxPrice:function(t,e){return this.renderNumber(t,e,"max_price")},renderMaxDiscount:function(t,e){return this.renderNumber(t,e,"max_discount")},renderCategory:function(t,e){return t("div",[e.row.categories.map((function(t){return t.name})).join("")])},renderCost:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.location_stock.length>0&&e.row.location_stock[0].cost?e.row.location_stock[0].cost:e.row.cost,this.$store.getters.settings.decimals)])},renderPrice:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.location_stock.length>0&&e.row.location_stock[0].price?e.row.location_stock[0].price:e.row.price,this.$store.getters.settings.decimals)])},renderStock:function(t,e){return t("div",{class:"text-center"},[e.row.location_stock.length>0?this.$options.filters.formatNumber(e.row.location_stock[0].quantity,this.$store.getters.settings.decimals):this.$options.filters.formatNumber(e.row.stock.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),this.$store.getters.settings.decimals)])},renderRack:function(t,e){return t("div",[e.row.location_stock.length>0&&e.row.location_stock[0].rack?e.row.location_stock[0].rack:e.row.location])},renderTaxMethod:function(t,e){return 1==e.row.tax_included?t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-success ivu-tag-border ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-success"},[this.$t("inclusive")])])]):t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-primary ivu-tag-border ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-primary"},[this.$t("exclusive")])])])},renderTaxes:function(t,e){return t("div",[e.row.taxes.map((function(t){return t.name})).join(", ")])}}};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("recipe",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/items/recipes/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add_x",{x:t.$tc("recipe")}))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/items?type=recipe",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"500","footer-hide":!0,"mask-closable":!1,title:t.$t("print_x",{x:t.$t("barcode")})},model:{value:t.barModal,callback:function(e){t.barModal=e},expression:"barModal"}},[r("div",{staticClass:"label text-center",domProps:{innerHTML:t._s(t.barcodeSVG)}}),t._v(" "),r("div",{staticClass:"np"},[r("Divider",{attrs:{dashed:""}}),t._v(" "),r("div",{staticClass:"text-center",staticStyle:{display:"none"}},[r("vue-barcode",{attrs:{width:1,margin:0,height:30,fontSize:12,"margin-top":0,id:"drawBarcode",value:t.row.code,"margin-bottom":4,format:t.row.symbology}},[t._v("\n          "+t._s(t.$t("barcode_error"))+"\n        ")])],1),t._v(" "),r("Alert",{domProps:{innerHTML:t._s(t.$t("label_print_instructions"))}}),t._v(" "),r("Button",{staticClass:"np",attrs:{type:"primary",icon:"ios-print",long:""},on:{click:function(e){return t.print()}}},[t._v(t._s(t.$t("print")))])],1)]),t._v(" "),r("Modal",{attrs:{"footer-hide":"",scrollable:"",width:750},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[r("p",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("\n        "+t._s(t.row.name)+"\n        ("+t._s(t.row.code)+")\n      ")])]),t._v(" "),r("item-view-component",{attrs:{item:t.row}})],1)],1)}),[],!1,null,null,null).exports},58462:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>d});var i=r(48921);r(23279);function s(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.images=[],delete t.photo,t.location_stock&&delete t.location_stock,t.valid_promotions&&delete t.valid_promotions,t.cost=parseFloat(t.cost),t.price=parseFloat(t.price),t.category_id=t.categories[0].id,t.sku=t.sku?t.sku:e.sku(),t.max_price=t.max_price?parseFloat(t.max_price):null,t.min_price=t.min_price?parseFloat(t.min_price):null,t.max_discount=t.max_discount?parseFloat(t.max_discount):null,t.taxes=t.taxes.map((function(t){return t.id})),t.modifiers||(t.modifiers=[]),t.modifiers=t.modifiers.map((function(t){return t.id})),e.attributes.filter((function(t){return"number"==t.type})).map((function(e){t.extra_attributes[e.slug]=t.extra_attributes[e.slug]?parseFloat(t.extra_attributes[e.slug]):null})),e.form=o(o({},t),t.extra_attributes),e.form};const u={mixins:[(0,i.Z)("item","app/items",!0,c,"services")],data:function(){var t=this,e=function(e,r,i){r&&parseFloat(r)<parseFloat(t.minCost)?i(new Error(t.$t("min_cost_error",{min:parseFloat(t.minCost)}))):i()},r=function(e,r,i){r&&parseFloat(r)<parseFloat(t.minCost)?i(new Error(t.$t("min_price_error",{min:parseFloat(t.minCost)}))):i()};return{step:0,taxes:[],photo:null,costV:e,option:!1,modifiers:[],priceV:r,categories:[],attributes:[],new_photo:null,sloading:!1,searching:!1,minCost:null,form:{id:"",code:"",name:"",stock:{},taxes:[],cost:null,details:"",photo:null,summary:"",images:[],video:null,price:null,is_stock:0,alt_name:"",weight:null,changeable:0,modifiers:[],dimensions:"",type:"service",has_serials:0,has_variants:0,min_price:null,max_price:null,sku:this.sku(),tax_included:"",category_id:null,supplier_id:null,max_discount:null,supplier_item_id:""},current:{name:""},rules:{type:[{required:!0,message:this.$t("field_is_required",{field:this.$t("type")}),trigger:"change"}],name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"},{required:!0,trigger:["blur","change"],pattern:/^([a-zA-Z0-9-_]{2,25})$/,message:this.$t("alpha_dash_error")}],category_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("category")}),trigger:"change"}],symbology:[{required:!0,message:this.$t("field_is_required",{field:this.$t("symbology")}),trigger:"change"}],taxes:[{type:"array",trigger:"change",message:this.$t("field_are_required",{field:this.$tc("tax",2)})}],cost:[{required:!0,type:"number",trigger:["change","blur"],message:this.$t("field_is_required",{field:this.$t("cost")})},{validator:e,type:"number",trigger:["change","blur"]}],price:[{required:!0,type:"number",trigger:["change","blur"],message:this.$t("field_is_required",{field:this.$t("price")})},{validator:r,type:"number",trigger:["change","blur"]}]}}},created:function(){var t=this;this.$http.get("app/taxes/search").then((function(e){return t.taxes=e.data})),this.$http.get("app/modifiers/search").then((function(e){return t.modifiers=e.data})),this.$http.get("app/all_categories/search").then((function(e){return t.categories=t.flattenDeep(e.data)}))},methods:{create:function(){var t=this;this.$http.get("app/items/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/items/".concat(t)).then((function(t){return e.form=c(t.data,e)})).finally((function(){return e.loading=!1}))},handleImages:function(t){var e=new FileReader;return this.form.images.push(t),e.readAsDataURL(t),!1},deleteImage:function(t){this.form.images.splice(t,1)},handleUpload:function(t){var e=this,r=new FileReader;return r.addEventListener("load",(function(){return e.new_photo=r.result}),!1),this.form.photo=t,r.readAsDataURL(t),!1},clearPhoto:function(){this.new_photo=null,this.form.photo=null},submit:function(t,e){var r=this;this.$refs.item.validate((function(i){if(i){var a="app/items",n="added";r.errors.message="";var l="record_added";r.form.id&&""!=r.form.id&&(n="updated",a="app/items/"+r.form.id,l="record_updated",r.form._method="PUT");var c=o({},r.form);if(r.attributes.length>0){var u=r.attributes.map((function(t){var e={};return delete c[t.slug],e[t.slug]=r.form[t.slug],e}));c.extra_attributes=Object.assign.apply(Object,s(u))}c=r.$form(c),r.$http.post(a,c).then((function(i){i.data.success?(r.$Notice.destroy(),r.$Notice.success({title:r.$tc("item")+" "+r.$t(n),desc:r.$t(l)}),e?"updated"==n||r.handleReset():r.$router.push({name:t+".services.list"})):r.$Notice.error({title:r.$t("failed"),desc:r.$t("failed_error_text")})})).catch((function(t){return r.errors=t})).finally((function(){return r.loading=!1}))}else r.sloading=!1,r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10})}))}}};const d=(0,r(51900).Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("service")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/items/services"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("service",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"item",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}}),t._v(" "),r("small",[t._v(t._s(t.$t("item_code_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("symbology"),prop:"symbology",error:t._f("a2s")(t.errors.form.symbology)}},[r("Select",{model:{value:t.form.symbology,callback:function(e){t.$set(t.form,"symbology",e)},expression:"form.symbology"}},[r("Option",{attrs:{value:"code128"}},[t._v("Code128")]),t._v(" "),r("Option",{attrs:{value:"code39"}},[t._v("Code39")]),t._v(" "),r("Option",{attrs:{value:"ean5"}},[t._v("EAN5")]),t._v(" "),r("Option",{attrs:{value:"ean8"}},[t._v("EAN8")]),t._v(" "),r("Option",{attrs:{value:"ean13"}},[t._v("EAN13")]),t._v(" "),r("Option",{attrs:{value:"upce"}},[t._v("UPC (E)")]),t._v(" "),r("Option",{attrs:{value:"upca"}},[t._v("UPC (A)")])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("category"),prop:"category_id",error:t._f("a2s")(t.errors.form.category_id)}},[r("Select",{model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(e){return r("Option",{key:e.value,attrs:{value:e.id}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("cost"),prop:"cost",error:t._f("a2s")(t.errors.form.cost)}},[r("InputNumber",{model:{value:t.form.cost,callback:function(e){t.$set(t.form,"cost",e)},expression:"form.cost"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("price"),prop:"price",error:t._f("a2s")(t.errors.form.price)}},[r("InputNumber",{model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("taxes"),prop:"taxes",error:t._f("a2s")(t.errors.form.taxes)}},[r("Select",{attrs:{filterable:"",multiple:""},model:{value:t.form.taxes,callback:function(e){t.$set(t.form,"taxes",e)},expression:"form.taxes"}},t._l(t.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("sku"),prop:"sku",error:t._f("a2s")(t.errors.form.sku)}},[r("Input",{attrs:{readonly:""},model:{value:t.form.sku,callback:function(e){t.$set(t.form,"sku",e)},expression:"form.sku"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("alt_name"),prop:"alt_name",error:t._f("a2s")(t.errors.form.alt_name)}},[r("Input",{model:{value:t.form.alt_name,callback:function(e){t.$set(t.form,"alt_name",e)},expression:"form.alt_name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("sac_number"),prop:"hsn_number",error:t._f("a2s")(t.errors.form.hsn_number)}},[r("Input",{model:{value:t.form.hsn_number,callback:function(e){t.$set(t.form,"hsn_number",e)},expression:"form.hsn_number"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{prop:"max_discount",label:t.$t("max_discount"),error:t._f("a2s")(t.errors.form.max_discount)}},[r("InputNumber",{attrs:{formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:t.form.max_discount,callback:function(e){t.$set(t.form,"max_discount",e)},expression:"form.max_discount"}}),t._v(" "),r("small",[t._v(t._s(t.$t("max_discount_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("modifier",2),prop:"modifier",error:t._f("a2s")(t.errors.form.modifier)}},[r("Select",{attrs:{clearable:"",multiple:""},model:{value:t.form.modifiers,callback:function(e){t.$set(t.form,"modifiers",e)},expression:"form.modifiers"}},t._l(t.modifiers,(function(e){return r("Option",{key:"modifier_"+e.value,attrs:{value:e.value}},[t._v("\n                      "+t._s(e.label)+"\n                    ")])})),1)],1)],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Checkbox",{attrs:{label:"tax_included","true-value":1,"false-value":0},model:{value:t.form.tax_included,callback:function(e){t.$set(t.form,"tax_included",e)},expression:"form.tax_included"}},[t._v("\n                "+t._s(t.$t("tax_inclusive"))+"\n              ")])],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Checkbox",{attrs:{label:"price_changeable","true-value":1,"false-value":0},model:{value:t.form.changeable,callback:function(e){t.$set(t.form,"changeable",e)},expression:"form.changeable"}},[t._v("\n                "+t._s(t.$t("allow_price_change"))+"\n              ")])],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[t.form.changeable?r("div",{staticStyle:{"margin-top":"16px"}},[r("Row",[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("min_price"),prop:"min_price",error:t._f("a2s")(t.errors.form.min_price)}},[r("InputNumber",{model:{value:t.form.min_price,callback:function(e){t.$set(t.form,"min_price",e)},expression:"form.min_price"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("max_price"),prop:"max_price",error:t._f("a2s")(t.errors.form.max_price)}},[r("InputNumber",{model:{value:t.form.max_price,callback:function(e){t.$set(t.form,"max_price",e)},expression:"form.max_price"}})],1)],1)],1)],1):t._e()]),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",{attrs:{label:t.$tc("photo"),prop:"photo",error:t._f("a2s")(t.errors.form.photo)}},[r("Upload",{attrs:{"before-upload":t.handleUpload,"max-size":1024,action:"",accept:".png, .jpeg, .jpg, .gif"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("select_x",{x:t.$t("photo")})))])],1),t._v(" "),t.photo||t.new_photo?r("div",{staticClass:"primary",staticStyle:{"margin-bottom":"16px"}},[t.form.photo?r("span",[r("span",{staticStyle:{margin:"10px 10px 10px 0"}},[t._v(t._s(t.$t("selected_file"))+": "+t._s(t.form.photo.name))]),t._v(" "),r("Button",{attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.clearPhoto()}}})],1):t._e(),t._v(" "),r("br"),t._v(" "),t.photo||t.new_photo?r("img",{staticStyle:{"max-width":"160px","max-height":"110px","border-radius":"4px 4px 0 0"},attrs:{alt:"photo",src:t.new_photo?t.new_photo:t.photo}}):t._e()]):t._e()],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("gallery_images"),prop:"images",error:t._f("a2s")(t.errors.form.images)}},[r("Upload",{attrs:{multiple:"","before-upload":t.handleImages,"max-size":2048,action:"",accept:".png, .jpeg, .jpg"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("\n                  "+t._s(t.$t("select_x",{x:t.$t("gallery_images")}))+"\n                ")])],1),t._v(" "),t.form.images.length?[r("span",{staticStyle:{margin:"10px 10px 10px 0"}},[t._v(t._s(t.$t("selected_file")))]),t._v(" "),t._l(t.form.images,(function(e,i){return r("span",{key:"gallery_"+i,staticClass:"primary",staticStyle:{margin:"0 16px 16px 0"}},[t._v("\n                  "+t._s(i+1)+". "+t._s(e.name)+"\n                  "),r("Button",{attrs:{type:"error",shape:"circle",size:"small",icon:"ios-trash"},on:{click:function(e){return t.deleteImage(i)}}})],1)}))]:t._e()],2),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("video_url"),prop:"video",error:t._f("a2s")(t.errors.form.video)}},[r("Input",{model:{value:t.form.video,callback:function(e){t.$set(t.form,"video",e)},expression:"form.video"}}),t._v(" "),r("small",[t._v(t._s(t.$t("video_tip")))])],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("summary"),prop:"summary",error:t._f("a2s")(t.errors.form.summary)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.summary,callback:function(e){t.$set(t.form,"summary",e)},expression:"form.summary"}})],1),t._v(" "),r("FormItem",{staticStyle:{"margin-bottom":"16px"},attrs:{prop:"details",label:t.$t("details"),error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:12}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.submit("items")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.submit("items",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"error",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},45504:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(7174),s=r.n(i),a=r(92704);const n={components:{ItemViewComponent:r(41944).Z,VueBarcode:s()},mixins:[(0,a.Z)("item","app/items","name","code","services")],data:function(){var t=this;return{row:{},view:!1,barModal:!1,barcodeSVG:null,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",width:200},{title:this.$t("code"),sortable:!0,key:"code",sortType:"asc",minWidth:150},{title:this.$t("cost"),sortable:!0,key:"cost",minWidth:125,render:this.renderCost},{title:this.$t("price"),sortable:!0,key:"price",minWidth:125,render:this.renderPrice},{title:this.$t("alt_name"),sortable:!0,key:"alt_name",minWidth:175},{title:this.$tc("category"),sortable:!1,key:"categories",minWidth:175,render:this.renderCategory},{title:this.$tc("taxes"),sortable:!1,key:"taxes",minWidth:200,render:this.renderTaxes},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("tax_method"),sortable:!0,key:"tax_included",minWidth:120,render:this.renderTaxMethod},{title:this.$t("changeable"),sortable:!0,key:"changeable",minWidth:120,render:this.renderChangeable},{title:this.$t("min_price"),sortable:!0,key:"min_price",minWidth:150,render:this.renderMinPrice},{title:this.$t("max_price"),sortable:!0,key:"max_price",minWidth:150,render:this.renderMaxPrice},{title:this.$t("max_discount"),sortable:!0,key:"max_discount",minWidth:150,render:this.renderMaxDiscount},{title:this.$t("summary"),sortable:!0,key:"summary",ellipsis:!0,minWidth:400},{title:this.$t("created_at"),sortable:!0,key:"created_at",minWidth:175,render:this.renderCreatedAt},{title:this.$t("updated_at"),sortable:!0,key:"updated_at",minWidth:175,render:this.renderUpdatedAt},{width:120,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,editFn:t.editRecord,labelFn:t.labelModal,deleteFn:t.deleteRecord,record:{model:"item",name:"name"},trailsFn:function(e){t.$router.push("/items/trails/"+e)}}})}}],options:{orderBy:"code",perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},mounted:function(){this.$store.getters.stock||(this.columns=this.columns.filter((function(t){return"stock"!=t.key})))},methods:{showInfo:function(t){this.row=t,this.view=!0},labelModal:function(t){var e=this;this.row=t,this.barModal=!0,this.barcodeSVG=this.$store.state.settings.svg_string.replace("--- Item Name ---",this.row.name).replace("--- Other info for item. ---",this.row.alt_name).replace("--- Price: 1,000.00 ---",this.$t("price")+": "+this.formatNumber(this.row.price)),this.$nextTick((function(){document.getElementById("replace-barcode").innerHTML="",document.getElementById("replace-barcode").removeAttribute("transform");var t=document.getElementById("drawBarcode").childNodes[0].cloneNode(!0);document.getElementById("replace-barcode").setAttribute("transform","matrix(1 0 0 1 10 "+(e.$store.state.settings.label_height-60)+")"),document.getElementById("replace-barcode").appendChild(t),1==e.$store.getters.settings.print_dialog&&setTimeout((function(){window.print()}),400)}))},print:function(){window.print()},renderChangeable:function(t,e){return this.renderBoolean(t,e,"changeable")},renderMinPrice:function(t,e){return this.renderNumber(t,e,"min_price")},renderMaxPrice:function(t,e){return this.renderNumber(t,e,"max_price")},renderMaxDiscount:function(t,e){return this.renderNumber(t,e,"max_discount")},renderCategory:function(t,e){return t("div",[e.row.categories.map((function(t){return t.name})).join("")])},renderCost:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.location_stock.length>0&&e.row.location_stock[0].cost?e.row.location_stock[0].cost:e.row.cost,this.$store.getters.settings.decimals)])},renderPrice:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.location_stock.length>0&&e.row.location_stock[0].price?e.row.location_stock[0].price:e.row.price,this.$store.getters.settings.decimals)])},renderStock:function(t,e){return t("div",{class:"text-center"},[e.row.location_stock.length>0?this.$options.filters.formatNumber(e.row.location_stock[0].quantity,this.$store.getters.settings.decimals):this.$options.filters.formatNumber(e.row.stock.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),this.$store.getters.settings.decimals)])},renderRack:function(t,e){return t("div",[e.row.location_stock.length>0&&e.row.location_stock[0].rack?e.row.location_stock[0].rack:e.row.location])},renderTaxMethod:function(t,e){return 1==e.row.tax_included?t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-success ivu-tag-border ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-success"},[this.$t("inclusive")])])]):t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-primary ivu-tag-border ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-primary"},[this.$t("exclusive")])])])},renderTaxes:function(t,e){return t("div",[e.row.taxes.map((function(t){return t.name})).join(", ")])}}};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("service",2)))]),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/items?type=service",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)]),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"500","footer-hide":!0,"mask-closable":!1,title:t.$t("print_x",{x:t.$t("barcode")})},model:{value:t.barModal,callback:function(e){t.barModal=e},expression:"barModal"}},[r("div",{staticClass:"label text-center",domProps:{innerHTML:t._s(t.barcodeSVG)}}),t._v(" "),r("div",{staticClass:"np"},[r("Divider",{attrs:{dashed:""}}),t._v(" "),r("div",{staticClass:"text-center",staticStyle:{display:"none"}},[r("vue-barcode",{attrs:{width:1,margin:0,height:30,fontSize:12,"margin-top":0,id:"drawBarcode",value:t.row.code,"margin-bottom":4,format:t.row.symbology}},[t._v("\n          "+t._s(t.$t("barcode_error"))+"\n        ")])],1),t._v(" "),r("Alert",{domProps:{innerHTML:t._s(t.$t("label_print_instructions"))}}),t._v(" "),r("Button",{staticClass:"np",attrs:{type:"primary",icon:"ios-print",long:""},on:{click:function(e){return t.print()}}},[t._v(t._s(t.$t("print")))])],1)]),t._v(" "),r("Modal",{attrs:{"footer-hide":"",scrollable:"",width:750},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[r("p",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("\n        "+t._s(t.row.name)+"\n        ("+t._s(t.row.code)+")\n      ")])]),t._v(" "),r("item-view-component",{attrs:{item:t.row}})],1)],1)}),[],!1,null,null,null).exports},45810:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>l});var i=r(48921);r(23279);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const o={mixins:[(0,i.Z)("location","app/locations",!0)],data:function(){return{logo:!1,accounts:[],countries:[],new_logo:!1,searching:!1,form:{id:"",name:"",color:"",email:"",phone:"",state:"",header:"",footer:"",address:"",country:"",attributes:{},company_id:"",registers:[{id:"",code:"",name:""}]},states:[{value:"",label:this.$t("select_country")}],rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],phone:[{required:!0,message:this.$t("field_is_required",{field:this.$t("phone")}),trigger:"blur"}],email:[{required:!0,message:this.$t("field_is_required",{field:this.$t("email")}),trigger:"blur"}],account_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("account")}),trigger:"change"}],country:[{trigger:"change",required:this.$store.getters.require_country,message:this.$t("field_is_required",{field:this.$t("country")})}],state:[{trigger:"change",required:this.$store.getters.require_country,message:this.$t("field_is_required",{field:this.$t("state")})}]}}},created:function(){var t=this;this.$http.get("app/accounts/search").then((function(e){return t.accounts=e.data})),this.$http.get("app/countries").then((function(e){return t.countries=e.data}))},methods:{create:function(){var t=this;this.$http.get("app/locations/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/locations/".concat(t)).then((function(t){e.attributes=t.data.attributes,delete t.data.attributes,e.logo=t.data.logo,delete t.data.logo,e.countryChange(t.data.country,t.data.state),t.data.state="",t.data.color=t.data.color||"",e.form=a(a({},t.data),t.data.extra_attributes),e.loading=!1})).catch((function(t){return e.$event.fire("appError",t.response)}))},countryChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t?(this.searching=!0,this.getStates(t,e),this.form.state=""):(this.form.state="",this.form.country="",this.states=[{value:"",label:this.$t("select_country")}])},getStates:function(t,e){var r=this;this.$http.get("app/states",{params:{country:t}}).then((function(t){r.states=t.data,e&&(r.form.state=r.states.find((function(t){return t.value==e})).value),r.searching=!1})).catch((function(t){return r.$event.fire("appError",t.response)}))},handleUpload:function(t){var e=this,r=new FileReader;return r.addEventListener("load",(function(){return e.new_logo=r.result}),!1),this.form.logo=t,r.readAsDataURL(t),!1},onSelect:function(t){t&&("mail_settings"==t?this.email=!0:"payment_settings"==t?this.payment=!0:this.$router.push({name:t}))},handleAdd:function(){this.form.registers.push({id:"",code:"",name:""})},handleRemove:function(t){this.form.registers.splice(t,1)}}};const l=(0,r(51900).Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("location")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/locations"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("location",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"location",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150,autocomplete:"off"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("phone"),prop:"phone",error:t._f("a2s")(t.errors.form.phone)}},[r("Input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("email"),prop:"email",error:t._f("a2s")(t.errors.form.email)}},[r("Input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"account_id",error:t._f("a2s")(t.errors.form.account_id),label:t.$t("default_x",{x:t.$tc("account")})}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.account_id,callback:function(e){t.$set(t.form,"account_id",e)},expression:"form.account_id"}},[t.accounts.length>0?t._l(t.accounts,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})):t._e()],2)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("account",2),prop:"accounts",error:t._f("a2s")(t.errors.form.accounts)}},[r("Select",{attrs:{multiple:"",placeholder:t.$t("select_x",{x:t.$tc("account",2)})},model:{value:t.form.accounts,callback:function(e){t.$set(t.form,"accounts",e)},expression:"form.accounts"}},[t.accounts.length>0?t._l(t.accounts,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})):t._e()],2)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("color"),prop:"color",error:t._f("a2s")(t.errors.form.color)}},[r("ColorPicker",{attrs:{recommend:""},model:{value:t.form.color,callback:function(e){t.$set(t.form,"color",e)},expression:"form.color"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("logo"),prop:"logo"}},[r("Upload",{attrs:{"before-upload":t.handleUpload,"max-size":500,action:""}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("select_logo_to_upload")))])],1),t._v(" "),t.new_logo?r("div",{staticClass:"primary"},[t._v(t._s(t.$t("selected_file"))+": "+t._s(t.form.logo.name))]):t._e(),t._v(" "),t.new_logo||t.logo?r("img",{staticStyle:{"max-width":"250px","max-height":"80px"},attrs:{src:t.new_logo?t.new_logo:t.logo,alt:"logo"}}):t._e()],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("house_no"),prop:"house_no",error:t._f("a2s")(t.errors.form.house_no)}},[r("Input",{model:{value:t.form.house_no,callback:function(e){t.$set(t.form,"house_no",e)},expression:"form.house_no"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("street_no"),prop:"street_no",error:t._f("a2s")(t.errors.form.street_no)}},[r("Input",{model:{value:t.form.street_no,callback:function(e){t.$set(t.form,"street_no",e)},expression:"form.street_no"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("address"),prop:"address",error:t._f("a2s")(t.errors.form.address)}},[r("Input",{model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("city"),prop:"city",error:t._f("a2s")(t.errors.form.city)}},[r("Input",{model:{value:t.form.city,callback:function(e){t.$set(t.form,"city",e)},expression:"form.city"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("postal_code"),prop:"postal_code",error:t._f("a2s")(t.errors.form.postal_code)}},[r("Input",{model:{value:t.form.postal_code,callback:function(e){t.$set(t.form,"postal_code",e)},expression:"form.postal_code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("country"),prop:"country",error:t._f("a2s")(t.errors.form.country)}},[r("Select",{attrs:{placeholder:"",filterable:"",autocomplete:"none"},on:{"on-change":t.countryChange},model:{value:t.form.country,callback:function(e){t.$set(t.form,"country",e)},expression:"form.country"}},t._l(t.countries,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("state"),prop:"state",error:t._f("a2s")(t.errors.form.state)}},[r("Select",{attrs:{placeholder:"",filterable:"",loading:t.searching,autocomplete:"none"},model:{value:t.form.state,callback:function(e){t.$set(t.form,"state",e)},expression:"form.state"}},t._l(t.states,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:24,xl:12}},[r("FormItem",{attrs:{label:t.$t("receipt_header"),prop:"header",error:t._f("a2s")(t.errors.form.header)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.header,callback:function(e){t.$set(t.form,"header",e)},expression:"form.header"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:24,xl:12}},[r("FormItem",{attrs:{label:t.$t("receipt_footer"),prop:"footer",error:t._f("a2s")(t.errors.form.footer)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.footer,callback:function(e){t.$set(t.form,"footer",e)},expression:"form.footer"}})],1)],1)],1),t._v(" "),r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("register",2)))]),t._v(" "),r("a",{attrs:{slot:"extra"},on:{click:t.handleAdd},slot:"extra"},[t._v("\n              "+t._s(t.$t("add_x",{x:t.$tc("register")}))+"\n            ")]),t._v(" "),r("Row",{attrs:{gutter:16}},t._l(this.form.registers,(function(e,i){return r("Col",{key:"reg_"+i,attrs:{sm:24,md:12,lg:12}},[r("Card",{class:{mt16:i>1},attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("register"))+" "+t._s(e.code?e.code:i+1))]),t._v(" "),r("a",{attrs:{slot:"extra"},on:{click:function(e){return t.handleRemove(i)}},slot:"extra"},[t._v("\n                    "+t._s(t.$t("remove"))+"\n                  ")]),t._v(" "),r("FormItem",{attrs:{label:t.$t("code"),prop:"reg_code"}},[r("Input",{model:{value:e.code,callback:function(r){t.$set(e,"code",r)},expression:"r.code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("name"),prop:"reg_name"}},[r("Input",{model:{value:e.name,callback:function(r){t.$set(e,"name",r)},expression:"r.name"}})],1)],1)],1)})),1)],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("locations")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("locations",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},54595:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("location","app/locations","name")],data:function(){var t=this;return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",sortType:"asc",minWidth:200},{title:this.$t("phone"),sortable:!0,key:"phone",width:150},{title:this.$t("email"),sortable:!0,key:"email",minWidth:200},{title:this.$tc("account"),sortable:!1,key:"account",minWidth:175,render:this.renderAccount},{title:this.$t("address"),sortable:!0,key:"address",minWidth:200,render:this.renderAddress},{title:this.$t("state"),sortable:!0,key:"state_name",maxWidth:150,minWidth:150},{title:this.$t("country"),sortable:!0,key:"country_name",maxWidth:150,minWidth:150},{title:this.$t("color"),sortable:!0,key:"color",width:100,render:this.renderColor},{title:this.$t("receipt_header"),sortable:!0,key:"header",minWidth:200},{title:this.$t("receipt_footer"),sortable:!0,key:"footer",minWidth:200},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:200,render:this.renderExtras},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,viewFn:t.viewModal,editFn:t.editRecord,deleteFn:t.deleteRecord,record:{model:"location",name:"name",title:t.$tc("location")}}})}}],options:{orderBy:"name",perPage:this.$store.state.settings.rows}}},methods:{renderAccount:function(t,e){return t("div",[e.row.account.name])},renderColor:function(t,e){return t("div",{style:{color:e.row.color,background:e.row.color,borderRadius:"4px"}},[e.row.color])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("location")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/locations/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add_x",{x:t.$tc("location")}))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/locations",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},19999:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>d});var i=r(48921),s=r(23279),a=r.n(s);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.options=t.options.map((function(t){return e.result.push(t.item),t.item_name=t.item.name,t.quantity=t.quantity?parseFloat(t.quantity):null,delete t.item,t})),e.form=o(o({},t),t.extra_attributes),e.form};const u={mixins:[(0,i.Z)("modifier","app/modifiers",!0,c)],data:function(){return{item:"",items:[],result:[],attributes:[],searching:!1,form:{id:"",code:"",name:"",show_as:"radio",details:"",options:[{sku:this.sku(),item_id:"",item_name:"",quantity:1}]},rules:{code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"}],title:[{required:!0,message:this.$t("field_is_required",{field:this.$t("title")}),trigger:"blur"}],name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],show_as:[{required:!0,message:this.$t("field_is_required",{field:this.$t("show_as")}),trigger:"change"}],cost:[{required:!0,type:"number",trigger:"change",message:this.$t("field_is_required",{field:this.$t("cost")})}],price:[{required:!0,type:"number",trigger:"change",message:this.$t("field_is_required",{field:this.$t("price")})}]}}},methods:{create:function(){var t=this;this.$http.get("app/modifiers/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/modifiers/".concat(t)).then((function(t){return c(t.data,e)})).finally((function(){return e.loading=!1}))},searchItems:function(t){""===(t=t.trim())||this.result.find((function(e){return e.id==t||e.name==t}))||this.getItems(t,this)},getItems:a()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/items/search?q="+t).then((function(t){return e.result=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),addOption:function(){this.form.options.push({sku:this.sku(),item_id:"",item_name:"",quantity:1})},deleteOption:function(t){this.form.options.splice(t,1)}}};const d=(0,r(51900).Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("modifier")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/modifiers"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("modifier",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"modifier",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:18,lg:12}},[r("FormItem",{attrs:{label:t.$t("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("title"),prop:"title",error:t._f("a2s")(t.errors.form.title)}},[r("Input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("show_as"),prop:"show_as",error:t._f("a2s")(t.errors.form.show_as)}},[r("Select",{model:{value:t.form.show_as,callback:function(e){t.$set(t.form,"show_as",e)},expression:"form.show_as"}},[r("Option",{attrs:{value:"radio"}},[t._v(t._s(t.$t("radio")))]),t._v(" "),r("Option",{attrs:{value:"checkbox"}},[t._v(t._s(t.$t("checkbox")))]),t._v(" "),r("Option",{attrs:{value:"select"}},[t._v(t._s(t.$t("select")))]),t._v(" "),r("Option",{attrs:{value:"select_multiple"}},[t._v(t._s(t.$t("select_multiple")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:6,lg:12}})],1),t._v(" "),r("FormItem",{attrs:{label:""}},[r("Card",{attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("options")))]),t._v(" "),r("Button",{attrs:{slot:"extra",size:"small",type:"success"},on:{click:t.addOption},slot:"extra"},[r("Icon",{attrs:{type:"ios-options"}}),t._v("\n                "+t._s(t.$t("add_x",{x:t.$tc("option")}))+"\n              ")],1),t._v(" "),r("div",{staticClass:"variants-form"},[r("div",{staticClass:"variant-table"},[r("table",{staticClass:"table"},[r("thead",[r("tr",[r("th",{staticStyle:{padding:"0","min-width":"150px"}},[t._v(t._s(t.$t("x_name",{x:t.$tc("item")})))]),t._v(" "),r("th",{staticStyle:{padding:"0","min-width":"100px",width:"200px"}},[t._v("\n                          "+t._s(t.$t("quantity"))+"\n                        ")]),t._v(" "),r("th",{staticStyle:{padding:"0","max-width":"40px","min-width":"40px",width:"40px"}},[r("icon",{attrs:{type:"md-trash"}})],1)])]),t._v(" "),r("tbody",t._l(t.form.options,(function(e,i){return r("tr",{key:"opt_"+i},[r("td",[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,label:e.item_name,"remote-method":t.searchItems},model:{value:e.item_id,callback:function(r){t.$set(e,"item_id",r)},expression:"option.item_id"}},t._l(t.result,(function(t,e){return r("Option",{key:"item_"+e,attrs:{value:t.id,label:t.name}})})),1)],1),t._v(" "),r("td",[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"option.quantity"}})],1),t._v(" "),r("td",{staticClass:"text-center"},[i?r("Icon",{staticClass:"pointer",attrs:{size:"16",color:"#ed3f14",type:"md-trash"},on:{click:function(e){return t.deleteOption(i)}}}):t._e()],1)])})),0)])])])],1)],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("modifiers")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("modifiers",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},81469:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("modifier","app/modifiers","title","reference")],data:function(){return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"asc",width:175,render:this.renderCreatedAt},{title:this.$t("code"),sortable:!0,key:"code",minWidth:150},{title:this.$t("title"),sortable:!0,key:"title",minWidth:200},{title:this.$tc("show_as"),sortable:!0,key:"show_as",width:200,render:this.renderShowAs},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:250},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:200,render:this.renderExtras},{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},methods:{renderShowAs:function(t,e){return t("div",[this.$t(e.row.show_as)])},renderOptions:function(t,e){var r=this,i=[];return e.row.options&&e.row.options.length&&(i=e.row.options.map((function(t){return"".concat(r.$t("name"),": ").concat(t.name,",\n                            ").concat(r.$t("cost"),": ").concat(t.cost,",\n                            ").concat(r.$t("price"),": ").concat(t.price,",\n                            ").concat(r.$t("quantity"),": ").concat(t.quantity)}))),console.log(i),t("div",[i])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("modifier",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/modifiers/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("modifier"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{columns:t.columns,options:t.options,refresh:t.refresh,url:"app/modifiers",dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords}})],1)],1)}),[],!1,null,null,null).exports},30714:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>b});var i=r(48921),s=r(23279),a=r.n(s),n=r(44605),o=r(41804);function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var h=function(t,e){t.amount=parseFloat(t.amount);var r="customer",i="",s="",a={id:t.payable.id,name:t.payable.name,value:t.payable.id,label:t.payable.name};return t.payable_type.indexOf("Supplier")>-1?(r="supplier",e.suppliers=[a],i=t.payable.id):(r="customer",e.customers=[a],s=t.payable.id),e.attachments=t.attachments&&t.attachments.length?d(t.attachments):[],e.form=c(c({},t),{},{type:r,customer_id:s,supplier_id:i}),e.form};const p={components:{StripeElementCard:o.UA},mixins:[n.Z,(0,i.Z)("payment","app/payments",!1,h)],data:function(){var t=this;return{accounts:[],customers:[],suppliers:[],gift_cards:[],gift_card:null,searching:!1,max_amount:null,form:{id:"",title:"",details:"",amount:null,reference:"",account_id:"",customer_id:"",supplier_id:"",sale_id:"",purchase_id:"",type:"customer",gateway:"",token:null,token_id:null,firstName:"",lastName:"",billingAddress1:"",billingCity:"",billingPostcode:"",billingState:"",billingCountry:""},rules:{title:[{required:!0,message:this.$t("field_is_required",{field:this.$t("title")}),trigger:"blur"}],account_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("account")}),trigger:"change"}],customer_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("customer")}),trigger:"change"}],supplier_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("supplier")}),trigger:"change"}],amount:[{required:!0,type:"number",validator:function(e,r,i){r&&""!=r?r&&t.max_amount&&r>t.max_amount?i(new Error(t.$t("payment_amount_error",{min:0,max:t.max_amount}))):i():i(new Error(t.$t("field_is_required",{field:t.$t("amount")})))},trigger:"blur"}],gateway:[{message:this.$t("field_is_required",{field:this.$t("gateway")}),trigger:"change"}],cheque_number:[{required:!0,message:this.$t("field_is_required",{field:this.$t("cheque_number")}),trigger:"blur"}],gift_card_number:[{required:!0,message:this.$t("field_is_required",{field:this.$t("gift_card_number")}),trigger:"blur"},{validator:function(e,r,i){r||i(),t.form.amount&&"gift_card"==t.form.gateway&&parseFloat(t.gift_card.balance)<t.form.amount?i(new Error(t.$t("gift_card_payment_error"))):i()},trigger:["change","blur"]}],card_holder:[{required:!0,message:this.$t("field_is_required",{field:this.$t("card_holder")}),trigger:"blur"}],card_number:[{required:!0,message:this.$t("field_is_required",{field:this.$t("card_number")}),trigger:"blur"}],expiry_date:[{required:!0,type:"date",message:this.$t("field_is_required",{field:this.$t("expiry_date")}),trigger:"blur"}],cvv:[{required:!0,message:this.$t("field_is_required",{field:this.$t("cvv")}),trigger:"blur"}],firstName:[{required:!0,message:this.$t("field_is_required",{field:this.$t("first_name")}),trigger:"blur"}],lastName:[{required:!0,message:this.$t("field_is_required",{field:this.$t("last_name")}),trigger:"blur"}],billingAddress1:[{required:!0,message:this.$t("field_is_required",{field:this.$t("billing_address")}),trigger:"blur"}],billingCity:[{required:!0,message:this.$t("field_is_required",{field:this.$t("billing_city")}),trigger:"blur"}],billingPostcode:[{required:!0,message:this.$t("field_is_required",{field:this.$t("billing_postcode")}),trigger:"blur"}],billingState:[{required:!0,message:this.$t("field_is_required",{field:this.$t("billing_state")}),trigger:"blur"}],billingCountry:[{required:!0,message:this.$t("field_is_required",{field:this.$t("billing_country")}),trigger:"blur"}]}}},watch:{"paymentForm.swipe":function(t,e){var r=this;t&&"%"==t.charAt(0)?setTimeout((function(){var e=t.split("^"),i=e&&e[1]?e[1].split("/"):"",s=i?i[0].trim().split(".")[0]:"",a=i&&i[1]?i[1].trim():"",n=e&&e[2]?e[2].substring(2,4)+"/"+e[2].substring(0,2):"",o=e&&e[2]?e[2].split(";"):"",l=o&&o[1]?o[1].split("="):null,c=l&&l[1]?l[1].trim():null,u=c?c.substring(2,4)+"/"+c.substring(0,2):n;r.form.card_number=e[0].substring(2),r.form.expiry_date=u||n,r.form.card_holder="".concat(a," ").concat(s),r.$nextTick((function(){this.form.swipe="",document.querySelector("#cvv").focus()}))}),400):t?(this.errors.payment.swipe=this.$t("unknown_value"),document.querySelector("#swipe_holder").classList.add("ivu-form-item-error")):(this.errors.payment.swipe="",document.querySelector("#swipe_holder").classList.remove("ivu-form-item-error"))}},created:function(){var t=this;this.$route.query.sale_id&&(this.form.sale_id=this.$route.query.sale_id),this.$route.query.customer_id&&(this.form.type="customer",this.form.customer_id=this.$route.query.customer_id),this.$route.query.purchase_id&&(this.form.purchase_id=this.$route.query.purchase_id),this.$route.query.supplier_id&&(this.form.type="supplier",this.form.supplier_id=this.$route.query.supplier_id),this.$route.query.amount&&(this.max_amount=this.form.amount=parseFloat(this.$route.query.amount)),this.$http.get("app/accounts/search").then((function(e){return t.accounts=e.data}))},methods:{fetch:function(t){var e=this;this.$http.get("app/payments/".concat(t)).then((function(t){return h(t.data,e)})).finally((function(){return e.loading=!1}))},handleSubmit:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$refs.payment.validate((function(i){i?"PayPal_Pro"==e.form.gateway||"PayPal_Rest"==e.form.gateway||"AuthorizeNetApi_Api"==e.form.gateway?e.$refs.cardForm.validate((function(i){i?(e.loading=!0,e.submit(t,r)):e.$Notice.error({title:e.$t("invalid_form"),desc:e.$t("invalid_form_error"),duration:10})})):(e.loading=!0,"Stripe"!=e.form.gateway||e.form.token_id?e.submit(t,r):e.$refs.stripeCard.submit()):e.$Notice.error({title:e.$t("invalid_form"),desc:e.$t("invalid_form_error"),duration:10})}))},tokenCreated:function(t){this.form.token=t,this.form.token_id=t.id,this.submit()},searchCustomers:function(t){""===t||this.customers.find((function(e){return e.label==t}))||this.getCustomers(t,this)},getCustomers:a()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/customers/search?q="+t).then((function(t){return e.customers=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),searchSuppliers:function(t){""===t||this.suppliers.find((function(e){return e.label==t}))||this.getSuppliers(t,this)},getSuppliers:a()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/suppliers/search?q="+t).then((function(t){return e.suppliers=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),updatePaymentFormFocus:function(){var t=this;this.form.gateway&&"cash"!=this.form.gateway&&"other"!=this.form.gateway&&"Stripe"!=this.form.gateway&&this.form.gateway!=this.$store.getters.payment.gateway&&(this.$refs.payment.fields.map((function(t){"type"!=t.prop&&"amount"!=t.prop&&"gateway"!=t.prop&&"details"!=t.prop&&"account_id"!=t.prop&&"reference"!=t.prop&&"customer_id"!=t.prop&&"supplier_id"!=t.prop&&t.resetField()})),setTimeout((function(){return document.querySelector("#"+t.form.gateway)?document.querySelector("#"+t.form.gateway).focus():""}),100))},giftCardSelected:function(t){this.gift_card=this.gift_cards.find((function(e){return e.number==t}))},searchGiftCard:function(t){this.getGiftCard(t,this)},getGiftCard:a()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/gift_cards/search?q="+t).then((function(t){1==t.data.length?(e.gift_card=t.data[0],e.form.gift_card_number=t.data[0].number):e.gift_cards=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250)}};var f=r(93379),_=r.n(f),v=r(52080),g={insert:"head",singleton:!1};_()(v.Z,g);v.Z.locals;const b=(0,r(51900).Z)(p,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("payment")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/payments"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("payment",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"payment",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,xl:12}},[r("FormItem",{attrs:{label:t.$t("type"),prop:"type",error:t._f("a2s")(t.errors.form.type)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[r("Option",{attrs:{value:"customer"}},[t._v(t._s(t.$tc("customer")))]),t._v(" "),r("Option",{attrs:{value:"supplier"}},[t._v(t._s(t.$tc("supplier")))])],1)],1),t._v(" "),"customer"==t.form.type?r("FormItem",{attrs:{prop:"customer_id",label:t.$tc("customer"),error:t._f("a2s")(t.errors.form.customer_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchCustomers,placeholder:t.$t("type_to_search_x",{x:t.$tc("customer")})},model:{value:t.form.customer_id,callback:function(e){t.$set(t.form,"customer_id",e)},expression:"form.customer_id"}},t._l(t.customers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1):t._e(),t._v(" "),"supplier"==t.form.type?r("FormItem",{attrs:{prop:"supplier_id",label:t.$tc("supplier"),error:t._f("a2s")(t.errors.form.supplier_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchSuppliers,placeholder:t.$t("type_to_search_x",{x:t.$tc("supplier")})},model:{value:t.form.supplier_id,callback:function(e){t.$set(t.form,"supplier_id",e)},expression:"form.supplier_id"}},t._l(t.suppliers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1):t._e(),t._v(" "),r("FormItem",{attrs:{label:t.$tc("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("account"),prop:"account_id",error:t._f("a2s")(t.errors.form.account_id)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.account_id,callback:function(e){t.$set(t.form,"account_id",e)},expression:"form.account_id"}},[t.accounts.length>0?t._l(t.accounts,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n                      "+t._s(e.label)+"\n                    ")])})):t._e()],2)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("amount"),prop:"amount",error:t._f("a2s")(t.errors.form.amount)}},[r("InputNumber",{model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("gateway"),prop:"gateway",error:t.errors.form.gateway}},[r("Select",{attrs:{placeholder:""},on:{"on-change":function(e){return t.updatePaymentFormFocus()}},model:{value:t.form.gateway,callback:function(e){t.$set(t.form,"gateway",e)},expression:"form.gateway"}},[r("Option",{attrs:{value:""}},[t._v(t._s(t.$t("requesting")))]),t._v(" "),"customer"==t.form.type&&t.$store.getters.gateway?r("Option",{attrs:{value:t.$store.getters.gateway}},[t._v("\n                    "+t._s(t.$t(t.$store.getters.gateway))+"\n                  ")]):t._e(),t._v(" "),r("Option",{attrs:{value:"cash"}},[t._v(t._s(t.$t("cash")))]),t._v(" "),r("Option",{attrs:{value:"cheque"}},[t._v(t._s(t.$t("cheque")))]),t._v(" "),r("Option",{attrs:{value:"gift_card"}},[t._v(t._s(t.$tc("gift_card")))]),t._v(" "),r("Option",{attrs:{value:"credit_card"}},[t._v(t._s(t.$t("credit_card"))+" ("+t._s(t.$t("record"))+")")]),t._v(" "),r("Option",{attrs:{value:"other"}},[t._v(t._s(t.$t("other")))])],1)],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},["Stripe"==t.form.gateway?r("FormItem",{staticClass:"mb0"},[r("stripe-card-elements",{ref:"stripeCard",staticClass:"stripe-card",attrs:{amount:t.form.amount,pk:t.$store.state.payment.public_key},on:{token:t.tokenCreated,loading:function(e){t.loading=e}}})],1):"PayPal_Pro"==t.form.gateway||"PayPal_Rest"==t.form.gateway||"AuthorizeNetApi_Api"==t.form.gateway?r("FormItem",[r("Card",{attrs:{"dis-hover":""}},[r("Form",{ref:"cardForm",staticClass:"form-top",attrs:{model:t.form,rules:t.rules,"label-position":"top"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("first_name"),prop:"firstName",error:t._f("a2s")(t.errors.form.firstName)}},[r("Input",{model:{value:t.form.firstName,callback:function(e){t.$set(t.form,"firstName",e)},expression:"form.firstName"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("last_name"),prop:"lastName",error:t._f("a2s")(t.errors.form.lastName)}},[r("Input",{model:{value:t.form.lastName,callback:function(e){t.$set(t.form,"lastName",e)},expression:"form.lastName"}})],1)],1)],1),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:16,lg:16}},[r("FormItem",{attrs:{label:t.$tc("billing_address"),prop:"billingAddress1",error:t._f("a2s")(t.errors.form.billingAddress1)}},[r("Input",{model:{value:t.form.billingAddress1,callback:function(e){t.$set(t.form,"billingAddress1",e)},expression:"form.billingAddress1"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{label:t.$tc("billing_city"),prop:"billingCity",error:t._f("a2s")(t.errors.form.billingCity)}},[r("Input",{model:{value:t.form.billingCity,callback:function(e){t.$set(t.form,"billingCity",e)},expression:"form.billingCity"}})],1)],1)],1),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{label:t.$tc("billing_postcode"),prop:"billingPostcode",error:t._f("a2s")(t.errors.form.billingPostcode)}},[r("Input",{model:{value:t.form.billingPostcode,callback:function(e){t.$set(t.form,"billingPostcode",e)},expression:"form.billingPostcode"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{label:t.$tc("billing_state"),prop:"billingState",error:t._f("a2s")(t.errors.form.billingState)}},[r("Input",{model:{value:t.form.billingState,callback:function(e){t.$set(t.form,"billingState",e)},expression:"form.billingState"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{label:t.$tc("billing_country"),prop:"billingCountry",error:t._f("a2s")(t.errors.form.billingCountry)}},[r("Input",{model:{value:t.form.billingCountry,callback:function(e){t.$set(t.form,"billingCountry",e)},expression:"form.billingCountry"}})],1)],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("card_number"),prop:"card_number",error:t._f("a2s")(t.errors.form.card_number)}},[r("Input",{model:{value:t.form.card_number,callback:function(e){t.$set(t.form,"card_number",e)},expression:"form.card_number"}})],1),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:16,lg:16}},[r("FormItem",{attrs:{label:t.$t("expiry_date"),prop:"expiry_date",error:t.errors.form.expiry_date}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"month",format:"MM/yyyy"},model:{value:t.form.expiry_date,callback:function(e){t.$set(t.form,"expiry_date",e)},expression:"form.expiry_date"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{label:t.$tc("cvv"),prop:"cvv",error:t._f("a2s")(t.errors.form.cvv)}},[r("Input",{model:{value:t.form.cvv,callback:function(e){t.$set(t.form,"cvv",e)},expression:"form.cvv"}})],1)],1)],1)],1)],1)],1):"credit_card"==t.form.gateway?r("span",[r("FormItem",{attrs:{error:t.errors.form.swipe,id:"swipe_holder"}},[r("Input",{attrs:{placeholder:t.$t("swipe_card_text"),"element-id":"credit_card"},model:{value:t.form.swipe,callback:function(e){t.$set(t.form,"swipe",e)},expression:"form.swipe"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("card_holder"),prop:"card_holder",error:t.errors.form.card_holder}},[r("Input",{model:{value:t.form.card_holder,callback:function(e){t.$set(t.form,"card_holder",e)},expression:"form.card_holder"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("card_number"),prop:"card_number",error:t.errors.form.card_number}},[r("Input",{model:{value:t.form.card_number,callback:function(e){t.$set(t.form,"card_number",e)},expression:"form.card_number"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("expiry_date"),prop:"expiry_date",error:t.errors.form.expiry_date}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"month",format:"MM/yyyy"},model:{value:t.form.expiry_date,callback:function(e){t.$set(t.form,"expiry_date",e)},expression:"form.expiry_date"}})],1)],1):"gift_card"==t.form.gateway?r("span",[r("FormItem",{attrs:{label:t.$t("gift_card_number"),prop:"gift_card_number",error:t.errors.form.gift_card_number}},[r("AutoComplete",{staticStyle:{width:"100%"},attrs:{icon:"ios-search","element-id":"gift_card"},on:{"on-search":t.searchGiftCard,"on-select":t.giftCardSelected},model:{value:t.form.gift_card_number,callback:function(e){t.$set(t.form,"gift_card_number",e)},expression:"form.gift_card_number"}},t._l(t.gift_cards,(function(e,i){return r("Option",{key:"gift_card_"+i,attrs:{value:e.number}},[t._v(t._s(e.number))])})),1),t._v(" "),t.gift_card&&t.gift_card.number?r("span",[t._v("\n                      "+t._s(t.$t("balance"))+": "+t._s(t._f("formatNumber")(t.gift_card.balance,t.$store.state.settings.decimals))+"\n                    ")]):t._e()],1)],1):"cheque"==t.form.gateway?r("span",[r("FormItem",{attrs:{label:t.$t("cheque_number"),prop:"cheque_number",error:t.errors.form.cheque_number}},[r("Input",{attrs:{"element-id":"cheque"},model:{value:t.form.cheque_number,callback:function(e){t.$set(t.form,"cheque_number",e)},expression:"form.cheque_number"}})],1)],1):t._e()],1),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("payments")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("payments",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},26736:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var i=r(92704);function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const a={components:{PaymentViewComponent:r(24874).Z},mixins:[(0,i.Z)("payment","app/payments","reference")],data:function(){var t,e=this;return{view:!1,loading:!1,payment:{},columns:[{type:"selection",width:50,align:"center",fixed:"left"},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("amount"),sortable:!1,key:"amount",width:150,render:this.renderAmount},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{title:this.$t("gateway"),sortable:!1,key:"gateway",width:150,render:this.renderGateway},{key:"for",maxWidth:300,minWidth:200,sortable:!1,title:this.$tc("account"),render:this.renderAccount},{key:"for",maxWidth:300,minWidth:200,sortable:!1,render:this.renderPayable,title:this.$tc("created_for")},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("received"),sortable:!0,key:"received",width:100,render:this.renderIconReceived},(t={title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0},s(t,"ellipsis",!0),s(t,"minWidth",250),s(t,"maxWidth",400),t),{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(t,r){return t("actions-dropdown-component",{props:{params:r,viewFn:e.viewModal,editFn:e.editRecord,emailFn:e.emailRecord,reviewFn:e.reviewRecord,deleteFn:e.deleteRecord,downloadFn:e.downloadRecord,record:{model:"payment",name:"reference",title:e.$tc("payment")}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},computed:{url:function(){return"app/payments"+(this.$route.query.review?"?review="+parseInt(this.$route.query.review):this.$route.query.due?"?due="+parseInt(this.$route.query.due):"")}},watch:{"$route.query.due":function(){this.refresh++},"$route.query.review":function(){this.refresh++}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.payment.id&&(this.loading=!0,this.$http.get("app/payments/".concat(t.id)).then((function(t){return e.payment=t.data})).finally((function(){return e.loading=!1})))},emailRecord:function(t){var e=this;this.$http.post("app/payments/email/"+t.id,{}).then((function(t){t.data.success?e.$Notice.success({title:e.$t("email_sent"),desc:e.$t("email_sent_text")}):e.$Notice.error({title:e.$tc("failed"),desc:e.$t("failed_error_text")})}))},downloadRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"download/payments/"+t.id}).click()},reviewRecord:function(t){var e=this;1!=t.review||t.reviewed_by||t.received||this.$http.post("app/payments/review/"+t.id,{}).then((function(t){t.data.success?(e.refresh++,e.view=!1,e.payment={},e.$Notice.success({title:e.$t("success"),desc:e.$t("review_payment_text")})):e.$Notice.error({title:e.$tc("failed"),desc:e.$t("failed_error_text")})}))},viewRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"view/payment/"+t.hash}).click()},renderAccount:function(t,e){return t("div",[e.row.account?e.row.account.name:""])},gatewayColor:function(t){var e={cash:"success",credit_card:"geekblue",cheque:"green",other:"purple"};return e[t]?e[t]:"primary"},renderGateway:function(t,e){return t("div",{class:"text-center"},[e.row.gateway?t("div",{class:"ivu-tag ivu-tag-".concat(this.gatewayColor(e.row.gateway)," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.$t(e.row.gateway)])]):""])},renderPayable:function(t,e){return t("div",[e.row.payable.name])},renderAmount:function(t,e){return this.renderNumber(t,e,"amount")},renderIconReceived:function(t,e){return this.renderBoolean(t,e,"received")}}};const n=(0,r(51900).Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("payment",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/payments/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add_x",{x:t.$tc("payment")}))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("payment")+" ("+t.payment.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("payment-view-component",{attrs:{payment:t.payment,review:t.reviewRecord},on:{remove:function(e){return t.deleteAttachment(e,t.payment)}}})],1)],1)}),[],!1,null,null,null).exports},73682:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>u});var i=r(48921),s=r(23279),a=r.n(s);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var l=function(t,e){return t.discount=t.discount?parseFloat(t.discount):null,t.amount_to_spend=t.amount_to_spend?parseFloat(t.amount_to_spend):null,t.quantity_to_buy=t.quantity_to_buy?parseFloat(t.quantity_to_buy):null,t.quantity_to_get=t.quantity_to_get?parseFloat(t.quantity_to_get):null,(t.items||t.item_id_to_buy)&&(e.items=t.items.map((function(t){return{label:t.name+" ("+t.code+")",value:t.id}})),t.item_id_to_get&&e.items.push({label:t.item_to_get.name+" ("+t.item_to_get.code+")",value:t.item_to_get.id})),t.categories&&(t.categories=t.categories.map((function(t){return t.id}))),e.form=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),e.form};const c={mixins:[(0,i.Z)("promo","app/promos",!1,l)],data:function(){return{logo:!1,new_logo:!1,searching:!1,items:[],accounts:[],categories:[],form:{id:"",name:"",items:[],active:"1",details:"",end_date:"",discount:null,categories:[],start_date:"",type:"simple",item_id_to_buy:"",item_id_to_get:"",quantity_to_buy:null,quantity_to_get:null,amount_to_spend:null,discount_method:"percentage"},errors:{message:"",form:{}},rules:{type:[{required:!0,message:this.$t("field_is_required",{field:this.$t("type")}),trigger:"change"}],name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],amount_to_spend:[{required:!0,type:"number",trigger:["blur","change"],message:this.$t("field_is_required",{field:this.$t("amount_to_spend")})}],items:[{type:"array",required:!1,trigger:"change",message:this.$t("field_is_required",{field:this.$tc("item",2)})}],categories:[{type:"array",required:!1,trigger:"change",message:this.$t("field_is_required",{field:this.$tc("category",2)})}],discount:[{required:!0,type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("discount")})}],discount_method:[{required:!0,message:this.$t("field_is_required",{field:this.$t("discount_method")}),trigger:"blur"}],item_id_to_buy:[{required:!0,message:this.$t("field_is_required",{field:this.$t("item_to_buy")}),trigger:"blur"}],quantity_to_buy:[{required:!0,type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("quantity_to_buy")})}],item_id_to_get:[{required:!0,message:this.$t("field_is_required",{field:this.$t("item_to_get")}),trigger:"blur"}],quantity_to_get:[{required:!0,type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("quantity_to_get")})}]}}},created:function(){var t=this;this.$http.get("app/categories/search").then((function(e){return t.categories=e.data})).finally((function(){return t.loading=!1}))},methods:{fetch:function(t){var e=this;this.$http.get("app/promos/".concat(t)).then((function(t){return e.form=l(t.data,e)})).then((function(){e.form.items=e.items.map((function(t){return t.value})),e.form.item_id_to_buy&&(e.form.item_id_to_buy="",e.form.item_id_to_get="",e.$nextTick((function(){e.form.item_id_to_buy=e.form.item_to_buy.id,e.form.item_id_to_get=e.form.item_to_get.id})))})).finally((function(){return e.loading=!1}))},searchItems:function(t){this.getItems(t,this)},getItems:a()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/items/search?select=1&q="+t).then((function(t){return e.items=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),handleSubmit:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.$refs.promo.validate((function(i){i?"BXGY"==e.form.type?e.submit(t,r):e.form.items.length||e.form.categories.length?(console.log("items"),e.submit(t,r)):(e.errors.message=e.$t("select_items_or_categories"),e.$Notice.error({title:e.$t("invalid_form"),desc:e.$t("select_items_or_categories"),duration:10})):e.$Notice.error({title:e.$t("invalid_form"),desc:e.$t("invalid_form_error"),duration:10})}))}}};const u=(0,r(51900).Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("promo")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/promos"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("promo",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"promo",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("type"),prop:"type",error:t._f("a2s")(t.errors.form.type)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[r("Option",{attrs:{value:"simple"}},[t._v(t._s(t.$t("simple_discount")))]),t._v(" "),r("Option",{attrs:{value:"advance"}},[t._v(t._s(t.$t("advance_discount")))]),t._v(" "),r("Option",{attrs:{value:"BXGY"}},[t._v(t._s(t.$t("buy_x_get_y")))]),t._v(" "),r("Option",{attrs:{value:"SXGD"}},[t._v(t._s(t.$t("spend_x_get_discount")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("start_date"),prop:"start_date",error:t._f("a2s")(t.errors.form.start_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.start_date,callback:function(e){t.$set(t.form,"start_date",e)},expression:"form.start_date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("end_date"),prop:"end_date",error:t._f("a2s")(t.errors.form.end_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.end_date,callback:function(e){t.$set(t.form,"end_date",e)},expression:"form.end_date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("transition",{attrs:{name:"slide-fade"}},["BXGY"==t.form.type?r("span",[r("FormItem",{attrs:{prop:"item_id_to_buy",label:t.$t("item_to_buy"),error:t._f("a2s")(t.errors.item_id_to_buy)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchItems},model:{value:t.form.item_id_to_buy,callback:function(e){t.$set(t.form,"item_id_to_buy",e)},expression:"form.item_id_to_buy"}},t._l(t.items,(function(e,i){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{prop:"quantity_to_buy",label:t.$t("quantity_to_buy"),error:t._f("a2s")(t.errors.quantity_to_buy)}},[r("InputNumber",{model:{value:t.form.quantity_to_buy,callback:function(e){t.$set(t.form,"quantity_to_buy",e)},expression:"form.quantity_to_buy"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"item_id_to_get",label:t.$t("item_to_get"),error:t._f("a2s")(t.errors.item_id_to_get)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchItems},model:{value:t.form.item_id_to_get,callback:function(e){t.$set(t.form,"item_id_to_get",e)},expression:"form.item_id_to_get"}},t._l(t.items,(function(e,i){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{prop:"quantity_to_get",label:t.$t("quantity_to_get"),error:t._f("a2s")(t.errors.quantity_to_get)}},[r("InputNumber",{model:{value:t.form.quantity_to_get,callback:function(e){t.$set(t.form,"quantity_to_get",e)},expression:"form.quantity_to_get"}})],1)],1):t._e()]),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},["SXGD"==t.form.type?r("span",[r("FormItem",{attrs:{prop:"amount_to_spend",label:t.$t("amount_to_spend"),error:t._f("a2s")(t.errors.form.amount_to_spend)}},[r("InputNumber",{model:{value:t.form.amount_to_spend,callback:function(e){t.$set(t.form,"amount_to_spend",e)},expression:"form.amount_to_spend"}})],1)],1):t._e()]),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},["BXGY"!=t.form.type?r("span",[r("FormItem",{attrs:{label:t.$tc("item",2),prop:"items",error:t._f("a2s")(t.errors.form.items)}},[r("Select",{attrs:{remote:"",multiple:"",filterable:"",loading:t.searching,"remote-method":t.searchItems},model:{value:t.form.items,callback:function(e){t.$set(t.form,"items",e)},expression:"form.items"}},t._l(t.items,(function(e,i){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("category",2),prop:"categories",error:t._f("a2s")(t.errors.form.categories)}},[r("Select",{attrs:{multiple:""},model:{value:t.form.categories,callback:function(e){t.$set(t.form,"categories",e)},expression:"form.categories"}},t._l(t.categories,(function(e,i){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1):t._e()]),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},["advance"==t.form.type?r("span",[r("FormItem",{attrs:{prop:"quantity_to_buy",label:t.$t("quantity_to_buy"),error:t._f("a2s")(t.errors.form.quantity_to_buy)}},[r("InputNumber",{model:{value:t.form.quantity_to_buy,callback:function(e){t.$set(t.form,"quantity_to_buy",e)},expression:"form.quantity_to_buy"}})],1)],1):t._e()]),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},["simple"==t.form.type||"advance"==t.form.type||"SXGD"==t.form.type?r("span",[r("FormItem",{attrs:{label:t.$t("discount_"),prop:"discount",error:t._f("a2s")(t.errors.form.discount)}},[r("InputNumber",{model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1)],1):t._e()])],1)],1),t._v(" "),r("FormItem",{attrs:{prop:"active",error:t._f("a2s")(t.errors.form.active)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.active,callback:function(e){t.$set(t.form,"active",e)},expression:"form.active"}},[r("span",[t._v(t._s(t.$t("active")))])])],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("promos")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("promos",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},76742:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const s={mixins:[(0,r(92704).Z)("promo","app/promos","reference")],data:function(){var t;return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("type"),sortable:!0,key:"type",width:100},{title:this.$t("name"),sortable:!0,key:"name",width:150},{title:this.$t("active"),sortable:!0,key:"active",width:80,render:this.renderIconActive},{title:this.$t("start_date"),sortable:!0,key:"start_date",width:110,render:this.renderDate},{title:this.$t("end_date"),sortable:!0,key:"end_date",width:110,render:this.renderDate},{title:this.$t("discount"),sortable:!0,key:"discount",width:110,render:this.renderDiscount},{title:this.$t("item_to_buy"),sortable:!0,key:"item_to_buy",width:150,render:this.renderItem2Buy},{title:this.$t("quantity_to_buy"),sortable:!0,key:"quantity_to_buy",width:140,render:this.renderQty2Buy},{title:this.$t("item_to_get"),sortable:!0,key:"item_to_get",width:150,render:this.renderItem2Get},{title:this.$t("quantity_to_get"),sortable:!0,key:"quantity_to_get",width:140,render:this.renderQty2Get},(t={title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0},i(t,"ellipsis",!0),i(t,"minWidth",250),i(t,"maxWidth",400),t),{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},methods:{renderDiscount:function(t,e){return this.renderNumber(t,e,"discount",!1,!1,"%")},renderItem2Buy:function(t,e){return t("div",[e.row.item_to_buy?e.row.item_to_buy.name:""])},renderItem2Get:function(t,e){return t("div",[e.row.item_to_get?e.row.item_to_get.name:""])},renderQty2Buy:function(t,e){return e.row.quantity_to_buy?this.renderNumber(t,e,"quantity_to_buy"):""},renderQty2Get:function(t,e){return e.row.quantity_to_get?this.renderNumber(t,e,"quantity_to_get"):""},renderIconActive:function(t,e){return this.renderBoolean(t,e,"active")}}};const a=(0,r(51900).Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("promo",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/promos/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("promo"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/promos",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},38650:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>_});var i=r(21490),s=r(61402);const a={props:{editItem:{type:Function},deleteItem:{type:Function},calcRowTotal:{type:Function},customer:{type:[Boolean,Object]},row:{type:Object,required:!0},deleteItemVariation:{type:Function},index:{type:Number,required:!0},itemVariationQuantityChanged:{type:Function}}};var n=r(51900);const o=(0,n.Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order-item"},[r("span",{staticClass:"item"},[r("span",{staticClass:"index"},[t._v(t._s(t.index+1))]),t._v(" "),r("span",{staticClass:"remove"},[t.row.selected.variations&&!t.row.selected.variations.length?r("span",[r("Icon",{staticClass:"pointer",attrs:{size:"18",type:"md-close",color:"#ed4014"},on:{click:function(e){return t.deleteItem(t.row)}}})],1):t._e()]),t._v(" "),r("span",{staticClass:"details pointer",on:{click:function(e){return t.editItem(t.index)}}},[r("strong",[t._v(t._s(t.row.name))]),t._v(" "),r("br"),t._v(" "),r("span",[t.customer&&t.customer.customer_group?r("span",{domProps:{innerHTML:t._s(t.customer.customer_group.name+" (<small>"+t.$t("discount")+": "+t.customer.customer_group.discount+"%</small>)<br />")}}):t._e(),t._v(" "),t.row.comment?r("span",[t._v(t._s(t.row.comment)+" ")]):t._e()])]),t._v(" "),t.row.selected.variations&&!t.row.selected.variations.length?[r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(t.row.cost))+"\n        ")]),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length,size:t.row.selected.variations.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(t.row.taxes,(function(e){return r("div",{key:"tax_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber(t.calcRowTotal(t.row)))+"\n      ")])]:[r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length,size:t.row.selected.variations.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})]],2),t._v(" "),t.row.selected.variations&&t.row.selected.variations.length?t._l(t.row.selected.variations,(function(e,i){return r("div",{key:"svi_"+i,staticClass:"combo-item variation"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.deleteItemVariation(t.row,e)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n        "+t._s(i+1)+".\n        "),r("span",{domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(e.cost))+"\n      ")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n        "+t._s(t.formatNumber(e.discount_amount))+"\n      ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{on:{"on-change":function(e){return t.itemVariationQuantityChanged(t.form.items[t.index])}},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"sv.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(e){return r("div",{key:"sv_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber((e.cost-(e.discount_amount||0)+e.total_tax_amount)*e.quantity))+"\n      ")])])})):t._e()],2)}),[],!1,null,null,null).exports;const l={props:{serials:{type:Array,twoWay:!0,required:!0},quantity:{type:Number,required:!0}},computed:{provided:function(){var t=this;return this.serials.reduce((function(e,r){return e+t.countSerials(r.number,r.till)}),0)}},methods:{countSerials:function(t,e){if(!t&&!e)return 0;if(t&&!e)return 1;var r=e-t;return r>0?r+1:e==t?1:"?"},addNew:function(t){this.provided<this.quantity&&this.quantity>t+1&&t==this.serials.length-1&&this.serials.push({number:"",till:""})}}};var c=r(93379),u=r.n(c),d=r(5423),m={insert:"head",singleton:!1};u()(d.Z,m);d.Z.locals;const h=(0,n.Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t._l(t.serials,(function(e,i){return r("div",{key:"serial_"+i,staticClass:"mb16"},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"mb0",attrs:{label:t.$tc("serial_number"),prop:"serial"}},[r("Input",{on:{"on-focus":function(e){return t.addNew(i)}},model:{value:e.number,callback:function(r){t.$set(e,"number",r)},expression:"serial.number"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("till"),prop:"serial"}},[r("Input",{model:{value:e.till,callback:function(r){t.$set(e,"till",r)},expression:"serial.till"}})],1)],1)],1)],1)})),t._v(" "),r("div",{staticClass:"sr-info",class:t.provided>t.quantity?"sr-error":""},[t._v("\n    "+t._s(t.$t("total_serials",{n:t.provided,serials:t.$tc("serial_number",t.provided),total:t.quantity}))+"\n  ")])],2)}),[],!1,null,null,null).exports,p={props:{taxes:{type:Array},deleteItem:{type:Function},updateItem:{type:Function},itemUnitChanged:{type:Function},edit_item:{type:Object,required:!0},expiryDateOptions:{type:Object,required:!0}},components:{ItemSerialComponent:h}};const f={components:{EditRowItemComponent:(0,n.Z)(p,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("FormItem",{attrs:{label:t.$t("quantity"),prop:"quantity"}},[r("InputNumber",{attrs:{size:"large"},model:{value:t.edit_item.quantity,callback:function(e){t.$set(t.edit_item,"quantity",e)},expression:"edit_item.quantity"}})],1),t._v(" "),1==t.edit_item.has_serials?r("div",{staticClass:"mt16 mb16"},[r("item-serial-component",{attrs:{serials:t.edit_item.selected.serials,quantity:t.edit_item.quantity}})],1):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.allUnits&&t.edit_item.allUnits.length>0?r("FormItem",{attrs:{label:t.$tc("unit")}},[r("Select",{staticStyle:{width:"100%"},on:{"on-change":t.itemUnitChanged},model:{value:t.edit_item.unit_id,callback:function(e){t.$set(t.edit_item,"unit_id",e)},expression:"edit_item.unit_id"}},t._l(t.edit_item.allUnits,(function(e,i){return r("Option",{key:"unit_"+i+"_"+e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),1)],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("cost"),prop:"cost"}},[r("InputNumber",{model:{value:t.edit_item.cost,callback:function(e){t.$set(t.edit_item,"cost",e)},expression:"edit_item.cost"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("discount_"),prop:"cdiscount"}},[r("InputNumber",{model:{value:t.edit_item.discount,callback:function(e){t.$set(t.edit_item,"discount",e)},expression:"edit_item.discount"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("batch_no"),prop:"batch_no"}},[r("Input",{model:{value:t.edit_item.batch_no,callback:function(e){t.$set(t.edit_item,"batch_no",e)},expression:"edit_item.batch_no"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.expiry?r("FormItem",{attrs:{label:t.$t("expiry_date"),prop:"expiry_date"}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd",options:t.expiryDateOptions},model:{value:t.edit_item.expiry_date,callback:function(e){t.$set(t.edit_item,"expiry_date",e)},expression:"edit_item.expiry_date"}})],1):t._e()],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("tax",2),prop:"taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.edit_item.allTaxes,callback:function(e){t.$set(t.edit_item,"allTaxes",e)},expression:"edit_item.allTaxes"}},t._l(this.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("comment")}},[r("Input",{attrs:{type:"textarea",placeholder:t.$t("item_comment"),autosize:{minRows:2,maxRows:5}},model:{value:t.edit_item.comment,callback:function(e){t.$set(t.edit_item,"comment",e)},expression:"edit_item.comment"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{long:"",type:"primary"},on:{click:function(e){return t.updateItem()}}},[t._v(t._s(t.$t("update")))])],1),t._v(" "),r("Button",{attrs:{long:"",type:"error"},on:{click:function(e){return t.deleteItem(t.edit_item)}}},[t._v(t._s(t.$t("remove_from_order")))])],1)}),[],!1,null,null,null).exports,RowItemComponent:o},mixins:[(0,i.Z)("purchase",null,null,{id:"purchase_id"}),(0,s.Z)("cost","form",!1)]};const _=(0,n.Z)(f,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("purchase")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/purchases"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("purchase",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"purchase",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("supplier"),prop:"supplier_id",error:t._f("a2s")(t.errors.form.supplier_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchSuppliers,placeholder:t.$t("type_to_search_x",{x:t.$tc("supplier")})},model:{value:t.form.supplier_id,callback:function(e){t.$set(t.form,"supplier_id",e)},expression:"form.supplier_id"}},t._l(t.suppliers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("order_taxes"),prop:"order_taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.form.taxes,callback:function(e){t.$set(t.form,"taxes",e)},expression:"form.taxes"}},t._l(t.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("shipping_fee"),prop:"shipping_fee",error:t._f("a2s")(t.errors.form.shipping_fee)}},[r("InputNumber",{model:{value:t.form.shipping_fee,callback:function(e){t.$set(t.form,"shipping_fee",e)},expression:"form.shipping_fee"}})],1),t._v(" "),t.$store.state.settings.max_discount>0?r("span",[r("FormItem",{attrs:{label:t.$t("discount"),prop:"discount",error:t._f("a2s")(t.errors.form.discount)}},[r("InputNumber",{attrs:{min:0,formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")},max:parseFloat(t.$store.state.settings.max_discount)},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("RadioGroup",{attrs:{vertical:""},model:{value:t.form.discount_method,callback:function(e){t.$set(t.form,"discount_method",e)},expression:"form.discount_method"}},[r("Radio",{attrs:{label:"order"}},[t._v(t._s(t.$t("apply_to_order_amount")))]),t._v(" "),r("Radio",{attrs:{label:"items"}},[t._v(t._s(t.$t("apply_to_order_items")))])],1)],1)],1):t._e()],1)],1),t._v(" "),r("div",{staticClass:"order-contents"},[r("div",{staticClass:"affix-content"},[r("AutoComplete",{ref:"scanCode",attrs:{icon:"ios-search","element-id":"scan_barcode",placeholder:t.$t("search_scan_barcode")},on:{"on-change":t.searchItems,"on-select":t.selectPurchaseItem},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}},t._l(t.result,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ("+t._s(e.code)+") ")])})),1)],1),t._v(" "),!t.form.items||t.form.items.length<1?r("div",[r("Alert",{attrs:{"show-icon":""}},[t._v("\n                  "+t._s(t.$t("empty_order"))+"\n                  "),r("template",{slot:"desc"},[t._v("\n                    "+t._s(t.$t("empty_order_text"))+"\n                  ")])],2)],1):r("div",[r("div",{staticClass:"order-items"},[r("div",{staticClass:"header"},[r("span",{staticClass:"index"},[t._v("#")]),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{attrs:{type:"ios-trash",size:"16"}})],1),t._v(" "),r("span",{staticClass:"details"},[t._v(t._s(t.$t("description")))]),t._v(" "),r("span",{staticClass:"price"},[t._v(t._s(t.$t("cost")))]),t._v(" "),r("span",{staticClass:"discount"},[t._v(t._s(t.$t("discount")))]),t._v(" "),r("span",{staticClass:"quantity"},[t._v(t._s(t.$t("quantity")))]),t._v(" "),r("span",{staticClass:"taxes"},[t._v(t._s(t.$t("taxes")))]),t._v(" "),r("span",{staticClass:"subtotal"},[t._v(t._s(t.$t("subtotal")))])]),t._v(" "),t.form.items&&t.form.items.length?[t._l(t.form.items,(function(e,i){return[r("row-item-component",{key:"row_"+i+"_"+e.id,attrs:{row:e,index:i,customer:t.customer,editItem:t.editItem,deleteItem:t.deleteItem,calcRowTotal:t.calcRowTotal,deleteItemVariation:t.deleteItemVariation,itemVariationQuantityChanged:t.itemVariationQuantityChanged}})]}))]:t._e()],2)]),t._v(" "),r("div",{staticClass:"affix-content"},[r("Alert",{staticStyle:{margin:"16px 0 0",padding:"8px 16px"},attrs:{banner:"",type:"warning"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:12,md:6}},[t._v("\n                      "+t._s(t.$tc("item",2))+":\n                      "),r("span",{staticClass:"float-right"},[r("strong",[t._v(t._s(t.orderTotalItems))]),t._v("\n                        "+t._s(t.$tc("item",t.orderTotalItems))+" "),r("strong",[t._v(t._s(t.orderTotalQuantity))]),t._v("\n                        "+t._s(t.$t("quantity"))+"\n                      ")])]),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("discount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.calculateItemDiscountAmount+t.orderDiscount,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$tc("tax"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.totalItemTax,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("payable_amount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t.orderOriginalTotal!=t.orderPayableAmount?r("span",[r("del",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderOriginalTotal,t.$store.state.settings.decimals))+"\n                          ")])]):t._e(),t._v(" "),r("span",[t.orderDiscount?r("span",[r("span",{staticStyle:{"font-weight":"normal"}},[t._v("\n                              ("+t._s(t._f("formatNumber")(t.orderTotalAmount,t.$store.state.settings.decimals))+" -\n                              "+t._s(t._f("formatNumber")(t.orderDiscount,t.$store.state.settings.decimals))+")\n                            ")]),t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")]):r("span",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")])])])],1)],1)],1)],1)]),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),t.is_draftable()?r("FormItem",{class:{mb0:1!=t.form.draft},attrs:{prop:"draft"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.draft,callback:function(e){t.$set(t.form,"draft",e)},expression:"form.draft"}},[r("span",[t._v(t._s(t.$t("order_draft_text")))])])],1):t._e(),t._v(" "),r("transition",{attrs:{mode:"out-in",name:"slide-in","enter-active-class":"animate__animated faster animate__fadeInDown","leave-active-class":"animate__animated fastest animate__fadeOutDown"}},[t.is_draftable()&&1!=t.form.draft?r("FormItem",{attrs:{prop:"payment"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.payment,callback:function(e){t.$set(t.form,"payment",e)},expression:"form.payment"}},[r("span",[t._v(t._s(t.$t("auto_payment_text")))])])],1):t._e()],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("purchases")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("purchases",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1),t._v(" "),r("Modal",{attrs:{width:600,"footer-hide":!0,title:t.edit_item?t.$t("edit")+" - "+t.edit_item.name:""},model:{value:t.show_item_edit,callback:function(e){t.show_item_edit=e},expression:"show_item_edit"}},[t.edit_item?r("span",[r("Form",{ref:"editItemForm",attrs:{model:t.edit_item,rules:t.itemRules}},[r("edit-row-item-component",{attrs:{taxes:t.taxes,edit_item:t.edit_item,itemPrice:t.itemPrice,itemDiscount:t.itemPrice,deleteItem:t.deleteItem,updateItem:t.updateItem,itemUnitChanged:t.itemUnitChanged,expiryDateOptions:t.expiry_date_options,addPortionToEditItem:t.addPortionToEditItem,changeSelectedPortion:t.changeSelectedPortion}})],1)],1):t._e()])],1)],1),t._v(" "),r("Modal",{attrs:{"footer-hide":!0,"mask-closable":!1,title:t.$t("select_x",{x:t.$tc("variant",2)})},model:{value:t.variantModal,callback:function(e){t.variantModal=e},expression:"variantModal"}},[r("select-variation-component",{ref:"selectVarMod",attrs:{item:t.item,purchase:""},on:{"on-submit":t.variationSubmitted}})],1)],1)}),[],!1,null,null,null).exports},58954:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(92704),s=r(85290),a=r(82016);const n={components:{PaymentsComponent:s.Z,OrderViewComponent:a.Z},mixins:[(0,i.Z)("purchase","app/purchases","reference")],data:function(){var t=this;return{view:!1,payments:[],purchase:{},loading:!1,paymentsModal:!1,paymentsLoading:!1,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",width:100,render:this.renderDate},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",minWidth:150},{maxWidth:300,minWidth:200,key:"supplier",sortable:!1,title:this.$tc("supplier"),render:this.renderSupplier},{title:this.$t("draft"),sortable:!0,key:"draft",width:80,render:this.renderIconDraft},{title:this.$t("paid"),sortable:!0,key:"paid",width:75,render:this.renderIconPaid},{title:this.$t("void"),sortable:!0,key:"void",width:75,render:this.renderIconVoid},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("total"),sortable:!1,key:"total",width:150,render:this.renderTotal},{title:this.$t("item_tax"),sortable:!1,key:"item_tax",width:150,render:this.renderItemTax},{title:this.$t("order_tax"),sortable:!1,key:"order_tax",width:150,render:this.renderOrderTax},{title:this.$t("discount"),sortable:!1,key:"discount",width:150,render:this.renderDiscount},{title:this.$t("shipping"),sortable:!1,key:"shipping",width:150,render:this.renderShipping},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0,width:350},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-dropdown-component",{props:{params:r,viewFn:t.viewModal,editFn:t.editRecord,payFn:t.paymentRecord,emailFn:t.emailRecord,duplicateFn:t.duplicate,deleteFn:t.deleteRecord,toggleVoidFn:t.toggleVoid,downloadFn:t.downloadRecord,listPayFn:t.ListPaymentForRecord,record:{model:"purchase",name:"reference",title:t.$tc("purchase")}}})}}],options:{perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.purchase.id&&(this.loading=!0,this.$http.get("app/purchases/".concat(t.id)).then((function(t){return e.purchase=t.data})).finally((function(){return e.loading=!1})))},duplicate:function(t){this.$router.push("/purchases/add?purchase_id=".concat(t.id))},toggleVoid:function(t){var e=this;this.$http.delete("app/purchases/".concat(t.id,"/toggle_void")).then((function(t){t.data.success?(e.refresh++,e.$Notice.success({title:e.$t("success"),desc:e.$t("order_marked_x_text",{x:1==t.data.void?e.$t("void"):e.$t("valid")})})):e.$Notice.error({title:e.$tc("failed"),desc:e.$t("failed_error_text")})})).finally((function(){return e.$Modal.remove()}))},emailRecord:function(t){var e=this;this.$http.post("app/purchases/email/"+t.id,{}).then((function(t){t.data.success?e.$Notice.success({title:e.$t("email_sent"),desc:e.$t("email_sent_text")}):e.$Notice.error({title:e.$tc("failed"),desc:e.$t("failed_error_text")})}))},downloadRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"download/purchases/"+t.id}).click()},viewRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"view/purchase/"+t.hash}).click()},paymentRecord:function(t){this.$router.push("/payments/add?purchase_id=".concat(t.id,"&supplier_id=").concat(t.supplier_id,"&amount=").concat(t.grand_total))},ListPaymentForRecord:function(t){var e=this;this.purchase=t,this.paymentsModal=!0,this.paymentsLoading=!0,this.$http.get("app/purchases/"+t.id+"/payments").then((function(t){e.payments=t.data,e.paymentsLoading=!1}))},paymentsModalChanged:function(t){t||(this.purchase=null,this.payments=[])},renderSupplier:function(t,e){return t("div",[e.row.supplier.name])},renderTotal:function(t,e){return this.renderNumber(t,e,"total")},renderItemTax:function(t,e){return this.renderNumber(t,e,"item_tax_amount")},renderOrderTax:function(t,e){return this.renderNumber(t,e,"order_tax_amount")},renderDiscount:function(t,e){return this.renderNumber(t,e,"discount_amount")},renderShipping:function(t,e){return this.renderNumber(t,e,"shipping")},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total",!0)},renderIconActive:function(t,e){return this.renderUnlessIcon(t,e,"draft")},renderIconDraft:function(t,e){return this.renderBoolean(t,e,"draft")},renderIconPaid:function(t,e){return this.renderBoolean(t,e,"paid")},renderIconVoid:function(t,e){return this.renderBoolean(t,e,"void")},rowClassName:function(t,e){return 1==t.void?"ivu-table-error-row":""}}};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("purchase",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/purchases/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("purchase"))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/purchases",columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords,"row-class-name":t.rowClassName}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("purchase")+" ("+t.purchase.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{field:"cost",to:"supplier",record:t.purchase,heading:t.$tc("purchase"),"to-text":t.$tc("order_to")},on:{remove:function(e){return t.deleteAttachment(e,t.purchase)}}})],1),t._v(" "),r("Modal",{attrs:{"footer-hide":"",width:750},on:{"on-visible-change":t.paymentsModalChanged},model:{value:t.paymentsModal,callback:function(e){t.paymentsModal=e},expression:"paymentsModal"}},[r("p",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("\n        "+t._s(t.$t("list_x",{x:t.$tc("payment",2)}))+"\n        "+t._s(t.purchase?"("+t.$tc("purchase")+" "+t.$t("reference")+" "+t.purchase.reference+")":"")+"\n      ")])]),t._v(" "),t.paymentsLoading?r("Loading"):r("payments-component",{attrs:{payments:t.payments}})],1)],1)}),[],!1,null,null,null).exports},80790:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>u});var i=r(21490),s=r(61402);const a={props:{editItem:{type:Function},deleteItem:{type:Function},calcItemTax:{type:Function},calcRowTotal:{type:Function},customer:{type:[Boolean,Object]},row:{type:Object,required:!0},deleteItemVariation:{type:Function},getPortionChoosable:{type:Function},index:{type:Number,required:!0},itemVariationQuantityChanged:{type:Function}}};var n=r(51900);const o=(0,n.Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order-item"},[r("span",{staticClass:"item"},[r("span",{staticClass:"index"},[t._v(t._s(t.index+1))]),t._v(" "),r("span",{staticClass:"remove"},[t.row.selected.variations&&t.row.selected.portions&&!t.row.selected.portions.length&&!t.row.selected.variations.length?r("span",[r("Icon",{staticClass:"pointer",attrs:{size:"18",type:"md-close",color:"#ed4014"},on:{click:function(e){return t.deleteItem(t.row.guid)}}})],1):t._e()]),t._v(" "),r("span",{staticClass:"details pointer",on:{click:function(e){return t.editItem(t.index)}}},[r("strong",[t._v(t._s(t.row.name))]),t._v(" "),r("br"),t._v(" "),r("span",[t.customer&&t.customer.customer_group?r("span",{domProps:{innerHTML:t._s(t.customer.customer_group.name+" (<small>"+t.$t("discount")+": "+t.customer.customer_group.discount+"%</small>)<br />")}}):t._e(),t._v(" "),t.row.comment?r("span",[t._v(t._s(t.row.comment)+" ")]):t._e()])]),t._v(" "),t.row.selected.variations&&t.row.selected.portions&&!t.row.selected.portions.length&&!t.row.selected.variations.length?[r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(t.row.price-t.row.discount_amount+t.calcItemTax(t.row)))+"\n      ")]),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length||!!t.row.selected.portions.length,size:t.row.selected.variations.length||t.row.selected.portions.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(t.row.taxes,(function(e){return r("div",{key:"tax_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber(t.calcRowTotal(t.row)))+"\n      ")])]:[r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length||!!t.row.selected.portions.length,size:t.row.selected.variations.length||t.row.selected.portions.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})]],2),t._v(" "),t.row.selected.variations&&t.row.selected.variations.length?t._l(t.row.selected.variations,(function(e,i){return r("div",{key:"svi_"+i,staticClass:"combo-item variation"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.deleteItemVariation(t.row,e)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n        "+t._s(i+1)+".\n        "),r("span",{domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(e.price))+"\n      ")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n        "+t._s(t.formatNumber(e.discount_amount))+"\n      ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{on:{"on-change":function(e){return t.itemVariationQuantityChanged(t.form.items[t.index])}},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"sv.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(e){return r("div",{key:"sv_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber((e.price-e.discount_amount+e.total_tax_amount)*e.quantity))+"\n      ")])])})):t._e(),t._v(" "),t.row.selected.portions.length?t._l(t.row.selected.portions,(function(e,i){return r("div",{key:"spi_"+i,staticClass:"combo"},t._l(t.row.portions.filter((function(t){return t.id==e.id})),(function(s){return r("div",{key:"pi_"+s.id,staticClass:"combo"},[r("div",{staticClass:"combo-item variation"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.deleteItemPortion(t.row,e,i)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[r("p",[t._v("\n              "+t._s(i+1)+". "+t._s(t.$tc("portion"))+":\n              "),r("strong",[t._v(t._s("regular"==s.name?t.$t("regular"):s.name))])])]),t._v(" "),r("span",{staticClass:"price"},[t._v(t._s(t.formatNumber(e.price)))]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n            "+t._s(t.formatNumber(e.discount_amount))+"\n          ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{on:{"on-change":function(e){return t.itemPortionQuantityChanged(t.form.items[t.index])}},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"sp.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(i){return r("div",{key:"sp_"+i.id},[t._v("\n              "+t._s(i.code)+"\n              "),r("span",{staticClass:"float-right"},[t._v("\n                "+t._s(t.formatNumber(i.amount*e.quantity))+"\n              ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n            "+t._s(t.formatNumber((e.price-e.discount_amount+e.total_tax_amount)*e.quantity))+"\n          ")])]),t._v(" "),t._l(s.essentials,(function(i,s){return r("div",{key:"ei_"+s,staticClass:"combo-item bt0",staticStyle:{"padding-top":"1px"}},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"}),t._v(" "),r("span",{staticClass:"details"},[t._v(" #"+t._s(s+1)+" "+t._s(i.item.name)+" ")]),t._v(" "),r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity input"},[t._v("\n            "+t._s(parseFloat(i.quantity*e.quantity))+"\n          ")]),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})])})),t._v(" "),t._l(s.choosables,(function(i,a){return t._l(i.items,(function(n,o){return t.getPortionChoosable(e,i.id,n.item_id)?r("div",{key:"gii_"+o+"_"+a,staticClass:"combo-item bt0",staticStyle:{"padding-top":"1px"}},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"}),t._v(" "),r("span",{staticClass:"details"},[t._v("\n              #"+t._s(a+1+s.essentials.length)+"\n              "+t._s(n.item.name)+"\n            ")]),t._v(" "),r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity input"},[t._v("\n              "+t._s(parseFloat(n.quantity*e.quantity))+"\n            ")]),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})]):t._e()}))}))],2)})),0)})):t._e(),t._v(" "),t.row.selected.modifiers.length?[r("div",{staticClass:"combo-item bg"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[t._v("")]),t._v(" "),r("span",{staticClass:"details"},[r("p",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.$tc("modifier",2)))])]),t._v(" "),r("span",{staticClass:"price"},[t._v("")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("")]),t._v(" "),r("span",{staticClass:"quantity"},[t._v("")]),t._v(" "),r("span",{staticClass:"taxes"},[t._v("")]),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("")])]),t._v(" "),t._l(t.row.selected.modifiers,(function(e,i){return r("div",{key:"mi_"+i},[r("div",{staticClass:"combo-item pt pb"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.deleteItemModifier(t.row,e,i)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n          "+t._s(i+1)+". "),r("strong",[t._v(t._s(e.option))]),t._v(" ("+t._s(e.title)+")\n        ")]),t._v(" "),r("span",{staticClass:"price"},[t._v("\n          "+t._s(t.formatNumber(e.price))+"\n        ")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n          "+t._s(t.formatNumber(e.discount_amount*e.quantity))+"\n        ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"m.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(i){return r("div",{key:"m_"+i.id},[t._v("\n            "+t._s(i.code)+"\n            "),r("span",{staticClass:"float-right"},[t._v("\n              "+t._s(t.formatNumber(i.amount*e.quantity))+"\n            ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"})])])}))]:t._e()],2)}),[],!1,null,null,null).exports;const l={props:{taxes:{type:Array},itemPrice:{type:Function},deleteItem:{type:Function},updateItem:{type:Function},modOptLabel:{type:Function},itemDiscount:{type:Function},addPortionToEditItem:{type:Function},changeSelectedPortion:{type:Function},edit_item:{type:Object,required:!0}}};const c={components:{EditRowItemComponent:(0,n.Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Row",{attrs:{gutter:16}},[t.edit_item.portions.length||t.edit_item.has_variants?t._e():r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{staticClass:"text-center",attrs:{prop:"quantity",label:t.$t("quantity"),rules:{type:"number",required:!0,trigger:"change",message:t.$t("field_is_required",{field:t.$t("quantity")})}}},[r("InputNumber",{attrs:{size:"large"},model:{value:t.edit_item.quantity,callback:function(e){t.$set(t.edit_item,"quantity",e)},expression:"edit_item.quantity"}})],1)],1),t._v(" "),t.edit_item.portions&&t.edit_item.portions.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},t._l(t.edit_item.selected.portions,(function(e,i){return r("span",{key:"eispi_"+i},t._l(t.edit_item.portions.filter((function(t){return t.id==e.id})),(function(s){return r("span",{key:"pi_"+s.id},[r("Card",{staticClass:"cardp",attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"ios-option"}}),t._v("\n                "+t._s(i+1)+". "+t._s(t.$tc("portion"))+": ("+t._s("regular"==s.name?t.$t("regular"):s.name)+")\n              ")],1),t._v(" "),!i&&t.edit_item.portions.length>1?r("Button",{attrs:{slot:"extra",type:"primary",size:"small"},on:{click:function(e){return t.addPortionToEditItem()}},slot:"extra"},[t._v("\n                "+t._s(t.$t("add_x",{x:t.$tc("portion")}))+"\n              ")]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{staticClass:"mb16",attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("portion")}},[r("Select",{attrs:{value:e.id},on:{"on-change":function(e){return t.changeSelectedPortion(e,i)}}},t._l(t.edit_item.portions,(function(e,i){return r("Option",{key:"pi_"+i,attrs:{value:e.id}},[t._v("\n                        "+t._s("regular"==e.name?t.$t("regular"):e.name)+"\n                      ")])})),1)],1)],1),t._v(" "),r("Col",{staticClass:"mb16",attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("quantity")}},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"eisp.quantity"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}},[r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                      "+t._s(t.$t("essential_items"))+"\n                    ")])]),t._v(" "),r("p",{staticStyle:{"margin-bottom":"8px","font-weight":"bold"}},[t._v("\n                    "+t._s(s.essentials.map((function(t){return t.item.name})).join(", "))+"\n                  ")]),t._v(" "),r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                      "+t._s(t.$t("choosable_items"))+"\n                    ")])]),t._v(" "),r("Row",{attrs:{gutter:16}},t._l(s.choosables,(function(s,a){return r("Col",{key:"gi_"+a,attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:s.name,prop:"selected.portions."+i+".choosables."+a+".selected",rules:{required:!0,trigger:"change",message:t.$t("select_x",{x:t.$tc("item")})}}},[r("Select",{model:{value:e.choosables[a].selected,callback:function(r){t.$set(e.choosables[a],"selected",r)},expression:"eisp.choosables[gi].selected"}},t._l(s.items,(function(e,i){return r("Option",{key:"gii_"+i,attrs:{value:e.item_id}},[t._v("\n                            "+t._s(e.item.name)+"\n                          ")])})),1)],1)],1)})),1)],1)],1)],1)],1)})),0)})),0),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),t.edit_item.variants&&t.edit_item.variants.length?[t._l(t.edit_item.selected.variations,(function(e,i){return r("span",{key:"sv_meta_"+i},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("span",{staticStyle:{color:"#515a6e"},domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("quantity"),prop:"selected.variations."+i+".quantity",rules:{required:!0,type:"number",trigger:"change",max:parseFloat(e.available),message:t.$t("only_x_quantity_available",{x:parseFloat(e.available)})}}},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"eisv.quantity"}})],1)],1),t._v(" "),r("Col",{staticClass:"text-primary",staticStyle:{"padding-top":"2.5em"},attrs:{sm:24,md:12,lg:12}},[t._v("\n          "+t._s(t.$t("available_x",{x:t.$t("quantity")}))+":\n          "),r("strong",[t._v(t._s(e.available))])])],1)})),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),t.edit_item.modifiers&&t.edit_item.modifiers.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n            "+t._s(t.$tc("modifier",2))+"\n          ")])])],1),t._v(" "),t._l(t.edit_item.modifiers,(function(e,i){return r("Col",{key:"mi_"+i,attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:e.title,prop:"modifiers"}},["radio"==e.show_as?r("span",[r("RadioGroup",{attrs:{vertical:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"checkbox"==e.show_as?r("span",[r("CheckboxGroup",{attrs:{vertical:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"select"==e.show_as?r("span",[r("Select",{model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"select_multiple"==e.show_as?r("span",[r("Select",{attrs:{multiple:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):t._e()])],1)})),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n        "+t._s(t.$t("general"))+"\n      ")])]),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.allUnits&&t.edit_item.allUnits.length>0?r("FormItem",{attrs:{label:t.$tc("unit")}},[r("Select",{staticStyle:{width:"100%"},on:{"on-change":t.itemUnitChanged},model:{value:t.edit_item.unit_id,callback:function(e){t.$set(t.edit_item,"unit_id",e)},expression:"edit_item.unit_id"}},t._l(t.edit_item.allUnits,(function(e,i){return r("Option",{key:"unit_"+i+"_"+e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),1)],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.changeable?r("FormItem",{attrs:{prop:"price",label:t.$t("price"),rules:[{required:!0,type:"number",message:t.$t("field_is_required",{field:t.$t("price")}),trigger:["change","blur"]},{validator:t.itemPrice,trigger:["change","blur"]}]}},[r("InputNumber",{model:{value:t.edit_item.price,callback:function(e){t.$set(t.edit_item,"price",e)},expression:"edit_item.price"}})],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{prop:"discount",label:t.$t("discount_"),rules:{validator:t.itemDiscount,trigger:["change","blur"]}}},[r("InputNumber",{model:{value:t.edit_item.discount,callback:function(e){t.$set(t.edit_item,"discount",e)},expression:"edit_item.discount"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.allPromotions&&t.edit_item.allPromotions.length>0?r("FormItem",{attrs:{label:t.$tc("promo",2)}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.edit_item.promotions,callback:function(e){t.$set(t.edit_item,"promotions",e)},expression:"edit_item.promotions"}},t._l(t.edit_item.allPromotions,(function(e,i){return r("Option",{key:"tax_"+i+"_"+e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),1)],1):t._e()],1)],2),t._v(" "),t.edit_item.changeable?r("FormItem",{attrs:{label:t.$tc("tax",2),prop:"taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.edit_item.allTaxes,callback:function(e){t.$set(t.edit_item,"allTaxes",e)},expression:"edit_item.allTaxes"}},t._l(this.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),1)],1):t._e(),t._v(" "),r("FormItem",{attrs:{label:t.$t("comment")}},[r("Input",{attrs:{type:"textarea",placeholder:t.$t("item_comment"),autosize:{minRows:2,maxRows:5}},model:{value:t.edit_item.comment,callback:function(e){t.$set(t.edit_item,"comment",e)},expression:"edit_item.comment"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{long:"",type:"primary"},on:{click:function(e){return t.updateItem()}}},[t._v(t._s(t.$t("update")))])],1),t._v(" "),r("Button",{attrs:{long:"",type:"error"},on:{click:function(e){return t.deleteItem(t.edit_item.guid)}}},[t._v(t._s(t.$t("remove_from_order")))])],1)}),[],!1,null,null,null).exports,RowItemComponent:o},mixins:[(0,i.Z)("quotation"),(0,s.Z)("price","form",!1)]};const u=(0,n.Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("quotation")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/quotations"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("quotation",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"quotation",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("customer"),prop:"customer_id",error:t._f("a2s")(t.errors.form.customer_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchCustomers,placeholder:t.$t("type_to_search",{x:t.$tc("customer")})},model:{value:t.form.customer_id,callback:function(e){t.$set(t.form,"customer_id",e)},expression:"form.customer_id"}},t._l(t.customers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("order_taxes"),prop:"order_taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.form.taxes,callback:function(e){t.$set(t.form,"taxes",e)},expression:"form.taxes"}},t._l(t.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("shipping_fee"),prop:"shipping_fee",error:t._f("a2s")(t.errors.form.shipping_fee)}},[r("InputNumber",{model:{value:t.form.shipping_fee,callback:function(e){t.$set(t.form,"shipping_fee",e)},expression:"form.shipping_fee"}})],1),t._v(" "),t.$store.state.settings.max_discount>0?r("span",[r("FormItem",{attrs:{label:t.$t("discount"),prop:"discount",error:t._f("a2s")(t.errors.form.discount)}},[r("InputNumber",{attrs:{min:0,formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")},max:parseFloat(t.$store.state.settings.max_discount)},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("RadioGroup",{attrs:{vertical:""},model:{value:t.form.discount_method,callback:function(e){t.$set(t.form,"discount_method",e)},expression:"form.discount_method"}},[r("Radio",{attrs:{label:"order"}},[t._v(t._s(t.$t("apply_to_order_amount")))]),t._v(" "),r("Radio",{attrs:{label:"items"}},[t._v(t._s(t.$t("apply_to_order_items")))])],1)],1)],1):t._e()],1)],1),t._v(" "),r("div",{staticClass:"order-contents"},[r("div",{staticClass:"affix-content"},[r("AutoComplete",{ref:"scanCode",attrs:{icon:"ios-search","element-id":"scan_barcode",placeholder:t.$t("search_scan_barcode")},on:{"on-change":t.searchItems,"on-select":t.selectSaleItem},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}},t._l(t.result,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ("+t._s(e.code)+") ")])})),1)],1),t._v(" "),!t.form.items||t.form.items.length<1?r("div",[r("Alert",{attrs:{"show-icon":""}},[t._v("\n                  "+t._s(t.$t("empty_order"))+"\n                  "),r("template",{slot:"desc"},[t._v("\n                    "+t._s(t.$t("empty_order_text"))+"\n                  ")])],2)],1):r("div",[r("div",{staticClass:"order-items"},[r("div",{staticClass:"header"},[r("span",{staticClass:"index"},[t._v("#")]),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{attrs:{type:"ios-trash",size:"16"}})],1),t._v(" "),r("span",{staticClass:"details"},[t._v(t._s(t.$t("description")))]),t._v(" "),r("span",{staticClass:"price"},[t._v(t._s(t.$t("price")))]),t._v(" "),r("span",{staticClass:"discount"},[t._v(t._s(t.$t("discount")))]),t._v(" "),r("span",{staticClass:"quantity"},[t._v(t._s(t.$t("quantity")))]),t._v(" "),r("span",{staticClass:"taxes"},[t._v(t._s(t.$t("taxes")))]),t._v(" "),r("span",{staticClass:"subtotal"},[t._v(t._s(t.$t("subtotal")))])]),t._v(" "),t.form.items&&t.form.items.length?[t._l(t.form.items,(function(e,i){return[r("row-item-component",{key:"row_"+i+"_"+e.id,attrs:{row:e,index:i,customer:t.customer,editItem:t.editItem,deleteItem:t.deleteItem,calcItemTax:t.calcItemTax,calcRowTotal:t.calcRowTotal,deleteItemVariation:t.deleteItemVariation,getPortionChoosable:t.getPortionChoosable,itemVariationQuantityChanged:t.itemVariationQuantityChanged}})]}))]:t._e()],2)]),t._v(" "),r("div",{staticClass:"affix-content"},[r("Alert",{staticStyle:{margin:"16px 0 0",padding:"8px 16px"},attrs:{banner:"",type:"warning"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:12,md:6}},[t._v("\n                      "+t._s(t.$tc("item",2))+":\n                      "),r("span",{staticClass:"float-right"},[r("strong",[t._v(t._s(t.orderTotalItems))]),t._v("\n                        "+t._s(t.$tc("item",t.orderTotalItems))+" "),r("strong",[t._v(t._s(t.orderTotalQuantity))]),t._v("\n                        "+t._s(t.$t("quantity"))+"\n                      ")])]),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("discount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.calculateItemDiscountAmount+t.orderDiscount,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$tc("tax"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.totalItemTax,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("payable_amount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t.orderOriginalTotal!=t.orderPayableAmount?r("span",[r("del",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderOriginalTotal,t.$store.state.settings.decimals))+"\n                          ")])]):t._e(),t._v(" "),r("span",[t.orderDiscount?r("span",[r("span",{staticStyle:{"font-weight":"normal"}},[t._v("\n                              ("+t._s(t._f("formatNumber")(t.orderTotalAmount,t.$store.state.settings.decimals))+" -\n                              "+t._s(t._f("formatNumber")(t.orderDiscount,t.$store.state.settings.decimals))+")\n                            ")]),t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")]):r("span",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")])])])],1)],1)],1)],1)]),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("quotations")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("quotations",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1),t._v(" "),r("Modal",{attrs:{width:600,"footer-hide":!0,title:t.edit_item?t.$t("edit")+" - "+t.edit_item.name:""},model:{value:t.show_item_edit,callback:function(e){t.show_item_edit=e},expression:"show_item_edit"}},[t.edit_item?r("div",[r("Form",{ref:"editItemForm",attrs:{model:t.edit_item,"label-position":"top"}},[r("edit-row-item-component",{attrs:{taxes:t.taxes,edit_item:t.edit_item,itemPrice:t.itemPrice,deleteItem:t.deleteItem,updateItem:t.updateItem,itemDiscount:t.itemPrice,modOptLabel:t.modOptLabel,itemUnitChanged:t.itemUnitChanged,addPortionToEditItem:t.addPortionToEditItem,changeSelectedPortion:t.changeSelectedPortion}})],1)],1):t._e()])],1)],1),t._v(" "),r("Modal",{attrs:{"footer-hide":!0,"mask-closable":!1,title:t.$t("select_x",{x:t.$tc("portion")+", "+t.$tc("modifier",2)+" & "+t.$tc("variant",2)})},model:{value:t.variantModal,callback:function(e){t.variantModal=e},expression:"variantModal"}},[r("select-variation-component",{ref:"selectVarMod",attrs:{item:t.item},on:{"on-submit":t.variationSubmitted}})],1)],1)}),[],!1,null,null,null).exports},40098:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(92704);const s={components:{OrderViewComponent:r(82016).Z},mixins:[(0,i.Z)("quotation","app/quotations","reference")],data:function(){var t=this;return{view:!1,quotation:{},loading:!1,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",width:100,render:this.renderDate},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",minWidth:150},{maxWidth:300,minWidth:200,key:"customer",sortable:!1,title:this.$tc("customer"),render:this.renderCustomer},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("total"),sortable:!1,key:"total",width:150,render:this.renderTotal},{title:this.$t("item_tax"),sortable:!1,key:"item_tax",width:125,render:this.renderItemTax},{title:this.$t("order_tax"),sortable:!1,key:"order_tax",width:125,render:this.renderOrderTax},{title:this.$t("discount"),sortable:!1,key:"discount",width:125,render:this.renderDiscount},{title:this.$t("shipping"),sortable:!1,key:"shipping",width:125,render:this.renderShipping},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0,width:350},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-dropdown-component",{props:{params:r,viewFn:t.viewModal,editFn:t.editRecord,emailFn:t.emailRecord,deleteFn:t.deleteRecord,createSaleFn:t.createSale,downloadFn:t.downloadRecord,record:{model:"quotation",name:"reference",title:t.$tc("quotation")}}})}}],options:{perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.quotation.id&&(this.loading=!0,this.$http.get("app/quotations/".concat(t.id)).then((function(t){return e.quotation=t.data})).finally((function(){return e.loading=!1})))},createSale:function(t){this.$router.push("/sales/add?quotation_id=".concat(t.id))},emailRecord:function(t){var e=this;this.$http.post("app/quotations/email/"+t.id,{}).then((function(t){t.data.success?e.$Notice.success({title:e.$t("email_sent"),desc:e.$t("email_sent_text")}):e.$Notice.error({title:e.$tc("failed"),desc:e.$t("failed_error_text")})}))},downloadRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"download/quotations/"+t.id}).click()},viewRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"view/quotation/"+t.id}).click()},renderCustomer:function(t,e){return t("div",[e.row.customer.name])},renderTotal:function(t,e){return this.renderNumber(t,e,"total")},renderItemTax:function(t,e){return this.renderNumber(t,e,"item_tax_amount")},renderOrderTax:function(t,e){return this.renderNumber(t,e,"order_tax_amount")},renderDiscount:function(t,e){return this.renderNumber(t,e,"discount_amount")},renderShipping:function(t,e){return this.renderNumber(t,e,"shipping")},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total",!0)},renderIconActive:function(t,e){return this.renderUnlessIcon(t,e,"draft")},renderIconDraft:function(t,e){return this.renderBoolean(t,e,"draft")},renderIconPaid:function(t,e){return this.renderBoolean(t,e,"paid")}}};const a=(0,r(51900).Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("quotation",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/quotations/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("quotation"))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{columns:t.columns,options:t.options,refresh:t.refresh,url:"app/quotations",dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("quotation")+" ("+t.quotation.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{summary:!1,record:t.quotation,"to-text":t.$tc("quote_to"),heading:t.$tc("quotation")},on:{remove:function(e){return t.deleteAttachment(e,t.quotation)}}})],1)],1)}),[],!1,null,null,null).exports},59859:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(92704),s=r(19996);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const l={components:{ExpenseViewComponent:r(31197).Z,ReportFormComponent:s.Z},mixins:[(0,i.Z)("expense","app/expenses","reference")],data:function(){return{url:"",data:{},expense:{},updated:0,view:!1,loading:!1,showForm:!1,reportForm:{},fields:["date","reference","custom_fields","account_id","category_id","user_id","details","title","approved"],columns:[{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",minWidth:125,render:this.renderDate},{title:this.$t("title"),sortable:!0,key:"title",minWidth:200},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("amount"),sortable:!0,key:"amount",maxWidth:125,minWidth:125,render:this.renderAmount},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{title:this.$tc("category"),sortable:!1,key:"categories",minWidth:175,render:this.renderCategory},{title:this.$tc("account"),sortable:!1,key:"account",minWidth:175,render:this.renderAccount},{title:this.$tc("created_by"),sortable:!1,key:"user",minWidth:175,render:this.renderUser},{title:this.$tc("approved"),sortable:!1,key:"approved",minWidth:90,render:this.renderApproved},{title:this.$tc("approval"),sortable:!1,key:"approved_by",minWidth:175,render:this.renderApproval},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:300},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:250,render:this.renderExtras},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"desc",minWidth:175,render:this.renderDateTime}],options:{hideSearch:!0,showSummary:!0,summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++})),this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.url="app/reports/expenses/table?"+this.queryString(this.reportForm),this.$http.get("app/reports/expenses",{params:n(n({},this.reportForm),{},{date:""})}).then((function(e){t.reportForm.date=[new Date(e.data.start_date),new Date(e.data.end_date)],t.prepareData(e.data.expenses),t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.date&&this.reportForm.date[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.date[0]).format(this.datetimeFormatString())),this.reportForm.date&&this.reportForm.date[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.date[1]).format(this.datetimeFormatString())),delete this.reportForm.date,this.url="app/reports/expenses/table?"+this.queryString(this.reportForm),this.refresh++,this.$http.get("app/reports/expenses",{params:n(n({},this.reportForm),{},{date:""})}).then((function(t){e.reportForm.date=[new Date(t.data.start_date),new Date(t.data.end_date)],e.prepareData(t.data.expenses),e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.reportForm.end_date=this.reportForm.date[1],this.reportForm.start_date=this.reportForm.date[0],this.data=[{label:this.$t("total_x",{x:this.$tc("expense",2)}),value:t.count},{label:this.$t("total_x",{x:this.$tc("unconfirmed",2)}),value:t.unconfirmed},{label:this.$t("total_x",{x:this.$tc("approved",2)}),value:t.approved},{label:this.$t("total_x",{x:this.$tc("amount",2)}),value:t.amount},{label:this.$t("total_x",{x:this.$tc("unconfirmed_amount",2)}),value:t.unconfirmed_amount},{label:this.$t("total_x",{x:this.$tc("approved_amount",2)}),value:t.approved_amount}]},viewModal:function(t){var e=this;this.view=!0,t.id!=this.expense.id&&(this.loading=!0,this.$http.get("app/expenses/".concat(t.id)).then((function(t){return e.expense=t.data})).finally((function(){return e.loading=!1})))},renderAmount:function(t,e){return this.renderNumber(t,e,"amount")},renderAccount:function(t,e){return t("div",[e.row.account.name])},renderLocation:function(t,e){return t("div",[e.row.location.name])},renderCategory:function(t,e){return t("div",[e.row.categories.map((function(t){return t.name})).join("")])},renderApproved:function(t,e){return this.renderBoolean(t,e,"approved")},renderApproval:function(t,e){return t("div",[e.row.approved_by?e.row.approved_by.name:""])},renderUser:function(t,e){return t("div",[e.row.user?e.row.user.name:""])},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["amount"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return t.void||t.draft?0:Number(e.formatDecimal(t[n]))}));if(!o.every((function(t){return isNaN(t)}))){var l=o.reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatNumber(l)}}}else a[n]={key:n,value:""}})),a}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$tc("expense",2)}))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" -\n      "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,reportForm:t.reportForm,updated:t.updated},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[e.value&&0!=e.value?r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box static",class:"box"+(i+1)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])]):t._e()]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("expense")+" ("+t.expense.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("expense-view-component",{attrs:{expense:t.expense},on:{remove:function(e){return t.deleteAttachment(e,t.expense)}}})],1)],1)}),[],!1,null,null,null).exports},34855:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("item","")],data:function(){return{columns:[{title:this.$t("name"),sortable:!0,key:"name",minWidth:200},{title:this.$t("code"),sortable:!0,key:"code",sortType:"asc",width:150},{title:this.$t("quantity"),sortable:!1,key:"balance",width:125,render:this.renderBalance},{title:this.$t("expiry_date"),sortable:!1,key:"expiry_date",width:150,render:this.renderExpiry},{title:this.$t("batch_no"),sortable:!1,key:"batch_no",width:150}],options:{orderBy:"expiry_date",perPage:this.$store.state.settings.rows}}},methods:{renderCode:function(t,e){return t("div",[e.row.item.code])},renderNmae:function(t,e){return t("div",[e.row.item.name])},renderBalance:function(t,e){return t("div",{class:"text-center"},[this.$options.filters.formatNumber(e.row.balance,this.$store.getters.settings.decimals)])},renderExpiry:function(t,e){return t("div",[this.date(e.row.expiry_date)])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("product_expiry_alerts",{x:t.$tc("item",2)})))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/items"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list_x",{x:t.$tc("item",2)}))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/alerts/expiring",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},44284:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(92704),s=r(19996);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const l={components:{IncomeViewComponent:r(25258).Z,ReportFormComponent:s.Z},mixins:[(0,i.Z)("income","app/incomes","reference")],data:function(){return{url:"",data:{},income:{},updated:0,view:!1,loading:!1,showForm:!1,reportForm:{},fields:["date","reference","custom_fields","account_id","category_id","user_id","details","title"],columns:[{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",minWidth:125,render:this.renderDate},{title:this.$t("title"),sortable:!0,key:"title",minWidth:200},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("amount"),sortable:!0,key:"amount",maxWidth:125,minWidth:125,render:this.renderAmount},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{title:this.$tc("category"),sortable:!1,key:"categories",minWidth:175,render:this.renderCategory},{title:this.$tc("account"),sortable:!1,key:"account",minWidth:175,render:this.renderAccount},{title:this.$tc("created_by"),sortable:!1,key:"user",minWidth:175,render:this.renderUser},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:300},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:250,render:this.renderExtras},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"desc",minWidth:175,render:this.renderDateTime}],options:{hideSearch:!0,showSummary:!0,summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++})),this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.url="app/reports/incomes/table?"+this.queryString(this.reportForm),this.$http.get("app/reports/incomes",{params:n(n({},this.reportForm),{},{date:""})}).then((function(e){t.reportForm.date=[new Date(e.data.start_date),new Date(e.data.end_date)],t.prepareData(e.data.incomes),t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.date&&this.reportForm.date[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.date[0]).format(this.datetimeFormatString())),this.reportForm.date&&this.reportForm.date[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.date[1]).format(this.datetimeFormatString())),delete this.reportForm.date,this.url="app/reports/incomes/table?"+this.queryString(this.reportForm),this.refresh++,this.$http.get("app/reports/incomes",{params:n(n({},this.reportForm),{},{date:""})}).then((function(t){e.reportForm.date=[new Date(t.data.start_date),new Date(t.data.end_date)],e.prepareData(t.data.incomes),e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.reportForm.end_date=this.reportForm.date[1],this.reportForm.start_date=this.reportForm.date[0],this.data=[{label:this.$t("total_x",{x:this.$tc("income",2)}),value:t.count},{label:this.$t("total_x",{x:this.$tc("amount",2)}),value:t.amount}]},viewModal:function(t){var e=this;this.view=!0,t.id!=this.income.id&&(this.loading=!0,this.$http.get("app/incomes/".concat(t.id)).then((function(t){return e.income=t.data})).finally((function(){return e.loading=!1})))},renderAmount:function(t,e){return this.renderNumber(t,e,"amount")},renderAccount:function(t,e){return t("div",[e.row.account.name])},renderLocation:function(t,e){return t("div",[e.row.location.name])},renderCategory:function(t,e){return t("div",[e.row.categories.map((function(t){return t.name})).join("")])},renderUser:function(t,e){return t("div",[e.row.user?e.row.user.name:""])},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["amount"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return t.void||t.draft?0:Number(e.formatDecimal(t[n]))}));if(!o.every((function(t){return isNaN(t)}))){var l=o.reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatNumber(l)}}}else a[n]={key:n,value:""}})),a}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$tc("income",2)}))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" -\n      "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,reportForm:t.reportForm,updated:t.updated},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[e.value&&0!=e.value?r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box static",class:"box"+(i+3)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])]):t._e()]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("income")+" ("+t.income.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("income-view-component",{attrs:{income:t.income},on:{remove:function(e){return t.deleteAttachment(e,t.income)}}})],1)],1)}),[],!1,null,null,null).exports},86326:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(92704);const s={components:{ReportFormComponent:r(19996).Z},mixins:[(0,i.Z)("item","app/items","reference")],data:function(){return{url:"",item:{},dates:[],updated:0,view:!1,loading:!1,reportForm:{},showForm:!1,fields:["created_at","date","category_id"],columns:[{title:this.$t("code"),sortable:!0,sortType:"asc",key:"code",minWidth:150},{title:this.$t("name"),sortable:!0,key:"name",minWidth:175},{title:this.$t("sold"),sortable:!1,key:"sold",minWidth:175,width:150,render:this.renderSold},{minWidth:175,sortable:!1,key:"sold_amount",render:this.renderSoldAmount,title:this.$t("x_amount",{x:this.$t("sold")})},{title:this.$t("purchased"),sortable:!1,key:"purchased",minWidth:175,width:150,render:this.renderPurchased},{minWidth:175,sortable:!1,key:"purchased_amount",render:this.renderPurchasedAmount,title:this.$t("x_amount",{x:this.$t("purchased")})},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("created_at"),sortable:!0,key:"created_at",width:175,render:this.renderCreatedAt}],options:{hideSearch:!0,showSummary:!0,orderBy:["name asc"],summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.$event.listen("table:loaded",this.setDates),this.url="app/reports/items?"+this.queryString(this.reportForm)},methods:{setDates:function(t){this.dates=t},handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.end_date="",this.reportForm.start_date="",this.reportForm.end_created_at="",this.reportForm.start_created_at="",this.reportForm.date&&this.reportForm.date[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.date[0]).format(this.datetimeFormatString())),this.reportForm.date&&this.reportForm.date[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.date[1]).format(this.datetimeFormatString())),this.reportForm.created_at&&this.reportForm.created_at[0]&&(this.reportForm.start_created_at=this.$moment(this.reportForm.created_at[0]).format(this.datetimeFormatString())),this.reportForm.created_at&&this.reportForm.created_at[1]&&(this.reportForm.end_created_at=this.$moment(this.reportForm.created_at[1]).format(this.datetimeFormatString())),delete this.reportForm.date,delete this.reportForm.created_at,this.url="app/reports/items?"+this.queryString(this.reportForm),this.refresh++},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total",!0)},renderSold:function(t,e){var r=0;return e.row.sale_items.length&&(r=e.row.sale_items.reduce((function(t,e){return t+parseFloat(e.quantity)}),0)),this.renderMyNumber(r)},renderSoldAmount:function(t,e){var r=0;return e.row.sale_items.length&&(r=e.row.sale_items.reduce((function(t,e){return t+parseFloat(e.subtotal)}),0)),this.renderMyNumber(r)},renderPurchased:function(t,e){var r=0;return e.row.purchase_items.length&&(r=e.row.purchase_items.reduce((function(t,e){return t+parseFloat(e.quantity)}),0)),this.renderMyNumber(r)},renderPurchasedAmount:function(t,e){var r=0;return e.row.purchase_items.length&&(r=e.row.purchase_items.reduce((function(t,e){return t+parseFloat(e.subtotal)}),0)),this.renderMyNumber(r)},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["sold","sold_amount","purchased","purchased_amount"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.reduce((function(t,e){return"sold"==n?e.sale_items.length?t+parseFloat(e.sale_items.reduce((function(t,e){return t+parseFloat(e.quantity)}),0)):t:"purchased"==n?e.purchase_items.length?t+parseFloat(e.purchase_items.reduce((function(t,e){return t+parseFloat(e.quantity)}),0)):t:"sold_amount"==n?e.sale_items.length?t+parseFloat(e.sale_items.reduce((function(t,e){return t+parseFloat(e.subtotal)}),0)):t:"purchased_amount"==n?e.purchase_items.length?t+parseFloat(e.purchase_items.reduce((function(t,e){return t+parseFloat(e.subtotal)}),0)):t:void 0}),0);a[n]={key:n,value:e.formatNumber(o)}}else a[n]={key:n,value:""}})),a}}};const a=(0,r(51900).Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$tc("item",2)}))+"\n      "),t.dates[0]&&t.dates[1]?r("span",[t._v(" ("+t._s(t.datetime(new Date(t.dates[0])))+" - "+t._s(t.datetime(new Date(t.dates[1])))+") ")]):t._e()]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,reportForm:t.reportForm,updated:t.updated},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("table-component",{attrs:{url:t.url,columns:t.columns,"sub-data":"table",options:t.options,refresh:t.refresh}})],1)],1)],1)}),[],!1,null,null,null).exports},74768:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("log","app/logs")],data:function(){return{columns:[{width:50,fixed:"left",type:"expand",render:function(t,e){return t("pre",{style:{margin:"0 10px"}},JSON.stringify(e.row.properties,null,"  "))}},{title:this.$tc("created_at"),sortable:!0,key:"created_at",width:175,sortType:"desc",render:this.renderCreatedAt},{title:this.$tc("log_name"),sortable:!0,key:"log_name",width:125},{title:this.$tc("description"),sortable:!0,key:"description",minWidth:250},{title:this.$tc("by"),sortable:!1,key:"user",width:200,render:this.renderUser}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},methods:{rowClassName:function(t,e){return t.description.includes("deleted")?"ivu-table-error-row":t.description.includes("updated")?"ivu-table-warning-row":t.description.includes("created")?"ivu-table-success-row":""}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("logs")))]),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/logs",columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.showInfo,"row-class-name":t.rowClassName}})],1)])}),[],!1,null,null,null).exports},20788:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>u});var i=r(92704),s=r(19996),a=r(24874);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const c={mixins:[(0,i.Z)("payment","app/payments","reference")],components:{PaymentViewComponent:a.Z,ReportFormComponent:s.Z},data:function(){var t;return{url:"",data:{},payment:{},updated:0,view:!1,loading:!1,showForm:!1,reportForm:{},fields:["created_at","reference","custom_fields","customer_id","supplier_id","user_id","received"],columns:[{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("amount"),sortable:!1,key:"amount",width:150,render:this.renderAmount},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{title:this.$t("gateway"),sortable:!1,key:"gateway",width:150,render:this.renderGateway},{key:"for",maxWidth:300,minWidth:200,sortable:!1,title:this.$tc("account"),render:this.renderAccount},{key:"for",maxWidth:300,minWidth:200,sortable:!1,render:this.renderPayable,title:this.$tc("created_for")},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("received"),sortable:!0,key:"received",width:100,render:this.renderIconReceived},(t={title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0},l(t,"ellipsis",!0),l(t,"minWidth",300),l(t,"maxWidth",400),t)],options:{hideSearch:!0,showSummary:!0,summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows,orderBy:["created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++})),this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.url="app/reports/payments/table?"+this.queryString(this.reportForm),this.$http.get("app/reports/payments",{params:o(o({},this.reportForm),{},{created_at:""})}).then((function(e){t.reportForm.created_at=[new Date(e.data.start_date),new Date(e.data.end_date)],t.prepareData(e.data.payments),t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.created_at&&this.reportForm.created_at[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.created_at[0]).format(this.datetimeFormatString())),this.reportForm.created_at&&this.reportForm.created_at[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.created_at[1]).format(this.datetimeFormatString())),delete this.reportForm.created_at,this.url="app/reports/payments/table?"+this.queryString(this.reportForm),this.refresh++,this.$http.get("app/reports/payments",{params:o(o({},this.reportForm),{},{date:""})}).then((function(t){e.reportForm.created_at=[new Date(t.data.start_date),new Date(t.data.end_date)],e.prepareData(t.data.payments),e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.reportForm.end_date=this.reportForm.created_at[1],this.reportForm.start_date=this.reportForm.created_at[0],this.data=[{label:this.$t("total_x",{x:this.$tc("payment",2)}),value:t.total},{label:this.$t("total_x",{x:this.$t("amount")}),value:t.amount},{label:this.$t("total_x",{x:this.$t("received")}),value:t.received},{label:this.$t("total_x",{x:this.$t("received_amount")}),value:t.received_amount},{label:this.$t("total_x",{x:this.$t("due")}),value:t.due},{label:this.$t("total_x",{x:this.$t("due_amount")}),value:t.due_amount},{label:this.$t("customer_amount"),value:t.customer_amount},{label:this.$t("supplier_amount"),value:t.supplier_amount}]},viewModal:function(t){var e=this;this.view=!0,t.id!=this.payment.id&&(this.loading=!0,this.$http.get("app/payments/".concat(t.id)).then((function(t){return e.payment=t.data})).finally((function(){return e.loading=!1})))},renderAccount:function(t,e){return t("div",[e.row.account?e.row.account.name:""])},gatewayColor:function(t){var e={cash:"success",credit_card:"geekblue",cheque:"green",other:"purple"};return e[t]?e[t]:"primary"},renderGateway:function(t,e){return t("div",{class:"text-center"},[e.row.gateway?t("div",{class:"ivu-tag ivu-tag-".concat(this.gatewayColor(e.row.gateway)," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.$t(e.row.gateway)])]):""])},renderPayable:function(t,e){return t("div",[e.row.payable.name])},renderAmount:function(t,e){return this.renderNumber(t,e,"amount")},renderIconReceived:function(t,e){return this.renderBoolean(t,e,"received")},rowClassName:function(t,e){return 1==t.void?"ivu-table-error-row":1==t.draft?"ivu-table-warning-row":1==t.paid?"ivu-table-success-row":""},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["amount"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return 1==t.received?Number(e.formatDecimal(t[n])):0}));if(!o.every((function(t){return isNaN(t)}))){var l=o.reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatNumber(l)}}}else a[n]={key:n,value:""}})),a}}};const u=(0,r(51900).Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$tc("payment",2)}))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" -\n      "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,reportForm:t.reportForm,updated:t.updated},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box static",class:"box"+(i+1)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])])]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords,"row-class-name":t.rowClassName}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("payment")+" ("+t.payment.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("payment-view-component",{attrs:{payment:t.payment},on:{remove:function(e){return t.deleteAttachment(e,t.payment)}}})],1)],1)}),[],!1,null,null,null).exports},44515:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(92704),s=r(19996);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const l={components:{OrderViewComponent:r(82016).Z,ReportFormComponent:s.Z},mixins:[(0,i.Z)("purchase","app/purchases","reference")],data:function(){return{url:"",data:{},purchase:{},updated:0,view:!1,loading:!1,showForm:!1,reportForm:{},fields:["date","reference","custom_fields","supplier_id","user_id","draft","paid","void","item_id","serial"],columns:[{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",width:100,render:this.renderDate},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",minWidth:150},{maxWidth:300,minWidth:200,key:"supplier",sortable:!1,title:this.$tc("supplier"),render:this.renderSupplier},{title:this.$t("draft"),sortable:!0,key:"draft",width:80,render:this.renderIconDraft},{title:this.$t("paid"),sortable:!0,key:"paid",width:75,render:this.renderIconPaid},{title:this.$t("void"),sortable:!0,key:"void",width:75,render:this.renderIconVoid},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("total"),sortable:!1,key:"total",width:150,render:this.renderTotal},{title:this.$t("item_tax"),sortable:!1,key:"item_tax_amount",width:125,render:this.renderItemTax},{title:this.$t("order_tax"),sortable:!1,key:"order_tax_amount",width:125,render:this.renderOrderTax},{title:this.$t("discount"),sortable:!1,key:"discount_amount",width:125,render:this.renderDiscount},{title:this.$t("shipping"),sortable:!1,key:"shipping",width:125,render:this.renderShipping},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0,width:350}],options:{hideSearch:!0,showSummary:!0,summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++})),this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.url="app/reports/purchases/table?"+this.queryString(this.reportForm),this.$http.get("app/reports/purchases",{params:n(n({},this.reportForm),{},{date:""})}).then((function(e){t.reportForm.date=[new Date(e.data.start_date),new Date(e.data.end_date)],t.prepareData(e.data.purchases),t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.date&&this.reportForm.date[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.date[0]).format(this.datetimeFormatString())),this.reportForm.date&&this.reportForm.date[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.date[1]).format(this.datetimeFormatString())),delete this.reportForm.date,this.url="app/reports/purchases/table?"+this.queryString(this.reportForm),this.refresh++,this.$http.get("app/reports/purchases",{params:n(n({},this.reportForm),{},{date:""})}).then((function(t){e.reportForm.date=[new Date(t.data.start_date),new Date(t.data.end_date)],e.prepareData(t.data.purchases),e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.reportForm.end_date=this.reportForm.date[1],this.reportForm.start_date=this.reportForm.date[0],this.data=[{label:this.$t("total_x",{x:this.$tc("purchase",2)}),value:t.grand_total},{label:this.$t("total_x",{x:this.$tc("tax",2)}),value:t.total_tax_amount},{label:this.$t("total_x",{x:this.$t("recoverable_tax_amount")}),value:t.recoverable_tax_amount},{label:this.$t("total_x",{x:this.$t("recoverable_tax_calculated_on")}),value:t.recoverable_tax_calculated_on},{label:this.$t("total_x",{x:this.$t("discount")}),value:t.discount_amount},{label:this.$t("total_x",{x:this.$t("shipping")}),value:t.shipping}]},viewModal:function(t){var e=this;this.view=!0,t.id!=this.purchase.id&&(this.loading=!0,this.$http.get("app/purchases/".concat(t.id)).then((function(t){return e.purchase=t.data})).finally((function(){return e.loading=!1})))},renderSupplier:function(t,e){return t("div",[e.row.supplier.name])},renderTotal:function(t,e){return this.renderNumber(t,e,"total")},renderItemTax:function(t,e){return this.renderNumber(t,e,"item_tax_amount")},renderOrderTax:function(t,e){return this.renderNumber(t,e,"order_tax_amount")},renderDiscount:function(t,e){return this.renderNumber(t,e,"discount_amount")},renderShipping:function(t,e){return this.renderNumber(t,e,"shipping")},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total",!0)},renderIconActive:function(t,e){return this.renderUnlessIcon(t,e,"draft")},renderIconDraft:function(t,e){return this.renderBoolean(t,e,"draft")},renderIconPaid:function(t,e){return this.renderBoolean(t,e,"paid")},renderIconVoid:function(t,e){return this.renderBoolean(t,e,"void")},rowClassName:function(t,e){return 1==t.void?"ivu-table-error-row":1==t.draft?"ivu-table-warning-row":1==t.paid?"ivu-table-success-row":""},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["grand_total","total","item_tax_amount","order_tax_amount","discount_amount","shipping"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return t.void||t.draft?0:Number(e.formatDecimal(t[n]))})).reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatNumber(o)}}else a[n]={key:n,value:""}})),a}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$tc("purchase",2)}))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" -\n      "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,reportForm:t.reportForm,updated:t.updated},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[e.value&&0!=e.value?r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box static",class:"box"+(i+1)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])]):t._e()]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords,"row-class-name":t.rowClassName}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("purchase")+" ("+t.purchase.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{record:t.purchase,heading:t.$tc("purchase"),"to-text":t.$tc("bill_to")},on:{remove:function(e){return t.deleteAttachment(e,t.purchase)}}})],1)],1)}),[],!1,null,null,null).exports},12186:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("item","")],data:function(){return{columns:[{title:this.$t("name"),sortable:!0,key:"name",minWidth:200},{title:this.$t("code"),sortable:!0,key:"code",sortType:"asc",width:150},{title:this.$t("total_quantity"),sortable:!1,key:"location_stock",width:125,render:this.renderAllStock},{title:this.$t("location_quantity"),sortable:!1,key:"stock",width:150,render:this.renderStock},{title:this.$t("alert_quantity"),sortable:!1,key:"alert_quantity",width:150,render:this.renderAlertQuantity},{title:this.$t("rack_location"),sortable:!1,key:"location",width:125,render:this.renderRack}],options:{orderBy:"code",perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},methods:{renderAllStock:function(t,e){return t("div",{class:"text-center"},[this.$options.filters.formatNumber(e.row.stock.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),this.$store.getters.settings.decimals)])},renderStock:function(t,e){return t("div",{class:"text-center"},[e.row.location_stock.length>0&&e.row.location_stock[0].quantity?this.$options.filters.formatNumber(e.row.location_stock[0].quantity,this.$store.getters.settings.decimals):0])},renderAlertQuantity:function(t,e){return t("div",{class:"text-center"},[this.$options.filters.formatNumber(e.alert_quantity,this.$store.getters.settings.decimals)])},renderRack:function(t,e){return t("div",[e.row.location_stock.length>0&&e.row.location_stock[0].rack?e.row.location_stock[0].rack:e.row.location])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("product_quantity_alerts",{x:t.$tc("item",2)})))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/items"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list_x",{x:t.$tc("item",2)}))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/alerts/quantity",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},52787:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>d});var i=r(92704);const s={props:{close:{required:!0},record:{required:!0}},computed:{total:function(){return this.record?parseFloat(this.record.total_cash_amount)+parseFloat(this.record.total_cc_slips_amount)+parseFloat(this.record.total_cheques_amount)+parseFloat(this.record.total_other_amount)+parseFloat(this.record.total_gift_card_amount)-parseFloat(this.record.total_refunds_amount)-parseFloat(this.record.total_expenses_amount):0},total_sales:function(){return this.record?parseFloat(this.record.total_cash_amount)+parseFloat(this.record.total_cc_slips_amount)+parseFloat(this.record.total_cheques_amount)+parseFloat(this.record.total_other_amount)+parseFloat(this.record.total_gift_card_amount):0}}};var a=r(93379),n=r.n(a),o=r(51804),l={insert:"head",singleton:!1};n()(o.Z,l);o.Z.locals;var c=r(51900);const u={components:{PosRegisterComponent:(0,c.Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.record?r("div",{staticClass:"order register"},[t.record.closed_at?t._e():r("Alert",[t._v("\n    "+t._s(t.$tc("register_is_not_closed"))+"\n  ")]),t._v(" "),r("List",{attrs:{border:""}},[r("ListItem",{staticClass:"table-wrapper"},[r("table",{staticClass:"table mt-0"},[r("tr",[r("td",{staticClass:"bold bg-gray",staticStyle:{"border-radius":"5px 0 0 0"}},[t._v(t._s(t.$tc("register")))]),t._v(" "),r("td",{staticClass:"bold bg-gray",staticStyle:{"border-radius":"0 5px 0 0"}},[t._v(t._s(t.record.register.name))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("opened_at")))]),t._v(" "),r("td",{staticClass:"bold"},[t._v(t._s(t._f("datetime")(t.record.created_at)))])]),t._v(" "),t.record.closed_at?r("tr",[r("td",[t._v(t._s(t.$t("closed_at")))]),t._v(" "),r("td",{staticClass:"bold"},[t._v(t._s(t._f("datetime")(t.record.closed_at)))])]):t._e(),t._v(" "),t.record.closed_by?r("tr",[r("td",[t._v(t._s(t.$t("closed_by")))]),t._v(" "),r("td",{staticClass:"bold"},[t._v(t._s(t.record.closed_by_user.name))])]):t._e(),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("total_sales_amount")))]),t._v(" "),r("td",{staticClass:"bold",staticStyle:{"border-radius":"0 0 5px 0"}},[t._v("\n            "+t._s(t._f("formatNumber")(t.total_sales,t.$store.state.settings.decimals))+"\n          ")])])])])],1),t._v(" "),r("List",{staticClass:"mt16",attrs:{border:""}},[r("ListItem",{staticClass:"table-wrapper mt-0"},[r("table",{staticClass:"table"},[r("tr",[r("td",[t._v(t._s(t.$t("cash_in_hand")))]),t._v(" "),r("td",{staticClass:"bold text-right"},[t._v(t._s(t._f("formatNumber")(t.record.cash_in_hand,t.$store.state.settings.decimals)))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("x_amount",{x:t.$t("cash")})))]),t._v(" "),r("td",{staticClass:"bold text-right"},[t._v(t._s(t._f("formatNumber")(t.record.total_cash_amount,t.$store.state.settings.decimals)))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("x_amount",{x:t.$t("credit_card")})))]),t._v(" "),r("td",{staticClass:"bold text-right"},[t._v(t._s(t._f("formatNumber")(t.record.total_cc_slips_amount,t.$store.state.settings.decimals)))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("x_amount",{x:t.$t("cheque")})))]),t._v(" "),r("td",{staticClass:"bold text-right"},[t._v(t._s(t._f("formatNumber")(t.record.total_cheques_amount,t.$store.state.settings.decimals)))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("x_amount",{x:t.$t("other")})))]),t._v(" "),r("td",{staticClass:"bold text-right"},[t._v(t._s(t._f("formatNumber")(t.record.total_other_amount,t.$store.state.settings.decimals)))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("x_amount",{x:t.$tc("gift_card")})))]),t._v(" "),r("td",{staticClass:"bold text-right"},[t._v(t._s(t._f("formatNumber")(t.record.total_gift_card_amount,t.$store.state.settings.decimals)))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("x_amount",{x:t.$tc("return_order",2)})))]),t._v(" "),r("td",{staticClass:"bold text-right"},[t._v(t._s(t._f("formatNumber")(t.record.total_return_orders_amount,t.$store.state.settings.decimals)))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("x_amount",{x:t.$tc("refund")})))]),t._v(" "),r("td",{staticClass:"bold text-right"},[t._v(t._s(t._f("formatNumber")(t.record.total_refunds_amount,t.$store.state.settings.decimals)))])]),t._v(" "),r("tr",[r("td",[t._v(t._s(t.$t("x_amount",{x:t.$tc("expense",2)})))]),t._v(" "),r("td",{staticClass:"bold text-right"},[t._v(t._s(t._f("formatNumber")(t.record.total_expenses_amount,t.$store.state.settings.decimals)))])]),t._v(" "),r("tr",[r("td",{staticClass:"bold bg-gray",staticStyle:{"border-radius":"0 0 0 5px"}},[t._v(t._s(t.$t("total_amount")))]),t._v(" "),r("td",{staticClass:"bold text-right bg-gray",staticStyle:{"border-radius":"0 0 5px 0"}},[t._v("\n            "+t._s(t._f("formatNumber")(t.total,t.$store.state.settings.decimals))+"\n          ")])])])])],1)],1):t._e()}),[],!1,null,null,null).exports},mixins:[(0,i.Z)("register","app/reports/registers","id","id")],data:function(){var t=this;return{columns:[{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"asc",minWidth:175,render:this.renderCreatedAt},{title:this.$tc("register"),sortable:!0,key:"register",width:150,render:this.renderRegister},{title:this.$tc("user"),sortable:!0,key:"user",width:150,render:this.renderUser},{title:this.$tc("cash_in_hand"),sortable:!1,key:"cash_in_hand",width:125,render:this.renderCashInHand},{width:175,sortable:!1,key:"total_cash_submitted",render:this.renderTotalCash,title:this.$t("x_sales",{x:this.$t("cash")})},{width:175,sortable:!1,key:"total_cheque_submitted",render:this.renderTotalCheque,title:this.$t("x_sales",{x:this.$t("cheque")})},{width:175,sortable:!1,key:"total_cc_slips_submitted",render:this.renderTotalCreditCard,title:this.$t("x_sales",{x:this.$t("credit_card")})},{width:125,sortable:!1,key:"total_gift_card_amount",render:this.renderTotalGiftCard,title:this.$t("x_sales",{x:this.$tc("gift_card")})},{width:125,sortable:!1,key:"total_other_amount",render:this.renderTotalOther,title:this.$t("x_sales",{x:this.$t("other")})},{width:125,sortable:!1,title:this.$tc("expense",2),key:"total_expenses_amount",render:this.renderTotalExpenses},{width:125,sortable:!1,key:"total_return_orders_amount",title:this.$tc("return_order",2),render:this.renderTotalReturnOrder},{width:125,sortable:!1,key:"total_refunds_amount",title:this.$tc("refund",2),render:this.renderTotalRefunds},{title:this.$t("closed_at"),sortable:!0,key:"closed_at",sortType:"asc",minWidth:175,render:this.renderClosedAt},{title:this.$t("closed_by"),sortable:!0,key:"closed_by",sortType:"asc",minWidth:175,render:this.renderClosedBy},{width:75,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,viewFn:t.viewRecord,record:{model:"register",name:"date",title:t.$tc("register")}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows},record:null,recordModal:!1}},methods:{viewRecord:function(t){this.record=t,this.recordModal=!0},closeRecordModal:function(){this.record=null,this.recordModal=!1},renderUser:function(t,e){return t("div",[e.row.user.name])},renderRegister:function(t,e){return t("div",[t("div",[e.row.register.name]),t("div",[e.row.location.name])])},renderClosedAt:function(t,e){return t("div",[e.row.closed_at?this.$options.filters.formatDate(e.row.closed_at,this.$store.state.settings.dateformat+" HH:mm A"):""])},renderClosedBy:function(t,e){return t("div",[e.row.closed_by_user?e.row.closed_by_user.name:""])},renderCashInHand:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.cash_in_hand,this.$store.getters.settings.decimals)])},renderTotalOther:function(t,e){return t("div",{class:"text-right"},[e.row.closed_at?this.$options.filters.formatNumber(e.row.total_other_amount,this.$store.getters.settings.decimals):""])},renderTotalGiftCard:function(t,e){return t("div",{class:"text-right"},[e.row.closed_at?this.$options.filters.formatNumber(e.row.total_gift_card_amount,this.$store.getters.settings.decimals):""])},renderTotalExpenses:function(t,e){return t("div",{class:"text-right"},[e.row.closed_at?this.$options.filters.formatNumber(e.row.total_expenses_amount,this.$store.getters.settings.decimals):""])},renderTotalRefunds:function(t,e){return t("div",{class:"text-right"},[e.row.closed_at?this.$options.filters.formatNumber(e.row.total_refunds_amount,this.$store.getters.settings.decimals):""])},renderTotalReturnOrder:function(t,e){return t("div",{class:"text-right"},[e.row.closed_at?this.$options.filters.formatNumber(e.row.total_return_orders_amount,this.$store.getters.settings.decimals):""])},renderTotalCash:function(t,e){return e.row.closed_at?t("table",{class:"table table-sm"},[t("tr",[t("td",[this.$t("total"),":"]),t("td",{class:"text-right"},[this.$options.filters.formatNumber(e.row.total_cash_amount,this.$store.getters.settings.decimals)])]),t("tr",[t("td",[this.$t("submitted"),":"]),t("td",{class:"text-right"},[this.$options.filters.formatNumber(e.row.total_cash_submitted,this.$store.getters.settings.decimals)])])]):""},renderTotalCheque:function(t,e){return e.row.closed_at?t("table",{class:"table table-sm"},[t("tr",[t("td",[this.$t("total"),":"]),t("td",{class:"text-right"},[this.$options.filters.formatNumber(e.row.total_cheques,this.$store.getters.settings.decimals)])]),t("tr",[t("td",[this.$t("submitted"),":"]),t("td",{class:"text-right"},[this.$options.filters.formatNumber(e.row.total_cheques_submitted,this.$store.getters.settings.decimals)])])]):""},renderTotalCreditCard:function(t,e){return e.row.closed_at?t("table",{class:"table table-sm"},[t("tr",[t("td",[this.$t("total"),":"]),t("td",{class:"text-right"},[this.$options.filters.formatNumber(e.row.total_cc_slips,this.$store.getters.settings.decimals)])]),t("tr",[t("td",[this.$t("submitted"),":"]),t("td",{class:"text-right"},[this.$options.filters.formatNumber(e.row.total_cc_slips_submitted,this.$store.getters.settings.decimals)])])]):""}}};const d=(0,c.Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("register",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/reports"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$tc("report",2))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{columns:t.columns,options:t.options,dblClickCB:t.showInfo,url:"app/reports/registers",bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1),t._v(" "),r("Modal",{attrs:{title:t.$t("register_details"),"mask-closable":!1,"footer-hide":!0},model:{value:t.recordModal,callback:function(e){t.recordModal=e},expression:"recordModal"}},[r("pos-register-component",{attrs:{record:t.record,close:t.closeRecordModal}})],1)],1)}),[],!1,null,null,null).exports},19996:(t,e,r)=>{"use strict";r.d(e,{Z:()=>c});var i=r(23279),s=r.n(i);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const l={props:{fields:{type:Array,required:!0},reportForm:{type:Object,default:{}},updated:{type:Number,default:0},statusOptions:{type:Array,default:function(){return[]}}},data:function(){return{form:{date:[],paid:"",void:"",draft:"",title:"",status:"",serial:"",details:"",item_id:"",user_id:"",reference:"",account_id:"",category_id:"",customer_id:"",location_id:"",supplier_id:"",custom_fields:"",to_location_id:"",from_location_id:""},oForm:{},rules:{},users:[],accounts:[],locations:[],categories:[],customers:[],suppliers:[],searching:!1,dateOptions:{shortcuts:[{text:this.$t("today"),value:function(){var t=new Date;return[new Date(t.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,999))]}},{text:this.$t("yesterday"),value:function(){var t=new Date;return t.setTime(t.getTime()-864e5),[new Date(t.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,999))]}},{text:this.$t("x_days",{x:7}),value:function(){var t=new Date,e=new Date;return e.setTime(e.getTime()-6048e5),[new Date(e.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,999))]}},{text:this.$t("x_days",{x:30}),value:function(){var t=new Date,e=new Date;return e.setTime(e.getTime()-2592e6),[new Date(e.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,999))]}},{text:this.$t("x_days",{x:60}),value:function(){var t=new Date,e=new Date;return e.setTime(e.getTime()-5184e6),[new Date(e.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,999))]}},{text:this.$t("x_days",{x:90}),value:function(){var t=new Date,e=new Date;return e.setTime(e.getTime()-7776e6),[new Date(e.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,999))]}},{text:this.$t("x_days",{x:180}),value:function(){var t=new Date,e=new Date;return e.setTime(e.getTime()-15552e6),[new Date(e.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,999))]}},{text:this.$t("this_x",{x:this.$t("year")}),value:function(){var t=new Date,e=new Date(t.getFullYear(),0,1),r=new Date(t.getFullYear(),t.getMonth()+1,0);return[new Date(e.setHours(0,0,0,0)),new Date(r.setHours(23,59,59,999))]}},{text:this.$t("last_x",{x:this.$t("year")}),value:function(){var t=new Date,e=new Date(t.getFullYear()-1,0,1),r=new Date(t.getFullYear(),0,0);return[new Date(e.setHours(0,0,0,0)),new Date(r.setHours(23,59,59,999))]}}]}}},watch:{updated:{deep:!0,handler:function(){var t=this;this.fields.map((function(e){t.form[e]=t.reportForm[e]}))}}},created:function(){var t=this;this.oForm=n({},this.form),this.$http.get("app/accounts/search").then((function(e){t.accounts=e.data,t.$http.get("app/locations/search").then((function(e){return t.locations=e.data})).finally((function(){return t.loading=!1}))})).finally((function(){return t.searching=!1}))},mounted:function(){var t=this;this.fields.map((function(e){t.form[e]=t.reportForm[e]}))},methods:{handleSubmit:function(){return this.$emit("submit",this.form),!1},handleReset:function(){this.form=n({},this.oForm),this.$refs.reportForm.resetFields(),this.$emit("submit",this.form)},searchCustomers:function(t){""===t||this.customers.find((function(e){return e.label==t}))||this.getCustomers(t,this)},getCustomers:s()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/customers/search?q="+t).then((function(t){return e.customers=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),searchSuppliers:function(t){""===t||this.suppliers.find((function(e){return e.label==t}))||this.getSuppliers(t,this)},getSuppliers:s()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/suppliers/search?q="+t).then((function(t){return e.suppliers=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),searchUsers:function(t){""===t||this.users.find((function(e){return e.label==t}))||this.getUsers(t,this)},getUsers:s()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/users/search?q="+t).then((function(t){return e.users=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),searchCategories:function(t){""===t||this.categories.find((function(e){return e.label==t}))||this.getCategories(t,this)},getCategories:s()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/categories/search?q="+t).then((function(t){return e.categories=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250)}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Form",{ref:"reportForm",attrs:{model:t.form,rules:t.rules,"label-position":"top"}},[r("Row",{attrs:{gutter:16}},[t.fields.includes("date")?r("Col",{attrs:{sm:12,md:12}},[r("FormItem",{attrs:{label:t.$t("date")}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{"split-panels":"",type:"datetimerange",options:t.dateOptions},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1)],1):t._e(),t._v(" "),t.fields.includes("created_at")?r("Col",{attrs:{sm:12,md:12}},[r("FormItem",{attrs:{label:t.$t("created_at")}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","split-panels":"",options:t.dateOptions},model:{value:t.form.created_at,callback:function(e){t.$set(t.form,"created_at",e)},expression:"form.created_at"}})],1)],1):t._e(),t._v(" "),t.fields.includes("reference")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$t("reference")}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1)],1):t._e(),t._v(" "),t.fields.includes("status")&&t.statusOptions.length?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$t("status")}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.statusOptions,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(t.$t(e)))])})),1)],1)],1):t._e(),t._v(" "),t.fields.includes("custom_fields")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("field",2)}},[r("Input",{model:{value:t.form.custom_fields,callback:function(e){t.$set(t.form,"custom_fields",e)},expression:"form.custom_fields"}})],1)],1):t._e(),t._v(" "),t.fields.includes("location_id")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("location")}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.location_id,callback:function(e){t.$set(t.form,"location_id",e)},expression:"form.location_id"}},[t.locations.length>0?t._l(t.locations,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n              "+t._s(e.label)+"\n            ")])})):t._e()],2)],1)],1):t._e(),t._v(" "),t.fields.includes("from_location")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$t("from_location")}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.from_location_id,callback:function(e){t.$set(t.form,"from_location_id",e)},expression:"form.from_location_id"}},[t.locations.length>0?t._l(t.locations,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n              "+t._s(e.label)+"\n            ")])})):t._e()],2)],1)],1):t._e(),t._v(" "),t.fields.includes("to_location")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$t("to_location")}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.to_location_id,callback:function(e){t.$set(t.form,"to_location_id",e)},expression:"form.to_location_id"}},[t.locations.length>0?t._l(t.locations,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n              "+t._s(e.label)+"\n            ")])})):t._e()],2)],1)],1):t._e(),t._v(" "),t.fields.includes("account_id")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("account")}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,placeholder:""},model:{value:t.form.account_id,callback:function(e){t.$set(t.form,"account_id",e)},expression:"form.account_id"}},t._l(t.accounts,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1):t._e(),t._v(" "),t.fields.includes("category_id")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("category")}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchCategories,placeholder:t.$t("type_to_search")},model:{value:t.form.category_id,callback:function(e){t.$set(t.form,"category_id",e)},expression:"form.category_id"}},t._l(t.categories,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1):t._e(),t._v(" "),t.fields.includes("customer_id")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("customer")}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchCustomers,placeholder:t.$t("type_to_search")},model:{value:t.form.customer_id,callback:function(e){t.$set(t.form,"customer_id",e)},expression:"form.customer_id"}},t._l(t.customers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1):t._e(),t._v(" "),t.fields.includes("supplier_id")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("supplier")}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchSuppliers,placeholder:t.$t("type_to_search")},model:{value:t.form.supplier_id,callback:function(e){t.$set(t.form,"supplier_id",e)},expression:"form.supplier_id"}},t._l(t.suppliers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1):t._e(),t._v(" "),t.fields.includes("user_id")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$t("created_by")}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchUsers,placeholder:t.$t("type_to_search")},model:{value:t.form.user_id,callback:function(e){t.$set(t.form,"user_id",e)},expression:"form.user_id"}},t._l(t.users,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1):t._e(),t._v(" "),t.fields.includes("item_id")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("item")}},[r("Input",{model:{value:t.form.item_id,callback:function(e){t.$set(t.form,"item_id",e)},expression:"form.item_id"}})],1)],1):t._e(),t._v(" "),t.fields.includes("serial")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("serial_number")}},[r("Input",{model:{value:t.form.serial,callback:function(e){t.$set(t.form,"serial",e)},expression:"form.serial"}})],1)],1):t._e(),t._v(" "),t.fields.includes("title")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$t("title")}},[r("Input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1):t._e(),t._v(" "),t.fields.includes("details")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$t("details")}},[r("Input",{model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],1):t._e()],1),t._v(" "),r("Row",{attrs:{gutter:16}},[t.fields.includes("approved")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("approved")}},[r("RadioGroup",{model:{value:t.form.approved,callback:function(e){t.$set(t.form,"approved",e)},expression:"form.approved"}},[r("Radio",{attrs:{label:""}},[r("span",[t._v(t._s(t.$t("all")))])]),t._v(" "),r("Radio",{attrs:{label:"1"}},[r("span",[t._v(t._s(t.$t("yes")))])]),t._v(" "),r("Radio",{attrs:{label:"0"}},[r("span",[t._v(t._s(t.$t("no")))])])],1)],1)],1):t._e(),t._v(" "),t.fields.includes("draft")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("draft")}},[r("RadioGroup",{model:{value:t.form.draft,callback:function(e){t.$set(t.form,"draft",e)},expression:"form.draft"}},[r("Radio",{attrs:{label:""}},[r("span",[t._v(t._s(t.$t("all")))])]),t._v(" "),r("Radio",{attrs:{label:"1"}},[r("span",[t._v(t._s(t.$t("yes")))])]),t._v(" "),r("Radio",{attrs:{label:"0"}},[r("span",[t._v(t._s(t.$t("no")))])])],1)],1)],1):t._e(),t._v(" "),t.fields.includes("paid")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("paid")}},[r("RadioGroup",{model:{value:t.form.paid,callback:function(e){t.$set(t.form,"paid",e)},expression:"form.paid"}},[r("Radio",{attrs:{label:""}},[r("span",[t._v(t._s(t.$t("all")))])]),t._v(" "),r("Radio",{attrs:{label:"1"}},[r("span",[t._v(t._s(t.$t("yes")))])]),t._v(" "),r("Radio",{attrs:{label:"0"}},[r("span",[t._v(t._s(t.$t("no")))])])],1)],1)],1):t._e(),t._v(" "),t.fields.includes("void")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("void")}},[r("RadioGroup",{model:{value:t.form.void,callback:function(e){t.$set(t.form,"void",e)},expression:"form.void"}},[r("Radio",{attrs:{label:""}},[r("span",[t._v(t._s(t.$t("all")))])]),t._v(" "),r("Radio",{attrs:{label:"1"}},[r("span",[t._v(t._s(t.$t("yes")))])]),t._v(" "),r("Radio",{attrs:{label:"0"}},[r("span",[t._v(t._s(t.$t("no")))])])],1)],1)],1):t._e(),t._v(" "),t.fields.includes("pos")?r("Col",{attrs:{sm:12,md:6}},[r("FormItem",{attrs:{label:t.$tc("pos")}},[r("RadioGroup",{model:{value:t.form.pos,callback:function(e){t.$set(t.form,"pos",e)},expression:"form.pos"}},[r("Radio",{attrs:{label:""}},[r("span",[t._v(t._s(t.$t("all")))])]),t._v(" "),r("Radio",{attrs:{label:"1"}},[r("span",[t._v(t._s(t.$t("yes")))])]),t._v(" "),r("Radio",{attrs:{label:"0"}},[r("span",[t._v(t._s(t.$t("no")))])])],1)],1)],1):t._e()],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit()}}},[t._v(t._s(t.$t("submit")))]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)}),[],!1,null,null,null).exports},32433:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(57797);const s={data:function(){return{data:{},report_routes:[]}},created:function(){var t=this;this.report_routes=this.routes=(0,i._)(this.$store.state.user_language)[0].children.find((function(t){return"reports"==t.path})).children,this.$http.get("app/reports/totals").then((function(e){t.prepareData(e.data.totals),t.updated++})).finally((function(){return t.loading=!1}))},methods:{prepareData:function(t){this.data=[{label:this.$t("total_x",{x:this.$tc("sale",2)}),value:t.sales},{label:this.$t("total_x",{x:this.$tc("purchase",2)}),value:t.purchases},{label:this.$t("total_x",{x:this.$tc("income",2)}),value:t.incomes},{label:this.$t("total_x",{x:this.$tc("expense",2)}),value:t.expenses},{label:this.$t("total_x",{x:this.$tc("quotation",2)}),value:t.quotations},{label:this.$t("total_x",{x:this.$tc("return_order",2)}),value:t.return_orders},{label:this.$t("total_x",{x:this.$tc("stock_adjustment",2)}),value:t.stock_adjustments},{label:this.$t("total_x",{x:this.$tc("stock_transfer",2)}),value:t.stock_transfers},{label:this.$t("total_x",{x:this.$tc("customer",2)}),value:t.customers},{label:this.$t("total_x",{x:this.$tc("supplier",2)}),value:t.suppliers},{label:this.$t("total_x",{x:this.$tc("category",2)}),value:t.categories},{label:this.$t("total_x",{x:this.$tc("brand",2)}),value:t.brands},{label:this.$t("total_x",{x:this.$tc("item",2)}),value:t.standard_items},{label:this.$t("total_x",{x:this.$tc("service",2)}),value:t.services},{label:this.$t("total_x",{x:this.$tc("recipe",2)}),value:t.recipes},{label:this.$t("total_x",{x:this.$tc("combo",2)}),value:t.combos}]},onSelect:function(t){t&&("mail_settings"==t?this.email=!0:"scale_barcode"==t?this.scale_barcode_show=!0:"payment_settings"==t?this.payment=!0:this.$router.push({name:t}))}}};const a=(0,r(51900).Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("report",2)))]),t._v(" "),r("a",{attrs:{slot:"extra",href:"#"},slot:"extra"},[r("Dropdown",{staticStyle:{margin:"0 -5px 0 20px"},attrs:{placement:"bottom-end"},on:{"on-click":t.onSelect}},[r("a",{staticStyle:{"padding-right":"10px"},attrs:{href:"javascript:void(0)"}},[r("Icon",{attrs:{type:"md-menu",size:"18"}})],1),t._v(" "),r("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[t.report_routes.length>0?[t._l(t.report_routes,(function(e,i){return[i&&!e.meta.hideInMenu?[r("DropdownItem",{key:e.name,attrs:{name:e.name,divided:e.meta.divided}},[t._v("\n                "+t._s(e.meta.title)+"\n              ")])]:t._e()]}))]:t._e()],2)],1)],1),t._v(" "),r("div",{staticStyle:{"margin-bottom":"-16px"}},[r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box dark static"},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(parseInt(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])])]}))],2),t._v(" "),r("h3",{staticClass:"mt16 mb16"},[t._v(t._s(t.$t("links")))]),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.report_routes,(function(e,i){return[i&&!e.meta.hideInMenu?r("Col",{key:i,attrs:{sm:12,md:6}},[r("router-link",{staticClass:"box-hover",attrs:{to:e.path}},[r("div",{staticClass:"box static"},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(e.meta.title))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])])],1):t._e()]}))],2)],1)])}),[],!1,null,null,null).exports},80386:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>u});var i=r(92704),s=r(19996),a=r(82016);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const c={mixins:[(0,i.Z)("sale","app/sales","reference")],components:{OrderViewComponent:a.Z,ReportFormComponent:s.Z},data:function(){return{url:"",data:{},sale:{},updated:0,view:!1,printData:{},loading:!1,showForm:!1,printing:!1,printModal:!1,reportForm:{},fields:["date","reference","custom_fields","customer_id","user_id","draft","paid","void","pos","item_id","serial"],columns:[{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",width:100,render:this.renderDate},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",minWidth:150},{maxWidth:300,minWidth:200,key:"customer",sortable:!1,title:this.$tc("customer"),render:this.renderCustomer},{title:this.$t("draft"),sortable:!0,key:"draft",width:80,render:this.renderIconDraft},{title:this.$t("paid"),sortable:!0,key:"paid",width:75,render:this.renderIconPaid},{title:this.$t("void"),sortable:!0,key:"void",width:75,render:this.renderIconVoid},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("total"),sortable:!1,key:"total",width:150,render:this.renderTotal},{title:this.$t("item_tax"),sortable:!1,key:"item_tax_amount",width:125,render:this.renderItemTax},{title:this.$t("order_tax"),sortable:!1,key:"order_tax_amount",width:125,render:this.renderOrderTax},{title:this.$t("discount"),sortable:!1,key:"discount_amount",width:125,render:this.renderDiscount},{title:this.$t("shipping"),sortable:!1,key:"shipping",width:125,render:this.renderShipping},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0,width:350}],options:{hideSearch:!0,showSummary:!0,summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++})),this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.url="app/reports/sales/table?"+this.queryString(this.reportForm),this.$http.get("app/reports/sales",{params:o(o({},this.reportForm),{},{date:""})}).then((function(e){t.reportForm.date=[new Date(e.data.start_date),new Date(e.data.end_date)],t.prepareData(e.data.sales),t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.date&&this.reportForm.date[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.date[0]).format(this.datetimeFormatString())),this.reportForm.date&&this.reportForm.date[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.date[1]).format(this.datetimeFormatString())),delete this.reportForm.date,this.url="app/reports/sales/table?"+this.queryString(this.reportForm),this.refresh++,this.$http.get("app/reports/sales",{params:o(o({},this.reportForm),{},{date:""})}).then((function(t){e.reportForm.date=[new Date(t.data.start_date),new Date(t.data.end_date)],e.prepareData(t.data.sales),e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.reportForm.end_date=this.reportForm.date[1],this.reportForm.start_date=this.reportForm.date[0],this.data=[{label:this.$t("total_x",{x:this.$tc("sale",2)}),value:t.grand_total},{label:this.$t("total_x",{x:this.$tc("tax",2)}),value:t.total_tax_amount},{label:this.$t("total_x",{x:this.$t("recoverable_tax_amount")}),value:t.recoverable_tax_amount},{label:this.$t("total_x",{x:this.$t("recoverable_tax_calculated_on")}),value:t.recoverable_tax_calculated_on},{label:this.$t("total_x",{x:this.$t("discount")}),value:t.discount_amount},{label:this.$t("total_x",{x:this.$t("shipping")}),value:t.shipping}]},showReceipt:function(){var t=this;this.printData.type="receipt",this.printData.order=this.sale,this.printData.order.items=this.printData.order.items.map((function(t){return t.selected={portions:[],variations:[],modifiers:[]},t.selected.portions=t.portions,t.selected.variations=t.variations,t.selected.modifiers=t.modifier_options,t})),this.$Modal.confirm({width:365,closable:!0,scrollable:!0,render:function(e){return e("print-component",{props:{print:t.printData,vm:t}})},okText:this.$t("print"),onOk:function(){window.print()},onCancel:function(){setTimeout((function(){return t.printData={}}),200)}})},viewModal:function(t){var e=this;t.id!=this.sale.id?(this.loading=!0,this.$http.get("app/sales/".concat(t.id)).then((function(t){e.sale=t.data,1==e.sale.pos?e.showReceipt():e.view=!0})).finally((function(){return e.loading=!1}))):1==this.sale.pos?this.showReceipt():this.view=!0},renderCustomer:function(t,e){return t("div",[e.row.customer.name])},renderTotal:function(t,e){return this.renderNumber(t,e,"total")},renderItemTax:function(t,e){return this.renderNumber(t,e,"item_tax_amount")},renderOrderTax:function(t,e){return this.renderNumber(t,e,"order_tax_amount")},renderDiscount:function(t,e){return this.renderNumber(t,e,"discount_amount")},renderShipping:function(t,e){return this.renderNumber(t,e,"shipping")},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total",!0)},renderIconActive:function(t,e){return this.renderUnlessIcon(t,e,"draft")},renderIconDraft:function(t,e){return this.renderBoolean(t,e,"draft")},renderIconPaid:function(t,e){return this.renderBoolean(t,e,"paid")},renderIconVoid:function(t,e){return this.renderBoolean(t,e,"void")},rowClassName:function(t,e){return 1==t.void?"ivu-table-error-row":1==t.draft?"ivu-table-warning-row":1==t.paid?"ivu-table-success-row":""},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["grand_total","total","item_tax_amount","order_tax_amount","discount_amount","shipping"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return t.void||t.draft?0:Number(e.formatDecimal(t[n]))}));if(!o.every((function(t){return isNaN(t)}))){var l=o.reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatNumber(l)}}}else a[n]={key:n,value:""}})),a}}};const u=(0,r(51900).Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$tc("sale",2)}))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" -\n      "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,reportForm:t.reportForm,updated:t.updated},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[e.value&&0!=e.value?r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box static",class:"box"+(i+1)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])]):t._e()]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords,"row-class-name":t.rowClassName}})],1)],1),t._v(" "),t.loading?r("center-loading-component"):t._e(),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("sale")+" ("+t.sale.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{record:t.sale,heading:t.$tc("sale"),"to-text":t.$tc("bill_to")},on:{remove:function(e){return t.deleteAttachment(e,t.sale)}}})],1)],1)}),[],!1,null,null,null).exports},98334:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(92704),s=r(19996);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const l={components:{OrderViewComponent:r(82016).Z,ReportFormComponent:s.Z},mixins:[(0,i.Z)("stock_adjustment","app/stock_adjustments","reference")],data:function(){var t;return{url:"",data:{},updated:0,view:!1,loading:!1,showForm:!1,reportForm:{},stock_adjustment:{},fields:["date","reference","custom_fields","item_id","serial","user_id","details","draft"],columns:[{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",width:100,render:this.renderDate},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("type"),sortable:!0,key:"type",width:125,render:this.renderType},{title:this.$t("total"),sortable:!0,key:"grand_total",width:150,render:this.renderGrandTotal},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{minWidth:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("draft"),sortable:!0,key:"draft",width:80,render:this.renderIconDraft},(t={title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0},o(t,"ellipsis",!0),o(t,"minWidth",250),o(t,"maxWidth",600),t),{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt}],options:{hideSearch:!0,showSummary:!0,summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++})),this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.url="app/reports/adjustments/table?"+this.queryString(this.reportForm),this.$http.get("app/reports/adjustments",{params:n(n({},this.reportForm),{},{date:""})}).then((function(e){t.reportForm.date=[new Date(e.data.start_date),new Date(e.data.end_date)],t.prepareData(e.data.stock_adjustments),t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.date&&this.reportForm.date[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.date[0]).format(this.datetimeFormatString())),this.reportForm.date&&this.reportForm.date[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.date[1]).format(this.datetimeFormatString())),delete this.reportForm.date,this.url="app/reports/adjustments/table?"+this.queryString(this.reportForm),this.refresh++,this.$http.get("app/reports/adjustments",{params:n(n({},this.reportForm),{},{date:""})}).then((function(t){e.reportForm.date=[new Date(t.data.start_date),new Date(t.data.end_date)],e.prepareData(t.data.stock_adjustments),e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.reportForm.end_date=this.reportForm.date[1],this.reportForm.start_date=this.reportForm.date[0],this.data=[{label:this.$t("total_x",{x:this.$tc("stock_adjustment",2)}),value:t.grand_total},{label:this.$t("total_x",{x:this.$tc("tax",2)}),value:t.total_tax_amount},{label:this.$t("total_x",{x:this.$tc("additions")}),value:t.additions_total},{label:this.$t("total_x",{x:this.$tc("damages")}),value:t.damages_total},{label:this.$t("total_x",{x:this.$tc("subtractions")}),value:t.subtractions_total}]},viewModal:function(t){var e=this;this.view=!0,t.id!=this.stock_adjustment.id&&(this.loading=!0,this.$http.get("app/adjustments/".concat(t.id)).then((function(t){return e.stock_adjustment=t.data})).finally((function(){return e.loading=!1})))},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total")},renderIconDraft:function(t,e){return this.renderBoolean(t,e,"draft")},renderType:function(t,e){return t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-".concat("addition"==e.row.type?"green":"red"," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.capitalize(e.row.type)])])])},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["grand_total"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return t.void||t.draft?0:Number(e.formatDecimal(t[n]))}));if(!o.every((function(t){return isNaN(t)}))){var l=o.reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatNumber(l)}}}else a[n]={key:n,value:""}})),a}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$tc("stock_adjustment",2)}))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" -\n      "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,reportForm:t.reportForm,updated:t.updated},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[e.value&&0!=e.value?r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box static",class:"box"+(i+1)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])]):t._e()]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("stock_adjustment")+" ("+t.stock_adjustment.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{"to-text":"",to:!1,field:"cost",payment:!1,record:t.stock_adjustment,heading:t.$tc("stock_adjustment")},on:{remove:function(e){return t.deleteAttachment(e,t.stock_adjustment)}}})],1)],1)}),[],!1,null,null,null).exports},85466:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(92704),s=r(19996);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const l={components:{OrderViewComponent:r(82016).Z,ReportFormComponent:s.Z},mixins:[(0,i.Z)("stock_transfer","app/transfers/stock","reference")],data:function(){var t;return{url:"",data:{},updated:0,view:!1,loading:!1,showForm:!1,reportForm:{},stock_transfer:{},status_options:["pending","transferring","transferred"],fields:["created_at","reference","custom_fields","item_id","user_id","from_location","to_location","status"],columns:[{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{key:"to",maxWidth:300,minWidth:200,sortable:!1,title:this.$tc("to_location"),render:this.renderToAccount},{key:"from",maxWidth:300,minWidth:200,sortable:!1,render:this.renderFromAccount,title:this.$tc("from_location")},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},(t={title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0},o(t,"ellipsis",!0),o(t,"minWidth",250),o(t,"maxWidth",600),t)],options:{hideSearch:!0,perPage:this.$store.state.settings.rows,orderBy:["created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++})),this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.url="app/reports/stock_transfers/table?"+this.queryString(this.reportForm),this.$http.get("app/reports/stock_transfers",{params:n(n({},this.reportForm),{},{date:""})}).then((function(e){t.reportForm.created_at=[new Date(e.data.start_date),new Date(e.data.end_date)],t.prepareData(e.data.stock_transfers),t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.created_at&&this.reportForm.created_at[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.created_at[0]).format(this.datetimeFormatString())),this.reportForm.created_at&&this.reportForm.created_at[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.created_at[1]).format(this.datetimeFormatString())),delete this.reportForm.created_at,this.url="app/reports/stock_transfers/table?"+this.queryString(this.reportForm),this.refresh++,this.$http.get("app/reports/stock_transfers",{params:n(n({},this.reportForm),{},{date:""})}).then((function(t){e.reportForm.created_at=[new Date(t.data.start_date),new Date(t.data.end_date)],e.prepareData(t.data.stock_transfers),e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.reportForm.end_date=this.reportForm.created_at[1],this.reportForm.start_date=this.reportForm.created_at[0],this.data=[{label:this.$t("total_x",{x:this.$tc("stock_transfer",2)}),value:t.count}]},viewModal:function(t){var e=this;this.view=!0,t.id!=this.stock_transfer.id&&(this.loading=!0,this.$http.get("app/transfers/stock/".concat(t.id)).then((function(t){return e.stock_transfer=t.data})).finally((function(){return e.loading=!1})))},renderToAccount:function(t,e){return t("div",[e.row.to_location.name])},renderFromAccount:function(t,e){return t("div",[e.row.from_location.name])}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$tc("stock_transfer",2)}))+" ("+t._s(t.datetime(t.reportForm.start_date))+" - "+t._s(t.datetime(t.reportForm.end_date))+")\n    ")]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,updated:t.updated,reportForm:t.reportForm,statusOptions:t.status_options},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[e.value&&0!=e.value?r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box static",class:"box"+(i+1)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])]):t._e()]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("stock_transfer")+" ("+t.stock_transfer.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{field:"cost",extra:!1,payment:!1,"only-qty":!0,to:"to_location","to-text":t.$t("to"),from:"from_location",record:t.stock_transfer,heading:t.$tc("stock_transfer")},on:{remove:function(e){return t.deleteAttachment(e,t.stock_transfer)}}})],1)],1)}),[],!1,null,null,null).exports},754:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const n={components:{ReportFormComponent:r(19996).Z},data:function(){return{data:{},sales:{},updated:0,purchases:{},loading:!1,showForm:!1,reportForm:{},fields:["date"]}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++})),this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.$http.get("app/reports/taxes",{params:s(s({},this.reportForm),{},{date:""})}).then((function(e){t.reportForm.date=[new Date(e.data.start_date),new Date(e.data.end_date)],t.prepareData(e.data.taxes),t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.date&&this.reportForm.date[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.date[0]).format(this.datetimeFormatString())),this.reportForm.date&&this.reportForm.date[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.date[1]).format(this.datetimeFormatString())),delete this.reportForm.date,this.refresh++,this.$http.get("app/reports/taxes",{params:s(s({},this.reportForm),{},{date:""})}).then((function(t){e.reportForm.date=[new Date(t.data.start_date),new Date(t.data.end_date)],e.prepareData(t.data.taxes),e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.reportForm.end_date=this.reportForm.date[1],this.reportForm.start_date=this.reportForm.date[0],this.sales=[{label:this.$t("total_x",{x:this.$tc("sale",2)}),value:t[0].grand_total},{label:this.$t("total_x",{x:this.$tc("tax",2)}),value:t[0].total_tax_amount},{label:this.$t("total_x",{x:this.$t("recoverable_tax_amount")}),value:t[0].recoverable_tax_amount},{label:this.$t("total_x",{x:this.$t("recoverable_tax_calculated_on")}),value:t[0].recoverable_tax_calculated_on}],this.purchase=[{label:this.$t("total_x",{x:this.$tc("purchase",2)}),value:t[1].grand_total},{label:this.$t("total_x",{x:this.$tc("tax",2)}),value:t[1].total_tax_amount},{label:this.$t("total_x",{x:this.$t("recoverable_tax_amount")}),value:t[1].recoverable_tax_amount},{label:this.$t("total_x",{x:this.$t("recoverable_tax_calculated_on")}),value:t[1].recoverable_tax_calculated_on}]}}};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$tc("tax")}))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" -\n      "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,reportForm:t.reportForm,updated:t.updated},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("sale",2)))]),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.sales,(function(e,i){return[e.value&&0!=e.value?r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box static",class:"box"+(i+1)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])]):t._e()]}))],2)],1),t._v(" "),r("Card",{staticClass:"mt16",attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("purchase",2)))]),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.purchase,(function(e,i){return[e.value&&0!=e.value?r("Col",{key:i,attrs:{sm:12,md:6}},[r("div",{staticClass:"box static",class:"box"+(i+1)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatNumber(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])]):t._e()]}))],2)],1)],1)],1),t._v(" "),t.loading?r("center-loading-component"):t._e()],1)}),[],!1,null,null,null).exports},17848:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("time_clock","app/reports/time_clocks","id","id")],data:function(){return{url:"app/reports/time_clocks",columns:[{title:this.$t("in"),sortable:!0,key:"in",minWidth:150,render:this.renderIn},{title:this.$t("out"),sortable:!0,key:"out",minWidth:150,render:this.renderOut},{title:this.$t("hours"),sortable:!1,key:"hours",width:100,render:this.rendersHours},{title:this.$tc("rate"),sortable:!1,key:"rate",width:100,render:this.renderRate},{title:this.$tc("amount"),sortable:!1,key:"amount",width:100,render:this.rendersAmount},{title:this.$tc("user"),sortable:!0,key:"user",minWidth:150,render:this.renderUser},{title:this.$tc("location"),sortable:!0,key:"location",minWidth:150,render:this.renderLocation},{title:this.$t("details"),sortable:!0,key:"details",ellipsis:!0,minWidth:250},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"asc",minWidth:150,render:this.renderCreatedAt}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},created:function(){this.url="/app/reports/time_clocks"+(this.$route.query.user_id?"?user_id="+this.$route.query.user_id:"")},methods:{renderLocation:function(t,e){return t("div",[e.row.location.name])},renderUser:function(t,e){return t("div",[e.row.user.name])},rendersHours:function(t,e){if(!e.row.out)return"";var r=parseFloat(Math.abs(new Date(e.row.in)-new Date(e.row.out))/36e5);return t("div",{class:"text-right"},[this.$options.filters.formatNumber(r,this.$store.state.settings.decimals)])},rendersAmount:function(t,e){if(!e.row.out)return"";var r=parseFloat(Math.abs(new Date(e.row.in)-new Date(e.row.out))/36e5)*e.row.rate;return t("div",{class:"text-right"},[this.$options.filters.formatNumber(r,this.$store.state.settings.decimals)])},renderIn:function(t,e){return t("div",[e.row.in?this.$options.filters.formatDate(e.row.in,this.$store.state.settings.dateformat+" HH:mm A"):""])},renderOut:function(t,e){return t("div",[e.row.out?this.$options.filters.formatDate(e.row.out,this.$store.state.settings.dateformat+" HH:mm A"):""])},renderRate:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatNumber(e.row.rate,this.$store.getters.settings.decimals)])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("time_clock",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/reports"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$tc("report",2))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords}})],1)],1)}),[],!1,null,null,null).exports},48734:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var i=r(92704);function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const a={components:{ReportFormComponent:r(19996).Z},mixins:[(0,i.Z)("item","app/items","reference")],data:function(){var t;return{url:"",item:{},dates:[],updated:0,view:!1,loading:!1,reportForm:{},showForm:!1,fields:["date","category_id","customer_id","user_id"],columns:[{title:this.$t("code"),sortable:!1,key:"code",minWidth:150},{title:this.$t("name"),sortable:!1,key:"name",minWidth:175},(t={title:this.$t("sold"),sortable:"custom",sortType:"desc",key:"sold",minWidth:200},s(t,"minWidth",80),s(t,"render",this.renderSold),t)],options:{orderBy:[],hideSearch:!0,perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.fields.map((function(e){t.reportForm[e]=""})),this.reportForm.end_date="",this.reportForm.start_date="",this.$event.listen("table:loaded",this.setDates),this.url="app/reports/items/top?"+this.queryString(this.reportForm)},methods:{setDates:function(t){this.dates=t},handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.end_date="",this.reportForm.start_date="",this.reportForm.date&&this.reportForm.date[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.date[0]).format(this.datetimeFormatString())),this.reportForm.date&&this.reportForm.date[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.date[1]).format(this.datetimeFormatString())),delete this.reportForm.date,this.url="app/reports/items/top?"+this.queryString(this.reportForm),this.refresh++},renderSold:function(t,e){return t("div",{class:"bold text-right"},[this.formatNumber(e.row.sold||0,this.$store.state.settings.quantity_decimals)])}}};const n=(0,r(51900).Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("x_report",{x:t.$t("top_items")}))+"\n      "),t.dates[0]&&t.dates[1]?r("span",[t._v(" ("+t._s(t.datetime(new Date(t.dates[0])))+" - "+t._s(t.datetime(new Date(t.dates[1])))+") ")]):t._e()]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n      "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n    ")],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,reportForm:t.reportForm,updated:t.updated},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("table-component",{attrs:{url:t.url,columns:t.columns,"sub-data":"table",options:t.options,refresh:t.refresh}})],1)],1)],1)}),[],!1,null,null,null).exports},58772:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>u});var i=r(21490),s=r(61402);const a={props:{field:{type:String},editItem:{type:Function},deleteItem:{type:Function},calcItemTax:{type:Function},calcRowTotal:{type:Function},customer:{type:[Boolean,Object]},row:{type:Object,required:!0},deleteItemVariation:{type:Function},index:{type:Number,required:!0},itemVariationQuantityChanged:{type:Function}}};var n=r(51900);const o=(0,n.Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order-item"},[r("span",{staticClass:"item"},[r("span",{staticClass:"index"},[t._v(t._s(t.index+1))]),t._v(" "),r("span",{staticClass:"remove"},[t.row.selected.variations&&t.row.selected.portions&&!t.row.selected.portions.length&&!t.row.selected.variations.length?r("span",[r("Icon",{staticClass:"pointer",attrs:{size:"18",type:"md-close",color:"#ed4014"},on:{click:function(e){return t.deleteItem(t.row.guid)}}})],1):t._e()]),t._v(" "),r("span",{staticClass:"details pointer",on:{click:function(e){return t.editItem(t.index)}}},[r("strong",[t._v(t._s(t.row.name))]),t._v(" "),r("br"),t._v(" "),r("span",[t.customer&&t.customer.customer_group?r("span",{domProps:{innerHTML:t._s(t.customer.customer_group.name+" (<small>"+t.$t("discount")+": "+t.customer.customer_group.discount+"%</small>)<br />")}}):t._e(),t._v(" "),t.row.comment?r("span",[t._v(t._s(t.row.comment)+" ")]):t._e()])]),t._v(" "),t.row.selected.variations&&t.row.selected.portions&&!t.row.selected.portions.length&&!t.row.selected.variations.length?[r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(t.row[t.field]-t.row.discount_amount+t.calcItemTax(t.row)))+"\n      ")]),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length||!!t.row.selected.portions.length,size:t.row.selected.variations.length||t.row.selected.portions.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(t.row.taxes,(function(e){return r("div",{key:"tax_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber(t.calcRowTotal(t.row)))+"\n      ")])]:[r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length||!!t.row.selected.portions.length,size:t.row.selected.variations.length||t.row.selected.portions.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})]],2),t._v(" "),t.row.selected.variations&&t.row.selected.variations.length?t._l(t.row.selected.variations,(function(e,i){return r("div",{key:"svi_"+i,staticClass:"combo-item variation"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.deleteItemVariation(t.row,e)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n        "+t._s(i+1)+".\n        "),r("span",{domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(e[t.field]))+"\n      ")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n        "+t._s(t.formatNumber(e.discount_amount))+"\n      ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{on:{"on-change":function(e){return t.itemVariationQuantityChanged(t.form.items[t.index])}},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"sv.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(e){return r("div",{key:"sv_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber((e[t.field]-e.discount_amount+e.total_tax_amount)*e.quantity))+"\n      ")])])})):t._e(),t._v(" "),t.row.selected.portions.length?t._l(t.row.selected.portions,(function(e,i){return r("div",{key:"spi_"+i,staticClass:"combo"},t._l(t.row.portions.filter((function(t){return t.id==e.id})),(function(s){return r("div",{key:"pi_"+s.id,staticClass:"combo"},[r("div",{staticClass:"combo-item variation"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.deleteItemPortion(t.row,e,i)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[r("p",[t._v("\n              "+t._s(i+1)+". "+t._s(t.$tc("portion"))+":\n              "),r("strong",[t._v(t._s("regular"==s.name?t.$t("regular"):s.name))])])]),t._v(" "),r("span",{staticClass:"price"},[t._v(t._s(t.formatNumber(e[t.field])))]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n            "+t._s(t.formatNumber(e.discount_amount))+"\n          ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{on:{"on-change":function(e){return t.itemPortionQuantityChanged(t.form.items[t.index])}},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"sp.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(i){return r("div",{key:"sp_"+i.id},[t._v("\n              "+t._s(i.code)+"\n              "),r("span",{staticClass:"float-right"},[t._v("\n                "+t._s(t.formatNumber(i.amount*e.quantity))+"\n              ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n            "+t._s(t.formatNumber((e[t.field]-e.discount_amount+e.total_tax_amount)*e.quantity))+"\n          ")])]),t._v(" "),t._l(s.essentials,(function(i,s){return r("div",{key:"ei_"+s,staticClass:"combo-item bt0",staticStyle:{"padding-top":"1px"}},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"}),t._v(" "),r("span",{staticClass:"details"},[t._v(" #"+t._s(s+1)+" "+t._s(i.item.name)+" ")]),t._v(" "),r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity input"},[t._v("\n            "+t._s(parseFloat(i.quantity*e.quantity))+"\n          ")]),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})])})),t._v(" "),t._l(s.choosables,(function(i,a){return t._l(i.items,(function(n,o){return t.getPortionChoosable(e,i.id,n.item_id)?r("div",{key:"gii_"+o+"_"+a,staticClass:"combo-item bt0",staticStyle:{"padding-top":"1px"}},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"}),t._v(" "),r("span",{staticClass:"details"},[t._v("\n              #"+t._s(a+1+s.essentials.length)+"\n              "+t._s(n.item.name)+"\n            ")]),t._v(" "),r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity input"},[t._v("\n              "+t._s(parseFloat(n.quantity*e.quantity))+"\n            ")]),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})]):t._e()}))}))],2)})),0)})):t._e(),t._v(" "),t.row.selected.modifiers.length?[r("div",{staticClass:"combo-item bg"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[t._v("")]),t._v(" "),r("span",{staticClass:"details"},[r("p",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.$tc("modifier",2)))])]),t._v(" "),r("span",{staticClass:"price"},[t._v("")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("")]),t._v(" "),r("span",{staticClass:"quantity"},[t._v("")]),t._v(" "),r("span",{staticClass:"taxes"},[t._v("")]),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("")])]),t._v(" "),t._l(t.row.selected.modifiers,(function(e,i){return r("div",{key:"mi_"+i},[r("div",{staticClass:"combo-item pt pb"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.deleteItemModifier(t.row,e,i)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n          "+t._s(i+1)+". "),r("strong",[t._v(t._s(e.option))]),t._v(" ("+t._s(e.title)+")\n        ")]),t._v(" "),r("span",{staticClass:"price"},[t._v("\n          "+t._s(t.formatNumber(e[t.field]))+"\n        ")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n          "+t._s(t.formatNumber(e.discount_amount*e.quantity))+"\n        ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"m.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(i){return r("div",{key:"m_"+i.id},[t._v("\n            "+t._s(i.code)+"\n            "),r("span",{staticClass:"float-right"},[t._v("\n              "+t._s(t.formatNumber(i.amount*e.quantity))+"\n            ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"})])])}))]:t._e()],2)}),[],!1,null,null,null).exports;const l={props:{taxes:{type:Array},field:{type:String},itemPrice:{type:Function},deleteItem:{type:Function},updateItem:{type:Function},modOptLabel:{type:Function},itemDiscount:{type:Function},addPortionToEditItem:{type:Function},changeSelectedPortion:{type:Function},edit_item:{type:Object,required:!0}}};const c={components:{EditRowItemComponent:(0,n.Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Row",{attrs:{gutter:16}},[t.edit_item.portions.length||t.edit_item.has_variants?t._e():r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{staticClass:"text-center",attrs:{prop:"quantity",label:t.$t("quantity"),rules:{type:"number",required:!0,trigger:"change",message:t.$t("field_is_required",{field:t.$t("quantity")})}}},[r("InputNumber",{attrs:{size:"large"},model:{value:t.edit_item.quantity,callback:function(e){t.$set(t.edit_item,"quantity",e)},expression:"edit_item.quantity"}})],1)],1),t._v(" "),t.edit_item.portions&&t.edit_item.portions.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},t._l(t.edit_item.selected.portions,(function(e,i){return r("span",{key:"eispi_"+i},t._l(t.edit_item.portions.filter((function(t){return t.id==e.id})),(function(s){return r("span",{key:"pi_"+s.id},[r("Card",{staticClass:"cardp",attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"ios-option"}}),t._v("\n                "+t._s(i+1)+". "+t._s(t.$tc("portion"))+": ("+t._s("regular"==s.name?t.$t("regular"):s.name)+")\n              ")],1),t._v(" "),!i&&t.edit_item.portions.length>1?r("Button",{attrs:{slot:"extra",type:"primary",size:"small"},on:{click:function(e){return t.addPortionToEditItem()}},slot:"extra"},[t._v("\n                "+t._s(t.$t("add_x",{x:t.$tc("portion")}))+"\n              ")]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{staticClass:"mb16",attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("portion")}},[r("Select",{attrs:{value:e.id},on:{"on-change":function(e){return t.changeSelectedPortion(e,i)}}},t._l(t.edit_item.portions,(function(e,i){return r("Option",{key:"pi_"+i,attrs:{value:e.id}},[t._v("\n                        "+t._s("regular"==e.name?t.$t("regular"):e.name)+"\n                      ")])})),1)],1)],1),t._v(" "),r("Col",{staticClass:"mb16",attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("quantity")}},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"eisp.quantity"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}},[r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                      "+t._s(t.$t("essential_items"))+"\n                    ")])]),t._v(" "),r("p",{staticStyle:{"margin-bottom":"8px","font-weight":"bold"}},[t._v("\n                    "+t._s(s.essentials.map((function(t){return t.item.name})).join(", "))+"\n                  ")]),t._v(" "),r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                      "+t._s(t.$t("choosable_items"))+"\n                    ")])]),t._v(" "),r("Row",{attrs:{gutter:16}},t._l(s.choosables,(function(s,a){return r("Col",{key:"gi_"+a,attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:s.name,prop:"selected.portions."+i+".choosables."+a+".selected",rules:{required:!0,trigger:"change",message:t.$t("select_x",{x:t.$tc("item")})}}},[r("Select",{model:{value:e.choosables[a].selected,callback:function(r){t.$set(e.choosables[a],"selected",r)},expression:"eisp.choosables[gi].selected"}},t._l(s.items,(function(e,i){return r("Option",{key:"gii_"+i,attrs:{value:e.item_id}},[t._v("\n                            "+t._s(e.item.name)+"\n                          ")])})),1)],1)],1)})),1)],1)],1)],1)],1)})),0)})),0),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),t.edit_item.variants&&t.edit_item.variants.length?[t._l(t.edit_item.selected.variations,(function(e,i){return r("span",{key:"sv_meta_"+i},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("span",{staticStyle:{color:"#515a6e"},domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("quantity"),prop:"selected.variations."+i+".quantity",rules:{required:!0,type:"number",trigger:"change",max:parseFloat(e.available),message:t.$t("only_x_quantity_available",{x:parseFloat(e.available)})}}},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"eisv.quantity"}})],1)],1),t._v(" "),r("Col",{staticClass:"text-primary",staticStyle:{"padding-top":"2.5em"},attrs:{sm:24,md:12,lg:12}},[t._v("\n          "+t._s(t.$t("available_x",{x:t.$t("quantity")}))+":\n          "),r("strong",[t._v(t._s(e.available))])])],1)})),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),t.edit_item.modifiers&&t.edit_item.modifiers.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n            "+t._s(t.$tc("modifier",2))+"\n          ")])])],1),t._v(" "),t._l(t.edit_item.modifiers,(function(e,i){return r("Col",{key:"mi_"+i,attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:e.title,prop:"modifiers"}},["radio"==e.show_as?r("span",[r("RadioGroup",{attrs:{vertical:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"checkbox"==e.show_as?r("span",[r("CheckboxGroup",{attrs:{vertical:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"select"==e.show_as?r("span",[r("Select",{model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"select_multiple"==e.show_as?r("span",[r("Select",{attrs:{multiple:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):t._e()])],1)})),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n        "+t._s(t.$t("general"))+"\n      ")])]),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.allUnits&&t.edit_item.allUnits.length>0?r("FormItem",{attrs:{label:t.$tc("unit")}},[r("Select",{staticStyle:{width:"100%"},on:{"on-change":t.itemUnitChanged},model:{value:t.edit_item.unit_id,callback:function(e){t.$set(t.edit_item,"unit_id",e)},expression:"edit_item.unit_id"}},t._l(t.edit_item.allUnits,(function(e,i){return r("Option",{key:"unit_"+i+"_"+e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),1)],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.changeable?r("FormItem",{attrs:{prop:"price",label:t.$t(t.field),rules:[{required:!0,type:"number",message:t.$t("field_is_required",{field:t.$t(t.field)}),trigger:["change","blur"]},{validator:t.itemPrice,trigger:["change","blur"]}]}},[r("InputNumber",{model:{value:t.edit_item[t.field],callback:function(e){t.$set(t.edit_item,t.field,e)},expression:"edit_item[field]"}})],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{prop:"discount",label:t.$t("discount_"),rules:{validator:t.itemDiscount,trigger:["change","blur"]}}},[r("InputNumber",{model:{value:t.edit_item.discount,callback:function(e){t.$set(t.edit_item,"discount",e)},expression:"edit_item.discount"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.allPromotions&&t.edit_item.allPromotions.length>0?r("FormItem",{attrs:{label:t.$tc("promo",2)}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.edit_item.promotions,callback:function(e){t.$set(t.edit_item,"promotions",e)},expression:"edit_item.promotions"}},t._l(t.edit_item.allPromotions,(function(e,i){return r("Option",{key:"tax_"+i+"_"+e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),1)],1):t._e()],1)],2),t._v(" "),t.edit_item.changeable?r("FormItem",{attrs:{label:t.$tc("tax",2),prop:"taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.edit_item.allTaxes,callback:function(e){t.$set(t.edit_item,"allTaxes",e)},expression:"edit_item.allTaxes"}},t._l(this.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),1)],1):t._e(),t._v(" "),r("FormItem",{attrs:{label:t.$t("comment")}},[r("Input",{attrs:{type:"textarea",placeholder:t.$t("item_comment"),autosize:{minRows:2,maxRows:5}},model:{value:t.edit_item.comment,callback:function(e){t.$set(t.edit_item,"comment",e)},expression:"edit_item.comment"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{long:"",type:"primary"},on:{click:function(e){return t.updateItem()}}},[t._v(t._s(t.$t("update")))])],1),t._v(" "),r("Button",{attrs:{long:"",type:"error"},on:{click:function(e){return t.deleteItem(t.edit_item.guid)}}},[t._v(t._s(t.$t("remove_from_order")))])],1)}),[],!1,null,null,null).exports,RowItemComponent:o},mixins:[(0,i.Z)("return_order"),(0,s.Z)("price","form",!1)],watch:{"form.type":function(t){this.field="sale"==t?"price":"cost"}},created:function(){this.form.type="sale"}};const u=(0,n.Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("return_order")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/return_orders"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("return_order",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"return_order",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("type"),prop:"type",error:t._f("a2s")(t.errors.form.type)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[r("Option",{attrs:{value:"sale"}},[t._v(t._s(t.$tc("sale")))]),t._v(" "),r("Option",{attrs:{value:"purchase"}},[t._v(t._s(t.$tc("purchase")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),"sale"==t.form.type?r("FormItem",{attrs:{label:t.$tc("customer"),prop:"customer_id",error:t._f("a2s")(t.errors.form.customer_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchCustomers,placeholder:t.$t("type_to_search",{x:t.$tc("customer")})},model:{value:t.form.customer_id,callback:function(e){t.$set(t.form,"customer_id",e)},expression:"form.customer_id"}},t._l(t.customers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1):t._e(),t._v(" "),"purchase"==t.form.type?r("FormItem",{attrs:{prop:"supplier_id",label:t.$tc("supplier"),error:t._f("a2s")(t.errors.form.supplier_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchSuppliers,placeholder:t.$t("type_to_search",{x:t.$tc("supplier")})},model:{value:t.form.supplier_id,callback:function(e){t.$set(t.form,"supplier_id",e)},expression:"form.supplier_id"}},t._l(t.suppliers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("order_taxes"),prop:"order_taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.form.taxes,callback:function(e){t.$set(t.form,"taxes",e)},expression:"form.taxes"}},t._l(t.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])})),1)],1),t._v(" "),t.$store.state.settings.max_discount>0?r("span",[r("FormItem",{attrs:{label:t.$t("discount"),prop:"discount",error:t._f("a2s")(t.errors.form.discount)}},[r("InputNumber",{attrs:{min:0,formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")},max:parseFloat(t.$store.state.settings.max_discount)},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1),t._v(" "),r("FormItem",{staticClass:"mb16"},[r("RadioGroup",{attrs:{vertical:""},model:{value:t.form.discount_method,callback:function(e){t.$set(t.form,"discount_method",e)},expression:"form.discount_method"}},[r("Radio",{attrs:{label:"order"}},[t._v(t._s(t.$t("apply_to_order_amount")))]),t._v(" "),r("Radio",{attrs:{label:"items"}},[t._v(t._s(t.$t("apply_to_order_items")))])],1)],1)],1):t._e()],1)],1),t._v(" "),t.form.type?r("div",{staticClass:"order-contents"},[r("div",{staticClass:"affix-content"},[r("AutoComplete",{ref:"scanCode",attrs:{icon:"ios-search","element-id":"scan_barcode",placeholder:t.$t("search_scan_barcode")},on:{"on-change":t.searchItems,"on-select":t.selectSaleItem},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}},t._l(t.result,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ("+t._s(e.code)+") ")])})),1)],1),t._v(" "),!t.form.items||t.form.items.length<1?r("div",[r("Alert",{attrs:{"show-icon":""}},[t._v("\n                  "+t._s(t.$t("empty_order"))+"\n                  "),r("template",{slot:"desc"},[t._v("\n                    "+t._s(t.$t("empty_order_text"))+"\n                  ")])],2)],1):r("div",[r("div",{staticClass:"order-items"},[r("div",{staticClass:"header"},[r("span",{staticClass:"index"},[t._v("#")]),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{attrs:{type:"ios-trash",size:"16"}})],1),t._v(" "),r("span",{staticClass:"details"},[t._v(t._s(t.$t("description")))]),t._v(" "),r("span",{staticClass:"price"},[t._v(t._s(t.$t("sale"==t.form.type?"price":"cost")))]),t._v(" "),r("span",{staticClass:"discount"},[t._v(t._s(t.$t("discount")))]),t._v(" "),r("span",{staticClass:"quantity"},[t._v(t._s(t.$t("quantity")))]),t._v(" "),r("span",{staticClass:"taxes"},[t._v(t._s(t.$t("taxes")))]),t._v(" "),r("span",{staticClass:"subtotal"},[t._v(t._s(t.$t("subtotal")))])]),t._v(" "),t.form.items&&t.form.items.length?[t._l(t.form.items,(function(e,i){return[r("row-item-component",{key:"row_"+i+"_"+e.id,attrs:{row:e,field:t.field,index:i,customer:t.customer,editItem:t.editItem,deleteItem:t.deleteItem,calcItemTax:t.calcItemTax,calcRowTotal:t.calcRowTotal,deleteItemVariation:t.deleteItemVariation,itemVariationQuantityChanged:t.itemVariationQuantityChanged}})]}))]:t._e()],2)]),t._v(" "),r("div",{staticClass:"affix-content"},[r("Alert",{staticStyle:{margin:"16px 0 0",padding:"8px 16px"},attrs:{banner:"",type:"warning"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:12,md:6}},[t._v("\n                      "+t._s(t.$tc("item",2))+":\n                      "),r("span",{staticClass:"float-right"},[r("strong",[t._v(t._s(t.orderTotalItems))]),t._v("\n                        "+t._s(t.$tc("item",t.orderTotalItems))+" "),r("strong",[t._v(t._s(t.orderTotalQuantity))]),t._v("\n                        "+t._s(t.$t("quantity"))+"\n                      ")])]),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("discount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.calculateItemDiscountAmount+t.orderDiscount,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$tc("tax"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.totalItemTax,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("payable_amount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t.orderOriginalTotal!=t.orderPayableAmount?r("span",[r("del",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderOriginalTotal,t.$store.state.settings.decimals))+"\n                          ")])]):t._e(),t._v(" "),r("span",[t.orderDiscount?r("span",[r("span",{staticStyle:{"font-weight":"normal"}},[t._v("\n                              ("+t._s(t._f("formatNumber")(t.orderTotalAmount,t.$store.state.settings.decimals))+" -\n                              "+t._s(t._f("formatNumber")(t.orderDiscount,t.$store.state.settings.decimals))+")\n                            ")]),t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")]):r("span",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")])])])],1)],1)],1)],1)]):t._e(),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),t.form.id?t._e():r("span",[r("FormItem",{staticClass:"mb0",attrs:{prop:"payment"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.payment,callback:function(e){t.$set(t.form,"payment",e)},expression:"form.payment"}},[r("span",[t._v(t._s(t.$t("auto_payment_text")))])])],1),t._v(" "),r("FormItem",{attrs:{prop:"deduct_from_register"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.deduct_from_register,callback:function(e){t.$set(t.form,"deduct_from_register",e)},expression:"form.deduct_from_register"}},[r("span",[t._v(t._s(t.$t("deduct_from_register")))])])],1)],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("return_orders")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("return_orders",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1),t._v(" "),r("Modal",{attrs:{width:600,"footer-hide":!0,title:t.edit_item?t.$t("edit")+" - "+t.edit_item.name:""},model:{value:t.show_item_edit,callback:function(e){t.show_item_edit=e},expression:"show_item_edit"}},[t.edit_item?r("div",[r("Form",{ref:"editItemForm",attrs:{model:t.edit_item,"label-position":"top"}},[r("edit-row-item-component",{attrs:{taxes:t.taxes,field:t.field,edit_item:t.edit_item,itemPrice:t.itemPrice,deleteItem:t.deleteItem,updateItem:t.updateItem,itemDiscount:t.itemPrice,modOptLabel:t.modOptLabel,itemUnitChanged:t.itemUnitChanged,addPortionToEditItem:t.addPortionToEditItem,changeSelectedPortion:t.changeSelectedPortion}})],1)],1):t._e()])],1)],1),t._v(" "),r("Modal",{attrs:{"footer-hide":!0,"mask-closable":!1,title:t.$t("select_x",{x:t.$tc("portion")+", "+t.$tc("modifier",2)+" & "+t.$tc("variant",2)})},model:{value:t.variantModal,callback:function(e){t.variantModal=e},expression:"variantModal"}},[r("select-variation-component",{ref:"selectVarMod",attrs:{item:t.item},on:{"on-submit":t.variationSubmitted}})],1)],1)}),[],!1,null,null,null).exports},71945:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(92704),s=r(85290),a=r(82016);const n={components:{PaymentsComponent:s.Z,OrderViewComponent:a.Z},mixins:[(0,i.Z)("return_order","app/return_orders","reference")],data:function(){var t=this;return{view:!1,payments:[],loading:!1,return_order:{},paymentsModal:!1,paymentsLoading:!1,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",width:125,render:this.renderDate},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",minWidth:150},{title:this.$t("type"),sortable:!0,key:"type",width:100,render:this.renderType},{maxWidth:300,minWidth:200,key:"customer",sortable:!1,render:this.renderPartner,title:this.$tc("from")+"/"+this.$tc("to")},{title:this.$tc("register"),sortable:!0,key:"deduct_from_register",width:100,render:this.renderIconDraft},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("total"),sortable:!1,key:"total",width:150,render:this.renderTotal},{title:this.$t("item_tax"),sortable:!1,key:"item_tax",width:125,render:this.renderItemTax},{title:this.$t("order_tax"),sortable:!1,key:"order_tax",width:125,render:this.renderOrderTax},{title:this.$t("discount"),sortable:!1,key:"discount",width:125,render:this.renderDiscount},{title:this.$t("shipping"),sortable:!1,key:"shipping",width:125,render:this.renderShipping},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0,width:350},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-dropdown-component",{props:{params:r,viewFn:t.viewModal,editFn:t.editRecord,emailFn:t.emailRecord,payFn:t.paymentRecord,deleteFn:t.deleteRecord,downloadFn:t.downloadRecord,listPayFn:t.ListPaymentForRecord,record:{model:"return_order",name:"reference",title:t.$tc("return_order")}}})}}],options:{perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.return_order.id&&(this.loading=!0,this.$http.get("app/return_orders/".concat(t.id)).then((function(t){return e.return_order=t.data})).finally((function(){return e.loading=!1})))},emailRecord:function(t){var e=this;this.$http.post("app/return_orders/email/"+t.id,{}).then((function(t){t.data.success?e.$Notice.success({title:e.$t("email_sent"),desc:e.$t("email_sent_text")}):e.$Notice.error({title:e.$tc("failed"),desc:e.$t("failed_error_text")})}))},downloadRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"download/return_orders/"+t.id}).click()},viewRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"view/return/"+t.id}).click()},paymentRecord:function(t){this.$router.push("payments/add?return_id=".concat(t.id,"&customer_id=").concat(t.customer_id,"&amount=").concat(t.grand_total))},ListPaymentForRecord:function(t){var e=this;this.return_order=t,this.paymentsModal=!0,this.paymentsLoading=!0,this.$http.get("app/returns/"+t.id+"/payments").then((function(t){e.payments=t.data,e.paymentsLoading=!1}))},paymentsModalChanged:function(t){t||(this.return=null,this.payments=[])},renderPartner:function(t,e){return t("div",["sale"==e.row.type?e.row.customer.name:e.row.supplier.name])},renderTotal:function(t,e){return this.renderNumber(t,e,"total")},renderItemTax:function(t,e){return this.renderNumber(t,e,"item_tax_amount")},renderOrderTax:function(t,e){return this.renderNumber(t,e,"order_tax_amount")},renderDiscount:function(t,e){return this.renderNumber(t,e,"discount_amount")},renderShipping:function(t,e){return this.renderNumber(t,e,"shipping")},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total",!0)},renderIconActive:function(t,e){return this.renderUnlessIcon(t,e,"draft")},renderIconDraft:function(t,e){return this.renderBoolean(t,e,"draft")},renderIconPaid:function(t,e){return this.renderBoolean(t,e,"paid")},renderType:function(t,e){return"sale"==e.row.type?t("div",{class:"ivu-tag ivu-tag-size-default ivu-tag-orange ivu-tag-checked"},[t("span",{class:"ivu-tag-text"},[e.row.type])]):t("div",{class:"ivu-tag ivu-tag-size-default ivu-tag-blue ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[e.row.type])])}}};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("return_order",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/return_orders/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("return_order"))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/return_orders",columns:t.columns,options:t.options,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("return_order")+" ("+t.return_order.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{record:t.return_order,field:"sale"==t.return_order.type?"price":"cost",to:"sale"==t.return_order.type?"customer":"supplier","to-text":"sale"==t.return_order.type?t.$tc("from"):t.$tc("to"),heading:t.$tc("return_order")+" ("+t.$tc(t.return_order.type)+")"},on:{remove:function(e){return t.deleteAttachment(e,t.return_order)}}})],1),t._v(" "),r("Modal",{attrs:{"footer-hide":"",width:750},on:{"on-visible-change":t.paymentsModalChanged},model:{value:t.paymentsModal,callback:function(e){t.paymentsModal=e},expression:"paymentsModal"}},[r("p",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("\n        "+t._s(t.$t("list_x",{x:t.$tc("payment",2)}))+"\n        "+t._s(t.return_order?"("+t.$tc("return_order")+" "+t.$t("reference")+" "+t.return_order.reference+")":"")+"\n      ")])]),t._v(" "),t.paymentsLoading?r("Loading"):r("payments-component",{attrs:{payments:t.payments}})],1)],1)}),[],!1,null,null,null).exports},22037:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("order","app/orders")],data:function(){var t=this;return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("ref_tab"),sortable:!0,key:"oId",width:125},{title:this.$t("date"),sortable:!0,key:"date",width:125,render:this.renderDate},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$tc("customer"),sortable:!1,key:"customer",maxWidth:250,minWidth:150,render:this.renderCustomer},{title:this.$tc("location"),sortable:!1,key:"location",maxWidth:300,minWidth:150,render:this.renderLocation},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("total_items"),sortable:!1,key:"total_items",width:125,render:this.renderTotalItems},{title:this.$t("total_quantity"),sortable:!1,key:"total_quantity",width:125,render:this.renderTotalQuantity},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0,minWidth:200,maxWidth:300},{width:75,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,deleteFn:t.deleteRecord,record:{model:"order",name:"oId"}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},mounted:function(){this.$store.getters.superAdmin||(this.columns=this.columns.filter((function(t){return"actions"!=t.key})))},methods:{renderCustomer:function(t,e){return t("div",[e.row.customer.name])},renderLocation:function(t,e){return t("div",[e.row.location.name])},renderTotalItems:function(t,e){return this.renderNumber(t,e,"total_items")},renderTotalQuantity:function(t,e){return this.renderNumber(t,e,"total_quantity")},renderDiscount:function(t,e){return this.renderNumber(t,e,"discount_amount")},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total",!0)}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("order",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/pos"},slot:"extra"},[r("Icon",{attrs:{type:"ios-apps"}}),t._v("\n    "+t._s(t.$t("pos"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/orders",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},31928:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(21490),s=r(61402),a=r(96677);const n={components:{EditRowItemComponent:r(96879).Z,RowItemComponent:a.Z},mixins:[(0,i.Z)("recurring_sale"),(0,s.Z)("price","form",!1)]};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("recurring_sale")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/sales/recurring"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("recurring_sale",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"recurring_sale",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("start_date"),prop:"start_date",error:t._f("a2s")(t.errors.form.start_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.start_date,callback:function(e){t.$set(t.form,"start_date",e)},expression:"form.start_date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("repeat"),prop:"repeat",error:t._f("a2s")(t.errors.form.repeat)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.repeat,callback:function(e){t.$set(t.form,"repeat",e)},expression:"form.repeat"}},[r("Option",{attrs:{value:"daily"}},[t._v(t._s(t.$t("daily")))]),t._v(" "),r("Option",{attrs:{value:"weekly"}},[t._v(t._s(t.$t("weekly")))]),t._v(" "),r("Option",{attrs:{value:"monthly"}},[t._v(t._s(t.$t("monthly")))]),t._v(" "),r("Option",{attrs:{value:"quarterly"}},[t._v(t._s(t.$t("quarterly")))]),t._v(" "),r("Option",{attrs:{value:"semiannually"}},[t._v(t._s(t.$t("semiannually")))]),t._v(" "),r("Option",{attrs:{value:"annually"}},[t._v(t._s(t.$t("annually")))]),t._v(" "),r("Option",{attrs:{value:"biennially"}},[t._v(t._s(t.$t("biennially")))]),t._v(" "),r("Option",{attrs:{value:"triennially"}},[t._v(t._s(t.$t("triennially")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("customer"),prop:"customer_id",error:t._f("a2s")(t.errors.form.customer_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchCustomers,placeholder:t.$t("type_to_search",{x:t.$tc("customer")})},model:{value:t.form.customer_id,callback:function(e){t.$set(t.form,"customer_id",e)},expression:"form.customer_id"}},t._l(t.customers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("create_before"),prop:"create_before",error:t._f("a2s")(t.errors.form.create_before)}},[r("InputNumber",{model:{value:t.form.create_before,callback:function(e){t.$set(t.form,"create_before",e)},expression:"form.create_before"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("order_taxes"),prop:"order_taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.form.taxes,callback:function(e){t.$set(t.form,"taxes",e)},expression:"form.taxes"}},t._l(t.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("shipping_fee"),prop:"shipping_fee",error:t._f("a2s")(t.errors.form.shipping_fee)}},[r("InputNumber",{model:{value:t.form.shipping_fee,callback:function(e){t.$set(t.form,"shipping_fee",e)},expression:"form.shipping_fee"}})],1),t._v(" "),t.$store.state.settings.max_discount>0?r("span",[r("FormItem",{attrs:{label:t.$t("discount"),prop:"discount",error:t._f("a2s")(t.errors.form.discount)}},[r("InputNumber",{attrs:{min:0,formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")},max:parseFloat(t.$store.state.settings.max_discount)},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("RadioGroup",{attrs:{vertical:""},model:{value:t.form.discount_method,callback:function(e){t.$set(t.form,"discount_method",e)},expression:"form.discount_method"}},[r("Radio",{attrs:{label:"order"}},[t._v(t._s(t.$t("apply_to_order_amount")))]),t._v(" "),r("Radio",{attrs:{label:"items"}},[t._v(t._s(t.$t("apply_to_order_items")))])],1)],1)],1):t._e()],1)],1),t._v(" "),r("div",{staticClass:"order-contents"},[r("div",{staticClass:"affix-content"},[r("AutoComplete",{ref:"scanCode",attrs:{icon:"ios-search","element-id":"scan_barcode",placeholder:t.$t("search_scan_barcode")},on:{"on-change":t.searchItems,"on-select":t.selectSaleItem},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}},t._l(t.result,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ("+t._s(e.code)+") ")])})),1)],1),t._v(" "),!t.form.items||t.form.items.length<1?r("div",[r("Alert",{attrs:{"show-icon":""}},[t._v("\n                  "+t._s(t.$t("empty_order"))+"\n                  "),r("template",{slot:"desc"},[t._v("\n                    "+t._s(t.$t("empty_order_text"))+"\n                  ")])],2)],1):r("div",[r("div",{staticClass:"order-items"},[r("div",{staticClass:"header"},[r("span",{staticClass:"index"},[t._v("#")]),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{attrs:{type:"ios-trash",size:"16"}})],1),t._v(" "),r("span",{staticClass:"details"},[t._v(t._s(t.$t("description")))]),t._v(" "),r("span",{staticClass:"price"},[t._v(t._s(t.$t("price")))]),t._v(" "),r("span",{staticClass:"discount"},[t._v(t._s(t.$t("discount")))]),t._v(" "),r("span",{staticClass:"quantity"},[t._v(t._s(t.$t("quantity")))]),t._v(" "),r("span",{staticClass:"taxes"},[t._v(t._s(t.$t("taxes")))]),t._v(" "),r("span",{staticClass:"subtotal"},[t._v(t._s(t.$t("subtotal")))])]),t._v(" "),t.form.items&&t.form.items.length?[t._l(t.form.items,(function(e,i){return[r("row-item-component",{key:"row_"+i+"_"+e.id,attrs:{row:e,index:i,remove:t.remove,customer:t.customer,editItem:t.editItem,calcItemTax:t.calcItemTax,calcRowTotal:t.calcRowTotal,getPortionChoosable:t.getPortionChoosable,itemVariationQuantityChanged:t.itemVariationQuantityChanged}})]}))]:t._e()],2)]),t._v(" "),r("div",{staticClass:"affix-content"},[r("Alert",{staticStyle:{margin:"16px 0 0",padding:"8px 16px"},attrs:{banner:"",type:"warning"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:12,md:6}},[t._v("\n                      "+t._s(t.$tc("item",2))+":\n                      "),r("span",{staticClass:"float-right"},[r("strong",[t._v(t._s(t.orderTotalItems))]),t._v("\n                        "+t._s(t.$tc("item",t.orderTotalItems))+" "),r("strong",[t._v(t._s(t.orderTotalQuantity))]),t._v("\n                        "+t._s(t.$t("quantity"))+"\n                      ")])]),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("discount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.calculateItemDiscountAmount+t.orderDiscount,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$tc("tax"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.totalItemTax,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("payable_amount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t.orderOriginalTotal!=t.orderPayableAmount?r("span",[r("del",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderOriginalTotal,t.$store.state.settings.decimals))+"\n                          ")])]):t._e(),t._v(" "),r("span",[t.orderDiscount?r("span",[r("span",{staticStyle:{"font-weight":"normal"}},[t._v("\n                              ("+t._s(t._f("formatNumber")(t.orderTotalAmount,t.$store.state.settings.decimals))+" -\n                              "+t._s(t._f("formatNumber")(t.orderDiscount,t.$store.state.settings.decimals))+")\n                            ")]),t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")]):r("span",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")])])])],1)],1)],1)],1)]),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),t.is_draftable()?r("FormItem",{attrs:{prop:"draft"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.draft,callback:function(e){t.$set(t.form,"draft",e)},expression:"form.draft"}},[r("span",[t._v(t._s(t.$t("order_draft_text")))])])],1):t._e(),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("recurring_sales")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("recurring_sales",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1),t._v(" "),r("Modal",{attrs:{width:600,"footer-hide":!0,title:t.edit_item?t.$t("edit")+" - "+t.edit_item.name:""},model:{value:t.show_item_edit,callback:function(e){t.show_item_edit=e},expression:"show_item_edit"}},[t.edit_item?r("div",[r("Form",{ref:"editItemForm",attrs:{model:t.edit_item,"label-position":"top"}},[r("edit-row-item-component",{attrs:{taxes:t.taxes,edit_item:t.edit_item,itemPrice:t.itemPrice,deleteItem:t.deleteItem,updateItem:t.updateItem,itemDiscount:t.itemPrice,modOptLabel:t.modOptLabel,addPortionToEditItem:t.addPortionToEditItem,changeSelectedPortion:t.changeSelectedPortion}})],1)],1):t._e()]),t._v(" "),r("Modal",{attrs:{"footer-hide":!0,"mask-closable":!1,title:t.$t("select_x",{x:t.$tc("portion")+", "+t.$tc("modifier",2)+" & "+t.$tc("variant",2)})},model:{value:t.variantModal,callback:function(e){t.variantModal=e},expression:"variantModal"}},[r("select-variation-component",{ref:"selectVarMod",attrs:{item:t.item},on:{"on-submit":t.variationSubmitted}})],1)],1)}),[],!1,null,null,null).exports},3872:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(92704);const s={components:{OrderViewComponent:r(82016).Z},mixins:[(0,i.Z)("recurring_sale","app/recurring_sales","reference")],data:function(){var t=this;return{view:!1,loading:!1,recurring_sale:{},columns:[{type:"selection",width:50,align:"center",fixed:"left"},{width:105,sortable:!0,sortType:"desc",key:"start_date",render:this.renderStartDate,title:this.$t("start_date")},{title:this.$t("repeat"),sortable:!0,key:"repeat",width:125,render:this.renderRepeat},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("before"),sortable:!0,key:"create_before",width:90},{title:this.$tc("customer"),sortable:!1,key:"customer",maxWidth:300,minWidth:200,render:this.renderCustomer},{title:this.$t("draft"),sortable:!0,key:"draft",width:80,render:this.renderIconDraft},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{width:175,sortable:!0,sortType:"desc",key:"last_created_at",title:this.$t("last_created_at"),render:this.renderLastCreatedAt},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("total"),sortable:!1,key:"total",width:150,render:this.renderTotal},{title:this.$t("item_tax"),sortable:!1,key:"item_tax",width:150,render:this.renderItemTax},{title:this.$t("order_tax"),sortable:!1,key:"order_tax",width:150,render:this.renderOrderTax},{title:this.$t("discount"),sortable:!1,key:"discount",width:150,render:this.renderDiscount},{title:this.$t("shipping"),sortable:!1,key:"shipping",width:150,render:this.renderShipping},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0,minWidth:200,maxWidth:300},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,viewFn:t.viewModal,editFn:t.editRecord,deleteFn:t.deleteRecord,record:{model:"recurring_sale",name:"reference",title:t.$tc("recurring_sale")}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},computed:{url:function(){return"app/recurring_sales"+(this.$route.query.in_days?"?in_days="+parseInt(this.$route.query.due):"")}},watch:{"$route.query.in_days":function(){this.refresh++}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.recurring_sale.id&&(this.loading=!0,this.$http.get("app/recurring_sales/".concat(t.id)).then((function(t){return e.recurring_sale=t.data})).finally((function(){return e.loading=!1})))},emailRecord:function(t){console.log("sending email for "+t.id)},viewRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"view/recurring_sale/"+t.hash}).click()},renderCustomer:function(t,e){return t("div",[e.row.customer.name])},renderStartDate:function(t,e){return t("div",[this.$options.filters.formatDate(e.row.start_date,this.$store.state.settings.dateformat)])},renderLastCreatedAt:function(t,e){return t("div",[e.row.last_created_at?this.$options.filters.formatDate(e.row.last_created_at,this.$store.state.settings.dateformat+" HH:mm A"):""])},renderTotal:function(t,e){return this.renderNumber(t,e,"total")},renderItemTax:function(t,e){return this.renderNumber(t,e,"item_tax_amount")},renderOrderTax:function(t,e){return this.renderNumber(t,e,"order_tax_amount")},renderDiscount:function(t,e){return this.renderNumber(t,e,"discount_amount")},renderShipping:function(t,e){return this.renderNumber(t,e,"shipping")},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total",!0)},renderIconActive:function(t,e){return this.renderUnlessIcon(t,e,"draft")},renderIconDraft:function(t,e){return this.renderBoolean(t,e,"draft")},repeatColor:function(t){var e={daily:"blue",weekly:"magenta",monthly:"primary",quarterly:"geekblue",semiannually:"purple",annually:"success",biennially:"green",triennially:"orange"};return e[t]?e[t]:"default"},renderRepeat:function(t,e){return t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-".concat(this.repeatColor(e.row.repeat)," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.$t(e.row.repeat)])])])}}};const a=(0,r(51900).Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("recurring_sale",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/sales/recurring/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("recurring_sale"))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("recurring_sale")+" ("+t.recurring_sale.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{summary:!1,recurring:!0,record:t.recurring_sale,"to-text":t.$tc("bill_to"),heading:t.$tc("recurring_sale")},on:{remove:function(e){return t.deleteAttachment(e,t.recurring_sale)}}})],1)],1)}),[],!1,null,null,null).exports},56902:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var i=r(21490),s=r(61402),a=r(96677);const n={components:{EditRowItemComponent:r(96879).Z,RowItemComponent:a.Z},mixins:[(0,i.Z)("sale",null,null,{id:"sale_id",qId:"quotation_id"}),(0,s.Z)("price","form",!1)]};const o=(0,r(51900).Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("sale")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/sales"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("sale",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"sale",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("type"),prop:"type",error:t._f("a2s")(t.errors.form.type)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[r("Option",{attrs:{value:"nett"}},[t._v(t._s(t.$t("nett")))]),t._v(" "),r("Option",{attrs:{value:"layaway"}},[t._v(t._s(t.$t("layaway")))]),t._v(" "),r("Option",{attrs:{value:"on_account"}},[t._v(t._s(t.$t("on_account")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("customer"),prop:"customer_id",error:t._f("a2s")(t.errors.form.customer_id)}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchCustomers,placeholder:t.$t("type_to_search",{x:t.$tc("customer")})},model:{value:t.form.customer_id,callback:function(e){t.$set(t.form,"customer_id",e)},expression:"form.customer_id"}},t._l(t.customers,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("order_taxes"),prop:"order_taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.form.taxes,callback:function(e){t.$set(t.form,"taxes",e)},expression:"form.taxes"}},t._l(t.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n                      "+t._s(e.name)+"\n                    ")])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("shipping_fee"),prop:"shipping_fee",error:t._f("a2s")(t.errors.form.shipping_fee)}},[r("InputNumber",{model:{value:t.form.shipping_fee,callback:function(e){t.$set(t.form,"shipping_fee",e)},expression:"form.shipping_fee"}})],1),t._v(" "),t.$store.state.settings.max_discount>0?r("span",[r("FormItem",{attrs:{label:t.$t("discount"),prop:"discount",error:t._f("a2s")(t.errors.form.discount)}},[r("InputNumber",{attrs:{min:0,formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")},max:parseFloat(t.$store.state.settings.max_discount)},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("RadioGroup",{attrs:{vertical:""},model:{value:t.form.discount_method,callback:function(e){t.$set(t.form,"discount_method",e)},expression:"form.discount_method"}},[r("Radio",{attrs:{label:"order"}},[t._v(t._s(t.$t("apply_to_order_amount")))]),t._v(" "),r("Radio",{attrs:{label:"items"}},[t._v(t._s(t.$t("apply_to_order_items")))])],1)],1)],1):t._e()],1)],1),t._v(" "),r("div",{staticClass:"order-contents"},[r("div",{staticClass:"affix-content"},[r("AutoComplete",{ref:"scanCode",attrs:{icon:"ios-search","element-id":"scan_barcode",placeholder:t.$t("search_scan_barcode")},on:{"on-change":t.searchItems,"on-select":t.selectSaleItem},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}},t._l(t.result,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ("+t._s(e.code)+") ")])})),1)],1),t._v(" "),!t.form.items||t.form.items.length<1?r("div",[r("Alert",{attrs:{"show-icon":""}},[t._v("\n                  "+t._s(t.$t("empty_order"))+"\n                  "),r("template",{slot:"desc"},[t._v("\n                    "+t._s(t.$t("empty_order_text"))+"\n                  ")])],2)],1):r("div",[r("div",{staticClass:"order-items"},[r("div",{staticClass:"header"},[r("span",{staticClass:"index"},[t._v("#")]),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{attrs:{type:"ios-trash",size:"16"}})],1),t._v(" "),r("span",{staticClass:"details"},[t._v(t._s(t.$t("description")))]),t._v(" "),r("span",{staticClass:"price"},[t._v(t._s(t.$t("price")))]),t._v(" "),r("span",{staticClass:"discount"},[t._v(t._s(t.$t("discount")))]),t._v(" "),r("span",{staticClass:"quantity"},[t._v(t._s(t.$t("quantity")))]),t._v(" "),r("span",{staticClass:"taxes"},[t._v(t._s(t.$t("taxes")))]),t._v(" "),r("span",{staticClass:"subtotal"},[t._v(t._s(t.$t("subtotal")))])]),t._v(" "),t.form.items&&t.form.items.length?[t._l(t.form.items,(function(e,i){return[r("row-item-component",{key:"row_"+i+"_"+e.id,attrs:{row:e,index:i,remove:t.remove,customer:t.customer,editItem:t.editItem,calcItemTax:t.calcItemTax,calcRowTotal:t.calcRowTotal,getPortionChoosable:t.getPortionChoosable,itemVariationQuantityChanged:t.itemVariationQuantityChanged}})]}))]:t._e()],2)]),t._v(" "),r("div",{staticClass:"affix-content"},[r("Alert",{staticStyle:{margin:"16px 0 0",padding:"8px 16px"},attrs:{banner:"",type:"warning"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:12,md:6}},[t._v("\n                      "+t._s(t.$tc("item",2))+":\n                      "),r("span",{staticClass:"float-right"},[r("strong",[t._v(t._s(t.orderTotalItems))]),t._v("\n                        "+t._s(t.$tc("item",t.orderTotalItems))+" "),r("strong",[t._v(t._s(t.orderTotalQuantity))]),t._v("\n                        "+t._s(t.$t("quantity"))+"\n                      ")])]),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("discount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.calculateItemDiscountAmount+t.orderDiscount,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$tc("tax"))+":\n                      "),r("strong",{staticClass:"float-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(t.totalItemTax,t.$store.state.settings.decimals))+"\n                      ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                      "+t._s(t.$t("payable_amount"))+":\n                      "),r("strong",{staticClass:"float-right"},[t.orderOriginalTotal!=t.orderPayableAmount?r("span",[r("del",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderOriginalTotal,t.$store.state.settings.decimals))+"\n                          ")])]):t._e(),t._v(" "),r("span",[t.orderDiscount?r("span",[r("span",{staticStyle:{"font-weight":"normal"}},[t._v("\n                              ("+t._s(t._f("formatNumber")(t.orderTotalAmount,t.$store.state.settings.decimals))+" -\n                              "+t._s(t._f("formatNumber")(t.orderDiscount,t.$store.state.settings.decimals))+")\n                            ")]),t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")]):r("span",[t._v("\n                            "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                          ")])])])],1)],1)],1)],1)]),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),t.is_draftable()?r("FormItem",{class:{mb0:1!=t.form.draft},attrs:{prop:"draft"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.draft,callback:function(e){t.$set(t.form,"draft",e)},expression:"form.draft"}},[r("span",[t._v(t._s(t.$t("order_draft_text")))])])],1):t._e(),t._v(" "),r("transition",{attrs:{mode:"out-in",name:"slide-in","enter-active-class":"animate__animated faster animate__fadeInDown","leave-active-class":"animate__animated fastest animate__fadeOutDown"}},[t.is_draftable()&&1!=t.form.draft?r("FormItem",{attrs:{prop:"payment"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.payment,callback:function(e){t.$set(t.form,"payment",e)},expression:"form.payment"}},[r("span",[t._v(t._s(t.$t("auto_payment_text")))])])],1):t._e()],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("sales")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("sales",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1),t._v(" "),r("Modal",{attrs:{width:600,"footer-hide":!0,title:t.edit_item?t.$t("edit")+" - "+t.edit_item.name:""},model:{value:t.show_item_edit,callback:function(e){t.show_item_edit=e},expression:"show_item_edit"}},[t.edit_item?r("div",[r("Form",{ref:"editItemForm",attrs:{model:t.edit_item,"label-position":"top"}},[r("edit-row-item-component",{attrs:{taxes:t.taxes,edit_item:t.edit_item,itemPrice:t.itemPrice,deleteItem:t.deleteItem,updateItem:t.updateItem,itemDiscount:t.itemPrice,modOptLabel:t.modOptLabel,itemUnitChanged:t.itemUnitChanged,addPortionToEditItem:t.addPortionToEditItem,changeSelectedPortion:t.changeSelectedPortion}})],1)],1):t._e()])],1)],1),t._v(" "),r("Modal",{attrs:{"footer-hide":!0,"mask-closable":!1,title:t.$t("select_x",{x:t.$tc("portion")+", "+t.$tc("modifier",2)+" & "+t.$tc("variant",2)})},model:{value:t.variantModal,callback:function(e){t.variantModal=e},expression:"variantModal"}},[r("select-variation-component",{ref:"selectVarMod",attrs:{item:t.item},on:{"on-submit":t.variationSubmitted}})],1)],1)}),[],!1,null,null,null).exports},26607:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(92704),s=r(85290),a=r(82016);const n={props:{delivery:{type:Object,required:!0}}};var o=r(51900);const l={components:{DeliveryViewComponent:(0,o.Z)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.delivery?r("div",{staticClass:"order"},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[t._v("\n      "+t._s(t.$t("date"))+": "),r("strong",[t._v(t._s(t._f("date")(t.delivery.created_at)))])]),t._v(" "),r("Col",{attrs:{xs:24,sm:12}},[t._v("\n      "+t._s(t.$t("reference"))+": "),r("strong",[t._v(t._s(t.delivery.reference))])])],1),t._v(" "),r("h2",{staticClass:"text-center my16",staticStyle:{"text-transform":"uppercase"}},[t._v(t._s(t.$tc("delivery")))]),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[r("p",[t._v(t._s(t.$tc("location"))+":")]),t._v(" "),t.delivery.location?r("div",[r("strong",[t._v(t._s(t.delivery.location.name))]),r("br"),t._v("\n        "+t._s(t.delivery.location.address+", "+t.delivery.location.state_name+", "+t.delivery.location.country_name)),r("br"),t._v("\n        "+t._s(t.delivery.location.phone)),r("br"),t._v("\n        "+t._s(t.delivery.location.email)),r("br")]):t._e()]),t._v(" "),r("Col",{attrs:{xs:24,sm:12}},[r("p",[t._v(t._s(t.$tc("customer"))+":")]),t._v(" "),t.delivery.customer?r("div",[r("strong",[t._v(t._s(t.delivery.customer.name))]),r("br"),t._v("\n        "+t._s(t.delivery.customer.address+", "+t.delivery.customer.state_name+", "+t.delivery.customer.country_name)),r("br"),t._v("\n        "+t._s(t.delivery.customer.phone)),r("br"),t._v("\n        "+t._s(t.delivery.customer.email)),r("br")]):t._e()])],1),t._v(" "),t.delivery.items?r("div",{staticClass:"table-wrapper"},[r("table",{staticClass:"table"},[r("thead",[r("tr",[r("th",{staticClass:"text-left"},[t._v(t._s(t.$t("description")))]),t._v(" "),r("th",{staticStyle:{width:"100px"}},[t._v(t._s(t.$t("quantity")))])])]),t._v(" "),r("tbody",[t._l(t.delivery.items,(function(e){return[e.variations&&e.variations.length?[r("tr",{key:e.id,staticClass:"border-b-0"},[r("td",[r("strong",[t._v(t._s(e.name))]),t._v(" "),e.variation?r("div",[t._v(t._s(e.variation.id))]):t._e()]),t._v(" "),r("td")]),t._v(" "),t._l(e.variations,(function(e,i){return r("tr",{key:e.id,staticClass:"border-y-0"},[r("td",{staticClass:"pt0"},[r("span",{domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("td",{staticClass:"pt0 text-right"},[t._v("\n                "+t._s(t._f("formatNumber")(e.pivot.quantity,2))+"\n              ")])])}))]:e.portions&&e.portions.length?[r("tr",{key:"p_"+e.id,staticClass:"border-b-0"},[r("td",[r("strong",[t._v(t._s(e.name))])]),t._v(" "),r("td")]),t._v(" "),t._l(e.portions,(function(e,i){return[r("tr",{key:e.id,staticClass:"border-y-0"},[r("td",{staticClass:"bold capitalize"},[t._v("\n                  "+t._s(e.name)+"\n                ")]),t._v(" "),r("td",{staticClass:"text-right"},[e.essentials.length<1&&e.choosables.length<1?r("span",[t._v("\n                    "+t._s(t._f("formatNumber")(e.pivot.quantity,2))+"\n                  ")]):t._e()])]),t._v(" "),t._l(e.essentials,(function(e,i){return r("tr",{key:e.id,staticClass:"border-y-0"},[r("td",{staticClass:"pt0"},[t._v("\n                  "+t._s(e.item.name)+"\n                ")]),t._v(" "),r("td",{staticClass:"pt0 text-right"},[t._v("\n                  "+t._s(t._f("formatNumber")(e.quantity,2))+"\n                ")])])})),t._v(" "),t._l(e.choosables,(function(i,s){return[t._l(i.items,(function(a,n){return[e.pivot.choosables.find((function(t){return t.id==i.id&&a.item_id==t.item_id}))?[r("tr",{key:"pci_"+s+"_"+n,staticClass:"border-y-0"},[r("td",{staticClass:"pt0"},[r("strong",[t._v(t._s(i.name))]),t._v(" "+t._s(a.item.name)+"\n                      ")]),t._v(" "),r("td",{staticClass:"pt0 text-right"},[t._v("\n                        "+t._s(t._f("formatNumber")(a.quantity,2))+"\n                      ")])])]:t._e()]}))]}))]}))]:[r("tr",{key:e.id},[r("td",{class:e.modifier_options.length?"border-y-0":"border-b border-t-0"},[t._v("\n                "+t._s(e.name)+"\n                "),e.variation?r("div",[t._v(t._s(e.variation.id))]):t._e()]),t._v(" "),r("td",{staticClass:"text-right"},[t._v(t._s(t._f("formatNumber")(e.quantity,2)))])])],t._v(" "),e.modifier_options&&e.modifier_options.length?[r("tr",{key:"mo_"+e.modifier_options.length,staticClass:"border-y-0"},[r("td",[r("strong",[t._v(t._s(t.$tc("modifier",2)))])]),t._v(" "),r("td")]),t._v(" "),t._l(e.modifier_options,(function(i,s){return r("tr",{key:i.id,class:s==e.modifier_options.length-1?"border-b border-t-0":"border-y-0"},[r("td",{staticClass:"pt0"},[t._v("\n                "+t._s(i.item.name)+"\n              ")]),t._v(" "),r("td",{staticClass:"pt0 text-right"},[t._v("\n                "+t._s(t._f("formatNumber")(i.pivot.quantity,2))+"\n              ")])])}))]:t._e()]}))],2)])]):t._e(),t._v(" "),r("Row",{staticClass:"mt16",attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[t._v("\n      "+t._s(t.$t("status"))+": "),r("strong",[t._v(t._s(t._f("capitalize")(t.delivery.status)))])]),t._v(" "),t.delivery.user?r("Col",{attrs:{xs:24,sm:12}},[t._v("\n      "+t._s(t.$t("created_by"))+": "),r("strong",[t._v(t._s(t.delivery.user.name))])]):t._e()],1),t._v(" "),r("Row",{staticClass:"mt16",attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[t._v("\n      "+t._s(t.$t("delivered_at"))+": "),t.delivery.delivered_at?r("strong",[t._v(t._s(t._f("datetime")(t.delivery.delivered_at)))]):t._e()]),t._v(" "),t.delivery.user?r("Col",{attrs:{xs:24,sm:12}},[t._v("\n      "+t._s(t.$t("delivered_by"))+": "),r("strong",[t._v(t._s(t.delivery.deliveryMan?t.delivery.deliveryMan.name:t.delivery.delivered_by))])]):t._e()],1),t._v(" "),r("Row",{staticClass:"mt16",attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[t._v("\n      "+t._s(t.$tc("driver"))+": "),t.delivery.driver?r("strong",[t._v(t._s(t._f("capitalize")(t.delivery.driver)))]):t._e()]),t._v(" "),r("Col",{attrs:{xs:24,sm:12}},[t._v("\n      "+t._s(t.$t("received_by"))+": "),t.delivery.received_by?r("strong",[t._v(t._s(t._f("capitalize")(t.delivery.received_by)))]):t._e()])],1)],1):t._e()}),[],!1,null,null,null).exports,PaymentsComponent:s.Z,OrderViewComponent:a.Z},mixins:[(0,i.Z)("sale","app/sales","reference")],data:function(){var t=this;return{sale:{},view:!1,delivery:{},payments:[],printData:{},loading:!1,printing:!1,printModal:!1,deliveryModal:!1,paymentsModal:!1,loadingDelivery:!1,loadingPayments:!1,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",width:100,render:this.renderDate},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",minWidth:150},{maxWidth:300,minWidth:200,key:"customer",sortable:!1,title:this.$tc("customer"),render:this.renderCustomer},{title:this.$t("draft"),sortable:!0,key:"draft",width:80,render:this.renderIconDraft},{title:this.$t("paid"),sortable:!0,key:"paid",width:75,render:this.renderIconPaid},{title:this.$t("void"),sortable:!0,key:"void",width:75,render:this.renderIconVoid},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("total"),sortable:!1,key:"total",width:150,render:this.renderTotal},{title:this.$t("item_tax"),sortable:!1,key:"item_tax",width:125,render:this.renderItemTax},{title:this.$t("order_tax"),sortable:!1,key:"order_tax",width:125,render:this.renderOrderTax},{title:this.$t("discount"),sortable:!1,key:"discount",width:125,render:this.renderDiscount},{title:this.$t("shipping"),sortable:!1,key:"shipping",width:125,render:this.renderShipping},{title:this.$t("grand_total"),sortable:!1,key:"grand_total",width:150,render:this.renderGrandTotal},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:300,render:this.renderExtras},{title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0,width:350},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-dropdown-component",{props:{params:r,viewFn:t.viewModal,editFn:t.editRecord,payFn:t.paymentRecord,emailFn:t.emailRecord,deliveryFn:t.deliveryFn,duplicateFn:t.duplicate,deleteFn:t.deleteRecord,receiptFn:t.viewReceipt,toggleVoidFn:t.toggleVoid,downloadFn:t.downloadRecord,listPayFn:t.ListPaymentForRecord,listDeliveriesFn:t.listDeliveriesFn,viewDeliveriesFn:t.viewDeliveriesFn,record:{model:"sale",name:"reference",title:t.$tc("sale")}}})}}],options:{perPage:this.$store.state.settings.rows,orderBy:["date desc","created_at desc"]}}},created:function(){var t=this;this.$event.listen("location:changed",(function(e){return t.refresh++}))},mounted:function(){var t=this;1==this.$store.state.settings.pos_server&&(this.$connect(),this.$socket.addEventListener("error",(function(e){console.error("WebSocket error: ",e),t.$Notice.error({title:t.$t("error"),desc:t.$t("pos_server_error"),duration:10})})),this.$socket.addEventListener("message",(function(e){t.$Notice.info({title:e.data,duration:5})})))},beforeDestory:function(){1==this.$store.state.settings.pos_server&&(this.$socket.removeEventListener("error",(function(){console.log("Socket error listener removed.")})),this.$socket.removeEventListener("message",(function(){console.log("Socket message listener removed.")})),this.$disconnect())},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.sale.id&&(this.loading=!0,this.$http.get("app/sales/".concat(t.id)).then((function(t){return e.sale=t.data})).finally((function(){return e.loading=!1})))},showReceipt:function(t){var e=this;t.pos&&(this.sale=t,this.printData.type="receipt",this.printData.order=this.sale,this.printData.order.items=this.printData.order.items.map((function(t){return t.selected={portions:[],variations:[],modifiers:[]},t.selected.portions=t.portions,t.selected.variations=t.variations,t.selected.modifiers=t.modifier_options,t})),this.$Modal.confirm({width:365,closable:!0,scrollable:!0,render:function(t){return t("print-component",{props:{print:e.printData,vm:e}})},okText:this.$t("print"),onOk:function(){if(1==e.$store.state.settings.pos_server){if(1!=e.$socket.readyState){var t=0;return e.$connect(),e.$socket.addEventListener("error",(function(t){console.error("WebSocket error: ",t),e.$Notice.error({title:e.$t("error"),desc:e.$t("pos_server_error"),duration:10})})),e.$socket.addEventListener("message",(function(t){e.$Notice.info({title:t.data,duration:5})})),0==t&&(e.$Notice.info({desc:e.$t("pos_server_reconnect_text"),duration:5}),setTimeout((function(){return e.printReceipt()}),1e3),t++),!1}e.printReceipt()}else window.print()},onCancel:function(){setTimeout((function(){return e.printData={}}),200)}}))},printReceipt:function(){var t,e,r,i,s,a=this,n=this.sale,o=null,l={},c=n.user?n.user:this.$store.getters.user,u=n.location?n.location:this.$store.getters.location;l.name=u.name||u.label;var d=[[this.$t("order_id"),n.orderId],[this.$t("reference"),n.reference],[this.$t("date"),this.date(n.date)],[this.$t("created_by"),c.name+"("+c.username+")"],[this.$t("created_at"),this.datetime(n.created_at)],[this.$t("printed_at"),this.datetime(new Date)]];t=n.items.map((function(t){var e=["feed"],r=t.code+"\n"+t.name+(t.alt_name?"\n"+t.alt_name:"")+(t.comment?"\n"+t.comment:"");return t.variations&&t.variations.length?(e.push({type:"text",text:r}),t.variations.map((function(t){e.push({type:"item",name:" "+a.metaString(t.meta,!0,!0),price:a.formatNumber(parseFloat(t.pivot.net_price)+parseFloat(t.pivot.tax_amount)),qty:a.formatQuantity(t.pivot.quantity),subtotal:a.formatNumber(t.pivot.total)})}))):t.portions&&t.portions.length?(e.push({type:"text",text:r}),t.portions.map((function(t){e.push("feed"),e.push({type:"item",name:a.$tc("portion")+": "+a.$tc(t.name),price:a.formatNumber(parseFloat(t.pivot.price)-parseFloat(t.pivot.discount_amount)),qty:a.formatQuantity(t.pivot.quantity),subtotal:a.formatNumber(t.pivot.total)}),t.portion_items&&t.portion_items.length&&t.portion_items.map((function(r){e.push({type:"item",name:" "+r.item.name+(r.meta?"\n("+a.metaString(r.meta,!0,!0)+")":""),price:" ",qty:a.formatQuantity(parseFloat(r.quantity)*parseFloat(t.pivot.quantity)),subtotal:" "})})),t.essentials&&t.essentials.length&&t.essentials.map((function(r){e.push({type:"item",name:" "+r.item.name+(r.meta?"\n("+a.metaString(r.meta,!0,!0)+")":""),price:" ",qty:a.formatQuantity(parseFloat(r.quantity)*parseFloat(t.pivot.quantity)),subtotal:" "})})),t.choosables&&t.choosables.length&&t.choosables.map((function(r){r.items.map((function(i){t.pivot.choosables.find((function(t){return t.id==r.id&&i.item_id==t.item_id}))&&(e.push({type:"text",text:r.name}),e.push({type:"item",name:" "+i.item.name+(r.meta?"\n("+a.metaString(r.meta,!0,!0)+")":""),price:" ",qty:a.formatQuantity(parseFloat(i.quantity)*parseFloat(t.pivot.quantity)),subtotal:" "}))}))}))}))):e.push({name:r,type:"item",price:a.formatNumber(t.unit_price),qty:a.formatQuantity(t.quantity),subtotal:a.formatNumber(t.subtotal)}),t.modifier_options&&t.modifier_options.length&&t.modifier_options.map((function(t){e.push({type:"text",text:t.modifier.title}),e.push({type:"item",name:" "+t.item.name,price:a.formatNumber(parseFloat(t.pivot.net_price)+parseFloat(t.pivot.tax_amount)),qty:a.formatQuantity(t.pivot.quantity),subtotal:a.formatNumber(t.pivot.total)})})),e})),e=[this.$store.state.settings.header,u.header],l.email=u.email,l.phone=u.phone,l.company=u.company,l.address=u.address,l.state=u.state_name,l.country=u.country_name,d.unshift([this.$tc("id"),n.id]),d.push([this.$tc("customer"),n.customer.name+(n.customer.company?" ("+n.customer.company+")":"")+(n.customer.email?" "+n.customer.email:"")+(n.customer.phone?" "+n.customer.phone:"")]),o=[{label:this.$t("total"),value:this.formatNumber(n.total)}],n.order_discount_amount&&o.push({label:this.$t("order_discount"),value:this.formatNumber(n.order_discount_amount)}),o.push({label:this.$t("tax_amount"),value:this.formatNumber(n.total_tax_amount)}),o.push({label:this.$t("grand_total"),value:this.formatNumber(n.grand_total)});var m=n&&n.payments?n.payments.reduce((function(t,e){return t+parseFloat(e.amount)}),0):0;o.push({label:this.$t("paid"),value:this.formatNumber(m)}),o.push({label:this.$t("balance_due"),value:this.formatNumber(parseFloat(n.grand_total)-m)}),i=this.$t("order_cgd"),s=[{label:this.$t("name")},{label:this.$t("price")},{label:this.$t("qty")},{label:this.$t("subtotal")}],r=[this.$store.state.settings.footer,u.footer];var h={logo:u.logo||this.$store.state.settings.default_logo,heading:this.$store.state.settings.name,store_heading:this.$tc("location"),store_details:l,type:this.$tc("receipt"),headers:e,info:d,table_headers:s,items:t,totals:o,footers:r,notice:i};this.$nextTick((function(){1==a.$socket.readyState?a.$socket.send(JSON.stringify({type:"print-json-receipt",data:h})):a.$Notice.error({title:a.$t("error"),desc:a.$t("pos_server_connection_error"),duration:10})}))},viewReceipt:function(t){var e=this;t.id!=this.sale.id?(this.loading=!0,this.$http.get("app/sales/".concat(t.id)).then((function(t){return e.showReceipt(t.data)})).finally((function(){return e.loading=!1}))):this.showReceipt(this.sale)},duplicate:function(t){this.$router.push("/sales/add?sale_id=".concat(t.id))},toggleVoid:function(t){var e=this;this.$http.delete("app/sales/".concat(t.id,"/toggle_void")).then((function(t){t.data.success?(e.refresh++,e.$Notice.success({title:e.$t("success"),desc:e.$t("order_marked_x_text",{x:1==t.data.void?e.$t("void"):e.$t("valid")})})):e.$Notice.error({title:e.$tc("failed"),desc:e.$t("failed_error_text")})})).finally((function(){return e.$Modal.remove()}))},emailRecord:function(t){var e=this;this.$http.post("app/sales/email/"+t.id,{}).then((function(t){t.data.success?e.$Notice.success({title:e.$t("email_sent"),desc:e.$t("email_sent_text")}):e.$Notice.error({title:e.$tc("failed"),desc:e.$t("failed_error_text")})}))},downloadRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"download/sales/"+t.id}).click()},viewRecord:function(t){Object.assign(document.createElement("a"),{target:"_blank",href:window.mpsURL+"view/sale/"+t.hash}).click()},paymentRecord:function(t){this.$router.push("/payments/add?sale_id=".concat(t.id,"&customer_id=").concat(t.customer_id,"&amount=").concat(t.grand_total))},deliveryFn:function(t){1==t.draft&&this.$Notice.warning({title:this.$tc("draft"),desc:this.$t("order_draft_text")}),t.deliveries.length?this.$router.push("deliveries/edit/".concat(t.deliveries[0].id)):this.$router.push("deliveries/add?sale_id=".concat(t.id,"&customer_id=").concat(t.customer_id))},viewDeliveriesFn:function(t){var e=this;this.deliveryModal=!0,t.deliveries[0].id!=this.delivery.id&&(this.loadingDelivery=!0,this.$http.get("app/deliveries/".concat(t.deliveries[0].id)).then((function(t){return e.delivery=t.data})).finally((function(){return e.loadingDelivery=!1})))},listDeliveriesFn:function(t){this.$router.push("deliveries?sale_id=".concat(t.id))},ListPaymentForRecord:function(t){var e=this;this.sale=t,this.paymentsModal=!0,this.loadingPayments=!0,this.$http.get("app/sales/"+t.id+"/payments").then((function(t){e.payments=t.data,e.loadingPayments=!1}))},paymentsModalChanged:function(t){t||(this.sale={},this.payments=[])},renderCustomer:function(t,e){return t("div",[e.row.customer.name])},renderTotal:function(t,e){return this.renderNumber(t,e,"total")},renderItemTax:function(t,e){return this.renderNumber(t,e,"item_tax_amount")},renderOrderTax:function(t,e){return this.renderNumber(t,e,"order_tax_amount")},renderDiscount:function(t,e){return this.renderNumber(t,e,"discount_amount")},renderShipping:function(t,e){return this.renderNumber(t,e,"shipping")},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total",!0)},renderIconActive:function(t,e){return this.renderUnlessIcon(t,e,"draft")},renderIconDraft:function(t,e){return this.renderBoolean(t,e,"draft")},renderIconPaid:function(t,e){return this.renderBoolean(t,e,"paid")},renderIconVoid:function(t,e){return this.renderBoolean(t,e,"void")},rowClassName:function(t,e){return 1==t.void?"ivu-table-error-row":""}}};const c=(0,o.Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("sale",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/sales/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("sale"))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/sales",columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords,"row-class-name":t.rowClassName}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("sale")+" ("+t.sale.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{record:t.sale,heading:t.$tc("sale"),"to-text":t.$tc("bill_to")},on:{remove:function(e){return t.deleteAttachment(e,t.sale)}}})],1),t._v(" "),r("Modal",{attrs:{"footer-hide":"",width:750},on:{"on-visible-change":t.paymentsModalChanged},model:{value:t.paymentsModal,callback:function(e){t.paymentsModal=e},expression:"paymentsModal"}},[r("p",{attrs:{slot:"header"},slot:"header"},[r("span",[t._v("\n        "+t._s(t.$t("list_x",{x:t.$tc("payment",2)}))+"\n        "+t._s(t.sale?"("+t.$tc("sale")+" "+t.$t("reference")+" "+t.sale.reference+")":"")+"\n      ")])]),t._v(" "),t.loadingPayments?r("Loading"):r("payments-component",{attrs:{payments:t.payments}})],1),t._v(" "),r("Modal",{attrs:{title:t.$tc("delivery"),"footer-hide":!0,"mask-closable":!1},model:{value:t.deliveryModal,callback:function(e){t.deliveryModal=e},expression:"deliveryModal"}},[t.loadingDelivery?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("delivery-view-component",{attrs:{delivery:t.delivery},on:{remove:function(e){return t.deleteAttachment(e,t.delivery)}}})],1)],1)}),[],!1,null,null,null).exports},96879:(t,e,r)=>{"use strict";r.d(e,{Z:()=>n});var i=r(18446),s=r.n(i);const a={props:{taxes:{type:Array},itemPrice:{type:Function},deleteItem:{type:Function},updateItem:{type:Function},modOptLabel:{type:Function},itemDiscount:{type:Function},itemUnitChanged:{type:Function},addPortionToEditItem:{type:Function},changeSelectedPortion:{type:Function},edit_item:{type:Object,required:!0}},methods:{selectChoosableVariant:function(t,e){var r=this.edit_item.selected.portions[t].choosables[e].meta,i=this.edit_item.selected.portions[t].choosables[e].variations.find((function(t){return s()(t.meta,r)}));this.edit_item.selected.portions[t].choosables[e].variation_id=i?i.id:""},selectPortionItemVariant:function(t,e){var r=this.edit_item.selected.portions[t].portion_items[e].meta,i=this.edit_item.selected.portions[t].portion_items[e].variations.find((function(t){return s()(t.meta,r)}));this.edit_item.selected.portions[t].portion_items[e].variation_id=i?i.id:""},selectEssentialVariant:function(t,e){var r=this.edit_item.selected.portions[t].essentials[e].meta,i=this.edit_item.selected.portions[t].essentials[e].variations.find((function(t){return s()(t.meta,r)}));this.edit_item.selected.portions[t].essentials[e].variation_id=i?i.id:""}}};const n=(0,r(51900).Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Row",{attrs:{gutter:16}},[t.edit_item.portions.length||t.edit_item.has_variants?t._e():r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{staticClass:"text-center",attrs:{prop:"quantity",label:t.$t("quantity"),rules:{type:"number",required:!0,trigger:"change",message:t.$t("field_is_required",{field:t.$t("quantity")})}}},[r("InputNumber",{attrs:{size:"large"},model:{value:t.edit_item.quantity,callback:function(e){t.$set(t.edit_item,"quantity",e)},expression:"edit_item.quantity"}})],1)],1),t._v(" "),t.edit_item.portions&&t.edit_item.portions.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},t._l(t.edit_item.selected.portions,(function(e,i){return r("span",{key:"eispi_"+i},t._l(t.edit_item.portions.filter((function(t){return t.id==e.id})),(function(s){return r("span",{key:"pi_"+s.id},[r("Card",{staticClass:"cardp",attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"ios-option"}}),t._v("\n                "+t._s(i+1)+". "+t._s(t.$tc("portion"))+": ("+t._s("regular"==s.name?t.$t("regular"):s.name)+")\n              ")],1),t._v(" "),!i&&t.edit_item.portions.length>1?r("Button",{attrs:{slot:"extra",type:"primary",size:"small"},on:{click:function(e){return t.addPortionToEditItem()}},slot:"extra"},[t._v("\n                "+t._s(t.$t("add_x",{x:t.$tc("portion")}))+"\n              ")]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{staticClass:"mb16",attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("portion")}},[r("Select",{attrs:{value:e.id},on:{"on-change":function(e){return t.changeSelectedPortion(e,i)}}},t._l(t.edit_item.portions,(function(e,i){return r("Option",{key:"pi_"+i,attrs:{value:e.id}},[t._v("\n                        "+t._s("regular"==e.name?t.$t("regular"):e.name)+"\n                      ")])})),1)],1)],1),t._v(" "),r("Col",{staticClass:"mb16",attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("quantity")}},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"eisp.quantity"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}},[s.portion_items&&s.portion_items.length?[r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                        "+t._s(t.$tc("item",s.portion_items.length))+"\n                      ")])]),t._v(" "),r("p",{staticStyle:{"margin-bottom":"8px","font-weight":"bold"}},[t._v("\n                      "+t._s(s.portion_items.map((function(t){return t.item.name})).join(", "))+"\n                    ")])]:t._e(),t._v(" "),s.essentials&&s.essentials.length?[r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                        "+t._s(t.$t("essential_items"))+"\n                      ")])]),t._v(" "),r("p",{staticStyle:{"margin-bottom":"8px","font-weight":"bold"}},[t._v("\n                      "+t._s(s.essentials.map((function(t){return t.item.name})).join(", "))+"\n                    ")])]:t._e(),t._v(" "),s.choosables&&s.choosables.length?[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                        "+t._s(t.$t("choosable_items"))+"\n                      ")])]),t._v(" "),r("Row",{attrs:{gutter:16}},t._l(s.choosables,(function(s,a){return r("Col",{key:"gi_"+a,attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:s.name,prop:"selected.portions."+i+".choosables."+a+".selected",rules:{required:!0,trigger:"change",message:t.$t("select_x",{x:t.$tc("item")})}}},[r("Select",{model:{value:e.choosables[a].selected,callback:function(r){t.$set(e.choosables[a],"selected",r)},expression:"eisp.choosables[gi].selected"}},t._l(s.items,(function(e,i){return r("Option",{key:"gii_"+i,attrs:{value:e.item_id}},[t._v("\n                              "+t._s(e.item.name)+"\n                            ")])})),1)],1)],1)})),1)]:t._e(),t._v(" "),s.portion_items&&s.portion_items.length?t._l(s.portion_items,(function(s,a){return r("div",{key:"eiv_"+a},[s.item.variants&&s.item.variants.length?[r("div",{key:"t_"+a,staticClass:"mb16"},[r("span",{staticClass:"bold"},[t._v(t._s(s.item.name)+" ("+t._s(t.$tc("variation"))+")")])]),t._v(" "),r("Row",{key:"r_"+a,attrs:{gutter:16}},t._l(s.item.variants,(function(s,n){return r("Col",{key:"pcsv_"+n,attrs:{xs:24,sm:12}},[r("FormItem",{key:"pcsvf_"+s.id,attrs:{label:s.name}},[r("Select",{on:{"on-change":function(e){return t.selectPortionItemVariant(i,a)}},model:{value:e.portion_items[a].meta[s.name],callback:function(r){t.$set(e.portion_items[a].meta,s.name,r)},expression:"eisp.portion_items[ei].meta[v.name]"}},t._l(s.options,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)})),1)]:t._e()],2)})):t._e(),t._v(" "),s.essentials&&s.essentials.length?t._l(s.essentials,(function(s,a){return r("div",{key:"eiv_"+a},[s.item.variants&&s.item.variants.length?[r("div",{key:"t_"+a,staticClass:"mb16"},[r("span",{staticClass:"bold"},[t._v(t._s(s.item.name)+" ("+t._s(t.$tc("variation"))+")")])]),t._v(" "),r("Row",{key:"r_"+a,attrs:{gutter:16}},t._l(s.item.variants,(function(s,n){return r("Col",{key:"pcsv_"+n,attrs:{xs:24,sm:12}},[r("FormItem",{key:"pcsvf_"+s.id,attrs:{label:s.name}},[r("Select",{on:{"on-change":function(e){return t.selectEssentialVariant(i,a)}},model:{value:e.essentials[a].meta[s.name],callback:function(r){t.$set(e.essentials[a].meta,s.name,r)},expression:"eisp.essentials[ei].meta[v.name]"}},t._l(s.options,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)})),1)]:t._e()],2)})):t._e(),t._v(" "),s.choosables&&s.choosables.length?t._l(s.choosables,(function(s,a){return r("div",{key:"giv_"+a},[t._l(s.items,(function(n){return[e.choosables[a].selected&&e.choosables[a].selected==n.item.id&&n.item.variants&&n.item.variants.length?[r("Row",{key:"r_"+a,attrs:{gutter:16}},[r("Col",{key:"t_"+a,staticClass:"mb16",attrs:{lg:24}},[r("span",{staticClass:"bold"},[t._v(t._s(s.name))]),t._v(": "+t._s(n.item.name)+" ("+t._s(t.$tc("variation"))+")\n                            ")]),t._v(" "),t._l(n.item.variants,(function(s,n){return r("Col",{key:"pcsv_"+n,attrs:{xs:24,sm:12}},[r("FormItem",{key:"pcsvf_"+s.id,attrs:{label:s.name}},[r("Select",{on:{"on-change":function(e){return t.selectChoosableVariant(i,a)}},model:{value:e.choosables[a].meta[s.name],callback:function(r){t.$set(e.choosables[a].meta,s.name,r)},expression:"eisp.choosables[gi].meta[v.name]"}},t._l(s.options,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)}))],2)]:t._e()]}))],2)})):t._e()],2)],1)],1)],1)})),0)})),0),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),t.edit_item.variants&&t.edit_item.variants.length?[t._l(t.edit_item.selected.variations,(function(e,i){return r("span",{key:"sv_meta_"+i},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("span",{staticStyle:{color:"#515a6e"},domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("quantity"),prop:"selected.variations."+i+".quantity",rules:{required:!0,type:"number",trigger:"change",max:parseFloat(e.available),message:t.$t("only_x_quantity_available",{x:parseFloat(e.available)})}}},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"eisv.quantity"}})],1)],1),t._v(" "),r("Col",{staticClass:"text-primary",staticStyle:{"padding-top":"2.5em"},attrs:{sm:24,md:12,lg:12}},[t._v("\n          "+t._s(t.$t("available_x",{x:t.$t("quantity")}))+":\n          "),r("strong",[t._v(t._s(e.available))])])],1)})),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),t.edit_item.modifiers&&t.edit_item.modifiers.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n            "+t._s(t.$tc("modifier",2))+"\n          ")])])],1),t._v(" "),t._l(t.edit_item.modifiers,(function(e,i){return r("Col",{key:"mi_"+i,attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:e.title,prop:"modifiers"}},["radio"==e.show_as?r("span",[r("RadioGroup",{attrs:{vertical:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Radio",{key:e.id,attrs:{label:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"checkbox"==e.show_as?r("span",[r("CheckboxGroup",{attrs:{vertical:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Checkbox",{key:e.id,attrs:{label:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"select"==e.show_as?r("span",[r("Select",{model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):"select_multiple"==e.show_as?r("span",[r("Select",{attrs:{multiple:""},model:{value:e.selected,callback:function(r){t.$set(e,"selected",r)},expression:"m.selected"}},t._l(e.options,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(t.modOptLabel(e)))])})),1)],1):t._e()])],1)})),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n        "+t._s(t.$t("general"))+"\n      ")])]),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.allUnits&&t.edit_item.allUnits.length>0?r("FormItem",{attrs:{label:t.$tc("unit")}},[r("Select",{staticStyle:{width:"100%"},on:{"on-change":t.itemUnitChanged},model:{value:t.edit_item.unit_id,callback:function(e){t.$set(t.edit_item,"unit_id",e)},expression:"edit_item.unit_id"}},t._l(t.edit_item.allUnits,(function(e,i){return r("Option",{key:"unit_"+i+"_"+e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),1)],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.changeable?r("FormItem",{attrs:{prop:"price",label:t.$t("price"),rules:[{required:!0,type:"number",message:t.$t("field_is_required",{field:t.$t("price")}),trigger:["change","blur"]},{validator:t.itemPrice,trigger:["change","blur"]}]}},[r("InputNumber",{model:{value:t.edit_item.price,callback:function(e){t.$set(t.edit_item,"price",e)},expression:"edit_item.price"}})],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{prop:"discount",label:t.$t("discount_"),rules:{validator:t.itemDiscount,trigger:["change","blur"]}}},[r("InputNumber",{model:{value:t.edit_item.discount,callback:function(e){t.$set(t.edit_item,"discount",e)},expression:"edit_item.discount"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.allPromotions&&t.edit_item.allPromotions.length>0?r("FormItem",{attrs:{label:t.$tc("promo",2)}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.edit_item.promotions,callback:function(e){t.$set(t.edit_item,"promotions",e)},expression:"edit_item.promotions"}},t._l(t.edit_item.allPromotions,(function(e,i){return r("Option",{key:"tax_"+i+"_"+e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),1)],1):t._e()],1)],2),t._v(" "),t.edit_item.changeable?r("FormItem",{attrs:{label:t.$tc("tax",2),prop:"taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.edit_item.allTaxes,callback:function(e){t.$set(t.edit_item,"allTaxes",e)},expression:"edit_item.allTaxes"}},t._l(this.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),1)],1):t._e(),t._v(" "),r("FormItem",{attrs:{label:t.$t("comment")}},[r("Input",{attrs:{type:"textarea",placeholder:t.$t("item_comment"),autosize:{minRows:2,maxRows:5}},model:{value:t.edit_item.comment,callback:function(e){t.$set(t.edit_item,"comment",e)},expression:"edit_item.comment"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{long:"",type:"primary"},on:{click:function(e){return t.updateItem()}}},[t._v(t._s(t.$t("update")))])],1),t._v(" "),r("Button",{attrs:{long:"",type:"error"},on:{click:function(e){return t.deleteItem(t.edit_item)}}},[t._v(t._s(t.$t("remove_from_order")))])],1)}),[],!1,null,null,null).exports},96677:(t,e,r)=>{"use strict";r.d(e,{Z:()=>s});const i={props:{editItem:{type:Function},remove:{type:Function},calcItemTax:{type:Function},calcRowTotal:{type:Function},customer:{type:[Boolean,Object]},row:{type:Object,required:!0},getPortionChoosable:{type:Function},index:{type:Number,required:!0},itemVariationQuantityChanged:{type:Function}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order-item"},[r("span",{staticClass:"item"},[r("span",{staticClass:"index"},[t._v(t._s(t.index+1))]),t._v(" "),r("span",{staticClass:"remove"},[t.row.selected.variations&&t.row.selected.portions&&!t.row.selected.portions.length&&!t.row.selected.variations.length?r("span",[r("Icon",{staticClass:"pointer",attrs:{size:"18",type:"md-close",color:"#ed4014"},on:{click:function(e){return t.remove(t.row)}}})],1):t._e()]),t._v(" "),r("span",{staticClass:"details pointer",on:{click:function(e){return t.editItem(t.index)}}},[r("strong",[t._v(t._s(t.row.name))]),t._v(" "),r("br"),t._v(" "),r("span",[t.customer&&t.customer.customer_group?r("span",{domProps:{innerHTML:t._s(t.customer.customer_group.name+" (<small>"+t.$t("discount")+": "+t.customer.customer_group.discount+"%</small>)<br />")}}):t._e(),t._v(" "),t.row.promotions&&t.row.promotions.length?r("span",[t._v(t._s(t.$tc("promo",t.row.promotions.length))+":\n          "+t._s(t.row.allPromotions.filter((function(e){return t.row.promotions.includes(e.id)})).map((function(e){return e.name+" ("+t.formatNumber(e.discount)+")"})).join(","))+"\n        ")]):t._e(),t._v(" "),t.row.comment?r("span",[t._v(t._s(t.row.comment)+" ")]):t._e()])]),t._v(" "),t.row.selected.variations&&t.row.selected.portions&&!t.row.selected.portions.length&&!t.row.selected.variations.length?[r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(t.row.price-t.row.discount_amount+t.calcItemTax(t.row)))+"\n      ")]),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length||!!t.row.selected.portions.length,size:t.row.selected.variations.length||t.row.selected.portions.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(t.row.taxes,(function(e){return r("div",{key:"tax_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber(t.calcRowTotal(t.row)))+"\n      ")])]:[r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length||!!t.row.selected.portions.length,size:t.row.selected.variations.length||t.row.selected.portions.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})]],2),t._v(" "),t.row.selected.variations&&t.row.selected.variations.length?t._l(t.row.selected.variations,(function(e,i){return r("div",{key:"svi_"+i,staticClass:"combo-item variation"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.remove(t.row,"Variation",e)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n        "+t._s(i+1)+".\n        "),r("span",{domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(e.price))+"\n      ")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n        "+t._s(t.formatNumber(e.discount_amount))+"\n      ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{on:{"on-change":function(e){return t.itemVariationQuantityChanged(t.form.items[t.index])}},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"sv.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(e){return r("div",{key:"sv_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber((e.price-e.discount_amount+e.total_tax_amount)*e.quantity))+"\n      ")])])})):t._e(),t._v(" "),t.row.selected.portions.length?t._l(t.row.selected.portions,(function(e,i){return r("div",{key:"spi_"+i,staticClass:"combo"},t._l(t.row.portions.filter((function(t){return t.id==e.id})),(function(s){return r("div",{key:"pi_"+s.id,staticClass:"combo"},[r("div",{staticClass:"combo-item variation"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.remove(t.row,"Portion",e,i)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[r("p",[t._v("\n              "+t._s(i+1)+". "+t._s(t.$tc("portion"))+":\n              "),r("strong",[t._v(t._s("regular"==s.name?t.$t("regular"):s.name))])])]),t._v(" "),r("span",{staticClass:"price"},[t._v(t._s(t.formatNumber(e.price)))]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n            "+t._s(t.formatNumber(e.discount_amount))+"\n          ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{on:{"on-change":function(e){return t.itemPortionQuantityChanged(t.form.items[t.index])}},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"sp.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(i){return r("div",{key:"sp_"+i.id},[t._v("\n              "+t._s(i.code)+"\n              "),r("span",{staticClass:"float-right"},[t._v("\n                "+t._s(t.formatNumber(i.amount*e.quantity))+"\n              ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n            "+t._s(t.formatNumber((e.price-e.discount_amount+e.total_tax_amount)*e.quantity))+"\n          ")])]),t._v(" "),t._l(s.portion_items,(function(i,s){return r("div",{key:"ei_"+s,staticClass:"combo-item bt0",staticStyle:{"padding-top":"1px"}},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"}),t._v(" "),r("span",{staticClass:"details"},[t._v("\n            #"+t._s(s+1)+" "+t._s(i.item.name)+"\n            "),e.portion_items[s].variation_id?r("span",[t._v(" ("),r("span",{domProps:{innerHTML:t._s(t.metaString(e.portion_items[s].meta))}}),t._v(") ")]):t._e()]),t._v(" "),r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity input"},[t._v("\n            "+t._s(parseFloat(i.quantity*e.quantity))+"\n          ")]),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})])})),t._v(" "),t._l(s.essentials,(function(i,s){return r("div",{key:"ei_"+s,staticClass:"combo-item bt0",staticStyle:{"padding-top":"1px"}},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"}),t._v(" "),r("span",{staticClass:"details"},[t._v("\n            #"+t._s(s+1)+" "+t._s(i.item.name)+"\n            "),e.essentials[s].variation_id?r("span",[t._v(" ("),r("span",{domProps:{innerHTML:t._s(t.metaString(e.essentials[s].meta))}}),t._v(") ")]):t._e()]),t._v(" "),r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity input"},[t._v("\n            "+t._s(parseFloat(i.quantity*e.quantity))+"\n          ")]),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})])})),t._v(" "),t._l(s.choosables,(function(i,a){return t._l(i.items,(function(n,o){return t.getPortionChoosable(e,i.id,n.item_id)?r("div",{key:"gii_"+o+"_"+a,staticClass:"combo-item bt0",staticStyle:{"padding-top":"1px"}},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"}),t._v(" "),r("span",{staticClass:"details"},[t._v("\n              #"+t._s(a+1+s.essentials.length)+"\n              "+t._s(n.item.name)+"\n              "),e.choosables[a].variation_id?r("span",[t._v(" ("),r("span",{domProps:{innerHTML:t._s(t.metaString(e.choosables[a].meta))}}),t._v(") ")]):t._e()]),t._v(" "),r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"discount"}),t._v(" "),r("span",{staticClass:"quantity input"},[t._v("\n              "+t._s(parseFloat(n.quantity*e.quantity))+"\n            ")]),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})]):t._e()}))}))],2)})),0)})):t._e(),t._v(" "),t.row.selected.modifiers.length?[r("div",{staticClass:"combo-item bg"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[t._v("")]),t._v(" "),r("span",{staticClass:"details"},[r("p",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.$tc("modifier",2)))])]),t._v(" "),r("span",{staticClass:"price"},[t._v("")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("")]),t._v(" "),r("span",{staticClass:"quantity"},[t._v("")]),t._v(" "),r("span",{staticClass:"taxes"},[t._v("")]),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("")])]),t._v(" "),t._l(t.row.selected.modifiers,(function(e,i){return r("div",{key:"mi_"+i},[r("div",{staticClass:"combo-item pt pb"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.remove(t.row,"Modifier",e,i)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n          "+t._s(i+1)+". "),r("strong",[t._v(t._s(e.option))]),t._v(" ("+t._s(e.title)+")\n        ")]),t._v(" "),r("span",{staticClass:"price"},[t._v("\n          "+t._s(t.formatNumber(e.price))+"\n        ")]),t._v(" "),r("span",{staticClass:"discount"},[t._v("\n          "+t._s(t.formatNumber(e.discount_amount*e.quantity))+"\n        ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"m.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(i){return r("div",{key:"m_"+i.id},[t._v("\n            "+t._s(i.code)+"\n            "),r("span",{staticClass:"float-right"},[t._v("\n              "+t._s(t.formatNumber(i.amount*e.quantity))+"\n            ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"})])])}))]:t._e()],2)}),[],!1,null,null,null).exports},7918:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>p});var i=r(57797);const s={data:function(){return{errors:null,form:{logo:""}}},methods:{handleUpload:function(t){var e=this;this.form.logo=t;var r=this.$form(this.form);return this.$http.post("/app/settings/logo",r).then((function(t){t.data.success&&(e.$store.commit("changeDefaultLogo",t.data.logo),e.$Notice.success({title:e.$t("success"),desc:e.$t("x_updated",{x:e.$t("logo")})}),e.errors=null,e.$emit("close"))})).catch((function(t){return e.errors=t.message})),!1},handleFormatError:function(t){this.$Notice.warning({title:"The file format is incorrect",desc:"File format of "+t.name+" is incorrect, please select jpg or png."})},handleMaxSize:function(t){this.$Notice.warning({title:"Exceeding file size limit",desc:"File  "+t.name+" is too large, no more than 300KB."})}}};var a=r(51900);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const c={components:{ChangeLogoComponent:(0,a.Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.errors?r("Alert",{attrs:{type:"error"}},[r("p",{domProps:{innerHTML:t._s(t.errors.replace(".,",".<br />"))}})]):t._e(),t._v(" "),t.$store.state.settings.default_logo?r("div",{staticClass:"text-center mb16"},[r("img",{staticClass:"image",attrs:{src:t.$store.state.settings.default_logo,alt:t.$t("default_logo")}})]):t._e(),t._v(" "),r("Upload",{ref:"upload",attrs:{action:"",type:"drag","max-size":300,"show-upload-list":!1,"before-upload":t.handleUpload,"on-exceeded-size":t.handleMaxSize,"on-format-error":t.handleFormatError,format:["jpg","jpeg","png","svg"]}},[r("div",{staticStyle:{width:"100%",height:"58px","line-height":"58px"}},[r("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[r("Icon",{staticStyle:{color:"#3399ff","margin-right":"8px"},attrs:{type:"ios-cloud-upload",size:"32"}}),t._v(" "),r("p",[t._v("\n          "+t._s(t.$t("click_or_drag"))+"\n        ")])],1)])])],1)}),[],!1,null,null,null).exports},data:function(){var t;return{logo:!1,accounts:[],email:!1,saving:!1,loading:!0,countries:[],customers:[],timezones:[],payment:!1,categories:[],searching:!1,settings_routes:[],mail_settings:null,payment_settings:null,saving_barcode:!1,scale_barcode_show:!1,scale_barcode_guide:!1,errors:{message:"",form:{}},states:[{value:"",label:this.$t("select_country")}],settings:(t={name:"",rows:10,email:"",theme:"",timezone:"",dateformat:"",hide_id:!1,quick_cash:[],overselling:"",confirmation:"",search_delay:250,max_discount:null,fixed_layout:!1,impersonation:!1,onscreen_keyboard:!0,inventory_accounting:"FIFO"},l(t,"inventory_accounting","FIFO"),l(t,"loyalty",{staff:{spent:null,points:null},customer:{spent:null,points:null}}),t),scale_barcode:{type:"weight",total_digits:null,flag_digits:null,item_code_start:null,item_code_digits:null,price_start:null,price_digits:null,price_divide_by:null,weight_start:null,weight_digits:null,weight_divide_by:null},rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("app_name")}),trigger:"blur"}],email:[{required:!0,message:this.$t("field_is_required",{field:this.$t("email")}),trigger:"blur"},{type:"email",message:"Email format is incorrect",trigger:"blur"}],timezone:[{required:!0,message:this.$t("field_is_required",{field:this.$t("timezone")}),trigger:"blur"}],language:[{required:!0,message:this.$t("field_is_required",{field:this.$t("language")}),trigger:"change"}],dateformat:[{required:!0,message:this.$t("field_is_required",{field:this.$t("date_format")}),trigger:"change"}],inventory_accounting:[{required:!0,message:this.$t("field_is_required",{field:this.$t("inventory_accounting")}),trigger:"change"}],theme:[{required:!0,message:this.$t("field_is_required",{field:this.$t("theme")}),trigger:"change"}],loader:[{required:!0,message:this.$t("field_is_required",{field:this.$t("loader")}),trigger:"change"}],rows:[{required:!0,message:this.$t("field_is_required",{field:this.$t("initial_table_rows")}),trigger:"change"}],short_name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("short_name")}),trigger:"change"}],company:[{required:!0,message:this.$t("field_is_required",{field:this.$t("company")}),trigger:"blur"}],phone:[{required:!0,message:this.$t("field_is_required",{field:this.$t("phone")}),trigger:"blur"}],address:[{required:!0,message:this.$t("field_is_required",{field:this.$t("address")}),trigger:"blur"}],default_account:[{required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("default_x",{x:this.$tc("account")})})}],default_customer:[{required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("default_x",{x:this.$tc("customer")})})}],default_category:[{required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("default_x",{x:this.$tc("category")})})}],country:[{required:!0,message:this.$t("field_is_required",{field:this.$t("country")}),trigger:"change"}],state:[{required:!0,message:this.$t("field_is_required",{field:this.$t("state")}),trigger:"change"}],reference:[{required:!0,message:this.$t("field_is_required",{field:this.$t("reference")}),trigger:"change"}],max_discount:[{required:!0,type:"number",trigger:["blur","change"],message:this.$t("field_is_required",{field:this.$t("max_discount")})}],search_delay:[{min:200,max:1e3,required:!0,type:"number",trigger:["blur","change"],message:this.$t("field_min_max_error",{field:this.$t("search_delay"),min:200,max:1e3})}],quick_cash:[{min:3,max:5,type:"array",required:!0,trigger:"change",message:this.$t("quick_cash_error")}]},rulesEmail:{},rulesPayment:{}}},created:function(){this.fetch(),this.settings_routes=this.routes=(0,i._)(this.$store.state.user_language)[0].children.find((function(t){return"settings"==t.path})).children},methods:{getWeekDayString:function(t){return new Date(this.$moment().day(t).format("YYYY-MM-DD")).toLocaleString("default",{weekday:"long"})},fetch:function(){var t=this;this.$http.get("app/settings").then((function(e){t.accounts=e.data.accounts,t.customers=e.data.customers,t.categories=e.data.categories,t.countries=e.data.countries,t.timezones=e.data.timezones,t.mail_settings=e.data.mail_settings,e.data.payment_settings.PAYPAL_ENABLED=!!e.data.payment_settings.PAYPAL_ENABLED,t.payment_settings=e.data.payment_settings,t.getStates(e.data.settings.country,e.data.settings.state),e.data.settings.state="",e.data.settings.inventory_accounting=e.data.settings.inventory_accounting||"FIFO",e.data.settings.quick_cash=e.data.settings.quick_cash?e.data.settings.quick_cash.split("|"):[],e.data.settings.search_delay=e.data.settings.search_delay?parseFloat(e.data.settings.search_delay):250,e.data.settings.max_discount=e.data.settings.max_discount?parseFloat(e.data.settings.max_discount):null,t.scale_barcode=e.data.settings.scale_barcode||t.scale_barcode,e.data.settings.loyalty=e.data.settings.loyalty||{staff:{spent:null,points:null},customer:{spent:null,points:null}},e.data.settings.auto_update_time=e.data.settings.auto_update_time||{day:"saturdays",time:["03:00","22:00"]},e.data.settings.loyalty.staff.spent=e.data.settings.loyalty.staff.spent?parseFloat(e.data.settings.loyalty.staff.spent):null,e.data.settings.loyalty.staff.points=e.data.settings.loyalty.staff.points?parseFloat(e.data.settings.loyalty.staff.points):null,e.data.settings.loyalty.customer.spent=e.data.settings.loyalty.customer.spent?parseFloat(e.data.settings.loyalty.customer.spent):null,e.data.settings.loyalty.customer.points=e.data.settings.loyalty.customer.points?parseFloat(e.data.settings.loyalty.customer.points):null,delete e.data.settings.svg_string,delete e.data.settings.json_string,delete e.data.settings.scale_barcode,t.settings=e.data.settings})).finally((function(){return t.loading=!1}))},handleSubmit:function(){var t=this;this.$refs.settings.validate((function(e){if(e){t.saving=!0,t.settings.quick_cash=t.settings.quick_cash.join("|");var r=t.$form(t.settings);t.settings.quick_cash=t.settings.quick_cash?t.settings.quick_cash.split("|"):[],t.$http.post("app/settings",r).then((function(e){t.$store.state.user_language!=e.data.language&&window.location.reload(),t.$store.commit("setSettings",e.data),t.$Notice.success({title:t.$t("settings")+" "+t.$t("saved"),desc:t.$t("settings_saved_text")}),window&&(document.body.className="dark"==t.$store.getters.settings.theme?"bg-dark":"bg-light")})).finally((function(){return t.saving=!1}))}else t.$Notice.error({title:t.$t("invalid_form"),desc:t.$t("invalid_form_error"),duration:10})}))},updateSettings:function(t){var e=this;this.$refs[t].validate((function(t){if(t){e.saving=!0;var r=o(o({},e.mail_settings),e.payment_settings);e.$http.put("app/settings",r).then((function(t){e.$Notice.success({title:e.$t("settings")+" "+e.$t("saved"),desc:e.$t("settings_saved_text")}),e.$store.commit("setPayment",{gateway:e.payment_settings.CARD_GATEWAY,public_key:e.payment_settings.STRIPE_KEY}),e.email=!1,e.payment=!1})).catch((function(t){return e.errors=t})).finally((function(){return e.saving=!1}))}else e.$Notice.error({title:e.$t("invalid_form"),desc:e.$t("invalid_form_error"),duration:10})}))},saveBarcode:function(t){var e=this;this.$refs[t].validate((function(t){if(t){e.saving_barcode=!0;var r={scale_barcode:o({},e.scale_barcode)};e.$http.post("app/settings/barcode",r).then((function(t){e.$Notice.success({title:e.$t("settings")+" "+e.$t("saved"),desc:e.$t("settings_saved_text")}),e.scale_barcode_show=!1,e.$store.commit("setScaleBarcode",e.scale_barcode)})).catch((function(t){return e.errors=t})).finally((function(){return e.saving_barcode=!1}))}else e.$Notice.error({title:e.$t("invalid_form"),desc:e.$t("invalid_form_error"),duration:10})}))},countryChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t?(this.searching=!0,this.getStates(t,e),this.settings.state=""):(this.settings.state="",this.settings.country="",this.states=[{value:"",label:this.$t("select_country")}])},getStates:function(t,e){var r=this;this.$http.get("app/states",{params:{country:t}}).then((function(t){r.states=t.data,e&&(r.settings.state=r.states.find((function(t){return t.value==e})).value),r.searching=!1})).catch((function(t){return r.$event.fire("appError",t.response)}))},handleReset:function(t){this.$refs[t].resetFields()},onSelect:function(t){t&&("mail_settings"==t?this.email=!0:"scale_barcode"==t?this.scale_barcode_show=!0:"payment_settings"==t?this.payment=!0:this.$router.push({name:t}))}}};var u=r(93379),d=r.n(u),m=r(66489),h={insert:"head",singleton:!1};d()(m.Z,h);m.Z.locals;const p=(0,a.Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("app_settings")))]),t._v(" "),r("div",{attrs:{slot:"extra"},slot:"extra"},[r("a",{attrs:{href:"/modules",target:"_blank"}},[t._v("Manage Modules")]),t._v(" "),r("a",{attrs:{slot:"extra",href:"#"},slot:"extra"},[r("Dropdown",{staticStyle:{margin:"0 -5px 0 20px"},attrs:{placement:"bottom-end"},on:{"on-click":t.onSelect}},[r("a",{staticStyle:{"padding-right":"10px"},attrs:{href:"javascript:void(0)"}},[r("Icon",{attrs:{type:"md-menu",size:"18"}})],1),t._v(" "),r("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[r("DropdownItem",{attrs:{name:"mail_settings"}},[t._v(t._s(t.$t("mail_settings")))]),t._v(" "),r("DropdownItem",{attrs:{name:"scale_barcode"}},[t._v(t._s(t.$t("scale_barcode")))]),t._v(" "),r("DropdownItem",{attrs:{name:"payment_settings"}},[t._v(t._s(t.$t("payment_settings")))]),t._v(" "),t.settings_routes.length>0?[t._l(t.settings_routes,(function(e){return[e.meta.hideInMenu||"/settings"==e.path?t._e():[r("DropdownItem",{key:e.name,attrs:{name:e.name,divided:e.meta.divided}},[t._v("\n                    "+t._s(e.meta.title)+"\n                  ")])]]}))]:t._e()],2)],1)],1)]),t._v(" "),r("div",[r("p",{staticStyle:{"margin-bottom":"20px"}},[t._v(t._s(t.$t("settings_heading_text")))]),t._v(" "),r("Form",{ref:"settings",staticClass:"form-responsive",attrs:{model:t.settings,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("app_name"),prop:"name"}},[r("Input",{model:{value:t.settings.name,callback:function(e){t.$set(t.settings,"name",e)},expression:"settings.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("short_name"),prop:"short_name"}},[r("Input",{model:{value:t.settings.short_name,callback:function(e){t.$set(t.settings,"short_name",e)},expression:"settings.short_name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("company"),prop:"company"}},[r("Input",{model:{value:t.settings.company,callback:function(e){t.$set(t.settings,"company",e)},expression:"settings.company"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("reg_number"),prop:"number"}},[r("Input",{model:{value:t.settings.number,callback:function(e){t.$set(t.settings,"number",e)},expression:"settings.number"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("default_x",{x:t.$tc("account")}),prop:"default_account"}},[r("Select",{model:{value:t.settings.default_account,callback:function(e){t.$set(t.settings,"default_account",e)},expression:"settings.default_account"}},t._l(t.accounts,(function(e){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("default_x",{x:t.$tc("category")}),prop:"default_category"}},[r("Select",{model:{value:t.settings.default_category,callback:function(e){t.$set(t.settings,"default_category",e)},expression:"settings.default_category"}},t._l(t.categories,(function(e){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("default_x",{x:t.$tc("customer")}),prop:"default_customer"}},[r("Select",{model:{value:t.settings.default_customer,callback:function(e){t.$set(t.settings,"default_customer",e)},expression:"settings.default_customer"}},t._l(t.customers,(function(e){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("timezone"),prop:"timezone"}},[r("Select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",placeholder:t.$t("select_x",{x:t.$t("timezone")})},model:{value:t.settings.timezone,callback:function(e){t.$set(t.settings,"timezone",e)},expression:"settings.timezone"}},t._l(t.timezones,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("language"),prop:"language"}},[r("Select",{model:{value:t.settings.language,callback:function(e){t.$set(t.settings,"language",e)},expression:"settings.language"}},t._l(t.$store.state.languages,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(t._f("regionName")(e))+" ("+t._s(e)+")")])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("user_locale"),prop:"user_locale"}},[r("Input",{model:{value:t.settings.user_locale,callback:function(e){t.$set(t.settings,"user_locale",e)},expression:"settings.user_locale"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("inventory_accounting"),prop:"inventory_accounting"}},[r("Select",{model:{value:t.settings.inventory_accounting,callback:function(e){t.$set(t.settings,"inventory_accounting",e)},expression:"settings.inventory_accounting"}},[r("Option",{attrs:{value:"FIFO"}},[t._v(t._s(t.$t("FIFO")))]),t._v(" "),r("Option",{attrs:{value:"LIFO"}},[t._v(t._s(t.$t("LIFO")))]),t._v(" "),r("Option",{attrs:{value:"AVCO"}},[t._v(t._s(t.$t("AVCO")))]),t._v(" "),r("Option",{attrs:{value:"ITEX"}},[t._v(t._s(t.$t("ITEX")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("max_discount"),prop:"max_discount"}},[r("InputNumber",{attrs:{formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:t.settings.max_discount,callback:function(e){t.$set(t.settings,"max_discount",e)},expression:"settings.max_discount"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("search_delay"),prop:"search_delay"}},[r("InputNumber",{model:{value:t.settings.search_delay,callback:function(e){t.$set(t.settings,"search_delay",e)},expression:"settings.search_delay"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("email"),prop:"email"}},[r("Input",{model:{value:t.settings.email,callback:function(e){t.$set(t.settings,"email",e)},expression:"settings.email"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("phone"),prop:"phone"}},[r("Input",{model:{value:t.settings.phone,callback:function(e){t.$set(t.settings,"phone",e)},expression:"settings.phone"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("address"),prop:"address"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.settings.address,callback:function(e){t.$set(t.settings,"address",e)},expression:"settings.address"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("country"),prop:"country"}},[r("Select",{attrs:{placeholder:"",filterable:""},on:{"on-change":t.countryChange},model:{value:t.settings.country,callback:function(e){t.$set(t.settings,"country",e)},expression:"settings.country"}},t._l(t.countries,(function(e,i){return r("Option",{key:i,attrs:{value:e.value},domProps:{innerHTML:t._s(e.label)}})})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("state"),prop:"state"}},[r("Select",{attrs:{placeholder:"",filterable:"",loading:t.searching},model:{value:t.settings.state,callback:function(e){t.$set(t.settings,"state",e)},expression:"settings.state"}},t._l(t.states,(function(e,i){return r("Option",{key:i,attrs:{value:e.value},domProps:{innerHTML:t._s(e.label)}})})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("reference"),prop:"reference"}},[r("Select",{attrs:{placeholder:"",loading:t.searching},model:{value:t.settings.reference,callback:function(e){t.$set(t.settings,"reference",e)},expression:"settings.reference"}},[r("Option",{attrs:{value:"yearly"}},[t._v(t._s(t.$t("employee_number")+"/"+t.$t("year")+"/"+t.$t("sequence_number")))]),t._v(" "),r("Option",{attrs:{value:"monthly",selected:"selected"}},[t._v(t._s(t.$t("employee_number")+"/"+t.$t("year")+"/"+t.$t("month")+"/"+t.$t("sequence_number")))]),t._v(" "),r("Option",{attrs:{value:"sequence"}},[t._v(t._s(t.$t("employee_number")+"/"+t.$t("sequence_number")))]),t._v(" "),r("Option",{attrs:{value:"random"}},[t._v(t._s(t.$t("employee_number")+"/"+t.$t("random_number")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("overselling"),prop:"overselling"}},[r("Select",{model:{value:t.settings.overselling,callback:function(e){t.$set(t.settings,"overselling",e)},expression:"settings.overselling"}},[r("Option",{attrs:{value:"0"}},[t._v(t._s(t.$t("disable")))]),t._v(" "),r("Option",{attrs:{value:"1"}},[t._v(t._s(t.$t("enable")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("receipt_header"),prop:"header"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:5}},model:{value:t.settings.header,callback:function(e){t.$set(t.settings,"header",e)},expression:"settings.header"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("receipt_footer"),prop:"footer"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:5}},model:{value:t.settings.footer,callback:function(e){t.$set(t.settings,"footer",e)},expression:"settings.footer"}})],1)],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("loyalty_points")}},[r("Card",{staticStyle:{"overflow-x":"auto"},attrs:{"dis-hover":""}},[r("div",{staticStyle:{"min-width":"700px"}},[r("p",{staticClass:"bold mb8"},[t._v(t._s(t.$t("for_x",{x:t.$tc("customer",2)})))]),t._v(" "),r("div",{staticClass:"flex-gap"},[r("span",[t._v(t._s(t.$t("each_spent")))]),t._v(" "),r("InputNumber",{model:{value:t.settings.loyalty.customer.spent,callback:function(e){t.$set(t.settings.loyalty.customer,"spent",e)},expression:"settings.loyalty.customer.spent"}}),t._v(" "),r("span",[t._v(t._s(t.$t("get_points")))]),t._v(" "),r("InputNumber",{model:{value:t.settings.loyalty.customer.points,callback:function(e){t.$set(t.settings.loyalty.customer,"points",e)},expression:"settings.loyalty.customer.points"}}),t._v(" "),r("span",[t._v(t._s(t.$t("points")))])],1),t._v(" "),r("Divider",{attrs:{dashed:""}}),t._v(" "),r("p",{staticClass:"bold mb8"},[t._v(t._s(t.$t("for_x",{x:t.$t("staff")})))]),t._v(" "),r("div",{staticClass:"flex-gap"},[r("span",[t._v(t._s(t.$t("each_spent")))]),t._v(" "),r("InputNumber",{model:{value:t.settings.loyalty.staff.spent,callback:function(e){t.$set(t.settings.loyalty.staff,"spent",e)},expression:"settings.loyalty.staff.spent"}}),t._v(" "),r("span",[t._v(t._s(t.$t("get_points")))]),t._v(" "),r("InputNumber",{model:{value:t.settings.loyalty.staff.points,callback:function(e){t.$set(t.settings.loyalty.staff,"points",e)},expression:"settings.loyalty.staff.points"}}),t._v(" "),r("span",[t._v(t._s(t.$t("points")))])],1)],1)])],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("quick_cash"),prop:"quick_cash"}},[r("CheckboxGroup",{model:{value:t.settings.quick_cash,callback:function(e){t.$set(t.settings,"quick_cash",e)},expression:"settings.quick_cash"}},[r("Checkbox",{attrs:{label:"10"}}),t._v(" "),r("Checkbox",{attrs:{label:"20"}}),t._v(" "),r("Checkbox",{attrs:{label:"50"}}),t._v(" "),r("Checkbox",{attrs:{label:"100"}}),t._v(" "),r("Checkbox",{attrs:{label:"500"}}),t._v(" "),r("Checkbox",{attrs:{label:"1000"}}),t._v(" "),r("Checkbox",{attrs:{label:"5000"}}),t._v(" "),r("Checkbox",{attrs:{label:"10000"}}),t._v(" "),r("Checkbox",{attrs:{label:"20000"}}),t._v(" "),r("Checkbox",{attrs:{label:"50000"}}),t._v(" "),r("Checkbox",{attrs:{label:"100000"}})],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("dimension_unit"),prop:"dimension_unit"}},[r("RadioGroup",{model:{value:t.settings.dimension_unit,callback:function(e){t.$set(t.settings,"dimension_unit",e)},expression:"settings.dimension_unit"}},[r("Radio",{attrs:{label:"mm"}},[t._v("Millimeter")]),t._v(" "),r("Radio",{attrs:{label:"cm"}},[t._v("Centimeter")]),t._v(" "),r("Radio",{attrs:{label:"in"}},[t._v("Inch")]),t._v(" "),r("Radio",{attrs:{label:"foot"}},[t._v("Foot")]),t._v(" "),r("Radio",{attrs:{label:"yd"}},[t._v("Yard")]),t._v(" "),r("Radio",{attrs:{label:"m"}},[t._v("Meter")])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("weight_unit"),prop:"weight_unit"}},[r("RadioGroup",{model:{value:t.settings.weight_unit,callback:function(e){t.$set(t.settings,"weight_unit",e)},expression:"settings.weight_unit"}},[r("Radio",{attrs:{label:"g"}},[t._v("Gram")]),t._v(" "),r("Radio",{attrs:{label:"kg"}},[t._v("Kilogram")]),t._v(" "),r("Radio",{attrs:{label:"oz"}},[t._v("Ounce")]),t._v(" "),r("Radio",{attrs:{label:"lb"}},[t._v("Pound")]),t._v(" "),r("Radio",{attrs:{label:"t"}},[t._v("Tonne")])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("theme"),prop:"theme"}},[r("RadioGroup",{model:{value:t.settings.theme,callback:function(e){t.$set(t.settings,"theme",e)},expression:"settings.theme"}},[r("Radio",{attrs:{label:"dark"}},[t._v(t._s(t.$t("default")))]),t._v(" "),r("Radio",{attrs:{label:"light"}},[t._v(t._s(t.$t("light")))]),t._v(" "),r("Radio",{attrs:{label:"primary"}},[t._v(t._s(t.$t("primary")))]),t._v(" "),r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.fixed_layout,callback:function(e){t.$set(t.settings,"fixed_layout",e)},expression:"settings.fixed_layout"}},[r("span",[t._v(t._s(t.$t("fixed_layout")))])])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("loader"),prop:"loader"}},[r("RadioGroup",{model:{value:t.settings.loader,callback:function(e){t.$set(t.settings,"loader",e)},expression:"settings.loader"}},[r("Radio",{attrs:{label:"circle"}},[t._v(t._s(t.$t("rotating_circle")))]),t._v(" "),r("Radio",{attrs:{label:"dot"}},[t._v(t._s(t.$t("blinking_dot")))])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("confirmation"),prop:"confirmation"}},[r("RadioGroup",{model:{value:t.settings.confirmation,callback:function(e){t.$set(t.settings,"confirmation",e)},expression:"settings.confirmation"}},[r("Radio",{attrs:{label:"modal"}},[t._v(t._s(t.$t("yes")))]),t._v(" "),r("Radio",{attrs:{label:""}},[t._v(t._s(t.$t("no"))+" ("+t._s(t.$t("not_recommended"))+")")])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("decimals"),prop:"decimals"}},[r("RadioGroup",{model:{value:t.settings.decimals,callback:function(e){t.$set(t.settings,"decimals",e)},expression:"settings.decimals"}},[r("Radio",{attrs:{label:"0"}},[t._v("0")]),t._v(" "),r("Radio",{attrs:{label:"1"}},[t._v("1")]),t._v(" "),r("Radio",{attrs:{label:"2"}},[t._v("2")]),t._v(" "),r("Radio",{attrs:{label:"3"}},[t._v("3")]),t._v(" "),r("Radio",{attrs:{label:"4"}},[t._v("4")])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("quantity_decimals"),prop:"quantity_decimals"}},[r("RadioGroup",{model:{value:t.settings.quantity_decimals,callback:function(e){t.$set(t.settings,"quantity_decimals",e)},expression:"settings.quantity_decimals"}},[r("Radio",{attrs:{label:"0"}},[t._v("0")]),t._v(" "),r("Radio",{attrs:{label:"1"}},[t._v("1")]),t._v(" "),r("Radio",{attrs:{label:"2"}},[t._v("2")]),t._v(" "),r("Radio",{attrs:{label:"3"}},[t._v("3")]),t._v(" "),r("Radio",{attrs:{label:"4"}},[t._v("4")])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("initial_table_rows"),prop:"rows"}},[r("RadioGroup",{model:{value:t.settings.rows,callback:function(e){t.$set(t.settings,"rows",e)},expression:"settings.rows"}},[r("Radio",{attrs:{label:"10"}},[t._v("10")]),t._v(" "),r("Radio",{attrs:{label:"25"}},[t._v("25")]),t._v(" "),r("Radio",{attrs:{label:"50"}},[t._v("50")]),t._v(" "),r("Radio",{attrs:{label:"100"}},[t._v("100")])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"hideId"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.hide_id,callback:function(e){t.$set(t.settings,"hide_id",e)},expression:"settings.hide_id"}},[r("span",[t._v(t._s(t.$t("hide_id")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"stock"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.stock,callback:function(e){t.$set(t.settings,"stock",e)},expression:"settings.stock"}},[r("span",[t._v(t._s(t.$t("track_stock")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"impersonation"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.impersonation,callback:function(e){t.$set(t.settings,"impersonation",e)},expression:"settings.impersonation"}},[r("span",[t._v(t._s(t.$t("x_impersonation",{x:t.$t("enable")})))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"play_sound"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.play_sound,callback:function(e){t.$set(t.settings,"play_sound",e)},expression:"settings.play_sound"}},[r("span",[t._v(t._s(t.$t("play_sound_on_pos")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"onscreen_keyboard"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.onscreen_keyboard,callback:function(e){t.$set(t.settings,"onscreen_keyboard",e)},expression:"settings.onscreen_keyboard"}},[r("span",[t._v(t._s(t.$t("x_onscreen_keyboard",{x:t.$t("enable")})))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"pos_server"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.pos_server,callback:function(e){t.$set(t.settings,"pos_server",e)},expression:"settings.pos_server"}},[r("span",[t._v(t._s(t.$t("pos_server_text")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"auto_open_order"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.auto_open_order,callback:function(e){t.$set(t.settings,"auto_open_order",e)},expression:"settings.auto_open_order"}},[r("span",[t._v(t._s(t.$t("auto_open_order_text")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"print_dialog"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.print_dialog,callback:function(e){t.$set(t.settings,"print_dialog",e)},expression:"settings.print_dialog"}},[r("span",[t._v(t._s(t.$t("auto_open_print_dialog_on_pos")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"categories_sidebar"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.categories_sidebar,callback:function(e){t.$set(t.settings,"categories_sidebar",e)},expression:"settings.categories_sidebar"}},[r("span",[t._v(t._s(t.$t("categories_sidebar_initial")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"restaurant"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.restaurant,callback:function(e){t.$set(t.settings,"restaurant",e)},expression:"settings.restaurant"}},[r("span",[t._v(t._s(t.$t("pos_for_restaurant")))])])],1),t._v(" "),r("FormItem",{attrs:{prop:"requireCountry"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.require_country,callback:function(e){t.$set(t.settings,"require_country",e)},expression:"settings.require_country"}},[r("span",[t._v(t._s(t.$t("require_country")))]),t._v("\n                ("),r("span",[t._v(t._s(t.$t("require_country_tip")))]),t._v(")\n              ")])],1),t._v(" "),r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                "+t._s(t.$t("order_settings"))+"\n              ")])]),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"showImage"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.show_image,callback:function(e){t.$set(t.settings,"show_image",e)},expression:"settings.show_image"}},[r("span",[t._v(t._s(t.$t("show_item_image")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"showTax"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.show_tax,callback:function(e){t.$set(t.settings,"show_tax",e)},expression:"settings.show_tax"}},[r("span",[t._v(t._s(t.$t("show_tax")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"showTaxSummary"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.show_tax_summary,callback:function(e){t.$set(t.settings,"show_tax_summary",e)},expression:"settings.show_tax_summary"}},[r("span",[t._v(t._s(t.$t("show_tax_summary")))])])],1),t._v(" "),r("FormItem",{attrs:{prop:"showDiscount"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.show_discount,callback:function(e){t.$set(t.settings,"show_discount",e)},expression:"settings.show_discount"}},[r("span",[t._v(t._s(t.$t("show_discount")))])])],1),t._v(" "),r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                "+t._s(t.$t("app_updates"))+"\n              ")])]),t._v(" "),r("FormItem",{attrs:{prop:"auto_update"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.settings.auto_update,callback:function(e){t.$set(t.settings,"auto_update",e)},expression:"settings.auto_update"}},[r("span",[t._v(t._s(t.$t("auto_update_text")))])])],1),t._v(" "),1==t.settings.auto_update?[r("transition",{attrs:{appear:"",name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutRight"}},[r("div",[r("FormItem",{staticStyle:{"margin-top":"-16px"}},[r("Select",{staticStyle:{width:"200px"},model:{value:t.settings.auto_update_time.day,callback:function(e){t.$set(t.settings.auto_update_time,"day",e)},expression:"settings.auto_update_time.day"}},[r("Option",{attrs:{value:"mondays"}},[t._v(t._s(t.getWeekDayString("monday")))]),t._v(" "),r("Option",{attrs:{value:"tuesdays"}},[t._v(t._s(t.getWeekDayString("tuesday")))]),t._v(" "),r("Option",{attrs:{value:"wednesdays"}},[t._v(t._s(t.getWeekDayString("wednesday")))]),t._v(" "),r("Option",{attrs:{value:"thursdays"}},[t._v(t._s(t.getWeekDayString("thursday")))]),t._v(" "),r("Option",{attrs:{value:"fridays"}},[t._v(t._s(t.getWeekDayString("friday")))]),t._v(" "),r("Option",{attrs:{value:"saturdays"}},[t._v(t._s(t.getWeekDayString("saturday")))]),t._v(" "),r("Option",{attrs:{value:"sundays"}},[t._v(t._s(t.getWeekDayString("sunday")))])],1),t._v(" "),r("TimePicker",{staticStyle:{width:"200px"},attrs:{format:"HH:mm",type:"timerange",clearable:!1,"disabled-hours":[0,1,2,21,22,23]},model:{value:t.settings.auto_update_time.time,callback:function(e){t.$set(t.settings.auto_update_time,"time",e)},expression:"settings.auto_update_time.time"}})],1)],1)])]:t._e(),t._v(" "),r("FormItem",{staticClass:"spaced-buttons"},[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("settings")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save")))])]),t._v(" "),r("Button",{on:{click:function(e){t.email=!0}}},[t._v(t._s(t.$t("mail_settings")))]),t._v(" "),r("Button",{on:{click:function(e){t.payment=!0}}},[t._v(t._s(t.$t("payment_settings")))]),t._v(" "),r("Button",{on:{click:function(e){t.scale_barcode_show=!0}}},[t._v(t._s(t.$t("scale_barcode")))]),t._v(" "),r("Button",{on:{click:function(e){t.logo=!0}}},[t._v(t._s(t.$t("change_logo")))])],1)],2)],1)],1)],1)]),t._v(" "),r("Drawer",{staticClass:"drawer-fixed",attrs:{title:t.$t("mail_settings"),width:"300"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[t.mail_settings?r("Form",{ref:"mail_settings",attrs:{model:t.mail_settings,rules:t.rulesEmail}},[r("div",{staticClass:"drawer-content"},[r("FormItem",{attrs:{label:t.$t("from_name"),prop:"MAIL_FROM_NAME"}},[r("Input",{model:{value:t.mail_settings.MAIL_FROM_NAME,callback:function(e){t.$set(t.mail_settings,"MAIL_FROM_NAME",e)},expression:"mail_settings.MAIL_FROM_NAME"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("from_address"),prop:"MAIL_FROM_ADDRESS"}},[r("Input",{model:{value:t.mail_settings.MAIL_FROM_ADDRESS,callback:function(e){t.$set(t.mail_settings,"MAIL_FROM_ADDRESS",e)},expression:"mail_settings.MAIL_FROM_ADDRESS"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("mail_driver"),prop:"MAIL_MAILER"}},[r("Select",{model:{value:t.mail_settings.MAIL_MAILER,callback:function(e){t.$set(t.mail_settings,"MAIL_MAILER",e)},expression:"mail_settings.MAIL_MAILER"}},[r("Option",{attrs:{value:"smtp"}},[t._v("SMTP")]),t._v(" "),r("Option",{attrs:{value:"sendmail"}},[t._v("SendMail")]),t._v(" "),r("Option",{attrs:{value:"mailgun"}},[t._v("Mailgun")]),t._v(" "),r("Option",{attrs:{value:"sparkpost"}},[t._v("SpartPost")])],1)],1),t._v(" "),"smtp"==t.mail_settings.MAIL_MAILER?r("span",[r("FormItem",{attrs:{label:t.$t("smtp_host"),prop:"MAIL_HOST"}},[r("Input",{model:{value:t.mail_settings.MAIL_HOST,callback:function(e){t.$set(t.mail_settings,"MAIL_HOST",e)},expression:"mail_settings.MAIL_HOST"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("smtp_port"),prop:"MAIL_PORT"}},[r("Input",{model:{value:t.mail_settings.MAIL_PORT,callback:function(e){t.$set(t.mail_settings,"MAIL_PORT",e)},expression:"mail_settings.MAIL_PORT"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("smtp_username"),prop:"MAIL_USERNAME"}},[r("Input",{model:{value:t.mail_settings.MAIL_USERNAME,callback:function(e){t.$set(t.mail_settings,"MAIL_USERNAME",e)},expression:"mail_settings.MAIL_USERNAME"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("smtp_password"),prop:"MAIL_PASSWORD"}},[r("Input",{model:{value:t.mail_settings.MAIL_PASSWORD,callback:function(e){t.$set(t.mail_settings,"MAIL_PASSWORD",e)},expression:"mail_settings.MAIL_PASSWORD"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("smtp_encryption"),prop:"MAIL_ENCRYPTION"}},[r("Input",{model:{value:t.mail_settings.MAIL_ENCRYPTION,callback:function(e){t.$set(t.mail_settings,"MAIL_ENCRYPTION",e)},expression:"mail_settings.MAIL_ENCRYPTION"}})],1)],1):t._e(),t._v(" "),"mailgun"==t.mail_settings.MAIL_MAILER?r("span",[r("FormItem",{attrs:{label:t.$t("mailgun_doamin"),prop:"MAILGUN_DOMAIN"}},[r("Input",{model:{value:t.mail_settings.MAILGUN_DOMAIN,callback:function(e){t.$set(t.mail_settings,"MAILGUN_DOMAIN",e)},expression:"mail_settings.MAILGUN_DOMAIN"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("mailgun_secret"),prop:"MAILGUN_SECRET"}},[r("Input",{model:{value:t.mail_settings.MAILGUN_SECRET,callback:function(e){t.$set(t.mail_settings,"MAILGUN_SECRET",e)},expression:"mail_settings.MAILGUN_SECRET"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("mailgun_secret"),prop:"MAILGUN_ENDPOINT"}},[r("Input",{model:{value:t.mail_settings.MAILGUN_ENDPOINT,callback:function(e){t.$set(t.mail_settings,"MAILGUN_ENDPOINT",e)},expression:"mail_settings.MAILGUN_ENDPOINT"}})],1)],1):t._e(),t._v(" "),"sparkpost"==t.mail_settings.MAIL_MAILER?r("span",[r("FormItem",{attrs:{label:t.$t("sparkpost_endpoint"),prop:"SPARKPOST_SECRET"}},[r("Input",{model:{value:t.mail_settings.SPARKPOST_SECRET,callback:function(e){t.$set(t.mail_settings,"SPARKPOST_SECRET",e)},expression:"mail_settings.SPARKPOST_SECRET"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("sparkpost_secret"),prop:"SPARKPOST_ENDPOINT"}},[r("Input",{model:{value:t.mail_settings.SPARKPOST_ENDPOINT,callback:function(e){t.$set(t.mail_settings,"SPARKPOST_ENDPOINT",e)},expression:"mail_settings.SPARKPOST_ENDPOINT"}})],1)],1):t._e()],1),t._v(" "),r("div",{staticClass:"drawer-footer"},[r("Button",{attrs:{long:"",type:"primary"},on:{click:function(e){return t.updateSettings("mail_settings")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save")))])])],1)]):t._e()],1),t._v(" "),r("Drawer",{staticClass:"drawer-fixed",attrs:{title:t.$t("payment_settings"),width:"300"},model:{value:t.payment,callback:function(e){t.payment=e},expression:"payment"}},[t.payment_settings?r("Form",{ref:"payment_settings",attrs:{model:t.payment_settings,rules:t.rulesPayment}},[r("div",{staticClass:"drawer-content"},[r("FormItem",{attrs:{label:t.$t("currency_code"),prop:"CURRENCY_CODE"}},[r("Input",{model:{value:t.payment_settings.CURRENCY_CODE,callback:function(e){t.$set(t.payment_settings,"CURRENCY_CODE",e)},expression:"payment_settings.CURRENCY_CODE"}})],1),t._v(" "),r("FormItem",[r("Checkbox",{model:{value:t.payment_settings.PAYPAL_ENABLED,callback:function(e){t.$set(t.payment_settings,"PAYPAL_ENABLED",e)},expression:"payment_settings.PAYPAL_ENABLED"}},[r("span",[t._v(t._s(t.$t("enable_paypal")))])])],1),t._v(" "),t.payment_settings.PAYPAL_ENABLED||"PayPal_Pro"==t.payment_settings.CARD_GATEWAY?r("span",[r("FormItem",{attrs:{label:t.$t("paypal_api_username"),prop:"PAYPAL_USERNAME"}},[r("Input",{model:{value:t.payment_settings.PAYPAL_USERNAME,callback:function(e){t.$set(t.payment_settings,"PAYPAL_USERNAME",e)},expression:"payment_settings.PAYPAL_USERNAME"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("paypal_api_password"),prop:"PAYPAL_PASSWORD"}},[r("Input",{model:{value:t.payment_settings.PAYPAL_PASSWORD,callback:function(e){t.$set(t.payment_settings,"PAYPAL_PASSWORD",e)},expression:"payment_settings.PAYPAL_PASSWORD"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("paypal_api_signature"),prop:"PAYPAL_SIGNATURE"}},[r("Input",{model:{value:t.payment_settings.PAYPAL_SIGNATURE,callback:function(e){t.$set(t.payment_settings,"PAYPAL_SIGNATURE",e)},expression:"payment_settings.PAYPAL_SIGNATURE"}})],1)],1):t._e(),t._v(" "),r("FormItem",{attrs:{label:t.$t("accept_card_with"),prop:"CARD_GATEWAY"}},[r("Select",{model:{value:t.payment_settings.CARD_GATEWAY,callback:function(e){t.$set(t.payment_settings,"CARD_GATEWAY",e)},expression:"payment_settings.CARD_GATEWAY"}},[r("Option",{attrs:{value:""}},[t._v(t._s(t.$t("disable")))]),t._v(" "),r("Option",{attrs:{value:"Stripe"}},[t._v(t._s(t.$t("Stripe")))]),t._v(" "),r("Option",{attrs:{value:"PayPal_Pro"}},[t._v(t._s(t.$t("PayPal_Pro")))]),t._v(" "),r("Option",{attrs:{value:"PayPal_Rest"}},[t._v(t._s(t.$t("PayPal_Rest")))]),t._v(" "),r("Option",{attrs:{value:"AuthorizeNetApi_Api"}},[t._v(t._s(t.$t("AuthorizeNetApi_Api")))])],1)],1),t._v(" "),"Stripe"==t.payment_settings.CARD_GATEWAY?r("span",[r("FormItem",{attrs:{label:t.$t("stripe_key"),prop:"STRIPE_KEY"}},[r("Input",{model:{value:t.payment_settings.STRIPE_KEY,callback:function(e){t.$set(t.payment_settings,"STRIPE_KEY",e)},expression:"payment_settings.STRIPE_KEY"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("stripe_secret"),prop:"STRIPE_SECRET"}},[r("Input",{model:{value:t.payment_settings.STRIPE_SECRET,callback:function(e){t.$set(t.payment_settings,"STRIPE_SECRET",e)},expression:"payment_settings.STRIPE_SECRET"}})],1)],1):t._e(),t._v(" "),"PayPal_Rest"==t.payment_settings.CARD_GATEWAY?r("span",[r("FormItem",{attrs:{label:t.$t("paypal_client_id"),prop:"PAYPAL_CLIENT_ID"}},[r("Input",{model:{value:t.payment_settings.PAYPAL_CLIENT_ID,callback:function(e){t.$set(t.payment_settings,"PAYPAL_CLIENT_ID",e)},expression:"payment_settings.PAYPAL_CLIENT_ID"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("paypal_secret"),prop:"PAYPAL_SECRET"}},[r("Input",{model:{value:t.payment_settings.PAYPAL_SECRET,callback:function(e){t.$set(t.payment_settings,"PAYPAL_SECRET",e)},expression:"payment_settings.PAYPAL_SECRET"}})],1)],1):t._e(),t._v(" "),"AuthorizeNetApi_Api"==t.payment_settings.CARD_GATEWAY?r("span",[r("FormItem",{attrs:{label:t.$t("authorize_login"),prop:"AUTHORIZE_LOGIN"}},[r("Input",{model:{value:t.payment_settings.AUTHORIZE_LOGIN,callback:function(e){t.$set(t.payment_settings,"AUTHORIZE_LOGIN",e)},expression:"payment_settings.AUTHORIZE_LOGIN"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("authorize_transaction_key"),prop:"AUTHORIZE_TRANSACTION_KEY"}},[r("Input",{model:{value:t.payment_settings.AUTHORIZE_TRANSACTION_KEY,callback:function(e){t.$set(t.payment_settings,"AUTHORIZE_TRANSACTION_KEY",e)},expression:"payment_settings.AUTHORIZE_TRANSACTION_KEY"}})],1)],1):t._e()],1),t._v(" "),r("div",{staticClass:"drawer-footer"},[r("Button",{attrs:{long:"",type:"primary"},on:{click:function(e){return t.updateSettings("payment_settings")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save")))])])],1)]):t._e()],1),t._v(" "),r("Modal",{attrs:{width:600},model:{value:t.scale_barcode_show,callback:function(e){t.scale_barcode_show=e},expression:"scale_barcode_show"}},[r("div",{attrs:{slot:"header"},slot:"header"},[r("h3",[t._v("\n        "+t._s(t.$t("scale_barcode"))+"\n        "),r("Button",{staticStyle:{"margin-top":"-0.25rem",float:"right","margin-right":"2rem"},attrs:{type:"info",size:"small"},on:{click:function(e){t.scale_barcode_guide=!0}}},[t._v(t._s(t.$t("guide")))])],1)]),t._v(" "),r("Form",{ref:"barcodeForm",attrs:{model:t.scale_barcode,"label-position":"top"}},[r("Row",{staticClass:"mt16",attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("barcode_type"),prop:"type",rules:{required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("barcode_type")})}}},[r("Select",{model:{value:t.scale_barcode.type,callback:function(e){t.$set(t.scale_barcode,"type",e)},expression:"scale_barcode.type"}},[r("Option",{attrs:{value:"price"}},[t._v(t._s(t.$t("price")))]),t._v(" "),r("Option",{attrs:{value:"weight"}},[t._v(t._s(t.$t("weight")))])],1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{prop:"total_digits",label:t.$t("total_digits"),rules:{required:!0,type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("total_digits")})}}},[r("InputNumber",{model:{value:t.scale_barcode.total_digits,callback:function(e){t.$set(t.scale_barcode,"total_digits",e)},expression:"scale_barcode.total_digits"}})],1)],1)],1),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{prop:"item_code_start",label:t.$t("item_code_start"),rules:{required:!0,type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("item_code_start")})}}},[r("InputNumber",{model:{value:t.scale_barcode.item_code_start,callback:function(e){t.$set(t.scale_barcode,"item_code_start",e)},expression:"scale_barcode.item_code_start"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{prop:"item_code_digits",label:t.$t("item_code_digits"),rules:{required:!0,type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("item_code_digits")})}}},[r("InputNumber",{model:{value:t.scale_barcode.item_code_digits,callback:function(e){t.$set(t.scale_barcode,"item_code_digits",e)},expression:"scale_barcode.item_code_digits"}})],1)],1)],1),t._v(" "),"price"==t.scale_barcode.type?r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{prop:"price_start",label:t.$t("price_start"),rules:{type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("price_start")}),required:!(t.scale_barcode.weight_start&&t.scale_barcode.weight_digits&&t.scale_barcode.weight_divide_by)}}},[r("InputNumber",{model:{value:t.scale_barcode.price_start,callback:function(e){t.$set(t.scale_barcode,"price_start",e)},expression:"scale_barcode.price_start"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{prop:"price_digits",label:t.$t("price_digits"),rules:{type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("price_digits")}),required:!(t.scale_barcode.weight_start&&t.scale_barcode.weight_digits&&t.scale_barcode.weight_divide_by)}}},[r("InputNumber",{model:{value:t.scale_barcode.price_digits,callback:function(e){t.$set(t.scale_barcode,"price_digits",e)},expression:"scale_barcode.price_digits"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{prop:"price_divide_by",label:t.$t("price_divide_by"),rules:{required:!0,type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("price_divide_by")}),required:!(t.scale_barcode.weight_start&&t.scale_barcode.weight_digits&&t.scale_barcode.weight_divide_by)}}},[r("InputNumber",{model:{value:t.scale_barcode.price_divide_by,callback:function(e){t.$set(t.scale_barcode,"price_divide_by",e)},expression:"scale_barcode.price_divide_by"}})],1)],1)],1):r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{prop:"weight_start",label:t.$t("weight_start"),rules:{type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("weight_start")}),required:!(t.scale_barcode.price_start&&t.scale_barcode.price_digits&&t.scale_barcode.price_divide_by)}}},[r("InputNumber",{model:{value:t.scale_barcode.weight_start,callback:function(e){t.$set(t.scale_barcode,"weight_start",e)},expression:"scale_barcode.weight_start"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{prop:"weight_digits",label:t.$t("weight_digits"),rules:{type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("weight_digits")}),required:!(t.scale_barcode.price_start&&t.scale_barcode.price_digits&&t.scale_barcode.price_divide_by)}}},[r("InputNumber",{model:{value:t.scale_barcode.weight_digits,callback:function(e){t.$set(t.scale_barcode,"weight_digits",e)},expression:"scale_barcode.weight_digits"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:8,lg:8}},[r("FormItem",{attrs:{prop:"weight_divide_by",label:t.$t("weight_divide_by"),rules:{type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("weight_divide_by")}),required:!(t.scale_barcode.price_start&&t.scale_barcode.price_digits&&t.scale_barcode.price_divide_by)}}},[r("InputNumber",{model:{value:t.scale_barcode.weight_divide_by,callback:function(e){t.$set(t.scale_barcode,"weight_divide_by",e)},expression:"scale_barcode.weight_divide_by"}})],1)],1)],1)],1),t._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary","html-type":"button",size:"large",long:"",loading:t.saving_barcode},on:{click:function(e){return t.saveBarcode("barcodeForm")}}},[t._v(t._s(t.$t("save")))])],1)],1),t._v(" "),r("Modal",{attrs:{width:600,"footer-hide":"",title:t.$t("guide")},model:{value:t.scale_barcode_guide,callback:function(e){t.scale_barcode_guide=e},expression:"scale_barcode_guide"}},[r("img",{staticStyle:{"max-width":"100%"},attrs:{src:"/images/scale_barcode.png",alt:""}})]),t._v(" "),r("Modal",{attrs:{width:600,"footer-hide":"",title:t.$t("change_logo")},model:{value:t.logo,callback:function(e){t.logo=e},expression:"logo"}},[r("change-logo-component",{on:{close:function(){return t.logo=!1}}})],1)],1)}),[],!1,null,null,null).exports},76542:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>m});var i=r(32777);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const o={data:function(){return{form:{text:"",width:400,height:200},canvas:null,loading:!1,json_input:!1,json_form:{text:null}}},watch:{"form.width":function(t){this.canvas.setWidth(t)},"form.height":function(t){this.canvas.setHeight(t)}},mounted:function(){var t=this;this.canvas=new i.fabric.Canvas("canvas",{width:this.form.width,height:this.form.height,fireRightClick:!0,fireMiddleClick:!0,stopContextMenu:!0,preserveObjectStacking:!0}),i.fabric.Object.prototype.cornerColor="blue",i.fabric.Object.prototype.cornerStyle="circle",i.fabric.Object.prototype.transparentCorners=!1,this.$http.get("/app/settings/label").then((function(e){e.data.label_width&&e.data.label_height&&(t.form.width=parseInt(e.data.label_width),t.form.height=parseInt(e.data.label_height)),e.data.json_string&&t.canvas.loadFromJSON(e.data.json_string,(function(){t.canvas.renderAll()}))}))},methods:{save:function(){var t=this;this.loading=!0,this.canvas.toObject(["id"]);var e={label_width:this.form.width,label_height:this.form.height,svg_string:this.canvas.toSVG(),json_string:JSON.stringify(this.canvas.toObject(["id","editable","selectable"]))};this.$http.post("app/settings/label",e).then((function(r){r.data.success&&(t.$Notice.destroy(),t.$store.commit("setSVGString",e.svg_string),t.$Notice.success({title:t.$t("saved"),desc:t.$t("settings_saved_text")}))})).finally((function(){return t.loading=!1}))},toSVG:function(){this.download(this.canvas.toSVG(),"label","svg")},toJSON:function(){this.download(this.canvas.toJSON(),"label","json")},loadJSON:function(){var t=this;if(this.isValidJson(this.json_form.text)){var e=JSON.parse(this.json_form.text);e.version&&e.objects&&e.objects.length?this.canvas.loadFromJSON(e,(function(){t.canvas.renderAll(),t.json_input=!1})):this.$Notice.error({title:this.$t("error"),desc:this.$t("invalid_json"),duration:10})}else this.$Notice.error({title:this.$t("error"),desc:this.$t("invalid_json"),duration:4})},isValidJson:function(t){try{return JSON.parse(t),!0}catch(t){return!1}},toObject:function(){console.log(this.canvas.toObject())},clearCanvas:function(){this.canvas.clear()},deleteSelected:function(){this.canvas.getActiveObject()?this.canvas.remove(this.canvas.getActiveObject()):this.$Notice.error({title:this.$t("error"),desc:this.$t("object_x_selected"),duration:10})},bringToFront:function(){this.canvas.getActiveObject()?this.canvas.getActiveObject().bringToFront():this.$Notice.error({title:this.$t("error"),desc:this.$t("object_x_selected"),duration:10})},sendToBack:function(){this.canvas.getActiveObject()?this.canvas.getActiveObject().sendToBack()():this.$Notice.error({title:this.$t("error"),desc:this.$t("object_x_selected"),duration:10})},addBarcode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"BARCODE",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:60,s=new i.fabric.Rect({rx:4,ry:4,top:0,left:0,fill:"#fff",stroke:"#ccc",height:e,originX:"center",originY:"center",selectable:!1,width:this.form.width-20}),a=new i.fabric.Text(t,{fontSize:16,fill:"#333",originX:"center",originY:"center",selectable:!1}),n=new i.fabric.Group([s,a],{left:9,selectable:!1,id:"replace-barcode",class:"replace-barcode",top:this.form.height-r});n.setControlVisible("mtr",!1),this.canvas.add(n)},addProductDetails:function(){this.addTextArea("--- Item Name ---\n--- Other info for item. --- ")},addPrice:function(){this.addText("--- Price: 1,000.00 ---")},addTextArea:function(t){var e={left:10,fontSize:16,fillColor:"#000000",registeObjectEvent:!1,width:this.form.width-20,editable:!t,top:this.form.height/2-30},r=new i.fabric.Textbox(t||"Please Edit Me,\nEnter for new line",a(a({},e),{},{fill:e.fillColor}));this.canvas.add(r)},addText:function(t){if(t||this.form.text){var e=new i.fabric.Text(t||this.form.text,{left:10,top:100,fontSize:16});this.canvas.add(e),this.form.text=""}},download:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"json";return function(t){if("json"==r)t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t));if("svg"==r)t="data:image/svg+xml;base64,"+window.btoa(t);var i=document.createElement("a");i.setAttribute("href",t),i.setAttribute("download",e+"."+r),document.body.appendChild(i),i.click(),i.remove()}(t)},readTextFile:function(t,e){var r=new XMLHttpRequest;r.overrideMimeType("application/json"),r.open("GET",t,!0),r.onreadystatechange=function(){4===r.readyState&&"200"==r.status&&e(r.responseText)},r.send(null)}}};var l=r(93379),c=r.n(l),u=r(12132),d={insert:"head",singleton:!1};c()(u.Z,d);u.Z.locals;const m=(0,r(51900).Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("item_label_design")))]),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{xs:24,lg:12}},[r("Form",{attrs:{model:t.form,"label-width":80}},[r("FormItem",{attrs:{label:t.$t("width")}},[r("InputNumber",{attrs:{formatter:function(t){return t+"px"},parser:function(t){return t.replace("px","")}},model:{value:t.form.width,callback:function(e){t.$set(t.form,"width",e)},expression:"form.width"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("height")}},[r("InputNumber",{attrs:{formatter:function(t){return t+"px"},parser:function(t){return t.replace("px","")}},model:{value:t.form.height,callback:function(e){t.$set(t.form,"height",e)},expression:"form.height"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("text")}},[r("Input",{model:{value:t.form.text,callback:function(e){t.$set(t.form,"text",e)},expression:"form.text"}},[r("Button",{attrs:{slot:"append"},on:{click:function(e){return t.addText()}},slot:"append"},[t._v(t._s(t.$t("add_x",{x:t.$t("text")})))])],1)],1),t._v(" "),r("FormItem",[r("Button",{on:{click:function(e){return t.addProductDetails()}}},[r("Icon",{attrs:{type:"ios-paper",size:"18"}}),t._v("\n              "+t._s(t.$t("item_details"))+"\n            ")],1),t._v(" "),r("Button",{on:{click:function(e){return t.addPrice()}}},[r("Icon",{attrs:{type:"ios-cash",size:"18"}}),t._v("\n              "+t._s(t.$t("price"))+"\n            ")],1),t._v(" "),r("Button",{on:{click:function(e){return t.addTextArea()}}},[r("Icon",{attrs:{type:"ios-paper-outline",size:"18"}}),t._v("\n              "+t._s(t.$t("add_x",{x:t.$t("textarea")}))+"\n            ")],1),t._v(" "),r("Button",{on:{click:function(e){return t.addBarcode()}}},[r("Icon",{attrs:{type:"ios-barcode-outline",size:"18"}}),t._v("\n              "+t._s(t.$t("add_x",{x:t.$t("barcode")}))+"\n            ")],1)],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",disabled:t.loading,loading:t.loading},on:{click:function(e){return t.save()}}},[t._v("\n              "+t._s(t.$t("save"))+"\n            ")]),t._v(" "),r("Button",{attrs:{type:"primary"},on:{click:function(e){t.json_input=!t.json_input}}},[t._v("\n              "+t._s(t.$t("load_from_json"))+"\n            ")]),t._v(" "),r("Dropdown",{attrs:{trigger:"click"}},[r("Button",{attrs:{type:"primary"}},[t._v("\n                "+t._s(t.$t("download"))+"\n                "),r("Icon",{attrs:{type:"ios-arrow-down"}})],1),t._v(" "),r("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[r("DropdownItem",[r("a",{staticStyle:{display:"block"},on:{click:function(e){return t.toSVG()}}},[t._v("SVG")])]),t._v(" "),r("DropdownItem",[r("a",{staticStyle:{display:"block"},on:{click:function(e){return t.toJSON()}}},[t._v("JSON")])])],1)],1)],1)],1),t._v(" "),t.json_input?r("Form",{attrs:{model:t.json_form,"label-width":80}},[r("FormItem",[r("Input",{attrs:{type:"textarea",autosize:{minRows:5,maxRows:15},placeholder:t.$t("paste_json_content")},model:{value:t.json_form.text,callback:function(e){t.$set(t.json_form,"text",e)},expression:"json_form.text"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.loadJSON()}}},[t._v("\n              "+t._s(t.$t("load"))+"\n            ")])],1)],1):t._e()],1),t._v(" "),r("Col",{staticClass:"text-center",attrs:{xs:24,lg:12}},[r("div",{staticStyle:{overflow:"auto"}},[r("canvas",{attrs:{id:"canvas",width:t.form.width,height:t.form.height}})]),t._v(" "),r("div",{staticClass:"text-right"},[r("ButtonGroup",{staticClass:"mt16"},[r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.bringToFront()}}},[t._v("\n              "+t._s(t.$t("bring_front"))+"\n            ")]),t._v(" "),r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.sendToBack()}}},[t._v("\n              "+t._s(t.$t("send_back"))+"\n            ")]),t._v(" "),r("Button",{attrs:{type:"error"},on:{click:function(e){return t.deleteSelected()}}},[t._v("\n              "+t._s(t.$t("remove"))+"\n            ")]),t._v(" "),r("Button",{attrs:{type:"error"},on:{click:function(e){return t.clearCanvas()}}},[t._v("\n              "+t._s(t.$t("remove_all"))+"\n            ")])],1)],1)])],1)],1),t._v(" "),r("Card",{staticClass:"mt16",attrs:{"dis-hover":"",shadow:""}},[r("div",{staticStyle:{overflow:"auto","font-size":"12px"},domProps:{innerHTML:t._s(t.$t("label_instructions_text"))}})])],1)}),[],!1,null,null,null).exports},28985:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>v});var i=r(21490),s=r(61402);const a={props:{editItem:{type:Function},deleteItem:{type:Function},calcRowTotal:{type:Function},customer:{type:[Boolean,Object]},row:{type:Object,required:!0},deleteItemVariation:{type:Function},index:{type:Number,required:!0},itemVariationQuantityChanged:{type:Function}}};var n=r(51900);const o=(0,n.Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"order-item"},[r("span",{staticClass:"item"},[r("span",{staticClass:"index"},[t._v(t._s(t.index+1))]),t._v(" "),r("span",{staticClass:"remove"},[t.row.selected.variations&&!t.row.selected.variations.length?r("span",[r("Icon",{staticClass:"pointer",attrs:{size:"18",type:"md-close",color:"#ed4014"},on:{click:function(e){return t.deleteItem(t.row)}}})],1):t._e()]),t._v(" "),r("span",{staticClass:"details pointer",on:{click:function(e){return t.editItem(t.index)}}},[r("strong",[t._v(t._s(t.row.name))]),t._v(" "),r("br"),t._v(" "),t.row.comment?r("span",[t._v(t._s(t.row.comment)+" ")]):t._e()]),t._v(" "),t.row.selected.variations&&!t.row.selected.variations.length?[r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(t.row.cost))+"\n        ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length,size:t.row.selected.variations.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(t.row.taxes,(function(e){return r("div",{key:"tax_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber(t.calcRowTotal(t.row)))+"\n      ")])]:[r("span",{staticClass:"price"}),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{attrs:{readonly:!!t.row.selected.variations.length,size:t.row.selected.variations.length?"small":"default"},model:{value:t.row.quantity,callback:function(e){t.$set(t.row,"quantity",e)},expression:"row.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"}),t._v(" "),r("span",{staticClass:"subtotal"})]],2),t._v(" "),t.row.selected.variations&&t.row.selected.variations.length?t._l(t.row.selected.variations,(function(e,i){return r("div",{key:"svi_"+i,staticClass:"combo-item variation"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.deleteItemVariation(t.row,e)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n        "+t._s(i+1)+".\n        "),r("span",{domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("span",{staticClass:"price"},[t._v("\n        "+t._s(t.formatNumber(e.cost))+"\n      ")]),t._v(" "),r("span",{staticClass:"quantity"},[r("InputNumber",{on:{"on-change":function(e){return t.itemVariationQuantityChanged(t.form.items[t.index])}},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"sv.quantity"}})],1),t._v(" "),r("span",{staticClass:"taxes"},t._l(e.taxes,(function(e){return r("div",{key:"sv_"+e.id},[t._v("\n          "+t._s(e.code)+"\n          "),r("span",{staticClass:"float-right"},[t._v("\n            "+t._s(t.formatNumber(e.amount*t.row.quantity))+"\n          ")])])})),0),t._v(" "),r("span",{staticClass:"subtotal"},[t._v("\n        "+t._s(t.formatNumber((e.cost-(e.discount_amount||0)+e.total_tax_amount)*e.quantity))+"\n      ")])])})):t._e()],2)}),[],!1,null,null,null).exports;const l={props:{serials:{type:Array,twoWay:!0,required:!0},quantity:{type:Number,required:!0}},computed:{provided:function(){var t=this;return this.serials.reduce((function(e,r){return e+t.countSerials(r.number,r.till)}),0)}},methods:{countSerials:function(t,e){if(!t&&!e)return 0;if(t&&!e)return 1;var r=e-t;return r>0?r+1:e==t?1:"?"},addNew:function(t){this.provided<this.quantity&&this.quantity>t+1&&t==this.serials.length-1&&this.serials.push({number:"",till:""})}}};var c=r(93379),u=r.n(c),d=r(99848),m={insert:"head",singleton:!1};u()(d.Z,m);d.Z.locals;const h=(0,n.Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t._l(t.serials,(function(e,i){return r("div",{key:"serial_"+i,staticClass:"mb16"},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"mb0",attrs:{label:t.$tc("serial_number"),prop:"serial"}},[r("Input",{on:{"on-focus":function(e){return t.addNew(i)}},model:{value:e.number,callback:function(r){t.$set(e,"number",r)},expression:"serial.number"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("till"),prop:"serial"}},[r("Input",{model:{value:e.till,callback:function(r){t.$set(e,"till",r)},expression:"serial.till"}})],1)],1)],1)],1)})),t._v(" "),r("div",{staticClass:"sr-info",class:t.provided>t.quantity?"sr-error":""},[t._v("\n    "+t._s(t.$t("total_serials",{n:t.provided,serials:t.$tc("serial_number",t.provided),total:t.quantity}))+"\n  ")])],2)}),[],!1,null,null,null).exports,p={props:{taxes:{type:Array},deleteItem:{type:Function},updateItem:{type:Function},itemUnitChanged:{type:Function},edit_item:{type:Object,required:!0},expiryDateOptions:{type:Object,required:!0}},components:{ItemSerialComponent:h}};const f=(0,n.Z)(p,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("FormItem",{attrs:{label:t.$t("quantity"),prop:"quantity"}},[r("InputNumber",{attrs:{size:"large"},model:{value:t.edit_item.quantity,callback:function(e){t.$set(t.edit_item,"quantity",e)},expression:"edit_item.quantity"}})],1),t._v(" "),1==t.edit_item.has_serials?r("div",{staticClass:"mt16 mb16"},[r("item-serial-component",{attrs:{serials:t.edit_item.selected.serials,quantity:t.edit_item.quantity}})],1):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.allUnits&&t.edit_item.allUnits.length>0?r("FormItem",{attrs:{label:t.$tc("unit")}},[r("Select",{staticStyle:{width:"100%"},on:{"on-change":t.itemUnitChanged},model:{value:t.edit_item.unit_id,callback:function(e){t.$set(t.edit_item,"unit_id",e)},expression:"edit_item.unit_id"}},t._l(t.edit_item.allUnits,(function(e,i){return r("Option",{key:"unit_"+i+"_"+e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),1)],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("cost"),prop:"cost"}},[r("InputNumber",{model:{value:t.edit_item.cost,callback:function(e){t.$set(t.edit_item,"cost",e)},expression:"edit_item.cost"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("batch_no"),prop:"batch_no"}},[r("Input",{model:{value:t.edit_item.batch_no,callback:function(e){t.$set(t.edit_item,"batch_no",e)},expression:"edit_item.batch_no"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.edit_item.expiry?r("FormItem",{attrs:{label:t.$t("expiry_date"),prop:"expiry_date"}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd",options:t.expiryDateOptions},model:{value:t.edit_item.expiry_date,callback:function(e){t.$set(t.edit_item,"expiry_date",e)},expression:"edit_item.expiry_date"}})],1):t._e()],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("tax",2),prop:"taxes"}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.edit_item.allTaxes,callback:function(e){t.$set(t.edit_item,"allTaxes",e)},expression:"edit_item.allTaxes"}},t._l(this.taxes,(function(e){return r("Option",{key:"tax_"+e.id,attrs:{value:e.id}},[t._v("\n        "+t._s(e.name)+"\n      ")])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("comment")}},[r("Input",{attrs:{type:"textarea",placeholder:t.$t("item_comment"),autosize:{minRows:2,maxRows:5}},model:{value:t.edit_item.comment,callback:function(e){t.$set(t.edit_item,"comment",e)},expression:"edit_item.comment"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{long:"",type:"primary"},on:{click:function(e){return t.updateItem()}}},[t._v(t._s(t.$t("update")))])],1),t._v(" "),r("Button",{attrs:{long:"",type:"error"},on:{click:function(e){return t.deleteItem(t.edit_item)}}},[t._v(t._s(t.$t("remove_from_order")))])],1)}),[],!1,null,null,null).exports,_={mixins:[(0,i.Z)("adjustment","app/adjustments","cost",null,!0),(0,s.Z)("cost","form",!1,!0)],components:{EditRowItemComponent:f,RowItemComponent:o},data:function(){return{form:{type:"addition"}}}};const v=(0,n.Z)(_,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.form.id?t.$t("edit_x",{x:t.$tc("stock_adjustment")}):t.$t("add_x",{x:t.$tc("stock_adjustment")+" ("+t.$store.getters.location.label+")"}))+"\n    ")]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/adjustments/stock"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("stock_adjustment",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"adjustment",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("type"),prop:"type",error:t._f("a2s")(t.errors.form.type)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[r("Option",{attrs:{value:"addition"}},[t._v(t._s(t.$t("addition")))]),t._v(" "),r("Option",{attrs:{value:"damage"}},[t._v(t._s(t.$t("damage")))]),t._v(" "),r("Option",{attrs:{value:"subtraction"}},[t._v(t._s(t.$t("subtraction")))])],1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1)],1)],1),t._v(" "),r("transition",{attrs:{mode:"out-in",name:"slide-in","enter-active-class":"animate__animated faster animate__fadeInDown","leave-active-class":"animate__animated fastest animate__fadeOutDown"}},[r("div",{staticClass:"order-contents"},[r("div",{staticClass:"affix-content"},[r("AutoComplete",{ref:"scanCode",attrs:{icon:"ios-search","element-id":"scan_barcode",placeholder:t.$t("search_scan_barcode")},on:{"on-change":t.searchItems,"on-select":t.selectPurchaseItem},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}},t._l(t.result,(function(e){return r("Option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ("+t._s(e.code)+") ")])})),1)],1),t._v(" "),!t.form.items||t.form.items.length<1?r("div",[r("Alert",{attrs:{"show-icon":""}},[t._v("\n                    "+t._s(t.$t("empty_order"))+"\n                    "),r("template",{slot:"desc"},[t._v("\n                      "+t._s(t.$t("empty_order_text"))+"\n                    ")])],2)],1):r("div",[r("div",{staticClass:"order-items"},[r("div",{staticClass:"header"},[r("span",{staticClass:"index"},[t._v("#")]),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{attrs:{type:"ios-trash",size:"16"}})],1),t._v(" "),r("span",{staticClass:"details"},[t._v(t._s(t.$t("description")))]),t._v(" "),r("span",{staticStyle:{width:"150px","text-align":"center",padding:"0 10px"}},[t._v(t._s(t.$t("cost")))]),t._v(" "),r("span",{staticStyle:{width:"100px","text-align":"center",padding:"0 10px"}},[t._v(t._s(t.$t("quantity")))]),t._v(" "),r("span",{staticStyle:{width:"100px","text-align":"center",padding:"0 10px"}},[t._v(t._s(t.$t("taxes")))]),t._v(" "),r("span",{staticStyle:{width:"200px","text-align":"center",padding:"0 10px"}},[t._v(t._s(t.$t("subtotal")))])]),t._v(" "),t.form.items&&t.form.items.length?[t._l(t.form.items,(function(e,i){return[r("row-item-component",{key:"row_"+i+"_"+e.id,attrs:{row:e,index:i,editItem:t.editItem,deleteItem:t.deleteItem,calcRowTotal:t.calcRowTotal,deleteItemVariation:t.deleteItemVariation,itemVariationQuantityChanged:t.itemVariationQuantityChanged}})]}))]:t._e()],2)]),t._v(" "),r("div",{staticClass:"affix-content"},[r("Alert",{staticStyle:{margin:"16px 0 0",padding:"8px 16px"},attrs:{banner:"",type:"warning"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:12,md:6}},[t._v("\n                        "+t._s(t.$tc("item",2))+":\n                        "),r("span",{staticClass:"float-right"},[r("strong",[t._v(t._s(t.orderTotalItems))]),t._v("\n                          "+t._s(t.$tc("item",t.orderTotalItems))+" "),r("strong",[t._v(t._s(t.orderTotalQuantity))]),t._v("\n                          "+t._s(t.$t("quantity"))+"\n                        ")])]),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                        "+t._s(t.$t("discount"))+":\n                        "),r("strong",{staticClass:"float-right"},[t._v("\n                          "+t._s(t._f("formatNumber")(t.calculateItemDiscountAmount+t.orderDiscount,t.$store.state.settings.decimals))+"\n                        ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                        "+t._s(t.$tc("tax"))+":\n                        "),r("strong",{staticClass:"float-right"},[t._v("\n                          "+t._s(t._f("formatNumber")(t.totalItemTax,t.$store.state.settings.decimals))+"\n                        ")])],1),t._v(" "),r("Col",{attrs:{sm:12,md:6}},[r("Divider",{staticClass:"hidden-sm",attrs:{type:"vertical"}}),t._v("\n                        "+t._s(t.$t("payable_amount"))+":\n                        "),r("strong",{staticClass:"float-right"},[t.orderOriginalTotal!=t.orderPayableAmount?r("span",[r("del",[t._v("\n                              "+t._s(t._f("formatNumber")(t.orderOriginalTotal,t.$store.state.settings.decimals))+"\n                            ")])]):t._e(),t._v(" "),r("span",[t.orderDiscount?r("span",[r("span",{staticStyle:{"font-weight":"normal"}},[t._v("\n                                ("+t._s(t._f("formatNumber")(t.orderTotalAmount,t.$store.state.settings.decimals))+" -\n                                "+t._s(t._f("formatNumber")(t.orderDiscount,t.$store.state.settings.decimals))+")\n                              ")]),t._v("\n                              "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                            ")]):r("span",[t._v("\n                              "+t._s(t._f("formatNumber")(t.orderPayableAmount,t.$store.state.settings.decimals))+"\n                            ")])])])],1)],1)],1)],1)])]),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),t.is_draftable()?r("FormItem",{attrs:{prop:"draft"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.draft,callback:function(e){t.$set(t.form,"draft",e)},expression:"form.draft"}},[r("span",[t._v(t._s(t.$t("order_draft_text")))])])],1):t._e(),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("stock_adjustments")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("stock_adjustments",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1),t._v(" "),r("Modal",{attrs:{width:600,"footer-hide":!0,title:t.edit_item?t.$t("edit")+" - "+t.edit_item.name:""},model:{value:t.show_item_edit,callback:function(e){t.show_item_edit=e},expression:"show_item_edit"}},[t.edit_item?r("span",[r("Form",{ref:"editItemForm",attrs:{model:t.edit_item,rules:t.itemRules}},[r("edit-row-item-component",{attrs:{taxes:t.taxes,edit_item:t.edit_item,itemPrice:t.itemPrice,itemDiscount:t.itemPrice,deleteItem:t.deleteItem,updateItem:t.updateItem,itemUnitChanged:t.itemUnitChanged,expiryDateOptions:t.expiry_date_options,addPortionToEditItem:t.addPortionToEditItem,changeSelectedPortion:t.changeSelectedPortion}})],1)],1):t._e()]),t._v(" "),r("Modal",{attrs:{"footer-hide":!0,"mask-closable":!1,title:t.$t("select_x",{x:t.$tc("variant",2)})},model:{value:t.variantModal,callback:function(e){t.variantModal=e},expression:"variantModal"}},[r("select-variation-component",{ref:"selectVarMod",attrs:{item:t.item,purchase:""},on:{"on-submit":t.variationSubmitted}})],1)],1)}),[],!1,null,null,null).exports},18803:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var i=r(92704);function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const a={components:{OrderViewComponent:r(82016).Z},mixins:[(0,i.Z)("stock_adjustments","app/adjustments","reference")],data:function(){var t,e=this;return{view:!1,loading:!1,adjustment:{id:null,reference:null},columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("date"),sortable:!0,key:"date",sortType:"desc",width:100,render:this.renderDate},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("type"),sortable:!0,key:"type",width:125,render:this.renderType},{title:this.$t("total"),sortable:!0,key:"grant_total",width:150,render:this.renderGrandTotal},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{minWidth:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},{title:this.$t("draft"),sortable:!0,key:"draft",width:80,render:this.renderIconDraft},(t={title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0},s(t,"ellipsis",!0),s(t,"minWidth",250),s(t,"maxWidth",600),t),{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(t,r){return t("actions-component",{props:{params:r,viewFn:e.viewModal,editFn:e.editRecord,deleteFn:e.deleteRecord,record:{model:"stock_adjustment",name:"reference",title:e.$tc("stock_adjustment")}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.adjustment.id&&(this.loading=!0,this.$http.get("app/adjustments/".concat(t.id)).then((function(t){return e.adjustment=t.data})).finally((function(){return e.loading=!1})))},editRecord:function(t){this.$router.push({name:"stock_adjustments.edit",params:{id:t.id}})},renderGrandTotal:function(t,e){return this.renderNumber(t,e,"grand_total")},renderIconDraft:function(t,e){return this.renderBoolean(t,e,"draft")},renderType:function(t,e){return t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-".concat("addition"==e.row.type?"green":"red"," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.capitalize(e.row.type)])])])}}};const n=(0,r(51900).Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("stock_adjustment",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/stock_adjustments/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add_x",{x:t.$tc("stock_adjustment")}))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,url:"app/adjustments",bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("stock_adjustment")+" ("+t.adjustment.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{"to-text":"",to:!1,field:"cost",payment:!1,record:t.adjustment,heading:t.$tc("stock_adjustment")},on:{remove:function(e){return t.deleteAttachment(e,t.adjustment)}}})],1)],1)}),[],!1,null,null,null).exports},14466:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(48921);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=function(t,e){return t.attributes&&(e.attributes=t.attributes,delete t.attributes),t.extra_attributes=e.formatAttributes(e.attributes,t.extra_attributes),t.due_limit=t.due_limit?parseFloat(t.due_limit):null,e.form=a(a({},t),t.extra_attributes),e.form};const l={mixins:[(0,i.Z)("supplier","app/suppliers",!0,o)],data:function(){return{countries:[],searching:!1,states:[{value:"",label:this.$t("select_country")}],form:{id:"",name:"",email:"",phone:"",state:"",number:"",footer:"",address:"",country:"",show_tax:0,due_limit:null,show_discount:0,require_country:0,opening_balance:null},rules:{name:[{required:!0,message:this.$t("name")+" "+this.$t("is_required"),trigger:"blur"}],phone:[{required:!1,message:this.$t("phone")+" "+this.$t("is_required"),trigger:"blur"}],email:[{required:!1,message:this.$t("email")+" "+this.$t("is_required"),trigger:"blur"}],address:[{required:!1,message:this.$t("address")+" "+this.$t("is_required"),trigger:"blur"}],country:[{required:this.$store.getters.require_country,message:this.$t("country")+" "+this.$t("is_required"),trigger:"change"}],state:[{required:this.$store.getters.require_country,message:this.$t("state")+" "+this.$t("is_required"),trigger:"change"}]}}},created:function(){var t=this;this.$http.get("app/countries").then((function(e){return t.countries=e.data}))},methods:{create:function(){var t=this;this.$http.get("app/suppliers/create").then((function(e){return t.attributes=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/suppliers/".concat(t)).then((function(t){e.form=o(t.data,e)})).finally((function(){return e.loading=!1}))},countryChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t?(this.searching=!0,this.getStates(t,e),this.form.state=""):(this.form.state="",this.form.country="",this.states=[{value:"",label:this.$t("select_country")}])},getStates:function(t,e){var r=this;this.$http.get("app/states",{params:{country:t}}).then((function(t){r.states=t.data,e&&(r.form.state=r.states.find((function(t){return t.value==e})).value),r.searching=!1}))}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("supplier")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/suppliers"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("supplier",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"supplier",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("company"),prop:"company",error:t._f("a2s")(t.errors.form.company)}},[r("Input",{model:{value:t.form.company,callback:function(e){t.$set(t.form,"company",e)},expression:"form.company"}})],1),t._v(" "),t.form.id?t._e():r("FormItem",{attrs:{error:t._f("a2s")(t.errors.form.opening_balance),label:t.$t("opening_balance"),prop:"opening_balance"}},[r("InputNumber",{model:{value:t.form.opening_balance,callback:function(e){t.$set(t.form,"opening_balance",e)},expression:"form.opening_balance"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("phone"),prop:"phone",error:t._f("a2s")(t.errors.form.phone)}},[r("Input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("email"),prop:"email",error:t._f("a2s")(t.errors.form.email)}},[r("Input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("due_limit"),prop:"due_limit",error:t._f("a2s")(t.errors.form.due_limit)}},[r("InputNumber",{model:{value:t.form.due_limit,callback:function(e){t.$set(t.form,"due_limit",e)},expression:"form.due_limit"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("Row",{staticClass:"mb24",attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:24,xl:12}},[r("FormItem",{attrs:{label:t.$t("house_no"),prop:"house_no",error:t._f("a2s")(t.errors.form.house_no)}},[r("Input",{model:{value:t.form.house_no,callback:function(e){t.$set(t.form,"house_no",e)},expression:"form.house_no"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:24,xl:12}},[r("FormItem",{attrs:{label:t.$t("street_no"),prop:"street_no",error:t._f("a2s")(t.errors.form.street_no)}},[r("Input",{model:{value:t.form.street_no,callback:function(e){t.$set(t.form,"street_no",e)},expression:"form.street_no"}})],1)],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("address"),prop:"address",error:t._f("a2s")(t.errors.form.address)}},[r("Input",{model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("city"),prop:"city",error:t._f("a2s")(t.errors.form.city)}},[r("Input",{model:{value:t.form.city,callback:function(e){t.$set(t.form,"city",e)},expression:"form.city"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("postal_code"),prop:"postal_code",error:t._f("a2s")(t.errors.form.postal_code)}},[r("Input",{model:{value:t.form.postal_code,callback:function(e){t.$set(t.form,"postal_code",e)},expression:"form.postal_code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("country"),prop:"country",error:t._f("a2s")(t.errors.form.country)}},[r("Select",{attrs:{placeholder:"",filterable:""},on:{"on-change":t.countryChange},model:{value:t.form.country,callback:function(e){t.$set(t.form,"country",e)},expression:"form.country"}},t._l(t.countries,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("state"),prop:"state",error:t._f("a2s")(t.errors.form.state)}},[r("Select",{attrs:{placeholder:"",filterable:"",loading:t.searching},model:{value:t.form.state,callback:function(e){t.$set(t.form,"state",e)},expression:"form.state"}},t._l(t.states,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1)],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("suppliers")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("suppliers",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},9750:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("supplier","app/suppliers","name","company")],data:function(){var t=this;return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",sortType:"asc",minWidth:200},{title:this.$tc("company"),sortable:!0,key:"company",width:175},{title:this.$t("phone"),sortable:!0,key:"phone",maxWidth:125,minWidth:125},{title:this.$t("email"),sortable:!0,key:"email",minWidth:200},{title:this.$t("balance"),sortable:!1,key:"journal",width:150,render:this.renderBalance},{title:this.$t("address"),sortable:!0,key:"address",minWidth:200,render:this.renderAddress},{title:this.$t("state"),sortable:!0,key:"state_name",maxWidth:150,minWidth:150},{title:this.$t("country"),sortable:!0,key:"country_name",maxWidth:150,minWidth:150},{title:this.$tc("field",2),sortable:!1,key:"extra_attributes",minWidth:200,render:this.renderExtras},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-dropdown-component",{props:{params:r,editFn:t.editRecord,listFn:t.listRecord,payFn:t.paymentRecord,deleteFn:t.deleteRecord,record:{model:"item",name:"name",title:t.$tc("customer")}}})}}],options:{orderBy:"name",perPage:this.$store.state.settings.rows}}},computed:{url:function(){return"app/suppliers"+(this.$route.query.due_limit?"?due_limit="+parseInt(this.$route.query.due_limit):"")}},watch:{"$route.query.due_limit":function(){this.refresh++}},methods:{paymentRecord:function(t){this.$router.push("/payments/add?supplier_id=".concat(t.id).concat(t.journal.balance.amount<0?"&amount="+(0-t.journal.balance.amount/100):""))},listRecord:function(t){this.$router.push("/suppliers/transactions/"+t.id)},renderTransactions:function(t,e){return t("transactions-icon-component",{props:{id:e.row.id,url:"/suppliers/transactions/"}})},renderBalance:function(t,e){return t("div",{class:"text-right"},[e.row.journal?this.$options.filters.formatJournalBalance(e.row.journal.balance.amount,this.$store.getters.settings.decimals):""])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("supplier",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/suppliers/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add"))+" "+t._s(t.$tc("supplier"))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1),t._v(" "),r("pre",{staticStyle:{"font-size":"10px"}},[t._v(t._s(t.$t("supplier_balance_tip")))])],1)}),[],!1,null,null,null).exports},61848:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>l});var i=r(19996);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const o={components:{PaymentViewComponent:r(24874).Z,ReportFormComponent:i.Z},data:function(){return{url:"",data:{},refresh:1,updated:0,reportForm:{},loading:!1,showForm:!1,payment:{},view_payment:!1,fields:["created_at","user_id"],columns:[{type:"expand",width:50,render:function(t,e){return t("pre",{style:{margin:"0"}},JSON.stringify(e.row.subject,null,"  "))}},{title:this.$t("created_at"),sortable:!0,key:"created_at",sortType:"asc",width:175,render:this.renderCreatedAt},{title:this.$tc("account"),sortable:!1,key:"account",render:this.renderAccount},{title:this.$tc("supplier"),sortable:!1,key:"supplier",render:this.renderSupplier},{title:this.$tc("debit"),sortable:!0,key:"debit",width:150,render:this.renderDebit},{title:this.$tc("credit"),sortable:!0,key:"credit",width:150,render:this.renderCredit},{title:this.$t("type"),sortable:!1,key:"type",width:200,render:this.renderType}],options:{hideSearch:!0,showSummary:!0,orderBy:"created_at desc",summaryMethod:this.handleSummary,perPage:this.$store.state.settings.rows}}},created:function(){var t=this;this.fields.map((function(e){t.reportForm[e]=""})),this.url="app/suppliers/transactions/".concat(this.$route.params.id,"/table"),this.$http.get("app/suppliers/transactions/".concat(this.$route.params.id),{params:a(a({},this.reportForm),{},{date:""})}).then((function(e){t.prepareData(e.data.transactions),t.reportForm.end_date=new Date(e.data.end_date),t.reportForm.start_date=new Date(e.data.start_date),t.reportForm.created_at=[new Date(e.data.start_date),new Date(e.data.end_date)],t.updated++})).finally((function(){return t.loading=!1}))},methods:{handleSubmit:function(t){var e=this;this.fields.map((function(r){e.reportForm[r]=t[r]})),this.reportForm.created_at&&this.reportForm.created_at[0]&&(this.reportForm.start_date=this.$moment(this.reportForm.created_at[0]).format(this.datetimeFormatString())),this.reportForm.created_at&&this.reportForm.created_at[1]&&(this.reportForm.end_date=this.$moment(this.reportForm.created_at[1]).format(this.datetimeFormatString())),delete this.reportForm.created_at,this.url="app/suppliers/transactions/".concat(this.$route.params.id,"/table?").concat(this.queryString(this.reportForm)),this.refresh++,this.$http.get("app/suppliers/transactions/".concat(this.$route.params.id),{params:a(a({},this.reportForm),{},{date:""})}).then((function(t){e.prepareData(t.data.transactions),e.reportForm.created_at=[new Date(t.data.start_date),new Date(t.data.end_date)],e.updated++})).finally((function(){return e.loading=!1}))},prepareData:function(t){this.data=[{label:this.$t("start_balance"),value:t.start_balance},{label:this.$t("close_balance"),value:t.close_balance}]},showInfo:function(t){t.subject_type&&t.subject_type.includes("Payment")&&this.viewPayment(t.subject_id)},viewPayment:function(t){var e=this;this.view_payment=!0,t!=this.payment.id&&(this.loading=!0,this.$http.get("app/payments/".concat(t)).then((function(t){return e.payment=t.data})).finally((function(){return e.loading=!1})))},renderType:function(t,e){var r=e.row.type.split("_"),i=r[0],s="opening"==i?"success":"primary",a=r[1],n="created"==a?"success":"updated"==a?"warning":"deleted"==a?"error":"default";return t("div",{class:"text-center"},[t("div",{class:"ivu-tag ivu-tag-".concat(s," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.capitalize(i)])]),t("div",{class:"ivu-tag ivu-tag-".concat(n," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ".concat("default"==n?"":"ivu-tag-color-white")},[this.capitalize(a)])])])},renderSupplier:function(t,e){return t("div",[e.row.journal.morphed?e.row.journal.morphed.name+" ("+e.row.journal.morphed.company+")":""])},renderAccount:function(t,e){return t("div",[e.row.subject&&e.row.subject.account?e.row.subject.account.name:""])},renderCredit:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatJournalBalance(e.row.credit,this.$store.getters.settings.decimals)])},renderDebit:function(t,e){return t("div",{class:"text-right"},[this.$options.filters.formatJournalBalance(e.row.debit,this.$store.getters.settings.decimals)])},renderCreatedAt:function(t,e){return t("div",[this.$options.filters.formatDate(e.row.created_at,this.$store.state.settings.dateformat+" HH:mm A")])},rowClassName:function(t,e){return t.debit>0?"ivu-table-warning-row":t.credit>0?"ivu-table-success-row":""},handleSummary:function(t){var e=this,r=t.columns,i=t.data,s=["debit","credit"],a={};return r.forEach((function(t,r){var n=t.key;if(s.includes(n)){var o=i.map((function(t){return t.void||t.draft?0:Number(e.formatDecimal(t[n]))}));if(!o.every((function(t){return isNaN(t)}))){var l=o.reduce((function(t,e){return isNaN(Number(e))?t:t+e}),0);a[n]={key:n,value:e.formatJournalBalance(l)}}}else a[n]={key:n,value:""}})),a}}};const l=(0,r(51900).Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n      "+t._s(t.$t("transactions"))+" ("+t._s(t.datetime(new Date(t.reportForm.start_date)))+" - "+t._s(t.datetime(new Date(t.reportForm.end_date)))+")\n    ")]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("router-link",{attrs:{to:"/suppliers"}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n        "+t._s(t.$t("list"))+" "+t._s(t.$tc("supplier",2))+"\n      ")],1),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.showForm=!t.showForm}},slot:"extra"},[r("Icon",{attrs:{type:"md-options"}}),t._v("\n        "+t._s(t.$t("toggle_x",{x:t.$tc("form",2)}))+"\n      ")],1)],1),t._v(" "),r("div",[r("transition",{attrs:{name:"fade",mode:"out-in","enter-active-class":"animate__animated fast animate__fadeInDown","leave-active-class":"animate__animated faster animate__fadeOutUp"}},[t.showForm?r("Card",{staticClass:"mb16",attrs:{"dis-hover":""}},[r("report-form-component",{attrs:{fields:t.fields,updated:t.updated,reportForm:t.reportForm},on:{submit:t.handleSubmit}})],1):t._e()],1),t._v(" "),r("Row",{staticClass:"sparkboxes",attrs:{gutter:16}},[t._l(t.data,(function(e,i){return[r("Col",{key:i,attrs:{sm:12,md:12}},[r("div",{staticClass:"box static",class:"box"+(i+5)},[r("div",{staticClass:"details"},[r("h3",[t._v(t._s(t.formatJournalBalance(e.value)))]),t._v(" "),r("h4",[t._v(t._s(e.label))])]),t._v(" "),r("div",{staticStyle:{clear:"both"}})])])]}))],2),t._v(" "),r("table-component",{attrs:{url:t.url,stripe:!1,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.showInfo,"row-class-name":t.rowClassName}})],1)]),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,title:t.$tc("payment")},model:{value:t.view_payment,callback:function(e){t.view_payment=e},expression:"view_payment"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("payment-view-component",{attrs:{payment:t.payment}})],1)],1)}),[],!1,null,null,null).exports},10527:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(48921).Z)("tax","app/taxes")],data:function(){return{form:{id:"",code:"",name:"",rate:null,number:"",description:"",compound:0,recoverable:0,state:0,same:0},rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"}],rate:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("rate")}),trigger:"blur"}]}}},methods:{fetch:function(t){var e=this;this.$http.get("app/taxes/".concat(t)).then((function(t){delete t.data.created_at,delete t.data.updated_at,t.data.same=t.data.same?1:0,t.data.state=t.data.state?1:0,t.data.rate=parseFloat(t.data.rate),t.data.compound=t.data.compound?1:0,t.data.recoverable=t.data.recoverable?1:0,e.form=t.data})).catch((function(t){e.$event.fire("appError",t.response)})).finally((function(){return e.loading=!1}))}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("tax")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/taxes"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("tax",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"tax",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("code"),prop:"code",error:t._f("a2s")(t.errors.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("rate"),prop:"rate",error:t._f("a2s")(t.errors.rate)}},[r("InputNumber",{attrs:{precision:2},model:{value:t.form.rate,callback:function(e){t.$set(t.form,"rate",e)},expression:"form.rate"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("tax_number"),prop:"number",error:t._f("a2s")(t.errors.number)}},[r("Input",{model:{value:t.form.number,callback:function(e){t.$set(t.form,"number",e)},expression:"form.number"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"compound",error:t._f("a2s")(t.errors.form.compound)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.compound,callback:function(e){t.$set(t.form,"compound",e)},expression:"form.compound"}},[r("span",[t._v(t._s(t.$t("compound_tax_text")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"recoverable",error:t._f("a2s")(t.errors.form.recoverable)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.recoverable,callback:function(e){t.$set(t.form,"recoverable",e)},expression:"form.recoverable"}},[r("span",[t._v(t._s(t.$t("recoverable_tax_text")))])])],1),t._v(" "),r("FormItem",{class:{mb0:1==t.form.state},attrs:{prop:"state",error:t._f("a2s")(t.errors.form.state)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.state,callback:function(e){t.$set(t.form,"state",e)},expression:"form.state"}},[r("span",[t._v(t._s(t.$t("state_tax_text")))])])],1),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[t.form.state?r("FormItem",{attrs:{prop:"same",error:t._f("a2s")(t.errors.form.same)}},[r("RadioGroup",{model:{value:t.form.same,callback:function(e){t.$set(t.form,"same",e)},expression:"form.same"}},[r("Radio",{attrs:{label:1,"true-value":1,"false-vale":0}},[r("span",[t._v(t._s(t.$t("same_state_text")))])]),t._v(" "),r("Radio",{attrs:{label:0,"true-value":0,"false-vale":1}},[r("span",[t._v(t._s(t.$t("different_state_text")))])])],1)],1):t._e()],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("taxes")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("taxes",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"warning",ghost:""},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},98567:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("tax","app/taxes","code","name")],data:function(){return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("code"),sortable:!0,key:"code",sortType:"asc",minWidth:120},{title:this.$t("name"),sortable:!0,key:"name",minWidth:150},{title:this.$t("number"),sortable:!0,key:"number",minWidth:150},{title:this.$t("rate"),sortable:!0,key:"rate",minWidth:120,render:this.renderRate},{title:this.$t("compound"),sortable:!0,key:"compound",width:120,render:this.renderIconCompound},{title:this.$t("recoverable"),sortable:!0,key:"recoverable",width:125,render:this.renderIconRecoverable},{title:this.$t("state"),sortable:!0,key:"state",width:100,render:this.renderIconState},{title:this.$t("description"),sortable:!0,key:"description",minWidth:200},{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"name",perPage:this.$store.state.settings.rows}}},methods:{renderRate:function(t,e){return this.renderNumber(t,e,"rate")},renderIconCompound:function(t,e){return this.renderBoolean(t,e,"compound")},renderIconRecoverable:function(t,e){return this.renderBoolean(t,e,"recoverable")},renderIconState:function(t,e){return t("div",{style:"text-align:center;"},[1==e.row.state?1==e.row.same?this.$t("same"):this.$t("different"):t("i",{class:"ivu-icon ivu-icon-md-close",style:"font-size: 16px; color: #ed4014;"})])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("tax",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/taxes/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("tax"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/taxes",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},86443:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>l});var i=r(48921);r(23279);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var n=function(t,e){return t.amount=parseFloat(t.amount),e.form=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),e.form};const o={mixins:[(0,i.Z)("asset_transfer","app/transfers/asset",!1,n)],data:function(){var t=this;return{accounts:[],searching:!1,form:{id:"",title:"",details:"",amount:null,reference:"",to:"",from:""},rules:{from:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("from_account")}),trigger:"change"}],to:[{required:!0,validator:function(e,r,i){r&&""!=r?r==t.form.from?i(new Error(t.$t("to_account_same_error"))):i():i(new Error(t.$t("field_is_required",{field:t.$t("to_account")})))},trigger:"change"}],amount:[{required:!0,type:"number",trigger:["change","blur"],message:this.$t("field_is_required",{field:this.$tc("amount")})}]}}},created:function(){var t=this;this.$route.query.amount&&(this.max_amount=this.form.amount=parseFloat(this.$route.query.amount)),this.$http.get("app/accounts/search").then((function(e){return t.accounts=e.data}))},methods:{fetch:function(t){var e=this;this.$http.get("app/transfers/asset/".concat(t)).then((function(t){return n(t.data,e)})).finally((function(){return e.loading=!1}))}}};const l=(0,r(51900).Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("asset_transfer")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/transfers/asset"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("asset_transfer",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"asset_transfer",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("from_account"),prop:"from",error:t._f("a2s")(t.errors.form.from)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.from,callback:function(e){t.$set(t.form,"from",e)},expression:"form.from"}},[t.accounts.length>0?t._l(t.accounts,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})):t._e()],2)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("to_account"),prop:"to",error:t._f("a2s")(t.errors.form.to)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.to,callback:function(e){t.$set(t.form,"to",e)},expression:"form.to"}},[t.accounts.length>0?t._l(t.accounts,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])})):t._e()],2)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("amount"),prop:"amount",error:t._f("a2s")(t.errors.form.amount)}},[r("InputNumber",{model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("transfers.asset")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("transfers.asset",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},75623:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const s={mixins:[(0,r(92704).Z)("asset_transfers","app/transfers/asset","reference")],data:function(){var t,e=this;return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{title:this.$t("amount"),sortable:!1,key:"amount",width:150,render:this.renderAmount},{key:"to",maxWidth:300,minWidth:200,sortable:!1,title:this.$tc("to_account"),render:this.renderToAccount},{key:"from",maxWidth:300,minWidth:200,sortable:!1,render:this.renderFromAccount,title:this.$tc("from_account")},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},(t={title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0},i(t,"ellipsis",!0),i(t,"minWidth",250),i(t,"maxWidth",400),t),{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(t,r){return t("actions-component",{props:{params:r,editFn:e.editRecord,deleteFn:e.deleteRecord,record:{model:"asset_transfer",name:"reference",title:e.$tc("asset_transfer")}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},methods:{editRecord:function(t){this.$router.push({name:"transfers.asset.edit",params:{id:t.id}})},renderToAccount:function(t,e){return t("div",[e.row.to_account.name])},renderFromAccount:function(t,e){return t("div",[e.row.from_account.name])},renderAmount:function(t,e){return this.renderNumber(t,e,"amount")}}};const a=(0,r(51900).Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("asset_transfer",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/transfers/asset/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add_x",{x:t.$tc("asset_transfer")}))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.showInfo,url:"app/transfers/asset",bulkDelCB:t.deleteRecords}})],1)],1)}),[],!1,null,null,null).exports},93790:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>v});var i=r(48921),s=r(18446),a=r.n(s),n=r(23279),o=r.n(n),l=r(44605),c=r(22254);function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var f=function(t,e){return t.items=t.items.map((function(t){return t.item.id=t.id,t.item.item_id=t.item_id,t.item.stock_transfer_item_id=t.id,t.item.quantity=parseFloat(t.quantity),t.item.stock_transfer_id=t.stock_transfer_id,t.item.selected={variations:[],serials:[]},t.variations.length&&(t.item.selected.variations=t.variations.map((function(e){var r=t.item.variations.find((function(t){return e.id==t.id}));return{id:e.id,meta:e.meta,quantity:parseFloat(e.pivot.quantity),available:parseFloat(e.pivot.quantity+r.stock[0].quantity)}}))),t.item})),e.attachments=t.attachments&&t.attachments.length?h(t.attachments):[],e.form=d({},t),e.form};const _={components:{SelectVariationComponent:c.Z},mixins:[l.Z,(0,i.Z)("transfer","app/transfers/stock",!1,f)],data:function(){var t=this;return{query:"",item:null,result:[],qty:!1,show:!1,locations:[],loading:!1,cloading:!1,edit_item:null,searching:!1,attachments:null,variantModal:!1,show_item_edit:!1,form:{id:"",to:"",from:"",items:[],details:"",reference:"",attachments:[],status:"pending"},rules:{to:[{required:!0,validator:function(e,r,i){r&&""!=r?r==t.form.from?i(new Error(t.$t("same_location_error"))):i():i(new Error(t.$t("field_is_required",{field:t.$t("to_location")})))},trigger:"change"}],from:[{required:!0,validator:function(e,r,i){r&&""!=r?r==t.form.to?i(new Error(t.$t("same_location_error"))):i():i(new Error(t.$t("field_is_required",{field:t.$t("from_location")})))},trigger:"change"}],status:[{required:!0,message:this.$t("field_is_required",{field:this.$t("status")}),trigger:"change"}],date:[{type:"date",required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("date")})}]}}},created:function(){var t=this;this.$http.get("app/locations/search").then((function(e){return t.locations=e.data})).finally((function(){return t.loading=!1}))},methods:{fetch:function(t){var e=this;this.$http.get("app/transfers/stock/".concat(t)).then((function(t){return f(t.data,e)})).finally((function(){return e.loading=!1}))},selectItem:function(t){this.query="",this.addToOrder(JSON.parse(t))},searchItems:function(t){t.includes("(")||this.getItems(t,this)},getItems:o()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/items_wt/search?q="+t+"&location="+e.form.from).then((function(t){1==t.data.length?(e.query="",e.addToOrder(t.data[0])):e.result=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250),addToOrder:function(t,e,r,i){var s=this;if(this.qty=0,t.selected||(t.selected={variations:[],serials:[]}),t.meta||(t.meta={}),this.cloading=!0,!r&&(t.serials&&t.serials.length||t.variants&&t.variants.length>0&&t.variations&&t.variations.length>0))return this.item=JSON.parse(JSON.stringify(t)),this.variantModal=!0,!1;var a={},n=this.form.items.length>0&&this.form.items.find((function(e){return e.id==t.id&&(!e.variation||e.variation&&t.variation&&e.variation.id==t.variation.id)}));n?(n.quantity=i?parseFloat(e):parseFloat(n.quantity)+(e?parseFloat(e):1),t.selected_variation&&n.selected.variations.push(t.selected_variation),this.alert(this.$root.$t("cart_item_updated",{item:t.name}))):(t.unit&&(t.allUnits=[d(d({},t.unit),{},{subunits:null})].concat(h(t.unit.subunits))),t.selected.variations.length&&t.selected.variations.push(t.selected_variation),a=d(d({},t),{},{id:"",comment:"",item_id:t.id,guid:this.guid(),selected:d(d({},t.selected),{},{variations:t.selected_variation?[d({},t.selected_variation)]:[]}),quantity:e?parseFloat(e):1}),this.form.items.push(a),this.alert(this.$root.$t("added_to_cart",{item:a.name}))),this.cloading=!1,this.$nextTick((function(){s.query="",document.querySelector("#scan_barcode").focus()}))},selectVariant:function(){var t=this,e=this.item.variations.find((function(e){return a()(e.meta,t.item.meta)}));e&&(this.qty=this.formatDecimal(e.stock[0].quantity),this.show=!0,this.item.variation_id=e.id)},variantSeleted:function(){var t=this;this.$refs.vform.validate((function(e){if(e){var r=t.item.quantity?t.item.quantity:1;if(t.item.serials.length&&t.item.selected.serials.length!=t.item.quantity)return t.$Notice.error({title:t.$t("invalid_form"),desc:t.$t("invalid_form_error"),duration:10}),!1;if(t.item.variation_id){var i=t.item.variations?t.item.variations.find((function(e){return e.id==t.item.variation_id})):null,s=i?{quantity:r,id:i.id,meta:i.meta,available:t.formatDecimal(i.stock[0].quantity)}:null;t.item.selected_variation=i?s:null}else t.item.selected_variation=null;t.addToOrder(t.item,r,!0),t.variantModal=!1,t.$nextTick((function(){t.$refs.vform.resetFields()}))}else t.$Notice.error({title:t.$t("invalid_form"),desc:t.$t("invalid_form_error"),duration:10})}))},editItem:function(t){this.form.items[t].guid||(this.form.items[t].guid=this.guid()),this.edit_item=JSON.parse(JSON.stringify(this.form.items[t])),this.show_item_edit=!0},updateItem:function(){var t=this;this.$refs.editItemForm.validate((function(e){if(e){if(t.edit_item.serials.length&&t.edit_item.selected.serials.length!=t.edit_item.quantity)return t.$Notice.error({title:t.$t("invalid_form"),desc:t.$t("invalid_form_error"),duration:10}),!1;t.edit_item.selected.variations.length&&(t.edit_item.selected_variation=null,t.edit_item.quantity=t.edit_item.selected.variations.reduce((function(t,e){return t+parseFloat(e.quantity)}),0)),t.$nextTick((function(){var e=JSON.parse(JSON.stringify(t.edit_item));t.form.items=t.form.items.map((function(t){return t.guid==e.guid?e:t})),t.addToOrder(e,e.quantity,!0,!0),t.edit_item=null,t.show_item_edit=!1}))}else t.$Notice.error({title:t.$t("invalid_form"),desc:t.$t("invalid_form_error"),duration:10})}))},deleteItem:function(t){this.form.items=this.form.items.filter((function(e){return e.guid!==t.guid})),this.edit_item=null,this.show_item_edit=!1},deleteItemVariation:function(t,e){var r=this.form.items.find((function(e){return e.guid==t.guid}));r.selected_variation=null,r.selected.variations=r.selected.variations.filter((function(t){return t.id!==e.id})),r.quantity=r.selected.variations.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),r.selected.variations.length<=0&&this.deleteItem(r)},itemVariationQuantityChanged:function(t){t.selected_variation=null,t.quantity=t.selected.variations.reduce((function(t,e){return t+parseFloat(e.quantity)}),0),this.addToOrder(t,t.quantity,!0,!0)},addTransfer:function(t,e){var r=this;this.$refs.transfer.validate((function(i){if(i){r.loading=!0;var s="app/transfers/stock",a="added";r.errors.message="";var n="record_added";r.form.id&&""!=r.form.id&&(a="updated",s="app/transfers/stock/"+r.form.id,n="record_updated",r.form._method="PUT");var o=d({},r.form);if(o.date&&(o.date=r.$moment(o.date).format(r.$moment.HTML5_FMT.DATE)),o.items=o.items.map((function(t){return{id:t.id,code:t.code,name:t.name,item_id:t.item_id,quantity:t.quantity,variations:t.selected.variations.map((function(t){var e={};return e[t.id]={quantity:t.quantity},e})),serials:t.selected.serials}})),r.attributes&&r.attributes.length>0){var l=r.attributes.map((function(t){var e={};return delete o[t.slug],e[t.slug]=r.form[t.slug],e}));o.extra_attributes=Object.assign.apply(Object,h(l))}o=r.$form(o),r.$http.post(s,o).then((function(i){i.data.success?(r.$Notice.destroy(),r.$Notice.success({title:r.$tc("transfer")+" "+r.$t(a),desc:r.$t(n)}),e?"updated"==a?fnFormat&&(r.form=fnFormat(i.data.data,r)):r.handleReset():r.$router.push({name:t+".list"})):r.$Notice.error({title:r.$t("failed"),desc:r.$t("failed_error_text")})})).catch((function(t){return r.errors=t})).finally((function(){return r.loading=!1}))}else r.$Notice.error({title:r.$t("invalid_form"),desc:r.$t("invalid_form_error"),duration:10})}))}}};const v=(0,r(51900).Z)(_,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("stock_transfer")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/transfers/stock"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("list"))+" "+t._s(t.$tc("stock_transfer",2))+"\n    ")],1),t._v(" "),r("div",[r("Form",{ref:"transfer",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("from_location"),prop:"from",error:t._f("a2s")(t.errors.form.from)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.from,callback:function(e){t.$set(t.form,"from",e)},expression:"form.from"}},[t.locations.length>0?t._l(t.locations,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n                        "+t._s(e.label)+"\n                      ")])})):t._e()],2)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("to_location"),prop:"to",error:t._f("a2s")(t.errors.form.to)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.to,callback:function(e){t.$set(t.form,"to",e)},expression:"form.to"}},[t.locations.length>0?t._l(t.locations,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n                        "+t._s(e.label)+"\n                      ")])})):t._e()],2)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("status"),prop:"status",error:t._f("a2s")(t.errors.form.status)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[r("Option",{attrs:{value:"pending"}},[t._v(t._s(t.$t("pending")))]),t._v(" "),r("Option",{attrs:{value:"transferring"}},[t._v(t._s(t.$t("transferring")))]),t._v(" "),r("Option",{attrs:{value:"transferred"}},[t._v(t._s(t.$t("transferred")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1)],1)],1),t._v(" "),r("transition",{attrs:{mode:"out-in",name:"slide-in","enter-active-class":"animate__animated faster animate__fadeInDown","leave-active-class":"animate__animated fastest animate__fadeOutDown"}},[t.form.from?r("div",{staticClass:"order-contents"},[r("div",{staticClass:"affix-content"},[r("AutoComplete",{ref:"scanCode",attrs:{size:"large",icon:"ios-search","element-id":"scan_barcode",placeholder:t.$t("search_scan_barcode")},on:{"on-select":t.selectItem,"on-change":t.searchItems},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}},t._l(t.result,(function(e){return r("Option",{key:e.id,attrs:{value:JSON.stringify(e)}},[t._v(" "+t._s(e.name)+" ("+t._s(e.code)+") ")])})),1)],1),t._v(" "),!t.form.items||t.form.items.length<1?r("div",[r("Alert",{attrs:{"show-icon":""}},[t._v("\n                    "+t._s(t.$t("empty_order"))+"\n                    "),r("template",{slot:"desc"},[t._v("\n                      "+t._s(t.$t("empty_order_text"))+"\n                    ")])],2)],1):r("div",[r("div",{staticClass:"order-items"},[r("div",{staticClass:"header"},[r("span",{staticClass:"index"},[t._v("#")]),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{attrs:{type:"ios-trash",size:"16"}})],1),t._v(" "),r("span",{staticClass:"details"},[t._v(t._s(t.$t("description")))]),t._v(" "),r("span",{staticStyle:{width:"200px"}},[t._v(t._s(t.$t("quantity")))])]),t._v(" "),t._l(t.form.items,(function(e,i){return r("div",{key:i+"_"+e.id,staticClass:"order-item"},[r("span",{staticClass:"item"},[r("span",{staticClass:"index"},[t._v(t._s(i+1))]),t._v(" "),r("span",{staticClass:"remove"},[e.selected.variations&&!e.selected.variations.length?r("span",[r("Icon",{staticClass:"pointer",attrs:{size:"18",type:"md-close",color:"#ed4014"},on:{click:function(r){return t.deleteItem(e)}}})],1):t._e()]),t._v(" "),r("span",{staticClass:"details pointer",on:{click:function(e){return t.editItem(i)}}},[r("strong",[t._v(t._s(e.name))])]),t._v(" "),r("span",{staticStyle:{width:"200px"}},[r("InputNumber",{attrs:{readonly:!!e.selected.variations.length,size:e.selected.variations.length?"small":"default"},model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"row.quantity"}})],1)]),t._v(" "),e.selected.variations&&e.selected.variations.length?t._l(e.selected.variations,(function(s,a){return r("div",{key:"svi_"+a,staticClass:"combo-item variation"},[r("span",{staticClass:"index"}),t._v(" "),r("span",{staticClass:"remove"},[r("Icon",{staticClass:"pointer",attrs:{size:"18",color:"#ed4014",type:"md-close"},on:{click:function(r){return t.deleteItemVariation(e,s)}}})],1),t._v(" "),r("span",{staticClass:"details leading-medium"},[t._v("\n                            "+t._s(a+1)+".\n                            "),r("span",{domProps:{innerHTML:t._s(t.metaString(s.meta))}})]),t._v(" "),r("span",{staticStyle:{width:"200px"}},[r("InputNumber",{on:{"on-change":function(e){return t.itemVariationQuantityChanged(t.form.items[i])}},model:{value:s.quantity,callback:function(e){t.$set(s,"quantity",e)},expression:"sv.quantity"}})],1)])})):t._e()],2)}))],2)])]):t._e()]),t._v(" "),r("form-custom-fields",{attrs:{attributes:t.attributes},on:{update:t.updateCF},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}}),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details",error:t._f("a2s")(t.errors.form.details)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.addTransfer("transfers.stock")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.addTransfer("transfers.stock",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1),t._v(" "),r("Modal",{attrs:{"footer-hide":!0,"mask-closable":!1,title:t.$t("select_x",{x:t.$tc("variant",2)})},model:{value:t.variantModal,callback:function(e){t.variantModal=e},expression:"variantModal"}},[t.item?r("div",[r("Form",{ref:"vform",attrs:{model:t.item,"label-position":"top"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{staticClass:"text-center",attrs:{label:t.$t("quantity")}},[r("InputNumber",{attrs:{size:"large"},model:{value:t.item.quantity,callback:function(e){t.$set(t.item,"quantity",e)},expression:"item.quantity"}})],1)],1),t._v(" "),t.item.serials&&t.item.serials.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.item.serials.length?r("FormItem",{attrs:{label:t.$tc("serial_number",2),prop:"serials",rules:[{required:!0,type:"array",size:t.item.quantity,message:t.$t("field_are_required",{field:t.$tc("serial_number",2)}),trigger:"change"}]}},[r("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.item.selected.serials,callback:function(e){t.$set(t.item.selected,"serials",e)},expression:"item.selected.serials"}},t._l(t.item.serials,(function(e,i){return r("Option",{key:"serial_"+i,attrs:{value:e.id}},[t._v("\n                    "+t._s(e.number)+"\n                  ")])})),1)],1):t._e()],1)]:t._e(),t._v(" "),t.item.variants&&t.item.variants.length?[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n                  "+t._s(t.$tc("variant",2))+"\n                ")])])],1),t._v(" "),t._l(t.item.variants,(function(e,i){return r("Col",{key:"sv_"+i,attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:e.name,prop:"meta."+e.name,rules:{required:!0,trigger:"change",message:t.$t("select_x",{x:t.$tc("variant")})}}},[r("Select",{on:{"on-change":t.selectVariant},model:{value:t.item.meta[e.name],callback:function(r){t.$set(t.item.meta,e.name,r)},expression:"item.meta[v.name]"}},t._l(e.options,(function(e){return r("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1)],1)})),t._v(" "),t.item.variants.length%2==1?r("Col",{attrs:{sm:24,md:12,lg:12}}):t._e(),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}},[t.show?r("Alert",{staticClass:"mb16",attrs:{type:"info","show-icon":""}},[r("strong",[t._v(t._s(this.$t("available_x",{x:this.$t("quantity")}))+": "+t._s(this.qty))])]):t._e()],1)]:t._e()],2)],1),t._v(" "),r("div",{staticClass:"text-right"},[r("Button",{attrs:{long:"",type:"primary",disabled:t.item.quantity<1},on:{click:t.variantSeleted}},[t._v("\n          "+t._s(this.$t("add"))+"\n        ")])],1)],1):t._e()]),t._v(" "),r("Modal",{attrs:{width:600,"footer-hide":!0,title:t.edit_item?t.$t("edit")+" - "+t.edit_item.name:""},model:{value:t.show_item_edit,callback:function(e){t.show_item_edit=e},expression:"show_item_edit"}},[t.edit_item?r("div",[r("Form",{ref:"editItemForm",attrs:{model:t.edit_item,"label-position":"top"}},[r("Row",{attrs:{gutter:16}},[t.edit_item.has_variants?t._e():r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{staticClass:"text-center",attrs:{label:t.$t("quantity")}},[r("InputNumber",{attrs:{size:"large"},model:{value:t.edit_item.quantity,callback:function(e){t.$set(t.edit_item,"quantity",e)},expression:"edit_item.quantity"}})],1)],1),t._v(" "),t.edit_item.variants&&t.edit_item.variants.length?[t._l(t.edit_item.selected.variations,(function(e,i){return r("span",{key:"sv_meta_"+i},[r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("span",{staticStyle:{color:"#515a6e"},domProps:{innerHTML:t._s(t.metaString(e.meta))}})]),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("quantity"),prop:"selected.variations."+i+".quantity",rules:{required:!0,type:"number",trigger:"change",max:parseFloat(e.available),message:t.$t("only_x_quantity_available",{x:parseFloat(e.available)})}}},[r("InputNumber",{model:{value:e.quantity,callback:function(r){t.$set(e,"quantity",r)},expression:"eisv.quantity"}})],1)],1),t._v(" "),r("Col",{staticClass:"text-primary",staticStyle:{"padding-top":"2.5em"},attrs:{sm:24,md:12,lg:12}},[t._v("\n                "+t._s(t.$t("available_x",{x:t.$t("quantity")}))+":\n                "),r("strong",[t._v(t._s(e.available))])])],1)})),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}})]:t._e(),t._v(" "),r("Divider",{staticStyle:{"margin-top":"0"},attrs:{dashed:"",orientation:"left"}},[r("small",{staticStyle:{color:"#aaa"}},[t._v("\n              "+t._s(t.$t("general"))+"\n            ")])])],2),t._v(" "),r("FormItem",{attrs:{label:t.$t("comment")}},[r("Input",{attrs:{type:"textarea",placeholder:t.$t("item_comment"),autosize:{minRows:2,maxRows:5}},model:{value:t.edit_item.comment,callback:function(e){t.$set(t.edit_item,"comment",e)},expression:"edit_item.comment"}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{long:"",type:"primary"},on:{click:function(e){return t.updateItem()}}},[t._v(t._s(t.$t("update")))])],1)],1),t._v(" "),r("Button",{attrs:{long:"",type:"error"},on:{click:function(e){return t.deleteItem(t.edit_item)}}},[t._v(t._s(t.$t("remove_from_order")))])],1):t._e()])],1)}),[],!1,null,null,null).exports},47757:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>n});var i=r(92704);function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const a={components:{OrderViewComponent:r(82016).Z},mixins:[(0,i.Z)("stock_transfers","app/transfers/stock","reference")],data:function(){var t,e=this;return{view:!1,loading:!1,stock:{id:null,reference:null},columns:[{type:"selection",width:50,align:"center",fixed:"left"},{width:175,sortable:!0,sortType:"desc",key:"created_at",title:this.$t("created_at"),render:this.renderCreatedAt},{title:this.$t("reference"),className:"reference",sortable:!0,key:"reference",width:150},{key:"to",maxWidth:300,minWidth:200,sortable:!1,title:this.$tc("to_location"),render:this.renderToAccount},{key:"from",maxWidth:300,minWidth:200,sortable:!1,render:this.renderFromAccount,title:this.$tc("from_location")},{title:"",align:"center",sortable:!1,key:"attachments",maxWidth:50,minWidth:125,render:this.renderAttachments},{width:175,key:"user_id",sortable:!1,render:this.renderUser,title:this.$t("created_by")},(t={title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0},s(t,"ellipsis",!0),s(t,"minWidth",250),s(t,"maxWidth",600),t),{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(t,r){return t("actions-component",{props:{params:r,viewFn:e.viewModal,editFn:e.editRecord,deleteFn:e.deleteRecord,record:{model:"stock_transfer",name:"reference",title:e.$tc("stock_transfer")}}})}}],options:{orderBy:"created_at desc",perPage:this.$store.state.settings.rows}}},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.stock.id&&(this.loading=!0,this.$http.get("app/transfers/stock/".concat(t.id)).then((function(t){return e.stock=t.data})).finally((function(){return e.loading=!1})))},editRecord:function(t){this.$router.push({name:"transfers.stock.edit",params:{id:t.id}})},renderToAccount:function(t,e){return t("div",[e.row.to_location.name])},renderFromAccount:function(t,e){return t("div",[e.row.from_location.name])}}};const n=(0,r(51900).Z)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("stock_transfer",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/transfers/stock/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n      "+t._s(t.$t("add_x",{x:t.$tc("stock_transfer")}))+"\n    ")],1),t._v(" "),r("div",[r("table-component",{attrs:{columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,url:"app/transfers/stock",bulkDelCB:t.deleteRecords}})],1)],1),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("stock_transfer")+" ("+t.stock.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("order-view-component",{attrs:{field:"cost",extra:!1,record:t.stock,payment:!1,"only-qty":!0,to:"to_location","to-text":t.$t("to"),from:"from_location",heading:t.$tc("stock_transfer")},on:{remove:function(e){return t.deleteAttachment(e,t.stock)}}})],1)],1)}),[],!1,null,null,null).exports},8811:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>l});var i=r(48921);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var n=function(t,e){return t.operation_value=t.operation_value?parseFloat(t.operation_value):null,e.form=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),e.form};const o={mixins:[(0,i.Z)("unit","app/units",!0,n)],data:function(){return{units:[],form:{id:"",code:"",name:"",operation_value:null,details:"",base_id:"",operator:""},rules:{code:[{required:!0,message:this.$t("field_is_required",{field:this.$t("code")}),trigger:"blur"}],name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],operator:[{required:!1,trigger:"change",message:this.$t("field_is_required",{field:this.$t("operator")})}],base_id:[{required:!1,message:this.$t("field_is_required",{field:this.$t("base_unit")}),trigger:"change"}],operation_value:[{required:!1,type:"number",trigger:"blur",message:this.$t("field_is_required",{field:this.$t("operation_value")})}]}}},computed:{formula:function(){var t=this,e=this.units.find((function(e){return e.id==t.form.base_id}));return e?e.name+" ("+e.code+") "+(this.form.operator||"")+" "+(this.form.operation_value||"")+" = "+this.form.name+" ("+this.form.code+")":null}},methods:{fetch:function(t){var e=this;this.$http.get("app/units/search").then((function(t){return e.units=t.data})).then((function(){e.$http.get("app/units/".concat(t)).then((function(t){return n(t.data,e)}))})).finally((function(){return e.loading=!1}))},create:function(){var t=this;this.$http.get("app/units/search").then((function(e){return t.units=e.data})).finally((function(){return t.loading=!1}))}}};const l=(0,r(51900).Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("uom")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/units"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("unit",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"unit",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:18,lg:12}},[r("FormItem",{attrs:{label:t.$t("code"),prop:"code",error:t._f("a2s")(t.errors.form.code)}},[r("Input",{model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),t.units&&t.units.length?r("span",[r("FormItem",{attrs:{label:t.$t("base_unit"),prop:"base_id",error:t._f("a2s")(t.errors.form.base_id)}},[r("Select",{model:{value:t.form.base_id,callback:function(e){t.$set(t.form,"base_id",e)},expression:"form.base_id"}},[t._l(t.units,(function(e){return[e.id!=t.form.id?[r("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])]:t._e()]}))],2)],1)],1):t._e(),t._v(" "),t.form.base_id?r("span",[r("FormItem",{attrs:{label:t.$tc("operator"),prop:"operator",error:t._f("a2s")(t.errors.form.operator)}},[r("Select",{model:{value:t.form.operator,callback:function(e){t.$set(t.form,"operator",e)},expression:"form.operator"}},[r("Option",{attrs:{value:"+"}},[t._v(t._s(t.$t("+")))]),t._v(" "),r("Option",{attrs:{value:"-"}},[t._v(t._s(t.$t("-")))]),t._v(" "),r("Option",{attrs:{value:"*"}},[t._v(t._s(t.$t("*")))]),t._v(" "),r("Option",{attrs:{value:"/"}},[t._v(t._s(t.$t("/")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("operation_value"),prop:"operation_value",error:t._f("a2s")(t.errors.form.operation_value)}},[r("InputNumber",{model:{value:t.form.operation_value,callback:function(e){t.$set(t.form,"operation_value",e)},expression:"form.operation_value"}})],1),t._v(" "),r("FormItem",{attrs:{label:""}},[r("Alert",{attrs:{"show-icon":""}},[r("Icon",{attrs:{slot:"icon",type:"md-git-compare"},slot:"icon"}),t._v(" "+t._s(t.formula))],1)],1)],1):t._e()],1),t._v(" "),r("Col",{attrs:{sm:24,md:6,lg:12}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("units")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("units",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},71264:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("unit","app/units","name","code")],data:function(){return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,sortType:"asc",key:"name",minWidth:200},{title:this.$tc("code"),sortable:!0,key:"code",width:150},{title:this.$t("base_unit"),sortable:!0,key:"base_unit",maxWidth:150,minWidth:200,render:this.renderBase},{title:this.$t("operator"),sortable:!1,key:"operator",width:125,render:this.renderOperator},{title:this.$t("operation_value"),sortable:!1,key:"operation_value",width:175},{title:this.$t("created_at"),sortable:!0,key:"created_at",minWidth:175,maxWidth:200,render:this.renderCreatedAt},{title:this.$t("actions"),key:"actions",align:"center",fixed:"right",width:100,render:this.renderActions}],options:{orderBy:"name",perPage:this.$store.state.settings.rows}}},methods:{renderBase:function(t,e){return t("div",[e.row.base_unit?e.row.base_unit.name:""])},renderOperator:function(t,e){return t("div",[e.row.operator?this.$t(e.row.operator):""])}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("uom",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/settings/units/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("unit"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/units",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},42055:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(48921).Z)("user","app/profile/change_password",!1)],data:function(){var t=this;return{form:{current:"",password:"",password_confirmation:""},rules:{current:[{required:!0,message:this.$t("field_is_required",{field:this.$t("current_password")}),trigger:"blur"}],password:[{required:!0,min:6,message:this.$t("password_error"),trigger:"blur"}],password_confirmation:[{required:!0,message:this.$t("field_is_required",{field:this.$t("confirm_password")}),trigger:"blur"},{validator:function(e,r,i){r!==t.form.password?i(new Error(t.$t("confirm_password_not_match"))):i()},required:!0,trigger:"change"}]}}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("change_password")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/profile"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("profile"))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"user",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("current_password"),prop:"current",error:t._f("a2s")(t.errors.form.current)}},[r("Input",{attrs:{type:"password",password:""},model:{value:t.form.current,callback:function(e){t.$set(t.form,"current",e)},expression:"form.current"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("new_password"),prop:"password",error:t._f("a2s")(t.errors.form.password)}},[r("Input",{attrs:{type:"password",password:""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("confirm_password"),prop:"password_confirmation",error:t._f("a2s")(t.errors.form.password_confirmation)}},[r("Input",{attrs:{type:"password",password:""},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("users")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},28337:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>f});var i=r(48921);const s={props:["error","label"],data:function(){return{image:null}},methods:{handleUpload:function(t){return this.image=t,this.$emit("upload",t),!1},clearImage:function(){this.image=null,this.$emit("clear")}}};var a=r(51900);const n={components:{ImageComponent:(0,a.Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("FormItem",{attrs:{label:t.label||t.$tc("image"),prop:"image",error:t.error}},[r("Upload",{attrs:{"before-upload":t.handleUpload,action:"",accept:"image/png, image/jpeg"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("select_image_to_upload")))])],1),t._v(" "),t.image&&t.image.name?r("div",[t._v("\n    "+t._s(t.$t("selected_file"))+": "+t._s(t.image.name)+"\n    "),r("Button",{staticStyle:{"margin-bottom":"3px"},attrs:{type:"error",size:"small",icon:"ios-trash"},on:{click:t.clearImage}},[t._v("\n      "+t._s(t.$t("clear_selection"))+"\n    ")])],1):t._e()],1)}),[],!1,null,null,null).exports},data:function(){return{form:{image:null}}},methods:{handleImageUpload:function(t){return this.form.image=t,!1},clearSelectedImage:function(){this.form.image=null}}};var o=r(41077);function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=function(t,e){return t.settings=t.settings&&0!=t.settings.length?t.settings:{},t.settings.collapsed=t.settings&&t.settings.collapsed?t.settings.collapsed:"0",t.settings.theme=t.settings&&t.settings.theme?t.settings.theme:e.$store.getters.settings.theme,t.settings.fixed_layout=t.settings&&(t.settings.fixed_layout||0==t.settings.fixed_layout)?t.settings.fixed_layout:e.$store.getters.settings.fixed,t.settings.play_sound=t.settings&&(t.settings.play_sound||0==t.settings.play_sound)?t.settings.play_sound:e.$store.getters.settings.play_sound,e.form=d(d({},t),t.extra_attributes),e.form};const p={components:{UserCardComponent:o.Z},mixins:[(0,i.Z)("user","app/profile",!0),n],data:function(){return{view:!1,form:{name:"",phone:"",email:"",avatar:"",username:"",settings:{collapsed:"0"}},rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],phone:[{required:!0,message:this.$t("field_is_required",{field:this.$t("phone")}),trigger:"blur"}]}}},methods:{closeUserCard:function(){this.view=!1},create:function(){var t=this;this.$http.get("app/profile").then((function(e){return t.form=h(e.data,t)})).finally((function(){return t.loading=!1}))},submit:function(t,e){var r=this;this.errors.message="";var i=d({},this.form);if(this.attributes.length>0){var s=this.attributes.map((function(t){var e={};return delete i[t.slug],e[t.slug]=r.form[t.slug],e}));i.extra_attributes=Object.assign.apply(Object,l(s))}i.settings&&i.settings.birth_date&&(i.settings.birth_date=this.$moment(i.settings.birth_date).format(this.$moment.HTML5_FMT.DATE)),i.settings&&i.settings.hire_date&&(i.settings.hire_date=this.$moment(i.settings.hire_date).format(this.$moment.HTML5_FMT.DATE)),i.settings.collapsed=i.settings.collapsed,i.avatar=i.image,delete i.image,i=this.$form(i),this.$http.post("app/profile",i).then((function(t){t.data.success?(r.$Notice.destroy(),r.form=h(t.data,r),r.$store.commit("setUserProfile",d({},t.data)),r.$store.commit("setUserSettings",d({},t.data.settings)),r.$Notice.success({title:r.$t("profile")+" "+r.$t("updated"),desc:r.$t("record_updated")})):r.$Notice.error({title:r.$t("failed"),desc:r.$t("failed_error_text")})})).catch((function(t){return r.errors=t})).finally((function(){return r.saving=!1}))}}};const f=(0,a.Z)(p,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("profile")))]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("router-link",{attrs:{to:"/"}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n        "+t._s(t.$t("dashboard"))+"\n      ")],1),t._v(" "),t.$store.getters.superAdmin?t._e():r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text",size:"small"},on:{click:function(e){t.view=!t.view}}},[r("Icon",{attrs:{type:"ios-contact",size:"16"}}),t._v("\n        "+t._s(t.$t("view_x",{x:t.$t("card")}))+"\n      ")],1)],1),t._v(" "),r("div",[r("Form",{ref:"user",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("username"),prop:"username",error:t._f("a2s")(t.errors.form.username)}},[r("Input",{attrs:{readonly:""},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("email"),prop:"email",error:t._f("a2s")(t.errors.form.email)}},[r("Input",{attrs:{readonly:""},model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("phone"),prop:"phone",error:t._f("a2s")(t.errors.form.phone)}},[r("Input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("birth_date"),prop:"birth_date",error:t._f("a2s")(t.errors.form.birth_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.settings.birth_date,callback:function(e){t.$set(t.form.settings,"birth_date",e)},expression:"form.settings.birth_date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("address"),prop:"address",error:t._f("a2s")(t.errors.form.address)}},[r("Input",{attrs:{type:"textarea"},model:{value:t.form.settings.address,callback:function(e){t.$set(t.form.settings,"address",e)},expression:"form.settings.address"}})],1)],1)],1),t._v(" "),r("image-component",{attrs:{label:t.$t("avatar"),error:t._f("a2s")(t.errors.form.name)},on:{clear:t.clearSelectedImage,upload:t.handleImageUpload}}),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("initial_sidebar"),prop:"sidebar"}},[r("RadioGroup",{model:{value:t.form.settings.collapsed,callback:function(e){t.$set(t.form.settings,"collapsed",e)},expression:"form.settings.collapsed"}},[r("Radio",{attrs:{label:"0"}},[t._v(t._s(t.$t("normal")))]),t._v(" "),r("Radio",{attrs:{label:"1"}},[t._v(t._s(t.$t("collapsed")))])],1)],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{label:t.$t("theme"),prop:"theme"}},[r("RadioGroup",{model:{value:t.form.settings.theme,callback:function(e){t.$set(t.form.settings,"theme",e)},expression:"form.settings.theme"}},[r("Radio",{attrs:{label:"dark"}},[t._v(t._s(t.$t("default")))]),t._v(" "),r("Radio",{attrs:{label:"light"}},[t._v(t._s(t.$t("light")))]),t._v(" "),r("Radio",{attrs:{label:"primary"}},[t._v(t._s(t.$t("primary")))]),t._v(" "),r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.settings.fixed_layout,callback:function(e){t.$set(t.form.settings,"fixed_layout",e)},expression:"form.settings.fixed_layout"}},[r("span",[t._v(t._s(t.$t("fixed_layout")))])])],1)],1),t._v(" "),r("FormItem",{attrs:{prop:"play_sound"}},[r("Checkbox",{attrs:{"true-value":"1","false-value":"0"},model:{value:t.form.settings.play_sound,callback:function(e){t.$set(t.form.settings,"play_sound",e)},expression:"form.settings.play_sound"}},[r("span",[t._v(t._s(t.$t("play_sound_on_pos")))])])],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("primary",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))]),t._v(" "),t.$store.getters.superAdmin?t._e():r("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"info"},on:{click:function(e){t.view=!t.view}}},[t._v(t._s(t.$t("view_x",{x:t.$t("card")})))])],1)],1)],1)],1)],1)]),t._v(" "),t.$store.getters.superAdmin?t._e():r("Modal",{staticClass:"np-header-footer",attrs:{width:282,"footer-hide":!0,"mask-closable":!1,title:t.$store.getters.user.name},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[r("user-card-component",{on:{close:t.closeUserCard}})],1)],1)}),[],!1,null,null,null).exports},14669:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>c});var i=r(48921);r(23279);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var o=function(t,e){return t.roles=t.roles.map((function(t){return t.name})),t.changePassword=!1,t.settings=t.settings&&0!=t.settings.length?t.settings:{},t.active=t.active?1:0,t.settings.clock_in=t.settings.clock_in,t.settings.first_login=1==t.settings.first_login?1:0,t.settings.require_password=1==t.settings.require_password?1:0,t.settings.salary=t.settings.salary?parseFloat(t.settings.salary):null,t.settings.hourly_rate=t.settings.hourly_rate?parseFloat(t.settings.hourly_rate):null,t.settings.max_discount=t.settings.max_discount?parseFloat(t.settings.max_discount):null,t.settings.commission_rate=t.settings.commission_rate?parseFloat(t.settings.commission_rate):null,t.files=[{name:"",file:null}],e.form=a(a({},t),t.extra_attributes),e.form};const l={mixins:[(0,i.Z)("user","app/users",!1,o)],data:function(){var t=this,e=function(e,r,i){t.form.email||t.form.phone?i():i(new Error(t.$t("field_is_required",{field:t.$t("email_or_phone")})))};return{roles:[],locations:[],searching:!1,form:{id:"",name:"",active:1,phone:"",email:"",roles:[],employee:1,username:"",password:"",locations:[],location_id:"",can_impersonate:0,changePassword:!0,password_confirmation:"",files:[{name:"",file:null}],settings:{number:"",address:"",salary:null,first_login:"",hire_date:null,birth_date:null,hourly_rate:null,max_discount:null,require_password:"",commission_rate:null}},rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}],username:[{required:!0,message:this.$t("field_is_required",{field:this.$t("username")}),trigger:"blur"}],phone:[{validator:e,required:!1,trigger:"change"}],email:[{validator:e,required:!1,trigger:"change"},{type:"email",message:this.$t("email_invalid"),trigger:["change","blur"]}],location_id:[{required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("default_x",{x:this.$tc("location")})})}],roles:[{min:1,type:"array",required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$tc("role")})}],password:[{required:!0,min:6,message:this.$t("password_error"),trigger:"blur"}],password_confirmation:[{required:!0,message:this.$t("field_is_required",{field:this.$t("confirm_password")}),trigger:"blur"},{validator:function(e,r,i){r!==t.form.password?i(new Error(t.$t("confirm_password_not_match"))):i()},required:!0,trigger:"change"}]}}},beforeRouteEnter:function(t,e,r){r((function(t){t.$store.getters.superAdmin||(t.$Notice.error({title:t.$tc("access_denied"),desc:t.$t("not_allowed_resource")}),t.$router.push(e.path))}))},created:function(){var t=this;this.$http.get("app/roles/search").then((function(e){return t.roles=e.data.filter((function(t){return"customer"!=t.label&&"supplier"!=t.label}))})),this.$http.get("app/locations/search").then((function(e){return t.locations=e.data}))},methods:{fetch:function(t){var e=this;this.$http.get("app/users/".concat(t)).then((function(t){return e.form=o(t.data,e)})).finally((function(){return e.loading=!1}))},handleUpload:function(t,e){return this.form.files[e].file=t,!1},addFile:function(){this.form.files.push({name:"",file:null})},removeFile:function(){this.form.files.length>1&&this.form.files.pop()},downloadMedia:function(t){window.location.href="app/media/"+t.id},deleteMedia:function(t){var e=this;this.$Modal.confirm({title:this.$t("delete_x",{x:t.name}),content:this.$t("delete_confirm")+"<br><br><strong>"+this.$t("r_u_sure")+"</strong>",okText:this.$t("yes"),cancelText:this.$t("cancel"),onOk:function(){e.$http.delete("app/media/"+t.id).then((function(r){r.data.success?e.form.media=e.form.media.filter((function(e){return e.id!=t.id})):e.$Notice.error({title:e.$t("unknown_error"),desc:e.$t("unknown_error_text2"),duration:10})}))}})}}};const c=(0,r(51900).Z)(l,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("user")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/users"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("user",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"user",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("phone"),prop:"phone",error:t._f("a2s")(t.errors.form.phone)}},[r("Input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("email"),prop:"email",error:t._f("a2s")(t.errors.form.email)}},[r("Input",{model:{value:t.form.email,callback:function(e){t.$set(t.form,"email",e)},expression:"form.email"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("username"),prop:"username",error:t._f("a2s")(t.errors.form.username)}},[r("Input",{model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),t._v(" "),t.form.customer_id?t._e():[r("FormItem",{attrs:{prop:"location_id",error:t._f("a2s")(t.errors.form.location_id),label:t.$t("default_x",{x:t.$tc("location")})}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.location_id,callback:function(e){t.$set(t.form,"location_id",e)},expression:"form.location_id"}},[t.locations.length>0?t._l(t.locations,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n                        "+t._s(e.label)+"\n                      ")])})):t._e()],2)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("location",2),prop:"locations",error:t._f("a2s")(t.errors.form.locations)}},[r("Select",{attrs:{multiple:"",placeholder:t.$t("select_x",{x:t.$tc("location",2)})},model:{value:t.form.locations,callback:function(e){t.$set(t.form,"locations",e)},expression:"form.locations"}},[t.locations.length>0?t._l(t.locations,(function(e,i){return r("Option",{key:i,attrs:{value:e.value}},[t._v("\n                        "+t._s(e.label)+"\n                      ")])})):t._e()],2)],1),t._v(" "),r("FormItem",{attrs:{prop:"clock_in",error:t._f("a2s")(t.errors.form.clock_in),label:t.$t("auto_clock_in")}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.settings.clock_in,callback:function(e){t.$set(t.form.settings,"clock_in",e)},expression:"form.settings.clock_in"}},[r("Option",{key:"clock_0",attrs:{value:""}},[t._v(t._s(t.$t("disable")))]),t._v(" "),r("Option",{key:"clock_1",attrs:{value:"login"}},[t._v(t._s(t.$t("auto_clock_in_with_login")))]),t._v(" "),r("Option",{key:"clock_2",attrs:{value:"register"}},[t._v(t._s(t.$t("auto_clock_in_with_register")))])],1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("birth_date"),prop:"birth_date",error:t._f("a2s")(t.errors.form.birth_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date"},model:{value:t.form.settings.birth_date,callback:function(e){t.$set(t.form.settings,"birth_date",e)},expression:"form.settings.birth_date"}})],1)]],2),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[t.form.customer_id?t._e():[r("FormItem",{attrs:{label:t.$t("employee_number"),prop:"number",error:t._f("a2s")(t.errors.form.number)}},[r("Input",{model:{value:t.form.settings.number,callback:function(e){t.$set(t.form.settings,"number",e)},expression:"form.settings.number"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("hire_date"),prop:"hire_date",error:t._f("a2s")(t.errors.form.hire_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date"},model:{value:t.form.settings.hire_date,callback:function(e){t.$set(t.form.settings,"hire_date",e)},expression:"form.settings.hire_date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("salary"),prop:"salary",error:t._f("a2s")(t.errors.form.salary)}},[r("InputNumber",{model:{value:t.form.settings.salary,callback:function(e){t.$set(t.form.settings,"salary",e)},expression:"form.settings.salary"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("hourly_rate"),prop:"hourly_rate",error:t._f("a2s")(t.errors.form.hourly_rate)}},[r("InputNumber",{model:{value:t.form.settings.hourly_rate,callback:function(e){t.$set(t.form.settings,"hourly_rate",e)},expression:"form.settings.hourly_rate"}}),t._v(" "),r("small",[t._v(t._s(t.$t("hourly_rate_tip")))])],1),t._v(" "),r("FormItem",{attrs:{prop:"commission_rate",label:t.$t("commission_rate"),error:t._f("a2s")(t.errors.form.commission_rate)}},[r("InputNumber",{attrs:{formatter:function(t){return t+"%"},parser:function(t){return t.replace("%","")}},model:{value:t.form.settings.commission_rate,callback:function(e){t.$set(t.form.settings,"commission_rate",e)},expression:"form.settings.commission_rate"}})],1),t._v(" "),r("FormItem",{staticClass:"input-tip",attrs:{label:t.$t("max_discount"),prop:"max_discount"}},[r("InputNumber",{model:{value:t.form.settings.max_discount,callback:function(e){t.$set(t.form.settings,"max_discount",e)},expression:"form.settings.max_discount"}}),t._v(" "),r("small",[t._v(t._s(t.$t("max_discount_settings_tip")))])],1)]],2)],1),t._v(" "),t.form.customer_id?t._e():[r("FormItem",{attrs:{label:t.$t("address"),prop:"address",error:t._f("a2s")(t.errors.form.address)}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.settings.address,callback:function(e){t.$set(t.form.settings,"address",e)},expression:"form.settings.address"}})],1),t._v(" "),t.form.media&&t.form.media.length>0?r("span",[r("FormItem",[t.form.media?r("div",{staticStyle:{padding:"10px",background:"#f8f8f9","border-radius":"4px"}},[r("Card",{attrs:{title:t.$tc("file",2),icon:"ios-options",padding:0,shadow:""}},[r("CellGroup",t._l(t.form.media,(function(e,i){return r("Cell",{key:"media_"+i,attrs:{title:e.name,label:e.file_name+", "+e.type+", "+e.size}},[r("ButtonGroup",{attrs:{slot:"extra",size:"small"},slot:"extra"},[r("Button",{attrs:{size:"small",type:"primary"},on:{click:function(r){return t.downloadMedia(e)}}},[t._v("\n                            "+t._s(t.$t("download"))+"\n                          ")]),t._v(" "),r("Button",{attrs:{size:"small",type:"error"},on:{click:function(r){return t.deleteMedia(e)}}},[t._v("\n                            "+t._s(t.$t("delete"))+"\n                          ")])],1)],1)})),1)],1)],1):t._e()])],1):t._e(),t._v(" "),t.form.files?r("span",t._l(t.form.files,(function(e,i){return r("Row",{key:"file_"+i,attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("file_name"),prop:"file_name",error:t._f("a2s")(t.errors.form.file)}},[r("Input",{model:{value:t.form.files[i].name,callback:function(e){t.$set(t.form.files[i],"name",e)},expression:"form.files[index].name"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("Upload",{attrs:{"before-upload":function(e){return t.handleUpload(e,i)},action:"#"}},[r("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v(t._s(t.$t("select_x",{x:t.$tc("file")})))])],1),t._v(" "),t.form.files[i].file?r("div",[t._v(t._s(t.$tc("file"))+": "+t._s(t.form.files[i].file.name))]):t._e()],1)],1)})),1):t._e(),t._v(" "),r("FormItem",[r("ButtonGroup",[r("Button",{on:{click:t.addFile}},[r("Icon",{attrs:{type:"md-add"}})],1),t._v(" "),r("Button",{attrs:{disabled:t.form.files&&t.form.files.length<2},on:{click:t.removeFile}},[r("Icon",{attrs:{type:"md-remove"}})],1)],1)],1)],t._v(" "),t.form.username!=t.$store.getters.user.username&&t.form.id?r("Divider",{attrs:{dashed:"",orientation:"left"}},[r("small",[r("a",{on:{click:function(e){t.form.changePassword=!t.form.changePassword}}},[t._v(" "+t._s(t.$t("toggle_change_password")))])])]):t._e(),t._v(" "),r("transition",{attrs:{name:"slide-fade"}},[t.form.changePassword?r("div",{staticStyle:{"margin-bottom":"16px"}},[r("FormItem",{attrs:{label:t.$t("new_password"),prop:"password",error:t._f("a2s")(t.errors.form.password)}},[r("Input",{attrs:{type:"password",password:""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"password_confirmation",label:t.$t("confirm_password"),error:t._f("a2s")(t.errors.form.password_confirmation)}},[r("Input",{attrs:{type:"password",password:""},model:{value:t.form.password_confirmation,callback:function(e){t.$set(t.form,"password_confirmation",e)},expression:"form.password_confirmation"}})],1)],1):t._e()]),t._v(" "),t.form.customer_id?t._e():[t.form.username!=t.$store.getters.user.username?r("FormItem",{attrs:{prop:"roles",label:t.$tc("role",2),error:t._f("a2s")(t.errors.form.roles)}},[r("CheckboxGroup",{model:{value:t.form.roles,callback:function(e){t.$set(t.form,"roles",e)},expression:"form.roles"}},t._l(t.roles,(function(e){return r("Checkbox",{key:e.value,attrs:{label:e.label,"true-value":e.label}},[t._v("\n                  "+t._s(t._f("capitalize")(e.label))+"\n                ")])})),1)],1):t._e()],t._v(" "),t.form.username!=t.$store.getters.user.username?r("FormItem",{class:t.form.customer_id?"":"mb0",attrs:{prop:"active",error:t._f("a2s")(t.errors.form.active)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.active,callback:function(e){t.$set(t.form,"active",e)},expression:"form.active"}},[r("span",[t._v(t._s(t.$t("active")))])])],1):t._e(),t._v(" "),t.form.customer_id?t._e():[r("FormItem",{staticClass:"mb0",attrs:{prop:"view_all",error:t._f("a2s")(t.errors.form.view_all)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.view_all,callback:function(e){t.$set(t.form,"view_all",e)},expression:"form.view_all"}},[r("span",[t._v(t._s(t.$t("view_all")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"edit_all",error:t._f("a2s")(t.errors.form.edit_all)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.edit_all,callback:function(e){t.$set(t.form,"edit_all",e)},expression:"form.edit_all"}},[r("span",[t._v(t._s(t.$t("edit_all")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"bulk_actions",error:t._f("a2s")(t.errors.form.bulk_actions)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.bulk_actions,callback:function(e){t.$set(t.form,"bulk_actions",e)},expression:"form.bulk_actions"}},[r("span",[t._v(t._s(t.$t("bulk_actions")))])])],1),t._v(" "),r("FormItem",{staticClass:"mb0",attrs:{prop:"first_login"}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.settings.first_login,callback:function(e){t.$set(t.form.settings,"first_login",e)},expression:"form.settings.first_login"}},[r("span",[t._v(t._s(t.$t("first_login")))])])],1),t._v(" "),r("FormItem",{attrs:{prop:"can_impersonate",error:t._f("a2s")(t.errors.form.can_impersonate)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.can_impersonate,callback:function(e){t.$set(t.form,"can_impersonate",e)},expression:"form.can_impersonate"}},[r("span",[t._v(t._s(t.$t("can_impersonate_text")))])])],1)],t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("users")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("users",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],2)],1)],1)],1)],1)}),[],!1,null,null,null).exports},6306:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(92704);const s={components:{UserCardComponent:r(41077).Z},mixins:[(0,i.Z)("user","app/users","username","name")],data:function(){var t=this;return{user:"",all:!1,view:!1,columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("name"),sortable:!0,key:"name",sortType:"asc",minWidth:200},{title:this.$t("username"),sortable:!0,key:"username",minWidth:150},{title:this.$t("email"),sortable:!0,key:"email",minWidth:200},{title:this.$t("active"),sortable:!0,key:"active",minWidth:100,render:this.renderActive},{title:this.$tc("role",2),sortable:!1,key:"roles",minWidth:200,render:this.renderRoles},{minWidth:150,key:"location",sortable:!1,render:this.renderLocation,title:this.$t("default_x",{x:this.$tc("location")})},{title:this.$tc("location",2),sortable:!1,key:"locations",minWidth:200,render:this.renderLocations},{title:this.$t("birth_date"),sortable:!1,key:"birth_date",minWidth:120,render:this.renderBirthDate},{title:this.$t("hire_date"),sortable:!1,key:"hire_date",minWidth:110,render:this.renderHireDate},{title:this.$tc("salary"),sortable:!1,key:"salary",minWidth:125,render:this.renderSalary},{title:this.$t("hourly_rate"),sortable:!1,key:"hourly_rate",minWidth:125,render:this.renderHourRate},{title:this.$t("commission_rate"),sortable:!1,key:"commission_rate",minWidth:150,render:this.renderCR},{title:this.$t("commission_method"),sortable:!1,key:"commission_method",minWidth:160,render:this.renderCM},{title:this.$t("address"),sortable:!1,key:"address",minWidth:200,render:this.renderAddress},{title:this.$t("clock_in"),sortable:!1,key:"clock_in",minWidth:200,render:this.renderCI},{title:this.$tc("permission",2),sortable:!0,key:"permission",minWidth:275,render:this.renderPermissions},{title:this.$t("require_password"),sortable:!1,key:"require_password",minWidth:150,render:this.renderRP},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-dropdown-component",{props:{params:r,editFn:t.editRecord,logsFn:t.viewTimeLogs,salaryFn:t.viewSalaries,deleteFn:t.deleteRecord,record:{model:"user",name:"username"},viewCardFn:1==t.$store.state.settings.impersonation?t.viewCard:null}})}}],options:{orderBy:"name",perPage:this.$store.state.settings.rows}}},computed:{url:function(){return"app/users"+(this.all?"?all=yes":"")}},watch:{all:function(){this.refresh++}},beforeRouteEnter:function(t,e,r){r((function(t){t.$store.getters.superAdmin||(t.$Notice.error({title:t.$tc("access_denied"),desc:t.$t("not_allowed_resource")}),t.$router.push(e.path))}))},methods:{viewCard:function(t){this.user=t,this.view=!0},viewSalaries:function(t){this.$router.push("/users/salaries?user_id=".concat(t.id))},viewTimeLogs:function(t){this.$router.push("/reports/time_clock?user_id=".concat(t))},closeUserCard:function(){this.user=null,this.view=!1},renderIcon:function(t,e){return this.renderBoolean(t,e,"super")},renderRoles:function(t,e){var r=this;return t("div",[e.row.roles.map((function(t){return r.capitalize(t.name)})).join(", ")])},renderLocations:function(t,e){return t("div",[e.row.locations?e.row.locations.map((function(t){return t.name})).join(", "):""])},renderLocation:function(t,e){return t("div",[e.row.location?e.row.location.name:""])},renderBirthDate:function(t,e){var r=e.row.meta.find((function(t){return"birth_date"==t.meta_key}));return t("div",[r?this.$options.filters.formatDate(r.value,this.$store.state.settings.dateformat):""])},renderHireDate:function(t,e){var r=e.row.meta.find((function(t){return"hire_date"==t.meta_key}));return t("div",[r?this.$options.filters.formatDate(r.meta_value,this.$store.state.settings.dateformat):""])},renderSalary:function(t,e){var r=e.row.meta.find((function(t){return"salary"==t.meta_key}));return t("div",[r?this.$options.filters.formatNumber(r.meta_value,this.$store.getters.settings.decimals):""])},renderHourRate:function(t,e){var r=e.row.meta.find((function(t){return"hourly_rate"==t.meta_key}));return t("div",[r?this.$options.filters.formatNumber(r.meta_value,this.$store.getters.settings.decimals):""])},renderCR:function(t,e){var r=e.row.meta.find((function(t){return"commission_rate"==t.meta_key}));return t("div",[r?this.$options.filters.formatNumber(r.meta_value,this.$store.getters.settings.decimals)+"%":""])},renderCM:function(t,e){var r=e.row.meta.find((function(t){return"commission_method"==t.meta_key}));return t("div",{style:"text-align:center;"},[r?"sale"==r.meta_value?t("div",{class:"ivu-tag ivu-tag-primary ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[r.meta_value])]):t("div",{class:"ivu-tag ivu-tag-success ivu-tag-checked"},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[r.meta_value])]):""])},renderAddress:function(t,e){var r=e.row.meta.find((function(t){return"address"==t.meta_key}));return t("div",[r?r.meta_value:""])},renderActive:function(t,e){return this.renderBoolean(t,e,"active")},renderPermissions:function(t,e){return t("div",[t("div",{style:"display:flex;"},[this.renderBoolean(t,e,"view_all")," ",t("span",{style:"margin-left:8px;"},[this.$t("view_all")])]),t("div",{style:"display:flex;"},[this.renderBoolean(t,e,"edit_all")," ",t("span",{style:"margin-left:8px;"},[this.$t("edit_all")])]),t("div",{style:"display:flex;"},[this.renderBoolean(t,e,"bulk_actions")," ",t("span",{style:"margin-left:8px;"},[this.$t("bulk_actions")])])])},renderCI:function(t,e){var r=e.row.meta.find((function(t){return"clock_in"==t.meta_key}));return t("div",[r&&"login"==r.meta_value?this.$t("auto_clock_in_with_login"):r&&"register"==r.meta_value?this.$t("auto_clock_in_with_register"):""])},renderRP:function(t,e){var r=e.row.meta.find((function(t){return"require_password"==t.meta_key}));return t("div",{style:"text-align:center;"},[r&&1==r.meta_value?t("i",{class:"ivu-icon ivu-icon-md-checkmark",style:"font-size: 16px; color: #19be6b;"}):t("i",{class:"ivu-icon ivu-icon-md-close",style:"font-size: 16px; color: #ed4014;"})])}}};const a=(0,r(51900).Z)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t.all?r("span",[t._v(t._s(t.$t("all"))+" "+t._s(t.$tc("user",2)))]):r("span",[t._v(t._s(t.$tc("employee",2)))])]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("router-link",{attrs:{to:"/users/add"}},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n        "+t._s(t.$t("add"))+" "+t._s(t.$tc("user"))+"\n      ")],1),t._v(" "),t.all?r("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.all=!1}}},[r("Icon",{attrs:{type:"ios-people"}}),t._v("\n        "+t._s(t.$tc("employee",2))+"\n      ")],1):r("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.all=!0}}},[r("Icon",{attrs:{type:"ios-people"}}),t._v("\n        "+t._s(t.$t("all"))+" "+t._s(t.$tc("user",2))+"\n      ")],1)],1),t._v(" "),r("div",[r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords}})],1)]),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:282,title:t.user?t.user.name:"","footer-hide":!0,"mask-closable":!1},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[r("user-card-component",{attrs:{u:t.user},on:{close:t.closeUserCard}})],1)],1)}),[],!1,null,null,null).exports},4869:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>l});var i=r(48921);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var n=function(t,e){return t.order=t.order?parseFloat(t.order):null,e.form=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),e.form};const o={mixins:[(0,i.Z)("role","app/roles",!1,n)],data:function(){return{roles:[],form:{id:"",name:""},rules:{name:[{required:!0,message:this.$t("field_is_required",{field:this.$t("name")}),trigger:"blur"}]}}},methods:{fetch:function(t){var e=this;this.$http.get("app/roles/".concat(t)).then((function(t){return n(t.data,e)})).finally((function(){return e.loading=!1}))}}};const l=(0,r(51900).Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("role")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/users/roles"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("role",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"role",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:18,lg:12}},[r("FormItem",{attrs:{label:t.$tc("name"),prop:"name",error:t._f("a2s")(t.errors.form.name)}},[r("Input",{attrs:{"element-id":"role-name"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:6,lg:12}})],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("roles")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("roles",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},76025:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={mixins:[(0,r(92704).Z)("role","app/roles","name")],data:function(){var t=this;return{columns:[{type:"selection",width:50,align:"center",fixed:"left"},{title:this.$t("created_at"),sortable:!0,key:"created_at",width:175,render:this.renderCreatedAt},{title:this.$t("name"),sortable:!0,key:"name",minWidth:200},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,editFn:t.editRecord,deleteFn:t.deleteRecord,record:{model:"role",name:"name"},trailsFn:function(e){t.$router.push("/users/roles/".concat(e,"/permissions"))}}})}}],options:{orderBy:"name",perPage:this.$store.state.settings.rows}}},methods:{}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("role",2)))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/users/roles/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("add"))+" "+t._s(t.$tc("role"))+"\n  ")],1),t._v(" "),r("div",[r("table-component",{attrs:{url:"app/roles",columns:t.columns,options:t.options,dblClickCB:t.showInfo,bulkDelCB:t.deleteRecords,refresh:t.refresh}})],1)],1)}),[],!1,null,null,null).exports},34562:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>f});var i=r(48921);function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var i,s,a=[],n=!0,o=!1;try{for(r=r.call(t);!(n=(i=r.next()).done)&&(a.push(i.value),!e||a.length!==e);n=!0);}catch(t){o=!0,s=t}finally{try{n||null==r.return||r.return()}finally{if(o)throw s}}return a}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=function(t,e){return e.role=o({},t),e.form=e.role.all_permissions.reduce((function(t,r){return o(o({},t),{},l({},r,e.role.permissions.includes(r)))}),{}),!0};const u={mixins:[(0,i.Z)("role","app/roles",!1,c)],data:function(){return{form:{},rules:{},role:null,saving:!1,loading:!0}},methods:{fetch:function(t){var e=this;this.$http.get("app/roles/".concat(t,"?permissions=yes")).then((function(t){return c(t.data,e)})).finally((function(){return e.loading=!1}))},setPermissions:function(t,e){var r=this;this.saving=!0;for(var i=[],a=0,n=Object.entries(this.form);a<n.length;a++){var o=s(n[a],2),l=o[0];o[1]&&i.push(l)}this.$http.post("app/roles/".concat(this.role.id,"/permissions"),i).then((function(i){r.$Notice.success({title:r.$tc("permission",2),desc:r.$t("record_updated"),duration:10}),e||r.$router.push({name:t+".list"})})).finally((function(){return r.saving=!1}))}}};var d=r(93379),m=r.n(d),h=r(66047),p={insert:"head",singleton:!1};m()(h.Z,p);h.Z.locals;const f=(0,r(51900).Z)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n    "+t._s(t.$t("edit_x",{x:t.$tc("permission",2)}))+"\n    "),t.role?r("span",[t._v("("+t._s(t.$tc("role"))+": "+t._s(t.role.name)+")")]):t._e()]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/users/roles"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("role",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"permissions",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:12}},[r("div",{staticClass:"mb16"},[r("List",{staticClass:"permissions",attrs:{border:""}},[r("ListItem",[r("ListItemMeta",{attrs:{title:t.$t("pos"),description:t.$t("permissions_for",{x:t.$t("pos")})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["pos-sales"],callback:function(e){t.$set(t.form,"pos-sales",e)},expression:"form['pos-sales']"}},[t._v(t._s(t.$t("access_x",{x:t.$t("pos")})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-orders"],callback:function(e){t.$set(t.form,"create-orders",e)},expression:"form['create-orders']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("order",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-orders"],callback:function(e){t.$set(t.form,"update-orders",e)},expression:"form['update-orders']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("order",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-orders"],callback:function(e){t.$set(t.form,"delete-orders",e)},expression:"form['delete-orders']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("order",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("sale",2),description:t.$t("permissions_for",{x:t.$tc("sale",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-sales"],callback:function(e){t.$set(t.form,"read-sales",e)},expression:"form['read-sales']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("sale",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-sales"],callback:function(e){t.$set(t.form,"create-sales",e)},expression:"form['create-sales']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("sale",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-sales"],callback:function(e){t.$set(t.form,"update-sales",e)},expression:"form['update-sales']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("sale",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-sales"],callback:function(e){t.$set(t.form,"delete-sales",e)},expression:"form['delete-sales']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("sale",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["email-sales"],callback:function(e){t.$set(t.form,"email-sales",e)},expression:"form['email-sales']"}},[t._v(t._s(t.$t("email_x",{x:t.$tc("sale",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("delivery",2),description:t.$t("permissions_for",{x:t.$tc("delivery",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-deliveries"],callback:function(e){t.$set(t.form,"read-deliveries",e)},expression:"form['read-deliveries']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("delivery",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-deliveries"],callback:function(e){t.$set(t.form,"create-deliveries",e)},expression:"form['create-deliveries']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("delivery",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-deliveries"],callback:function(e){t.$set(t.form,"update-deliveries",e)},expression:"form['update-deliveries']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("delivery",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-deliveries"],callback:function(e){t.$set(t.form,"delete-deliveries",e)},expression:"form['delete-deliveries']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("delivery",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["email-deliveries"],callback:function(e){t.$set(t.form,"email-deliveries",e)},expression:"form['email-deliveries']"}},[t._v(t._s(t.$t("email_x",{x:t.$tc("delivery",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("recurring_sale",2),description:t.$t("permissions_for",{x:t.$tc("recurring_sale",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-recurring-sales"],callback:function(e){t.$set(t.form,"read-recurring-sales",e)},expression:"form['read-recurring-sales']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("recurring_sale",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-recurring-sales"],callback:function(e){t.$set(t.form,"create-recurring-sales",e)},expression:"form['create-recurring-sales']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("recurring_sale",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-recurring-sales"],callback:function(e){t.$set(t.form,"update-recurring-sales",e)},expression:"form['update-recurring-sales']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("recurring_sale",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-recurring-sales"],callback:function(e){t.$set(t.form,"delete-recurring-sales",e)},expression:"form['delete-recurring-sales']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("recurring_sale",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["email-recurring-sales"],callback:function(e){t.$set(t.form,"email-recurring-sales",e)},expression:"form['email-recurring-sales']"}},[t._v(t._s(t.$t("email_x",{x:t.$tc("recurring_sale",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("customer",2),description:t.$t("permissions_for",{x:t.$tc("customer",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-customers"],callback:function(e){t.$set(t.form,"read-customers",e)},expression:"form['read-customers']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("customer",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-customers"],callback:function(e){t.$set(t.form,"create-customers",e)},expression:"form['create-customers']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("customer",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-customers"],callback:function(e){t.$set(t.form,"update-customers",e)},expression:"form['update-customers']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("customer",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-customers"],callback:function(e){t.$set(t.form,"delete-customers",e)},expression:"form['delete-customers']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("customer",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("purchase",2),description:t.$t("permissions_for",{x:t.$tc("purchase",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-purchases"],callback:function(e){t.$set(t.form,"read-purchases",e)},expression:"form['read-purchases']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("purchase",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-purchases"],callback:function(e){t.$set(t.form,"create-purchases",e)},expression:"form['create-purchases']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("purchase",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-purchases"],callback:function(e){t.$set(t.form,"update-purchases",e)},expression:"form['update-purchases']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("purchase",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-purchases"],callback:function(e){t.$set(t.form,"delete-purchases",e)},expression:"form['delete-purchases']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("purchase",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["email-purchases"],callback:function(e){t.$set(t.form,"email-purchases",e)},expression:"form['email-purchases']"}},[t._v(t._s(t.$t("email_x",{x:t.$tc("purchase",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("supplier",2),description:t.$t("permissions_for",{x:t.$tc("supplier",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-suppliers"],callback:function(e){t.$set(t.form,"read-suppliers",e)},expression:"form['read-suppliers']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("supplier",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-suppliers"],callback:function(e){t.$set(t.form,"create-suppliers",e)},expression:"form['create-suppliers']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("supplier",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-suppliers"],callback:function(e){t.$set(t.form,"update-suppliers",e)},expression:"form['update-suppliers']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("supplier",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-suppliers"],callback:function(e){t.$set(t.form,"delete-suppliers",e)},expression:"form['delete-suppliers']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("supplier",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("quotation",2),description:t.$t("permissions_for",{x:t.$tc("quotation",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-quotations"],callback:function(e){t.$set(t.form,"read-quotations",e)},expression:"form['read-quotations']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("quotation",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-quotations"],callback:function(e){t.$set(t.form,"create-quotations",e)},expression:"form['create-quotations']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("quotation",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-quotations"],callback:function(e){t.$set(t.form,"update-quotations",e)},expression:"form['update-quotations']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("quotation",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-quotations"],callback:function(e){t.$set(t.form,"delete-quotations",e)},expression:"form['delete-quotations']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("quotation",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("return_order",2),description:t.$t("permissions_for",{x:t.$tc("return_order",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-return-orders"],callback:function(e){t.$set(t.form,"read-return-orders",e)},expression:"form['read-return-orders']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("return_order",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-return-orders"],callback:function(e){t.$set(t.form,"create-return-orders",e)},expression:"form['create-return-orders']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("return_order",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-return-orders"],callback:function(e){t.$set(t.form,"update-return-orders",e)},expression:"form['update-return-orders']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("return_order",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-return-orders"],callback:function(e){t.$set(t.form,"delete-return-orders",e)},expression:"form['delete-return-orders']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("return_order",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("payment",2),description:t.$t("permissions_for",{x:t.$tc("payment",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-payments"],callback:function(e){t.$set(t.form,"read-payments",e)},expression:"form['read-payments']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("payment",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-payments"],callback:function(e){t.$set(t.form,"create-payments",e)},expression:"form['create-payments']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("payment",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-payments"],callback:function(e){t.$set(t.form,"update-payments",e)},expression:"form['update-payments']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("payment",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-payments"],callback:function(e){t.$set(t.form,"delete-payments",e)},expression:"form['delete-payments']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("payment",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["email-payments"],callback:function(e){t.$set(t.form,"email-payments",e)},expression:"form['email-payments']"}},[t._v(t._s(t.$t("email_x",{x:t.$tc("payment",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("income",2),description:t.$t("permissions_for",{x:t.$tc("income",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-incomes"],callback:function(e){t.$set(t.form,"read-incomes",e)},expression:"form['read-incomes']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("income",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-incomes"],callback:function(e){t.$set(t.form,"create-incomes",e)},expression:"form['create-incomes']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("income",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-incomes"],callback:function(e){t.$set(t.form,"update-incomes",e)},expression:"form['update-incomes']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("income",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-incomes"],callback:function(e){t.$set(t.form,"delete-incomes",e)},expression:"form['delete-incomes']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("income",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("expense",2),description:t.$t("permissions_for",{x:t.$tc("expense",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-expenses"],callback:function(e){t.$set(t.form,"read-expenses",e)},expression:"form['read-expenses']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("expense",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-expenses"],callback:function(e){t.$set(t.form,"create-expenses",e)},expression:"form['create-expenses']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("expense",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-expenses"],callback:function(e){t.$set(t.form,"update-expenses",e)},expression:"form['update-expenses']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("expense",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-expenses"],callback:function(e){t.$set(t.form,"delete-expenses",e)},expression:"form['delete-expenses']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("expense",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("item",2),description:t.$t("permissions_for",{x:t.$tc("item",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-items"],callback:function(e){t.$set(t.form,"read-items",e)},expression:"form['read-items']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("item",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-items"],callback:function(e){t.$set(t.form,"create-items",e)},expression:"form['create-items']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("item",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-items"],callback:function(e){t.$set(t.form,"update-items",e)},expression:"form['update-items']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("item",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-items"],callback:function(e){t.$set(t.form,"delete-items",e)},expression:"form['delete-items']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("item",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["label-items"],callback:function(e){t.$set(t.form,"label-items",e)},expression:"form['label-items']"}},[t._v(t._s(t.$t("view_x",{x:t.$t("item_label")})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["trail-items"],callback:function(e){t.$set(t.form,"trail-items",e)},expression:"form['trail-items']"}},[t._v(t._s(t.$t("trail_x",{x:t.$tc("item",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("modifier",2),description:t.$t("permissions_for",{x:t.$tc("modifier",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-modifiers"],callback:function(e){t.$set(t.form,"read-modifiers",e)},expression:"form['read-modifiers']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("modifier",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-modifiers"],callback:function(e){t.$set(t.form,"create-modifiers",e)},expression:"form['create-modifiers']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("modifier",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-modifiers"],callback:function(e){t.$set(t.form,"update-modifiers",e)},expression:"form['update-modifiers']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("modifier",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-modifiers"],callback:function(e){t.$set(t.form,"delete-modifiers",e)},expression:"form['delete-modifiers']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("modifier",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("gift_card",2),description:t.$t("permissions_for",{x:t.$tc("gift_card",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-gift-cards"],callback:function(e){t.$set(t.form,"read-gift-cards",e)},expression:"form['read-gift-cards']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("gift_card",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-gift-cards"],callback:function(e){t.$set(t.form,"create-gift-cards",e)},expression:"form['create-gift-cards']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("gift_card",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-gift-cards"],callback:function(e){t.$set(t.form,"update-gift-cards",e)},expression:"form['update-gift-cards']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("gift_card",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-gift-cards"],callback:function(e){t.$set(t.form,"delete-gift-cards",e)},expression:"form['delete-gift-cards']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("gift_card",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["log-gift-cards"],callback:function(e){t.$set(t.form,"log-gift-cards",e)},expression:"form['log-gift-cards']"}},[t._v(t._s(t.$t("log_x",{x:t.$tc("gift_card",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("stock_adjustment",2),description:t.$t("permissions_for",{x:t.$tc("stock_adjustment",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-stock-adjustments"],callback:function(e){t.$set(t.form,"read-stock-adjustments",e)},expression:"form['read-stock-adjustments']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("stock_adjustment",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-stock-adjustments"],callback:function(e){t.$set(t.form,"create-stock-adjustments",e)},expression:"form['create-stock-adjustments']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("stock_adjustment",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-stock-adjustments"],callback:function(e){t.$set(t.form,"update-stock-adjustments",e)},expression:"form['update-stock-adjustments']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("stock_adjustment",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-stock-adjustments"],callback:function(e){t.$set(t.form,"delete-stock-adjustments",e)},expression:"form['delete-stock-adjustments']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("stock_adjustment",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("asset_transfer",2),description:t.$t("permissions_for",{x:t.$tc("asset_transfer",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-asset-transfers"],callback:function(e){t.$set(t.form,"read-asset-transfers",e)},expression:"form['read-asset-transfers']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("asset_transfer",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-asset-transfers"],callback:function(e){t.$set(t.form,"create-asset-transfers",e)},expression:"form['create-asset-transfers']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("asset_transfer",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-asset-transfers"],callback:function(e){t.$set(t.form,"update-asset-transfers",e)},expression:"form['update-asset-transfers']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("asset_transfer",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-asset-transfers"],callback:function(e){t.$set(t.form,"delete-asset-transfers",e)},expression:"form['delete-asset-transfers']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("asset_transfer",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("stock_transfer",2),description:t.$t("permissions_for",{x:t.$tc("stock_transfer",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-stock-transfers"],callback:function(e){t.$set(t.form,"read-stock-transfers",e)},expression:"form['read-stock-transfers']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("stock_transfer",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-stock-transfers"],callback:function(e){t.$set(t.form,"create-stock-transfers",e)},expression:"form['create-stock-transfers']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("stock_transfer",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-stock-transfers"],callback:function(e){t.$set(t.form,"update-stock-transfers",e)},expression:"form['update-stock-transfers']"}},[t._v(t._s(t.$t("edit_x",{x:t.$tc("stock_transfer",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-stock-transfers"],callback:function(e){t.$set(t.form,"delete-stock-transfers",e)},expression:"form['delete-stock-transfers']"}},[t._v(t._s(t.$t("delete_x",{x:t.$tc("stock_transfer",2)})))])],1)],2)],1)],1)]),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:12}},[r("div",{staticClass:"mb16"},[r("List",{staticClass:"permissions",attrs:{border:""}},[r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("account",2),description:t.$t("permissions_for",{x:t.$tc("account",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-accounts"],callback:function(e){t.$set(t.form,"read-accounts",e)},expression:"form['read-accounts']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("account",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-accounts"],callback:function(e){t.$set(t.form,"create-accounts",e)},expression:"form['create-accounts']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("account",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-accounts"],callback:function(e){t.$set(t.form,"update-accounts",e)},expression:"form['update-accounts']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("account",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-accounts"],callback:function(e){t.$set(t.form,"delete-accounts",e)},expression:"form['delete-accounts']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("account",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("location",2),description:t.$t("permissions_for",{x:t.$tc("location",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-locations"],callback:function(e){t.$set(t.form,"read-locations",e)},expression:"form['read-locations']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("location",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-locations"],callback:function(e){t.$set(t.form,"create-locations",e)},expression:"form['create-locations']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("location",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-locations"],callback:function(e){t.$set(t.form,"update-locations",e)},expression:"form['update-locations']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("location",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-locations"],callback:function(e){t.$set(t.form,"delete-locations",e)},expression:"form['delete-locations']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("location",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("user",2),description:t.$t("permissions_for",{x:t.$tc("user",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-users"],callback:function(e){t.$set(t.form,"read-users",e)},expression:"form['read-users']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("user",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-users"],callback:function(e){t.$set(t.form,"create-users",e)},expression:"form['create-users']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("user",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-users"],callback:function(e){t.$set(t.form,"update-users",e)},expression:"form['update-users']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("user",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-users"],callback:function(e){t.$set(t.form,"delete-users",e)},expression:"form['delete-users']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("user",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("role",2),description:t.$t("permissions_for",{x:t.$tc("user_role",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-roles"],callback:function(e){t.$set(t.form,"read-roles",e)},expression:"form['read-roles']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("role",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-roles"],callback:function(e){t.$set(t.form,"create-roles",e)},expression:"form['create-roles']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("role",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-roles"],callback:function(e){t.$set(t.form,"update-roles",e)},expression:"form['update-roles']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("role",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-roles"],callback:function(e){t.$set(t.form,"delete-roles",e)},expression:"form['delete-roles']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("role",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("salary",2),description:t.$t("permissions_for",{x:t.$tc("salary",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-salaries"],callback:function(e){t.$set(t.form,"read-salaries",e)},expression:"form['read-salaries']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("salary",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-salaries"],callback:function(e){t.$set(t.form,"create-salaries",e)},expression:"form['create-salaries']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("salary",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-salaries"],callback:function(e){t.$set(t.form,"update-salaries",e)},expression:"form['update-salaries']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("salary",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-salaries"],callback:function(e){t.$set(t.form,"delete-salaries",e)},expression:"form['delete-salaries']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("salary",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("promo",2),description:t.$t("permissions_for",{x:t.$tc("promo",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-promos"],callback:function(e){t.$set(t.form,"read-promos",e)},expression:"form['read-promos']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("promo",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-promos"],callback:function(e){t.$set(t.form,"create-promos",e)},expression:"form['create-promos']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("promo",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-promos"],callback:function(e){t.$set(t.form,"update-promos",e)},expression:"form['update-promos']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("promo",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-promos"],callback:function(e){t.$set(t.form,"delete-promos",e)},expression:"form['delete-promos']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("promo",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("brand",2),description:t.$t("permissions_for",{x:t.$tc("brand",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-brands"],callback:function(e){t.$set(t.form,"read-brands",e)},expression:"form['read-brands']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("brand",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-brands"],callback:function(e){t.$set(t.form,"create-brands",e)},expression:"form['create-brands']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("brand",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-brands"],callback:function(e){t.$set(t.form,"update-brands",e)},expression:"form['update-brands']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("brand",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-brands"],callback:function(e){t.$set(t.form,"delete-brands",e)},expression:"form['delete-brands']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("brand",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("category",2),description:t.$t("permissions_for",{x:t.$tc("category",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-categories"],callback:function(e){t.$set(t.form,"read-categories",e)},expression:"form['read-categories']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("category",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-categories"],callback:function(e){t.$set(t.form,"create-categories",e)},expression:"form['create-categories']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("category",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-categories"],callback:function(e){t.$set(t.form,"update-categories",e)},expression:"form['update-categories']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("category",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-categories"],callback:function(e){t.$set(t.form,"delete-categories",e)},expression:"form['delete-categories']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("category",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("tax",2),description:t.$t("permissions_for",{x:t.$tc("tax",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-taxes"],callback:function(e){t.$set(t.form,"read-taxes",e)},expression:"form['read-taxes']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("tax",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-taxes"],callback:function(e){t.$set(t.form,"create-taxes",e)},expression:"form['create-taxes']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("tax",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-taxes"],callback:function(e){t.$set(t.form,"update-taxes",e)},expression:"form['update-taxes']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("tax",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-taxes"],callback:function(e){t.$set(t.form,"delete-taxes",e)},expression:"form['delete-taxes']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("tax",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("field",2),description:t.$t("permissions_for",{x:t.$tc("field",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-fields"],callback:function(e){t.$set(t.form,"read-fields",e)},expression:"form['read-fields']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("field",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-fields"],callback:function(e){t.$set(t.form,"create-fields",e)},expression:"form['create-fields']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("field",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-fields"],callback:function(e){t.$set(t.form,"update-fields",e)},expression:"form['update-fields']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("field",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-fields"],callback:function(e){t.$set(t.form,"delete-fields",e)},expression:"form['delete-fields']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("field",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("customer_group",2),description:t.$t("permissions_for",{x:t.$tc("customer_group",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-customer-groups"],callback:function(e){t.$set(t.form,"read-customer-groups",e)},expression:"form['read-customer-groups']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("customer_group",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-customer-groups"],callback:function(e){t.$set(t.form,"create-customer-groups",e)},expression:"form['create-customer-groups']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("customer_group",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-customer-groups"],callback:function(e){t.$set(t.form,"update-customer-groups",e)},expression:"form['update-customer-groups']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("customer_group",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-customer-groups"],callback:function(e){t.$set(t.form,"delete-customer-groups",e)},expression:"form['delete-customer-groups']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("customer_group",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("hall",2),description:t.$t("permissions_for",{x:t.$tc("hall",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-halls"],callback:function(e){t.$set(t.form,"read-halls",e)},expression:"form['read-halls']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("hall",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-halls"],callback:function(e){t.$set(t.form,"create-halls",e)},expression:"form['create-halls']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("hall",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-halls"],callback:function(e){t.$set(t.form,"update-halls",e)},expression:"form['update-halls']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("hall",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-halls"],callback:function(e){t.$set(t.form,"delete-halls",e)},expression:"form['delete-halls']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("hall",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("table",2),description:t.$t("permissions_for",{x:t.$tc("table",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-tables"],callback:function(e){t.$set(t.form,"read-tables",e)},expression:"form['read-tables']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("table",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-tables"],callback:function(e){t.$set(t.form,"create-tables",e)},expression:"form['create-tables']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("table",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-tables"],callback:function(e){t.$set(t.form,"update-tables",e)},expression:"form['update-tables']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("table",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-tables"],callback:function(e){t.$set(t.form,"delete-tables",e)},expression:"form['delete-tables']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("table",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("unit",2),description:t.$t("permissions_for",{x:t.$tc("unit",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-units"],callback:function(e){t.$set(t.form,"read-units",e)},expression:"form['read-units']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("unit",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-units"],callback:function(e){t.$set(t.form,"create-units",e)},expression:"form['create-units']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("unit",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-units"],callback:function(e){t.$set(t.form,"update-units",e)},expression:"form['update-units']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("unit",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-units"],callback:function(e){t.$set(t.form,"delete-units",e)},expression:"form['delete-units']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("unit",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("report",2),description:t.$t("permissions_for",{x:t.$tc("report",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-report"],callback:function(e){t.$set(t.form,"read-report",e)},expression:"form['read-report']"}},[t._v(t._s(t.$tc("report",2)))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["registers-report"],callback:function(e){t.$set(t.form,"registers-report",e)},expression:"form['registers-report']"}},[t._v(t._s(t.$tc("register",2)))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["expiry-alerts-report"],callback:function(e){t.$set(t.form,"expiry-alerts-report",e)},expression:"form['expiry-alerts-report']"}},[t._v(t._s(t.$t("expiry_alerts")))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["quantity-alerts-report"],callback:function(e){t.$set(t.form,"quantity-alerts-report",e)},expression:"form['quantity-alerts-report']"}},[t._v(t._s(t.$t("quantity_alerts")))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["items-report"],callback:function(e){t.$set(t.form,"items-report",e)},expression:"form['items-report']"}},[t._v(t._s(t.$t("x_report",{x:t.$tc("item",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["sales-report"],callback:function(e){t.$set(t.form,"sales-report",e)},expression:"form['sales-report']"}},[t._v(t._s(t.$t("x_report",{x:t.$tc("sale",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["purchases-report"],callback:function(e){t.$set(t.form,"purchases-report",e)},expression:"form['purchases-report']"}},[t._v(t._s(t.$t("x_report",{x:t.$tc("purchase",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["payments-report"],callback:function(e){t.$set(t.form,"payments-report",e)},expression:"form['payments-report']"}},[t._v(t._s(t.$t("x_report",{x:t.$tc("payment",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["expenses-report"],callback:function(e){t.$set(t.form,"expenses-report",e)},expression:"form['expenses-report']"}},[t._v(t._s(t.$t("x_report",{x:t.$tc("expense",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["incomes-report"],callback:function(e){t.$set(t.form,"incomes-report",e)},expression:"form['incomes-report']"}},[t._v(t._s(t.$t("x_report",{x:t.$tc("income",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["taxes-report"],callback:function(e){t.$set(t.form,"taxes-report",e)},expression:"form['taxes-report']"}},[t._v(t._s(t.$t("x_report",{x:t.$tc("tax",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["stock-transfers-report"],callback:function(e){t.$set(t.form,"stock-transfers-report",e)},expression:"form['stock-transfers-report']"}},[t._v(t._s(t.$tc("stock_transfer",2)))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["stock-adjustments-report"],callback:function(e){t.$set(t.form,"stock-adjustments-report",e)},expression:"form['stock-adjustments-report']"}},[t._v(t._s(t.$tc("stock_adjustment",2)))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["time-clock-report"],callback:function(e){t.$set(t.form,"time-clock-report",e)},expression:"form['time-clock-report']"}},[t._v(t._s(t.$tc("time_clock",2)))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["activity-logs-report"],callback:function(e){t.$set(t.form,"activity-logs-report",e)},expression:"form['activity-logs-report']"}},[t._v(t._s(t.$t("activity_logs")))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("event",2),description:t.$t("permissions_for",{x:t.$tc("event",2)})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form.calendar,callback:function(e){t.$set(t.form,"calendar",e)},expression:"form['calendar']"}},[t._v(t._s(t.$t("calendar")))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["read-events"],callback:function(e){t.$set(t.form,"read-events",e)},expression:"form['read-events']"}},[t._v(t._s(t.$t("view_x",{x:t.$tc("event",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["create-events"],callback:function(e){t.$set(t.form,"create-events",e)},expression:"form['create-events']"}},[t._v(t._s(t.$t("add_x",{x:t.$tc("event",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["update-events"],callback:function(e){t.$set(t.form,"update-events",e)},expression:"form['update-events']"}},[t._v(t._s(t.$t("edit_x_all",{x:t.$tc("event",2)})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-events"],callback:function(e){t.$set(t.form,"delete-events",e)},expression:"form['delete-events']"}},[t._v(t._s(t.$t("delete_x_all",{x:t.$tc("event",2)})))])],1)],2),t._v(" "),r("ListItem",[r("ListItemMeta",{attrs:{title:t.$tc("misc",2),description:t.$t("permissions_for",{x:t.$t("misc")})}}),t._v(" "),r("template",{slot:"action"},[r("Checkbox",{staticClass:"v-check",model:{value:t.form["alerts-report"],callback:function(e){t.$set(t.form,"alerts-report",e)},expression:"form['alerts-report']"}},[t._v(t._s(t.$tc("alert",2)))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["delete-media"],callback:function(e){t.$set(t.form,"delete-media",e)},expression:"form['delete-media']"}},[t._v(t._s(t.$t("delete_x",{x:t.$t("media")})))]),t._v(" "),r("Checkbox",{staticClass:"v-check",model:{value:t.form["item-label-design"],callback:function(e){t.$set(t.form,"item-label-design",e)},expression:"form['item-label-design']"}},[t._v(t._s(t.$t("item_label_design")))])],1)],2)],1)],1)])],1),t._v(" "),r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.setPermissions("roles")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.setPermissions("roles",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])])],1)],1)],1)}),[],!1,null,null,null).exports},59580:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>h});var i=r(48921),s=r(23279),a=r.n(s),n=r(44605);function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return u(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var d=function(t,e){return t.amount=parseFloat(t.amount),t.advance=1==t.advance?1:0,e.attachments=t.attachments&&t.attachments.length?c(t.attachments):[],e.form=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),e.form};const m={mixins:[n.Z,(0,i.Z)("salary","app/salaries",!0,d)],data:function(){return{users:[],accounts:[],salaries:[],account_id:null,searching:!1,form:{id:"",type:"",amount:null,advance:0,user_id:"",account_id:"",status:"",points:null},rules:{type:[{required:!0,message:this.$t("field_is_required",{field:this.$t("type")}),trigger:"change"}],status:[{required:!0,message:this.$t("field_is_required",{field:this.$t("status")}),trigger:"change"}],user_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("user")}),trigger:"change"}],account_id:[{required:!0,message:this.$t("field_is_required",{field:this.$tc("account")}),trigger:"change"}],points:[{type:"number",trigger:"change",required:!0,message:this.$t("field_is_required",{field:this.$t("points")})}],amount:[{required:!0,type:"number",message:this.$t("field_is_required",{field:this.$t("amount")}),trigger:"change"}],date:[{type:"date",required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("date")})}]}}},methods:{create:function(){var t=this;this.$http.get("app/accounts/search").then((function(e){return t.accounts=e.data})).finally((function(){return t.loading=!1}))},fetch:function(t){var e=this;this.$http.get("app/accounts/search").then((function(r){e.accounts=r.data,e.$http.get("app/salaries/".concat(t)).then((function(t){return d(t.data,e)}))})).finally((function(){return e.loading=!1}))},searchUsers:function(t){""===t||this.users.find((function(e){return e.label==t}))||this.getUsers(t,this)},getUsers:a()((function(t,e){e.searching=!0;e.$store.getters.search_delay;e.$http.get("app/users/search?q="+t).then((function(t){return e.users=t.data})).finally((function(){return e.searching=!1}))}),search_delay||250)}};const h=(0,r(51900).Z)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.form.id?t.$t("edit"):t.$t("add"))+" "+t._s(t.$tc("salary")))]),t._v(" "),r("router-link",{attrs:{slot:"extra",to:"/users/salaries"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n    "+t._s(t.$t("list"))+" "+t._s(t.$tc("salary",2))+"\n  ")],1),t._v(" "),r("div",[r("Form",{ref:"salary",staticClass:"form-responsive",attrs:{model:t.form,rules:t.rules,"label-width":150}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[t.loading?r("Loading"):t._e(),t._v(" "),t.errors.message?r("Alert",{staticClass:"mb26",attrs:{type:"error","show-icon":""}},[r("div",{domProps:{innerHTML:t._s(t.errors.message)}})]):t._e(),t._v(" "),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$t("date"),prop:"date",error:t._f("a2s")(t.errors.form.date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("reference"),prop:"reference",error:t._f("a2s")(t.errors.form.reference)}},[r("Input",{model:{value:t.form.reference,callback:function(e){t.$set(t.form,"reference",e)},expression:"form.reference"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("user"),prop:"user_id"}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,"remote-method":t.searchUsers,placeholder:t.$t("type_to_search")},model:{value:t.form.user_id,callback:function(e){t.$set(t.form,"user_id",e)},expression:"form.user_id"}},t._l(t.users,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),t._v(" "),r("FormItem",{attrs:{label:t.$tc("account"),prop:"account_id"}},[r("Select",{attrs:{remote:"",clearable:"",filterable:"",loading:t.searching,placeholder:""},model:{value:t.form.account_id,callback:function(e){t.$set(t.form,"account_id",e)},expression:"form.account_id"}},t._l(t.accounts,(function(e,i){return r("Option",{key:i+e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{attrs:{label:t.$tc("amount"),prop:"amount",error:t._f("a2s")(t.errors.form.amount)}},[r("InputNumber",{model:{value:t.form.amount,callback:function(e){t.$set(t.form,"amount",e)},expression:"form.amount"}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("type"),prop:"type",error:t._f("a2s")(t.errors.form.type)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},[r("Option",{attrs:{value:"salary"}},[t._v(t._s(t.$tc("salary")))]),t._v(" "),r("Option",{attrs:{value:"commission"}},[t._v(t._s(t.$tc("commission")))])],1)],1),t._v(" "),"commission"==t.form.type?r("FormItem",{attrs:{label:t.$t("points"),prop:"points",error:t._f("a2s")(t.errors.form.points)}},[r("InputNumber",{model:{value:t.form.points,callback:function(e){t.$set(t.form,"points",e)},expression:"form.points"}})],1):t._e(),t._v(" "),r("FormItem",{attrs:{label:t.$t("status"),prop:"status",error:t._f("a2s")(t.errors.form.status)}},[r("Select",{attrs:{placeholder:""},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[r("Option",{attrs:{value:"due"}},[t._v(t._s(t.$t("due")))]),t._v(" "),r("Option",{attrs:{value:"paid"}},[t._v(t._s(t.$t("paid")))])],1)],1)],1)],1),t._v(" "),r("attachments-component",{attrs:{error:t._f("a2s")(t.errors.form.attachments)},on:{selected:t.handleUpload,clear:t.clearAttachments}},[r("list-attachments-component",{attrs:{attachments:t.attachments},on:{remove:t.deleteAttachment}})],1),t._v(" "),r("FormItem",{attrs:{label:t.$t("details"),prop:"details"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:8}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",{attrs:{prop:"advance",error:t._f("a2s")(t.errors.form.advance)}},[r("Checkbox",{attrs:{"true-value":1,"false-value":0},model:{value:t.form.advance,callback:function(e){t.$set(t.form,"advance",e)},expression:"form.advance"}},[r("span",[t._v(t._s(t.$t("advance_salary_text")))])])],1),t._v(" "),r("FormItem",[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("salaries")}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},attrs:{ghost:"",type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.handleSubmit("salaries",!0)}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("save_n_stay")))])]),t._v(" "),t.form.id?t._e():r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset()}}},[t._v(t._s(t.$t("reset")))])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},74097:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>u});var i=r(92704),s=r(7174),a=r.n(s),n=r(47401);const o={props:{salary:{type:Object,required:!0}},components:{VueBarcode:a(),ListAttachmentsComponent:n.Z},data:function(){return{loading:!1}},methods:{print:function(){window.print()},deleteAttachment:function(t){this.$emit("remove",t)}}};var l=r(51900);const c={components:{SalaryViewComponent:(0,l.Z)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{}},[t.salary.id?r("div",{staticClass:"order"},[r("div",{staticClass:"order-header"},[r("div",{staticClass:"details"},[r("img",{staticClass:"logo",attrs:{src:t.salary.user.location&&t.salary.user.location.logo?t.salary.user.location.logo:t.$store.state.settings.default_logo}}),t._v(" "),r("div",{staticClass:"header-text"},[r("ul",[r("li",[r("strong",[t._v(t._s(t.$store.getters.settings.name)+" ("+t._s(t.$store.getters.settings.short_name)+")")])]),t._v(" "),r("li",[r("strong",[t._v(t._s(t.$store.getters.settings.company))])]),t._v(" "),r("li",[t._v(t._s(t.$store.getters.settings.email)+" "),r("span",{staticClass:"text-muted"},[t._v("|")]),t._v(" "+t._s(t.$store.getters.settings.phone))]),t._v(" "),r("li",[t._v(t._s(t.$store.getters.settings.address))])])])]),t._v(" "),r("vue-barcode",{staticClass:"barcode",attrs:{width:1,margin:0,height:50,fontSize:12,"margin-top":0,format:"code39","margin-bottom":2,value:t.salary.reference}},[t._v("\n        "+t._s(t.$t("barcode_error"))+"\n      ")])],1),t._v(" "),r("Row",{staticClass:"border-t",attrs:{gutter:16}},[r("Col",{staticClass:"border-y py-2",attrs:{xs:24}},[r("h3",{staticClass:"text-center",staticStyle:{"text-transform":"uppercase"}},[t._v("\n          "+t._s(t.$tc("salary"))+"\n        ")])])],1),t._v(" "),r("Row",{staticClass:"border-y py-2",attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[t._v("\n        "+t._s(t.$t("date"))+": "),r("strong",[t._v(t._s(t._f("date")(t.salary.date)))]),t._v(" "),r("br"),t._v("\n        "+t._s(t.$t("reference"))+": "),r("strong",[t._v(t._s(t.salary.reference))]),t._v(" "),r("br"),t._v("\n        "+t._s(t.$t("created_at"))+": "),r("strong",[t._v(t._s(t._f("datetime")(t.salary.created_at)))])]),t._v(" "),r("Col",{attrs:{xs:24,sm:12}},[t._v("\n        "+t._s(t.$t("name"))+": "),r("strong",[t._v(t._s(t.salary.user.name))]),t._v(" "),r("br"),t._v("\n        "+t._s(t.$t("employee_number"))+": "),r("strong",[t._v(t._s(t.salary.user.employee_number))]),t._v(" "),r("br"),t._v("\n        "+t._s(t.$t("phone"))+": "),r("strong",[t._v(t._s(t.salary.user.phone))])])],1),t._v(" "),r("Row",{staticClass:"mt16",attrs:{gutter:16}},[r("Col",{attrs:{xs:24,sm:12}},[r("p",[t._v(t._s(t.$tc("store"))+":")]),t._v(" "),t.salary.user.location?r("div",[r("strong",[t._v(t._s(t.salary.user.location.name))]),r("br"),t._v("\n          "+t._s(t.salary.user.location.address+", "+t.salary.user.location.state_name+", "+t.salary.user.location.country_name)),r("br"),t._v("\n          "+t._s(t.salary.user.location.phone)),r("br"),t._v("\n          "+t._s(t.salary.user.location.email)),r("br")]):t._e()])],1),t._v(" "),r("div",{staticClass:"table-wrapper"},[r("table",{staticClass:"table"},[r("tbody",[r("tr",[r("td",[t._v(t._s(t.$tc("account")))]),t._v(" "),r("td",[t._v(t._s(t.salary.account.name))])]),t._v(" "),r("tr",[r("td",{staticClass:"bold"},[t._v(t._s(t.$t("amount")))]),t._v(" "),r("td",{staticClass:"bold"},[t._v(t._s(t.formatNumber(t.salary.amount)))])])])])]),t._v(" "),t.checkExtraAttributes(t.salary.extra_attributes)?r("Card",{staticClass:"mt16",attrs:{"dis-hover":""}},[r("span",{domProps:{innerHTML:t._s(t.renderExtraAttributes(t.salary.extra_attributes,t.salary.attributes))}})]):t._e(),t._v(" "),r("list-attachments-component",{staticClass:"mt16",attrs:{attachments:t.salary.attachments},on:{remove:t.deleteAttachment}}),t._v(" "),t.salary.details?r("Card",{staticClass:"mt16",attrs:{"dis-hover":""}},[t._v(t._s(t.salary.details))]):t._e(),t._v(" "),r("p",{staticClass:"cgd"},[t._v(t._s(t.$t("order_cgd")))])],1):t._e(),t._v(" "),r("div",{staticClass:"np text-center"},[r("Button",{staticClass:"mt16 mx8",attrs:{type:"primary",loading:t.loading,disabled:t.loading,icon:"md-print"},on:{click:function(e){return t.print()}}},[t._v("\n      "+t._s(t.$t("print"))+"\n    ")])],1)])}),[],!1,null,null,null).exports},mixins:[(0,i.Z)("salary","app/salaries","name")],data:function(){var t=this;return{salary:{},view:!1,message:null,loading:!1,url:"app/salaries",columns:[{title:this.$t("date"),sortable:!0,sortType:"desc",key:"date",width:100,render:this.renderDate},{title:this.$t("created_at"),sortable:!0,key:"created_at",width:175,render:this.renderCreatedAt},{title:this.$t("amount"),sortable:!0,key:"amount",minWidth:100,render:this.renderAmount},{title:this.$t("advance"),sortable:!0,key:"advance",width:100,render:this.renderAdvance},{title:this.$t("type"),sortable:!0,key:"type",width:100,render:this.renderType},{title:this.$t("status"),sortable:!0,key:"status",width:100,render:this.renderStatus},{title:this.$tc("user"),sortable:!0,key:"user",minWidth:175,render:this.renderUser},{title:this.$tc("account"),sortable:!0,key:"account",minWidth:175,render:this.renderAccount},{title:this.$t("details"),sortable:!1,key:"details",ellipsis:!0,width:350},{width:100,fixed:"right",key:"actions",align:"center",title:this.$t("actions"),render:function(e,r){return e("actions-component",{props:{params:r,viewFn:t.viewModal,editFn:t.editRecord,deleteFn:t.deleteRecord,record:{model:"salary",name:"reference"}}})}}],options:{orderBy:"date desc",perPage:this.$store.state.settings.rows}}},created:function(){this.url="app/salaries"+(this.$route.query.user_id?"?user_id="+this.$route.query.user_id:"")},methods:{viewModal:function(t){var e=this;this.view=!0,t.id!=this.salary.id&&(this.loading=!0,this.$http.get("app/salaries/".concat(t.id)).then((function(t){return e.salary=t.data})).finally((function(){return e.loading=!1})))},renderAmount:function(t,e){return this.renderNumber(t,e,"amount")},renderAdvance:function(t,e){return this.renderBoolean(t,e,"advance")},renderType:function(t,e){return t("div",{class:"text-center"},[e.row.type?t("div",{class:"ivu-tag ivu-tag-".concat("salary"==e.row.type?"primary":"purple"," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.$tc(e.row.type)])]):""])},renderStatus:function(t,e){return t("div",{class:"text-center"},[e.row.status?t("div",{class:"ivu-tag ivu-tag-".concat("paid"==e.row.status?"success":"warning"," ivu-tag-checked")},[t("span",{class:"ivu-tag-text ivu-tag-color-white"},[this.$t(e.row.status)])]):""])},renderAccount:function(t,e){return t("div",[e.row.account?e.row.account.name:""])},renderUser:function(t,e){return t("div",[e.row.user?e.row.user.name:""])},generateSalaries:function(){var t=this;this.loading=!0,this.$http.post("/app/salaries/generate").then((function(e){e.data.success&&(t.message=e.data.message,t.$Notice.success({title:t.$t("success"),desc:e.data.message||t.$t("record_updated"),duration:10}))})).catch((function(e){t.$Notice.error({title:t.$t("failed"),desc:e.message,duration:10})})).finally((function(){return t.loading=!1}))}}};const u=(0,l.Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("salary",2)))]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("router-link",{attrs:{slot:"extra",to:"/users/salaries/add"},slot:"extra"},[r("Icon",{attrs:{type:"ios-grid-outline"}}),t._v("\n        "+t._s(t.$t("add"))+" "+t._s(t.$tc("salary"))+"\n      ")],1),t._v(" "),r("Button",{attrs:{type:"primary",loading:t.loading,disabled:t.loading,size:"small"},on:{click:function(e){return t.generateSalaries()}}},[r("Icon",{attrs:{type:"ios-sync"}}),t._v("\n        "+t._s(t.$t("generate_x",{x:t.$tc("salary",2)}))+"\n      ")],1)],1),t._v(" "),r("div",[t.message?r("Alert",{domProps:{innerHTML:t._s(t.message.replaceAll("\n","<br />"))}}):t._e(),t._v(" "),r("table-component",{attrs:{url:t.url,columns:t.columns,options:t.options,refresh:t.refresh,dblClickCB:t.viewModal,bulkDelCB:t.deleteRecords}})],1)]),t._v(" "),r("Modal",{staticClass:"np-header-footer",attrs:{width:"750","footer-hide":!0,"mask-closable":!1,title:t.$tc("salary")+" ("+t.salary.reference+")"},model:{value:t.view,callback:function(e){t.view=e},expression:"view"}},[t.loading?r("div",{staticClass:"py16"},[r("Loading")],1):t._e(),t._v(" "),r("salary-view-component",{attrs:{salary:t.salary},on:{remove:function(e){return t.deleteAttachment(e,t.salary)}}})],1)],1)}),[],!1,null,null,null).exports},61855:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>p});function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var i,s,a=[],n=!0,o=!1;try{for(r=r.call(t);!(n=(i=r.next()).done)&&(a.push(i.value),!e||a.length!==e);n=!0);}catch(t){o=!0,s=t}finally{try{n||null==r.return||r.return()}finally{if(o)throw s}}return a}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){if(t){if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}const c={data:function(){var t=this;return{value:"",deleting:0,month:null,event:!1,saving:!1,loading:!1,interval:null,delete_id:null,newEventModal:!1,errors:{message:"",form:{}},translatedMonths:[1,2,3,4,5,6,7,8,9,10,11,12].map((function(e){return t.$t("i.datepicker.month"+parseInt(e))})),events:{},dateEvent:[],selected_date:null,form:{title:"",details:"",start_date:new Date,end_date:null,start_time:new Date,end_time:null,color:"#FFFFFF"},rules:{title:[{required:!0,message:this.$t("field_is_required",{field:this.$t("title")}),trigger:"blur"}],start_date:[{type:"date",required:!0,trigger:"change",message:this.$t("field_is_required",{field:this.$t("start_date")})}]}}},computed:{formatedDate:function(){return this.$options.filters.date(this.selected_date)}},mounted:function(){var t=this;this.setEvents(null,!0);for(var e=document.querySelectorAll(".ivu-picker-panel-icon-btn"),r=0;r<e.length;r++)e[r].addEventListener("click",this.handleClick);document.querySelectorAll(".ivu-date-picker-header-label")[0].addEventListener("click",(function(){for(var e=document.querySelector(".ivu-date-picker-cells-month").childNodes,r=0;r<e.length;r++)e[r].addEventListener("click",t.handleClick)})),document.querySelectorAll(".ivu-date-picker-header-label")[1].addEventListener("click",(function(){for(var e=document.querySelector(".ivu-date-picker-cells-year").childNodes,r=0;r<e.length;r++)e[r].addEventListener("click",(function(){for(var e=document.querySelector(".ivu-date-picker-cells-month").childNodes,r=0;r<e.length;r++)e[r].addEventListener("click",t.handleClick)}))}))},methods:{handleClick:function(t){if(t){for(var e=null,r=document.querySelectorAll(".ivu-date-picker-header-label")[0].outerText,i=document.querySelectorAll(".ivu-date-picker-header-label")[1].outerText,s=1;s<=12;s++)this.$t("i.datepicker.month"+parseInt(s))==r&&(e=s>9?s:"0"+s);var a=i+"-"+e;this.setEvents(a)}},setEvents:function(t,e){var r=this;(t!=this.month||e)&&(t||(t=this.$moment().format("YYYY-MM")),this.$http.get("app/events?month="+t).then((function(t){return r.events=t.data})).then((function(){r.loading=!1;for(var t=[],e=0,i=Object.entries(r.events);e<i.length;e++){var s=n(i[e],2),o=s[0];s[1];t.push(parseInt(o.substring(o.length-2,o.length))-1)}a(document.querySelectorAll(".ivu-date-picker-cells-cell:not(.ivu-date-picker-cells-cell-prev-month):not(.ivu-date-picker-cells-cell-next-month)")).map((function(e,r){if(t.includes(r)){var i=document.createElement("span");i.style.position="absolute",i.innerHTML='<div class="got-event"></div>',e.firstChild.append(i)}}))})))},handleChange:function(t){this.selected_date=t,this.dateEvent=this.events[t],this.dateEvent&&(this.event=!0)},closeModal:function(){this.newEventModal=!1,this.form={title:"",details:"",start_date:this.$moment().format("YYYY-MM-DD"),end_date:null,start_time:new Date,end_time:null,color:"#FFFFFF"}},addEvent:function(){var t=this;this.$refs.newEvent.validate((function(e){if(e){t.saving=!0;var r="added",a="post",n="app/events";t.errors.message="";var o="record_added";t.form.id&&(a="put",r="updated",o="record_updated",n=n+"/"+t.form.id);var l=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t.form);l.start_date&&(l.start_date=t.$moment(l.start_date).format(t.$moment.HTML5_FMT.DATE)),l.end_date&&(l.end_date=t.$moment(l.end_date).format(t.$moment.HTML5_FMT.DATE)),t.$http[a](n,l).then((function(e){e.data.success?(t.newEventModal=!1,t.setEvents(t.month,!0),t.$Notice.destroy(),t.$Notice.success({title:t.$tc("event")+" "+t.$t(r),desc:t.$t(o)}),t.form={title:"",details:"",start_date:t.$moment().format("YYYY-MM-DD"),end_date:null,start_time:new Date,end_time:null,color:"#FFFFFF"}):t.$Notice.error({title:t.$t("failed"),desc:t.$t("failed_error_text")})})).catch((function(e){return t.errors=e})).finally((function(){t.event=!1,t.saving=!1,t.loading=!1}))}else t.$Notice.error({title:t.$t("invalid_form"),desc:t.$t("invalid_form_error"),duration:10})}))},deleteEvent:function(t,e){var r=this;this.delete_id=e,this.deleting=5,this.interval=setInterval((function(){r.deleting--,r.deleting||r.$http.delete("app/events/"+e).then((function(e){e.data.success&&(r.events[r.selected_date].splice(t,1),r.$Notice.success({title:r.$t("deleted"),desc:r.$t("record_deleted")}))})).catch((function(t){return r.$Notice.error({title:r.$t("failed"),desc:r.$t("failed_error_text")})})).finally((function(){r.delete_id=null,r.resetDelete()}))}),500)},resetDelete:function(){this.deleting=0,this.delete_id=null,clearInterval(this.interval)}}};var u=r(93379),d=r.n(u),m=r(69199),h={insert:"head",singleton:!1};d()(m.Z,h);m.Z.locals;const p=(0,r(51900).Z)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$t("calendar")))]),t._v(" "),r("Button",{attrs:{slot:"extra",type:"text",size:"small"},on:{click:function(e){t.newEventModal=!0}},slot:"extra"},[r("Icon",{attrs:{type:"ios-add-circle-outline",size:"16"}}),t._v("\n      "+t._s(t.$t("add_x",{x:t.$tc("event")}))+"\n    ")],1),t._v(" "),r("div",{staticClass:"calendar"},[r("DatePicker",{attrs:{type:"date",open:!0,value:t.value,transfer:!1,clearable:!1},on:{"on-change":t.handleChange,"on-open-change":t.handleClick}},[r("a",{staticStyle:{width:"0",height:"0",padding:"0",margin:"0"},attrs:{href:"javascript:void(0)"}})]),t._v(" "),r("transition",{attrs:{name:"event"}},[t.event?r("div",{staticClass:"events"},[r("Card",{staticStyle:{height:"100%"},attrs:{"dis-hover":""}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n              "+t._s(t.$t("events_on",{x:t.formatedDate}))+"\n            ")]),t._v(" "),r("a",{attrs:{slot:"extra"},on:{click:function(e){t.event=!1}},slot:"extra"},[r("Icon",{attrs:{type:"ios-close-circle",size:"20",color:"#495060"}})],1),t._v(" "),r("div",{staticClass:"day-events"},t._l(t.dateEvent,(function(e,i){return r("Card",{key:"event_"+i,staticStyle:{"margin-right":"16px","margin-bottom":"16px"},attrs:{"dis-hover":""}},[r("div",{staticStyle:{"min-width":"60px",position:"absolute",top:"-5px",right:"0","text-align":"right"},attrs:{slot:"extra"},slot:"extra"},[r("a",{on:{click:function(r){t.form=e,t.newEventModal=!0}}},[r("Icon",{attrs:{type:"ios-create",size:"20",color:"#495060"}})],1),t._v(" "),r("span",{staticStyle:{"margin-left":"8px",position:"relative"}},[t.delete_id&&t.delete_id==e.id?r("span",{staticStyle:{color:"red",position:"absolute",width:"150px",top:"-5px",right:"0",display:"flex","align-items":"center"}},[r("span",{staticStyle:{"margin-right":"5px"}},[t._v(t._s(t.$t("deleting_in",{x:t.deleting})))]),t._v(" "),r("Button",{staticClass:"red-bg",attrs:{type:"error",size:"small"},on:{click:function(e){return t.resetDelete()}}},[t._v(t._s(t.$t("cancel")))])],1):r("a",{on:{click:function(r){return t.deleteEvent(i,e.id)}}},[r("Icon",{attrs:{type:"ios-trash",size:"20",color:"#495060"}})],1)])]),t._v(" "),r("div",{staticClass:"event"},[r("h3",[t._v(t._s(e.title))]),t._v(" "),e.details?r("p",[t._v(t._s(e.details))]):r("p",{staticStyle:{"margin-bottom":"-16px"}}),t._v(" "),r("div",{staticClass:"time"},[e.start_date?r("span",[t._v("\n                      "+t._s(t.$t("start_date"))+": "),r("strong",[t._v(t._s(t._f("date")(e.start_date)))])]):t._e(),t._v(" "),e.start_time?r("span",[t._v("\n                      "+t._s(t.$t("start_time"))+": "),r("strong",[t._v(t._s(e.start_time))])]):t._e(),t._v(" "),e.end_date?r("span",[t._v("\n                      "+t._s(t.$t("end_date"))+": "),r("strong",[t._v(t._s(t._f("date")(e.end_date)))])]):t._e(),t._v(" "),e.end_time?r("span",[t._v("\n                      "+t._s(t.$t("end_time"))+": "),r("strong",[t._v(t._s(e.end_time))])]):t._e()])])])})),1)])],1):t._e()])],1)],1),t._v(" "),r("Modal",{attrs:{"footer-hide":""},model:{value:t.newEventModal,callback:function(e){t.newEventModal=e},expression:"newEventModal"}},[r("p",{attrs:{slot:"header"},slot:"header"},[t.form.id?r("span",[t._v("\n        "+t._s(t.$t("edit_x",{x:t.$tc("event")}))+"\n      ")]):r("span",[t._v("\n        "+t._s(t.$t("add_x",{x:t.$tc("event")}))+"\n      ")])]),t._v(" "),r("a",{staticStyle:{"margin-top":"6px",display:"inline-block",width:"2.5em",height:"2.5em"},attrs:{slot:"close"},on:{click:function(e){return t.closeModal()}},slot:"close"},[r("Icon",{attrs:{type:"md-close",size:"20"}})],1),t._v(" "),r("Form",{ref:"newEvent",staticClass:"form-responsive normal",attrs:{model:t.form,rules:t.rules,"label-position":"top"}},[r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{staticClass:"mb26",attrs:{label:t.$t("title"),prop:"title",error:t._f("a2s")(t.errors.form.title)}},[r("Input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"mb26",attrs:{label:t.$t("start_date"),prop:"start_date",error:t._f("a2s")(t.errors.form.start_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.start_date,callback:function(e){t.$set(t.form,"start_date",e)},expression:"form.start_date"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"mb26",attrs:{label:t.$t("end_date"),error:t._f("a2s")(t.errors.form.end_date)}},[r("DatePicker",{staticStyle:{width:"100%"},attrs:{type:"date",format:"yyyy-MM-dd"},model:{value:t.form.end_date,callback:function(e){t.$set(t.form,"end_date",e)},expression:"form.end_date"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"mb26",attrs:{label:t.$t("start_time"),prop:"start_time",error:t._f("a2s")(t.errors.form.start_time)}},[r("TimePicker",{staticStyle:{width:"100%"},attrs:{type:"time",format:"HH:mm:ss"},model:{value:t.form.start_time,callback:function(e){t.$set(t.form,"start_time",e)},expression:"form.start_time"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:12,lg:12}},[r("FormItem",{staticClass:"mb26",attrs:{label:t.$t("end_time"),error:t._f("a2s")(t.errors.form.end_time)}},[r("TimePicker",{staticStyle:{width:"100%"},attrs:{type:"time",format:"HH:mm:ss"},model:{value:t.form.end_time,callback:function(e){t.$set(t.form,"end_time",e)},expression:"form.end_time"}})],1)],1),t._v(" "),r("Col",{attrs:{sm:24,md:24,lg:24}},[r("FormItem",{staticClass:"mb26",attrs:{label:t.$t("details")}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5}},model:{value:t.form.details,callback:function(e){t.$set(t.form,"details",e)},expression:"form.details"}})],1),t._v(" "),r("FormItem",{staticClass:"mb0"},[r("Button",{attrs:{type:"primary",loading:t.saving,disabled:t.saving},on:{click:function(e){return t.addEvent()}}},[t.saving?r("span",[t._v(t._s(t.$t("saving"))+"...")]):r("span",[t._v(t._s(t.$t("submit")))])]),t._v(" "),r("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.closeModal()}}},[t._v("Cancel")])],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null).exports},88456:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>s});const i={data:function(){return{page:1,loading:!1,notifications:{}}},watch:{"$route.query.reload":function(){console.log("reload"),this.getNotifications()}},mounted:function(){this.getNotifications()},methods:{getNotifications:function(){var t=this;this.$http.get("app/notifications",{params:{page:this.page}}).then((function(e){return t.notifications=e.data}))},pageChanged:function(t){this.page=t},markAsRead:function(t){var e=this;this.$http.put("app/notifications/"+t).then((function(){return e.getNotifications()}))},markAsUnread:function(t){var e=this;this.$http.post("app/notifications/"+t).then((function(){return e.getNotifications()}))},deleteNotification:function(t){var e=this;this.$http.delete("app/notifications/"+t).then((function(){return e.getNotifications()}))},readAllNotification:function(){var t=this;this.$http.post("app/notifications/read/all").then((function(){return t.getNotifications()}))},deleteAllNotification:function(){var t=this;this.$http.post("app/notifications/delete/all").then((function(){return t.getNotifications()}))}}};const s=(0,r(51900).Z)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("Card",{attrs:{"dis-hover":!0}},[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(t.$tc("notification",2)))]),t._v(" "),r("span",{attrs:{slot:"extra"},slot:"extra"},[r("Button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.readAllNotification()}}},[t._v("\n        "+t._s(t.$t("mark_all_as_x",{x:t.$t("read")}))+"\n      ")]),t._v(" "),r("Button",{attrs:{type:"error",size:"small"},on:{click:function(e){return t.deleteAllNotification()}}},[r("Icon",{attrs:{type:"ios-trash",size:"16"}}),t._v("\n        "+t._s(t.$t("delete_x",{x:t.$t("all")}))+"\n      ")],1)],1),t._v(" "),t.notifications.data&&t.notifications.data.length?r("div",[r("List",t._l(t.notifications.data,(function(e){return r("ListItem",{key:e.id},[r("ListItemMeta",[r("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n              "+t._s(e.data.title)+"\n              "),e.read_at?r("Icon",{attrs:{type:"md-checkmark"}}):t._e()],1),t._v(" "),r("div",{attrs:{slot:"description"},slot:"description"},[t._v("\n              "+t._s(e.data.description)+"\n              "),r("div",{staticStyle:{"font-weight":"normal","margin-top":"5px"}},[r("Icon",{attrs:{type:"md-time"}}),t._v("\n                "+t._s(t.datetime(e.created_at))+"\n              ")],1)])]),t._v(" "),r("template",{slot:"action"},[e.read_at?r("li",[r("Button",{attrs:{type:"text",size:"small"},on:{click:function(r){return t.markAsUnread(e.id)}}},[t._v(t._s(t.$t("mark_as_x",{x:t.$t("unread")})))])],1):r("li",[r("Button",{attrs:{type:"text",size:"small"},on:{click:function(r){return t.markAsRead(e.id)}}},[t._v(t._s(t.$t("mark_as_x",{x:t.$t("read")})))])],1),t._v(" "),r("li",[r("Button",{attrs:{ghost:"",type:"error",size:"small"},on:{click:function(r){return t.deleteNotification(e.id)}}},[t._v(t._s(t.$t("delete")))])],1)])],2)})),1),t._v(" "),r("Row",{staticStyle:{"padding-top":"16px","border-top":"1px solid #e8eaec"}},[r("Col",{staticClass:"table-info",attrs:{sm:24,md:8}},[r("span",{staticStyle:{"line-height":"32px"}},[t.notifications.total>0?r("span",[t._v(t._s(t.$t("table_info",{start:t.notifications.from,end:t.notifications.to,total:t.notifications.total})))]):r("span",[t._v(t._s(t.$t("zero_records")))])])]),t._v(" "),t.page>0?r("Col",{staticClass:"table-page",attrs:{sm:24,md:16}},[r("span",{staticClass:"page"},[r("Page",{attrs:{total:t.notifications.total,"page-size":t.notifications.per_page,current:t.notifications.current_page},on:{"on-change":t.pageChanged}})],1)]):t._e()],1)],1):r("Alert",{attrs:{type:"warning","show-icon":""}},[t._v("\n      "+t._s(t.$t("no_data"))+"\n    ")])],1)],1)}),[],!1,null,null,null).exports},24960:()=>{},26759:()=>{},56272:()=>{}}]);